/*! For license information please see deferred.js.LICENSE.txt */
(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred",340,380,391,562,617],Array(1571).concat([function(e,t,n){"use strict";n.r(t),n.d(t,"oneDriveItemFacet",function(){return P});var a=n(0),i=n(65),r=n(2),o=n(6),s=n(21),c=n(108),d=n(9),l=n(43),u=n(1155),f=n(34),p=n(197),m=n(144),_=n(695),h=n(14),b=n(235),g=n(78),v=n(57),y=n(454),S=n(209),D=n(1044),I=n(484),x=n(308),C=n(16),O=n(115),w=n(450),E=n(194),A=n(501),L=n(718),k=n(381),M=C.e.isActivated("05C4FA92-0F9B-44BF-93E9-70913775DFAE","11/12/2020","Avoid demanding parent item data just to determine identity"),P=new i.e("oneDriveItem",function(e,t){var n=t.itemKey,i=e.demandItemFacet(b.t,n);if(void 0!==i){var C=i.key,P=i.id,T=e.demandItemFacet(o.f,n),U=e.demandItemFacet(o.m,n),F=U&&U.name||T||"",H=U&&U.extension||"",R=e.demandItemFacet(d.e,n),N=e.demandItemFacet(o._,n),B=e.demandItemFacet(o.h,n),j=e.demandItemFacet(o.d,n),V=e.demandItemFacet(f.k,p.e),z=V&&V.language||window.navigator.language,G=e.demandItemFacet(o.L,n),K=e.demandItemFacet(S.e,n),W=B||K?m.e.Folder:m.e.File,q=Object(_.a)({type:W,extension:H,textEditorMimeType:void 0}),Q=e.demandItemFacet(g.e,n),Y=e.demandItemFacet(v.ct,n),J=e.demandItemFacet(y.e,n),X=J&&new Date(J.sharedDateTime).getTime(),Z=e.demandItemFacet(o.c,n),$=e.demandItem({createdByPerson:I.a},n).createdByPerson,ee=e.demandItemFacet(v.On,n),te=e.demandItemFacet(v.Ke,n),ne=e.demandItemFacet(v.Ge,n),ae=e.demandItemFacet(o.M,n,{suppressGetItems:!1}),ie=ae&&ae.itemKey,re=e.demandItemFacet(b.t,ie,{suppressGetItems:!M}),oe=re&&re.key,se=e.demandItemFacet(c.i,n),ce=B||K?m.e.Folder:se?m.e.OneNote:m.e.File,de=function(e,t){var n=e.demandItemFacet(O.t,t);if(n){var a=w.e.accessDenied,i=401,o=L.e,s=n.message||A.DefaultSubText;if(n instanceof k.e){var c=Object(r.a)({accessDeniedError:E.e,itemNotFoundError:E.p,offlineError:E.v},n.facets),d=c.accessDeniedError,l=c.itemNotFoundError,u=c.offlineError;d||l?(o=A.ItemNotFoundTitle,s=A.ItemNotFoundSubText,l&&(i=404)):u&&(s=A.offlineActionFailed)}return{type:a,data:{errorCode:i,errorTitle:o,errorDetailedText:s}}}}(e,n),le=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({key:C,queryType:l.e.Files,displayType:l.e.Files,id:P},R?{itemId:R.itemId}:{}),R?{graph:{itemId:R.itemId,driveId:R.driveId}}:{}),F?{name:F}:{}),T?{displayName:T}:{}),H?{extension:H}:{}),void 0!==N?{size:N}:{}),{type:ce}),B?{folder:{}}:{}),{childCount:Q,isBundle:!!K}),oe?{parentKey:oe}:{}),void 0===j||isNaN(j)?{}:{dateModifiedTime:new Date(j),dateModified:Object(u.n)(new Date(j),z)}),void 0===Z||isNaN(Z)?{}:{dateCretedTime:new Date(Z),dateCreated:Object(u.n)(new Date(Z),z)}),void 0===X||isNaN(X)?{}:{dateSharedTime:new Date(X),dateShared:Object(u.n)(new Date(X),z)}),{properties:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},ee?{uniqueId:Object(x.normalizeLower)(ee,!0)}:{}),ne?{listId:Object(x.normalizeLower)(ne,!0)}:{}),te?{ID:te}:{})}),q?{iconName:q}:{}),Y?{appMap:Y}:{}),{urls:{}}),G?{openUrl:G}:{}),de?{error:de}:{}),{creatorName:$&&$.displayValue,isPlaceholder:!e.isItemFacetResolved(o.f,n)&&!e.isItemFacetResolved(s.e,n)&&!e.isItemFacetResolved(O.t,n),state:{},recycleBinProperties:{},reputationProperties:{},statistics:{}}),ue=e.demandItemFacet(D.e,h.e);return D.e.evaluate(ue)(e,{itemKey:n,key:C,item:le}).item}})}],Array(118),[function(e,t,n){"use strict";n.r(t),n.d(t,"WithKnockoutStoreItems",function(){return S}),n.d(t,"WithKnockoutResourcesAndItemCacheData",function(){return D});var a=n(1),i=n(188),r=(n(0),n(1050),n(494)),o=n(6),s=n(172),c=n(69),d=n(52),l=n(44),u=n(135),f=n(808),p=n(1282),m=n(1129),_=n(3741),h=n(862),b=n(146),g=n(8),v=n(233),y=n(3),S=Object(d.t)(function(e,t){var n=t.itemKey,i=t.children,d=function(e,t){var n=[];t&&n.push(t);var a=Object(c.e)(e);a&&n.push(a);var i=Object(s.e)(e);if(i)for(var r=0,o=i;r<o.length;r++){var d=o[r];n.push(d)}return n}(e,n);return Object(y.cs)(y.jo)||function(e,t){var n=!0;return t.forEach(function(t){n=n&&function(e,t){for(var n=!0,a=t;a;){e.demandItemFacet(r.t,a),n=n&&e.isItemFacetResolved(r.t,a);var i=e.demandItemFacet(o.M,a);a=i&&i.itemKey}return n}(e,t)}),n}(e,d)?a.createElement(a.Fragment,null,i):null}),D=Object(i.n)(v.e)(Object(i.n)(S)(function(e){var t=Object(b.n)(),n=Object(l.t)({initializeResources:function(e){g.e.isActivated("39107185-9E15-471B-BECB-F5ACE7B98951","02/08/2022","Override ItemCache evaluation context for shimmed components")||e.expose(h.e,t),e.exposeFactory(f.e,new u.e(p.typeResourceKey)),e.exposeFactory(m.resourceKey,new u.e(_.resourceKey))},options:{owner:"ItemCacheToKOResourceProvider"}},[]);return a.createElement(l.e,{resources:n},e.children)}))}],Array(21),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return H});var a,i=n(0),r=n(123),o=n(8),s=n(47),c=n(7),d=n(135),l=n(191),u=n(1828),f=function(){var e,t,n;return a||(a=null===(n=null===(t=null===(e=window.mssearchux)||void 0===e?void 0:e.header)||void 0===t?void 0:t.getInstrumenter)||void 0===n?void 0:n.call(t)),a},p=function(e,t){var n,a,i=t||_(),r=e||h().activeScopeId;try{for(var o=Object(u.s)(i||[]),s=o.next();!s.done;s=o.next()){var c=s.value;if(c.id===r)return c}}catch(e){n={error:e}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}},m=function(e,t){var n;t&&(a=t);var i=f();i&&i.setProps({hostAppInfo:Object(u.e)(Object(u.e)({},i.props.hostAppInfo),{scopeId:null===(n=p(e.activeScopeId,e.scopes))||void 0===n?void 0:n.searchBoxScopeId}),scopingControl:Object(u.e)({},e)})},_=function(){var e;return null===(e=h())||void 0===e?void 0:e.scopes},h=function(){var e;return null===(e=f())||void 0===e?void 0:e.props.scopingControl},b=n(37),g=n(855),v=new c.t("scopingControlDataSource"),y=n(1337),S=n(106),D=(n(547),n(1039)),I={id:"spListFolder",name:D.t},x={id:"spList",name:D.r},C={id:"spDocLibFolder",name:D.t},O={id:"spDocLib",name:D.i};D.o,D.a,D.e,D.n,D._;var w,E=n(403),A=n(3),L=n(254),k=n(446),M=n(16),P=n(896),T=n(4335),U="AdvancedSearchButton",F=function(){function e(e,t){this._isConfigured=!1,this._resources=t.resources,this._engagement=t.engagement,this._searchBoxDataSource=t.searchBoxDataSource,this._config=t.searchBoxConfig,this._scope=new l.e,this._getViewParams=function(){throw new Error("Search box not configured")},this._isLastPageSearch=!1,this._searchInstrumenter=this._config.getInstrumenter(),this._scopingControlDataSource=t.scopingControlDataSource,this._metadataSearchDataSource=t.metadataSearchDataSource,this._bootOptions=t.bootOptions,this._teachingBubbleProvider=t.teachingBubbleProvider,this._shouldLogContentQueryFREDismissed=!o.t.isActivated("A9535421-FA61-46CA-BC67-46B656FE5319","05/24/2023","add logs for unintentional teaching bubble dismiss")}return e.prototype.configureSearchBox=function(e){var t=this;if(this._config.isEnabled()){var n=new s.e({name:"SuiteNavSearchBox.Configure"});this._getViewParams=e,this._isLastPageSearch=this._searchBoxDataSource.isSearchResultsPage(),this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.OnHasMember("Search",function(){var a,r,c,d,l=e.Search;Object(A.cs)(A.Ha)&&!(null===(a=t._metadataSearchDataSource)||void 0===a?void 0:a.isMetadataSearchResultPage(t._getViewParams()))||l.SetSearchText(t._config.getSearchText()),l.SetPlaceholderText(t._config.getPlaceholderText()),l.SetTokenProviders(t._searchBoxDataSource.getTokenProviders());var u=l.OnSubmitSearch(t._onSubmitSearchCallback.bind(t)),f=l.OnSearchBoxActivated(t._onSearchBoxActivatedCallback.bind(t)),p=l.OnSearchBoxDeactivated(t._onSearchBoxDeactivatedCallback.bind(t));t._trackHandler(u,l.RemoveOnSubmitSearch),t._trackHandler(f,l.RemoveOnSearchBoxActivated),t._trackHandler(p,l.RemoveOnSearchBoxDeactivated);var m,_=l.OnExitSearch(t._onExitSearchCallback.bind(t));t._trackHandler(_,l.RemoveOnExitSearch),t._searchBoxDataSource.getProviderConfigUpdaters&&l.SetProviderConfigUpdaters(t._searchBoxDataSource.getProviderConfigUpdaters(null===(r=t._scopingControlDataSource)||void 0===r?void 0:r.getActiveScope.bind(t._scopingControlDataSource),t._getViewParams)),(Object(A.cs)(A.Ha)||Object(A.cs)(A.qa))&&(t._shouldDisableSetSearchBoxSettingsInChromeless()&&(null===(c=t._bootOptions)||void 0===c?void 0:c.chromeless)&&!(null===(d=t._bootOptions)||void 0===d?void 0:d.isListHome)&&!t.shouldSetSearchBoxSettings(l)||l.SetSearchBoxSettings(Object(i.__assign)({cache:void 0,instrumenter:t._config.getInstrumenter(),tokenProviders:t._config.getTokenProviders()},o.t.isActivated("8852ae00-f7e0-4a74-bf2e-f5f33e61fde7","09/30/2020","[stvikenv] Specify search box loading pattern in SetSearchBoxSettings in odsp-next.")?{}:{loadingPattern:(w||(w=L.n.isFeatureEnabled({ODB:1804})||(m=window._spPageContextInfo)&&!M.e.isActivated("1166a987-eb1e-4f42-baf6-46d50b7fc0c4","09/30/2020","[stvikenv] Activate this kill switch to pause experiment 90065 - using the PFP loading pattern in the search box.")&&1===Object(k.n)(90065,m)?"pfp":"eager"),w)}))),t._updateSearchInstrumenter(),n.end({resultType:s.t.Success})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getO365ShellError"})})}).catch(function(e){n.end({resultType:s.t.Failure,error:e.message,resultCode:"getSuiteNavProviderError"})}),this._updateSearchInstrumenter(),this._isConfigured=!0}},e.prototype.updateSearchBoxConfiguration=function(e,t){var n,a,i,c,d;null===(a=(n=this._searchBoxDataSource).setIsPrimedLibrary)||void 0===a||a.call(n,t),!o.t.isActivated("aa2a6471-d9a3-4277-8151-55fd6b5b4b27","11/18/2022","set isGenericList")&&e&&(null===(c=(i=this._searchBoxDataSource).setIsGenericList)||void 0===c||c.call(i,Object(r.o)(e))),this._listTemplate=e,this._isMetadataSearchSupported=this._isMetadataSearchSupportedTemplate(this._listTemplate);var l=new s.e({name:"SuiteNavSearchBox.UpdateSearchBoxConfiguration"});if(this._isConfigured)try{this._resetSearchBoxText(),this._updateSearchInstrumenter(),l.end({resultType:s.t.Success})}catch(e){l.end({resultType:s.t.Failure,error:e,resultCode:"RuntimeError"})}else l.end({resultType:s.t.Failure,resultCode:"SearchBoxNotInitialized"});var u=null===(d=this._removeTeachingBubble)||void 0===d?void 0:d.call(this);this._logTeachingBubbleDismissEngagment(!1,u)},e.prototype.dispose=function(){this._scope.dispose()},e.prototype._shouldDisableSetSearchBoxSettingsInChromeless=function(){return!o.t.isActivated("4385e4cc-3ff4-4707-a6b7-ca36740100a0","2020/11/12","Disable SetSearchBoxSettings when chromeless")},e.prototype._isMetadataSearchSupportedTemplate=function(e){var t;if(!this._metadataSearchDataSource)return!1;var n=!!e&&!Object(r.o)(e);return Object(A.cs)(A.C)?(n=!0,this._metadataSearchDataSource.isList=!!e&&Object(r.o)(e)):n=n||(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.isMetadataSearchResultPage(this._getViewParams())),n},e.prototype.shouldSetSearchBoxSettings=function(e){var t=e.GetSearchBoxSettings();return!(null==t?void 0:t.instrumenter)},e.prototype._runInShellSearch=function(e){return this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){return e.getO365Shell()}).then(function(t){t.OnHasMember("Search",function(){return e(t.Search)})})},e.prototype._resetSearchBoxText=function(e){var t=this,n=this._searchBoxDataSource.isSearchResultsPage(),a=Object(A.cs)(A.Ha);this._config.isEnabled()&&this._runInShellSearch(function(e){(!a||n||t._isLastPageSearch)&&e.SetSearchText(t._config.getSearchText()),e.SetPlaceholderText(t._config.getPlaceholderText()),t._isLastPageSearch=n})},e.prototype._trackHandler=function(e,t){this._scope.attach({dispose:function(){return t(e)}})},e.prototype._onSubmitSearchCallback=function(e,t,n){var a,i,r,o=this._getViewParams();this._searchBoxDataSource.isSearchResultsPage()||(this._viewParamsBeforeSearch=o,this._urlBeforeSearch=window.location.href),this._isScopeControlSupported()&&(r=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage()),i=this._scopingControlDataSource.getActiveScope()),this._engagement.logData({name:"SuiteNavSearchBox.Click",isIntentional:!0,extraData:{trigger:n?"ScopingControl":"SubmitSearch",targetScope:null==i?void 0:i.id},scenario:r,privacyClassification:b.t.optionalDiagnostic}),this._searchBoxDataSource.onSubmitSearchCallback(e,this._getViewParams,null===(a=this._scopingControlDataSource)||void 0===a?void 0:a.getActiveScope(),this._urlBeforeSearch,n),this._endQos("Click")},e.prototype._onExitMetadataSearchCallback=function(){var e,t,n=this;if(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isMetadataSearchMode){this._metadataSearchDataSource.isMetadataSearchMode=!1;var a=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource);this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(a,n._getViewParams)),n._updateSearchInstrumenter()})}},e.prototype._onExitSearchCallback=function(){this._searchBoxDataSource.onExitSearchCallback&&(this._searchBoxDataSource.isSearchResultsPage()&&(this._engagement.logData({name:"SuiteNavSearchBox.ExitSearch",isIntentional:!0}),this._searchBoxDataSource.onExitSearchCallback(this._viewParamsBeforeSearch)),this._onExitMetadataSearchCallback())},e.prototype._onSearchBoxActivatedCallback=function(){var e,t,n,a;this._isScopeControlSupported()&&(a=this._scopingControlDataSource.getScopeControlScenario(this._scopingControlDataSource.getInitialScope(),this._searchBoxDataSource.isSearchResultsPage())),this._engagement.logData({name:"SuiteNavSearchBox.FocusIn",isIntentional:!0,scenario:a,privacyClassification:b.t.optionalDiagnostic,extraData:{isMetadataSearchAvailable:!!this._metadataSearchDataSource}}),this._startQos(),(null===(e=this._metadataSearchDataSource)||void 0===e?void 0:e.isQueryableListColumnsSupported())||null===(t=this._metadataSearchDataSource)||void 0===t||t.getSiteColumns(),Object(A.cs)(A.D)&&(null===(n=this._metadataSearchDataSource)||void 0===n?void 0:n.shouldShowDiscoveryFRE())&&this._runContentQueryDiscoveryFRE()},e.prototype._runContentQueryDiscoveryFRE=function(){var e=this,t=document.querySelector("#".concat(U));this._metadataSearchDataSource&&t&&n.ee(54,3376).then(function(a){var i=!!e._shouldLogContentQueryFREDismissed||void 0;e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN,!1).then(function(r){r?n.ee([708,"ondemand.resx-ondemand"],5311).then(function(n){n.showContentQueryDiscoveryTeachingBubble(t,function(){o.t.isActivated("EB47E8AD-F922-4EAD-A345-1BD51CC67383","04/14/2023","do not show second attack FRE if user 'Try it now'")||e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN),e._openMetadataSearchForm(),e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_TRYITNOW_ENGAGEMENT,isIntentional:i})},function(){e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_MAYBELATER_ENGAGEMENT,isIntentional:i})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT,isIntentional:i})}):a.shouldShowSecondaryDiscoveryTeachingBubble()&&e._teachingBubbleProvider.shouldBubbleBeAdded(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN,!1).then(function(r){r&&n.ee(16,4912).then(function(n){n.runContentQueryDiscoverySecondaryTeachingBubble(t,function(){e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_DISMISSED_ENGAGEMENT,isIntentional:i})}),e._teachingBubbleProvider.markBubbleAsSeen(a.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN),e._removeTeachingBubble=n.removeMetadataSearchTeachingBubble,e._engagement.logData({name:a.DISCOVERY_SECONDARY_TEACHING_BUBBLE_SHOWN_ENGAGEMENT,isIntentional:i})})})})})},e.prototype._onSearchBoxDeactivatedCallback=function(){this._engagement.logData({name:"SuiteNavSearchBox.FocusOut",isIntentional:!0,privacyClassification:b.t.optionalDiagnostic}),this._endQos("FocusOut")},e.prototype._startQos=function(){this._currentQosEvent&&this._currentQosEvent.end({resultType:s.t.Failure}),this._currentQosEvent=new s.e({name:"SuiteNavSearchBox.Usage"})},e.prototype._endQos=function(e){this._currentQosEvent&&(this._currentQosEvent.end({resultType:s.t.Success,resultCode:e}),this._currentQosEvent=void 0)},e.prototype._updateSearchInstrumenter=function(){if(this._triggerSearchBoxReconfiguration(),this._isScopeControlSupported()){m(this._getScopingControlConfig(),this._searchInstrumenter);var e=this._scopingControlDataSource.getInitialScope();this._scopingControlDataSource.setActiveScope(e)}this._setSearchInstrumenterProps(),this._configureMetadataSearch()},e.prototype._isScopeControlSupported=function(){return!!this._scopingControlDataSource&&this._scopingControlDataSource.isScopingControlEnabled()},e.prototype._isMetadataSearchSupportedScope=function(e){var t=e||O,n=t===O||t===C,a=t===x||t===I;return Object(A.cs)(A.C)?n||a:n},e.prototype._getScopingControlConfig=function(){var e=this;if(!this._isScopeControlSupported())throw new Error("Scoping control is not supported.");return{scopes:this._scopingControlDataSource.getAvailableScopes(),activeScopeId:this._scopingControlDataSource.getInitialScope().id,onChange:function(t,n){e._scopingControlDataSource.setActiveScope(n),e._triggerSearchBoxReconfiguration();var a=!!t&&e._searchBoxDataSource.isSearchResultsPage();e._logScopeChange(n,a),a?e._onSubmitSearchCallback(t,void 0,!0):e._setFocusSearchBox(),e._metadataSearchDataSource&&e._updateMetadataSearchConfiguration()}}},e.prototype._hideScopingControl=function(){this._searchInstrumenter.setProps({scopingControl:Object(i.__assign)(Object(i.__assign)({},this._searchInstrumenter.props.scopingControl),{activeScopeId:void 0,scopes:void 0})})},e.prototype._configureMetadataSearch=function(){var e=this;this._metadataSearchDataSource&&(this._metadataSearchDataSource.updateMetadataSearchConfig=function(t){e._metadataSearchDataSource.isMetadataSearchMode=e._metadataSearchDataSource.isMetadataSearchResultPage(e._getViewParams())||t,e._updateMetadataSearchConfiguration(),e._metadataSearchDataSource.isMetadataSearchMode?t&&e._setFocusSearchBox():e._isScopeControlSupported()&&m(e._getScopingControlConfig(),e._searchInstrumenter)},this._metadataSearchDataSource.isMetadataSearchMode=this._metadataSearchDataSource.isMetadataSearchResultPage(this._getViewParams()),this._updateMetadataSearchConfiguration())},e.prototype._hideMetadataSearchButton=function(){var e;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:void 0})},e.prototype._showMetadataSearchButton=function(){var e,t=this;null===(e=this._searchInstrumenter)||void 0===e||e.setProps({filterButtonConfig:{id:U,onClick:function(e){var n,a,i=e||window.event;if(i)if(i.preventDefault(),t._teachingBubbleProvider&&!Object(A.cs)(A.D))t._showMetadataSearchTeachingBubble(i);else{var r=null===(n=t._removeTeachingBubble)||void 0===n?void 0:n.call(t);t._onUnmountDiscoveryTeachingBubble(r),t._openMetadataSearchForm(i.type)}else null===(a=t._removeTeachingBubble)||void 0===a||a.call(t),t._openMetadataSearchForm()},ariaLabel:D.s,title:D.s}})},e.prototype._onUnmountDiscoveryTeachingBubble=function(e){var t=this;this._logTeachingBubbleDismissEngagment(!1,e,{isSearchFormOpenened:!0}),o.t.isActivated("AB505D1C-57C3-45D2-8065-4F7D2E8D6B2F","05/24/2023","do not show second attack if user has open search form")||n.ee(54,3376).then(function(n){var a;e===n.DISCOVERY_TEACHING_BUBBLE&&(null===(a=t._teachingBubbleProvider)||void 0===a||a.markBubbleAsSeen(n.DISCOVERY_TEACHING_BUBBLE_SECONDARY_CAMPAIGN))})},e.prototype._logTeachingBubbleDismissEngagment=function(e,t,n){this._shouldLogContentQueryFREDismissed&&t&&this._engagement.logData({name:"ContentQuery.Form.".concat(t,".Dismissed"),extraData:n,isIntentional:e})},e.prototype._showMetadataSearchTeachingBubble=function(e){var t=this,a=e.target,i=e.type;n.ee(16,4912).then(function(e){var n={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:{Fallback:!0}},r=new s.e({name:"SearchBox.ShowMetadataSearchTeachingBubble"});t._teachingBubbleProvider.shouldBubbleBeAdded(n,!1).then(function(o){if(o){var c={isVisible:o,onDismiss:function(){t._teachingBubbleProvider.markBubbleAsDismissed(n),t._openMetadataSearchForm(i)},target:a,listTemplate:t._listTemplate};e.showMetadataSearchTeachingBubble(c),t._teachingBubbleProvider.markBubbleAsSeen(n),r.end({resultType:s.t.Success})}else e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Success,resultCode:"AlreadyShowed"})}).catch(function(n){e.removeMetadataSearchTeachingBubble(),t._openMetadataSearchForm(i),r.end({resultType:s.t.Failure,error:n.message})})}).catch(function(){t._openMetadataSearchForm(i)})},e.prototype._openMetadataSearchForm=function(e){var t,n,a=this;if(this._metadataSearchDataSource&&(this._metadataSearchDataSource.isMetadataSearchMode=!0,this._updateMetadataSearchConfiguration(),this._setFocusSearchBox(),"keydown"===e&&setTimeout(function(){return a._setFocusSearchBox()},0),void 0===this._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble&&Object(A.cs)(A.D)&&(null===(t=this._metadataSearchDataSource)||void 0===t?void 0:t.shouldShowDiscoveryFRE())))if(o.t.isActivated("5426BA38-F699-47BF-9782-5AED17CB1B8A","04/14/2023","do not show queryable teaching bubble")){var i={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:{Fallback:!0},isDismissable:!0};null===(n=this._teachingBubbleProvider)||void 0===n||n.shouldBubbleBeAdded(i,!1).then(function(e){a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=e,a._metadataSearchDataSource.markQueryableFieldMenuTeachingBubbleAsSeen=function(){var e;null===(e=a._teachingBubbleProvider)||void 0===e||e.markBubbleAsSeen(i),a._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=!1}})}else this._metadataSearchDataSource.showQueryableFieldMenuTeachingBubble=!1},e.prototype._updateMetadataSearchConfiguration=function(){var e,t,n=this,a=null===(e=this._scopingControlDataSource)||void 0===e?void 0:e.getActiveScope(),i=null===(t=this._scopingControlDataSource)||void 0===t?void 0:t.getActiveScope.bind(this._scopingControlDataSource),r=this._isMetadataSearchSupportedScope(a),o=this._isMetadataSearchSupported&&r;this._runInShellSearch(function(e){e.SetProviderConfigUpdaters(n._searchBoxDataSource.getProviderConfigUpdaters(i,n._getViewParams))}),o?this._metadataSearchDataSource.isMetadataSearchMode?(this._hideScopingControl(),this._hideMetadataSearchButton()):this._searchBoxDataSource.isSearchResultsPage()?this._hideMetadataSearchButton():this._showMetadataSearchButton():this._hideMetadataSearchButton()},e.prototype._setFocusSearchBox=function(){this._resources.consumeAsync(this._searchBoxDataSource.getSuiteNavProviderKey()).then(function(e){e.getO365Shell().then(function(e){e.Search.FocusSearchBox()})})},e.prototype._setSearchInstrumenterProps=function(){this._searchBoxDataSource.getSearchInstrumenterProps&&this._searchInstrumenter&&this._searchInstrumenter.setProps(this._searchBoxDataSource.getSearchInstrumenterProps())},e.prototype._triggerSearchBoxReconfiguration=function(){this._runInShellSearch(function(e){return e.RecomputeSearchBoxConfiguration()})},e.prototype._logScopeChange=function(e,t){if(!this._scopingControlDataSource)throw new Error("Scoping control is not supported.");var n=this._scopingControlDataSource.getInitialScope(),a=this._scopingControlDataSource.getScopeControlScenario(n,this._searchBoxDataSource.isSearchResultsPage());this._engagement.logData({name:"SuiteNavSearchBox.ScopeChanged",isIntentional:!0,scenario:a,extraData:{initialScope:n.id,targetScope:e.id,searchTriggered:t},privacyClassification:b.t.optionalDiagnostic})},e.dependencies={resources:c.r,engagement:E.e,searchBoxDataSource:y.e,searchBoxConfig:g.e,scopingControlDataSource:v.optional,metadataSearchDataSource:T.e.optional,bootOptions:P.e.optional,teachingBubbleProvider:S.O.optional},e}(),H=(t.default=F,Object(d.r)("SearchBoxProvider",F))}],Array(104),[function(e,t,n){e.exports=n(2227)()},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(812),n(59)),r=n(1129),o=n(809),s=n(1827),c=n(75),d=n(32),l=n(77),u=n(819),f=n(140),p=n(814),m=n(482),_=n(1930),h=n(1931),b=n(1899),g=n(1453),v=n(7),y=n(135),S=n(1863),D=n(242),I=n(1896),x=n(27),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b.e(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(1837),E=n(3),A=n(309),L=n(8),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.cs)(E.jo))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this.invalidateItem(e.parentKey),this.resources.consume(A.e)?[4,this.resources.consumeAsync(l.k)]:[3,2];case 1:t.sent().invalidateItems(e.parentKey),t.label=2;case 2:return[2,n]}})})})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b.e(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.v.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b.e(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.k).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.T))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.h.optional,schemaDataSource:l.re.optional,itemsStore:s.e,operationProvider:r.resourceKey,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(809),r=n(128),o=n(264),s=n(7),c=n(135),d=n(103),l=n(304),u=n(144),f=n(1967),p=n(1850),m=n(13),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.n,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)})},function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"o",function(){return u});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)};function i(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function d(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}},function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"r",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return a}),n.d(t,"o",function(){return i}),n.d(t,"i",function(){return m});var a,i,r,o,s=n(7),c=new s.t("sortManager"),d=new s.t("dataManager"),l=(new s.t("listViewContextMenuCommandSet"),new s.t("topCommandSet"),new s.t("listViewContextMenuHelper")),u=new s.t("fileContent"),f=new s.t("contentRange"),p=new s.t("error");!function(e){var t,n,a,i,r;(r=e.leftNav||(e.leftNav={})).isLeftNavClosing=new s.t("base.leftNav.isLeftNavClosing"),r.isLeftNavVisible=new s.t("base.leftNav.isLeftNavVisible"),r.hideLeftNav=new s.t("base.leftNav.hideLeftNav"),r.isLeftNavUserExpanded=new s.t("base.leftNav.isLeftNavUserExpanded"),r.toggleIsLeftNavUserExpanded=new s.t("base.leftNav.toggleIsLeftNavUserExpanded"),(i=e.suiteNav||(e.suiteNav={})).context=new s.t("base.suiteNav.context"),i.isTopBarVisible=new s.t("base.suiteNav.isTopBarVisible"),i.isTopBarHamburgerVisible=new s.t("base.suiteNav.isTopBarHamburgerVisible"),i.isSuiteNavHamburgerVisible=new s.t("base.suiteNav.isSuiteNavHamburgerVisible"),i.supportHamburgerInSuiteNav=new s.t("base.suiteNav.supportHamburgerInSuiteNav"),i.isSuiteNavHidden=new s.t("base.suiteNav.isSuiteNavHidden"),(a=e.commandBar||(e.commandBar={})).transclusionProvider=new s.t("base.commandBar.transclusionProvider"),a.isDarkTheme=new s.t("base.commandBar.isDarkTheme"),a.isSearchHidden=new s.t("base.commandBar.isSearchHidden"),(n=e.infoPane||(e.infoPane={})).isInfoPaneAvailable=new s.t("base.infoPane.isInfoPaneAvailable"),n.hidePreview=new s.t("base.infoPane.hidePreview"),(e.filtersPane||(e.filtersPane={})).isFiltersPaneAvailable=new s.t("base.filtersPane.isFiltersPaneAvailable"),(t=e.columnCustomizationPane||(e.columnCustomizationPane={})).isColumnCustomizationPaneExpanded=new s.t("base.columnCustomizationPane.isColumnCustomizationPaneExpanded"),t.columnToFormat=new s.t("base.columnCustomizationPane.columnToFormat"),t.viewToFormat=new s.t("base.columnCustomizationPane.viewToFormat"),(e.oneUpOverlay||(e.oneUpOverlay={})).isPhotosOnly=new s.t("base.oneUpOverlay.isPhotosOnly"),(e.footer||(e.footer={})).hasFooter=new s.t("base.footer.hasFooter"),e.isSPLightSpeed=new s.t("base.isSPLightSpeed"),e.isScrollbarHidden=new s.t("base.isScrollbarHidden"),e.addPaddingBottom=new s.t("base.addPaddingBottom"),e.makeFlexBox=new s.t("base.makeFlexBox"),e.contextMenuHelper=new s.t("base.contextMenuHelper"),e.isRetrievingData=new s.t("base.isRetrievingData")}(a||(a={})),function(e){e.layoutType=new s.t("files.layoutType"),e.isArrangeControlVisible=new s.t("files.isArrangeControlVisible")}(i||(i={})),function(e){e.layoutType=new s.t("photos.layoutType")}(r||(r={})),function(e){e.layoutType=new s.t("storageInfo.layoutType")}(o||(o={}));var m=new s.t("eventScope")},,,,,function(e,t,n){"use strict";n.d(t,"u",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return v}),n.d(t,"m",function(){return y}),n.d(t,"p",function(){return S});var a=n(7),i=n(1945),r=n(3),o=n(244),s=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:!r.ps||Object(r.cs)(r.yo)||Object(r.cs)(r.wo)}}}}),c=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:!r.ps||Object(r.cs)(r.yo)}}}}),d=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInRecentPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.cs)(r.It)}}}}),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(r.cs)(r.Io)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!r.ps&&Object(r.cs)(r.wo)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:o.e},create:function(e){return{instance:Object(r.cs)(r.fo)&&(!e.platformDetection.isIE||Object(r.cs)(r.po))&&(!e.platformDetection.isSafari||Object(r.cs)(r.ho))&&(!e.platformDetection.isMobile||Object(r.cs)(r._o))}}}})),f=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.xo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),p=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.Oo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),m=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.Co)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),_=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.mo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),h=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.bo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),b=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.So)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),g=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(r.cs)(r.uo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),v=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(i.t)()&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),y=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:p},create:function(e){return{instance:Object(r.cs)(r.es)&&e.isItemsScopeEnabledInSingleTagView}}}}),S=new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:m},create:function(e){return{instance:Object(r.cs)(r.$o)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},,,,function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(1973),o=n(27),s=function(e){function t(t){var n=e.call(this,t)||this;new(n.managed(r.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}});var a=n._componentParentContent,i=n.valueAccessor(),s=function(e){return"object"==typeof e}(i)?i:{},c=s.data,d=void 0===c?n.bindingContext.$data:c,l=s.afterRender;return o.applyBindingsToNode(n.element,{template:{nodes:a.templateNodes,afterRender:l}},a.bindingContext.extend({$host:d,$hostContext:n.bindingContext})),n.controlsDescendantBindings=!0,n}return Object(a.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){this._componentParentContent=e},t.supportsVirtualElements=!0,t}(i.t);t.e=s},,,,,,,,,,,,,function(e,t,n){"use strict";var a,i=n(0),r=n(183),o=n(59),s=n(242),c=n(135),d=n(1970),l=n(1886),u=n(608),f=n(37),p=n(47);!function(e){e[e.none=0]="none",e[e.queue=1]="queue",e[e.server=2]="server"}(a||(a={}));var m=a,_=Object(u.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:a,type:f.e.Enum}},p.e),h=n(1856),b=n(97),g=n(8),v=n(13),y=!g.t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),S=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._semaphore=new l.e(16),a._thumbnailCache=n.thumbnailCache,a}return Object(i.__extends)(t,e),t.prototype.loadImage=function(e){var t=this,n=e.url,a=e.imageElement,i=void 0===a?document.createElement("img"):a,r=e.scenarioName,o=e.desiredSize,s=e.getContents,c={url:n,width:0,height:0},l=this._thumbnailCache,u=l.isLoaded(c),f=function(e){return d.e.authenticate(e).then(function(){return t._waitForImageLoad(i,e,r)}).then(function(e){if(l.record(c),i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return y&&s?this.trackPromise(s(Object(v.isFeatureEnabled)(v.FixODCOneUpPreview)?o:void 0,n).then(function(e){var n=URL.createObjectURL(e);return u?f(n):t._semaphore.enqueue(function(){return f(n)})})):u?f(n):this._semaphore.enqueue(function(){return f(n)})},t.prototype._waitForImageLoad=function(e,t,n){var a,i,r,o=this.async,c=this.events,d=function(){r&&o.clearTimeout(r),c.off(e)},l=new s.e(function(){d(),e.setAttribute("src",""),t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),u=t&&t.indexOf("&encodeFailures=1")>=0;return c.onAll(e,{load:function(){if(d(),u&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?p.t.ExpectedFailure:p.t.Failure,resultCode:"".concat(t),error:"Encoded failure"}),l.error(new b.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else i&&i.end({resultType:p.t.Success}),l.complete(a)},error:function(){d(),i&&i.end({resultType:p.t.Failure}),l.error(new Error("Image '".concat(t,"' failed to load")))}}),r=o.setTimeout(function(){l.cancel()},3e4),n&&(i=new _({name:n,loadType:m.server})),e.setAttribute("src",t),a=!!e.complete,this.trackPromise(l.getPromise())},t.prototype._waitForTimeout=function(e){var t,n=this.async,a=new s.e(function(){t&&n.clearTimeout(t)});return t=n.setTimeout(function(){a.complete()},e),a.getPromise()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:h.e}),t}(o.n),D=Object(c.r)("ImageLoader",S),I=n(816),x=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._debouncer=new I.e,a._imageLoader=a.resources.consume(D);var i=a.valueAccessor(),r=i.src,o=i.image,s=i.error,c=i.isLoaded,d=i.isError,l=i.actualSize,u=i.scenarioName,f=i.desiredSize,p=i.getContents;a._src=a.wrapObservable(r),a._image=a.wrapObservable(o),a._error=a.wrapObservable(s),a._scenarioName=u,a._getContents=p,a._desiredSize=a.wrapObservable(f);var m=n.outputExtenders,_=void 0===m?{deferred:!0}:m;return a.createComputed(a._computeLoadImage),a.createBackgroundComputed(function(){var e=a._image();if(c&&c(!!e),l){var t=void 0;e&&(t={width:e.width,height:e.height}),l(t)}o&&o(e)}).extend(_),a.createBackgroundComputed(function(){var e=a._error();s&&s(e),d&&d(!!e)}).extend(_),a}return Object(i.__extends)(t,e),t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),a=this.unwrapObservable(this._getContents);this._image(void 0),this._scenarioName&&(e=new _({name:this._scenarioName,loadType:m.queue})),this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,desiredSize:this.unwrapObservable(this._desiredSize),getContents:a}))).then(function(n){t._image(n),t._error(void 0),e&&e.end({resultType:p.t.Success})},function(n){t._error(n),e&&e.end({resultType:n.isExpected?p.t.ExpectedFailure:p.t.Failure})})},t}(r.t);t.e=x},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Overlay{height:0;width:0;overflow:hidden}"}]);var i=n(1943),r=n(402),o=n(0),s=n(260),c=n(2066),d=n(1119),l=n(1838),u=n(59),f=n(27),p=function(e){function t(t){var n=e.call(this,{})||this,a=t.topTab,i=t.bottomTab,r=t.animation,o=void 0===r?{}:r,s=t.alignToParent,c=void 0===s?f.observable(!0):s,d=t.parentElement,l=t.isOpen;return n.topTab=a,n.bottomTab=i,n.animation=o,n.alignToParent=c,n.parentElement=d,n.isOpen=l,n}return Object(o.__extends)(t,e),t}(u.n),m=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.transclusionContentTagName=i.e.tagName;var r=n.overlayProvider,o=void 0===r?a.resources.consume(c.e):r,s=t.animation,u=t.alignToParent,f=void 0!==u&&u,m=t.parentElement,_=t.virtualParentElement;return a.addBindingHandlers({host:l.e,element:d.e}),a.overlayProvider=o,a.topTab=a.createObservable(null),a.bottomTab=a.createObservable(null),a.isOpen=a.createObservable(!1),a.virtualParentElement=_,a.overlay=new p({alignToParent:a.wrapObservable(f),parentElement:m,animation:s,topTab:a.topTab,bottomTab:a.bottomTab,isOpen:a.isOpen}),a}return Object(o.__extends)(t,e),t}(s.t),_=r.e({tagName:"od-overlay",template:'<a href="javascript:;" class="ms-accessible" aria-hidden="true" role="presentation" data-bind="element:topTab"></a><div class="od-Overlay ms-accessible" role="presentation" data-bind="component:{name:transclusionContentTagName,params:{provider:overlayProvider,parentElement:virtualParentElement||$element.parentElement,options:overlay}}">\x3c!--ko host:{}--\x3e\x3c!--/ko--\x3e</div><a href="javascript:;" class="ms-accessible" aria-hidden="true" role="presentation" data-bind="element:bottomTab"></a>',viewModel:m,synchronous:!0});t.e=_},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(59),r=n(135),o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._recordsByThumbnailKey={},a._bucketsByImageKey={};var i=a.observables;a.lastAccessedDate=i.create(new Date);var r=n.pruneThumbnailsExtenders,o=void 0===r?{rateLimit:{timeout:6e5}}:r;return i.backgroundCompute(a._pruneThumbnails).extend(o),a}return Object(a.__extends)(t,e),t.prototype.getCoveragePercent=function(e,t){var n=l(e),a=l(t);return Math.sqrt(a/n)},t.prototype.register=function(e,t,n,a){void 0===n&&(n=t),void 0===a&&(a=!0);var i=this.lastAccessedDate;i(new Date);var r=d(this.getCoveragePercent(e,n)),o=c(e),s=c(t),l=this._recordsByThumbnailKey,u=this._bucketsByImageKey,f=l[o]||{lastAccessed:void 0,buckets:{}};f.lastAccessed=i.peek();var p=f.buckets[r];(!p||this.getCoveragePercent(p.size,n)>1)&&(p&&delete u[p.key],p=f.buckets[r]={key:s,size:n,image:t,isLoaded:a,lastAccessed:i.peek()}),u[s]=p,l[o]=f},t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey,i=a[n];i?i.isLoaded=!0:a[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}},t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey[n];return a&&(a.lastAccessed=t.peek()),!!a&&a.isLoaded},t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=t);var a=c(e),i=this._recordsByThumbnailKey[a],r=this.lastAccessedDate;if(r(new Date),i){var o=i.buckets;i.lastAccessed=r.peek();var s=d(t),l=d(n),u=-1/0,f=!1;for(var p in o){var m=Number(p);m<=s&&m>=l&&o[m].isLoaded&&(u=Math.max(u,m),f=!0)}var _=f&&o[u];return _&&_.image}},t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e),u(this._bucketsByImageKey,e)},t}(i.n),s=Object(r.r)("ThumbnailCache",o);function c(e){var t=e.url,n=e.width,a=e.height;return JSON.stringify({url:t,width:n,height:a})}function d(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function u(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},,function(e,t,n){"use strict";var a=n(0),i=n(27),r=n(1962),o=n(183);function s(e){var t=document.createElement("div");return t.tabIndex=0,t.className="ms-accessible",t.setAttribute("role","presentation"),t.setAttribute("aria-hidden","true"),t.setAttribute("data-focus-trap",e),t}var c=r.i,d=r.n,l=r.a,u=r.e,f=i.virtualElements,p=i.applyBindingsToNode,m=i.applyBindingsToDescendants,_=function(e){function t(t){var n=e.call(this,t)||this;n._onParentMutation=function(){var e,t;if(n._beforeHook&&n._afterHook&&n._beforeHook.isConnected&&n._beforeHook.parentElement){var a=null===(e=n._before)||void 0===e?void 0:e.peek(),i=null===(t=n._after)||void 0===t?void 0:t.peek(),r=!1,o=c(n._beforeHook,void 0,!0);o&&o!==n._afterHook&&o!==c(n._afterHook,void 0,!0)&&(r=!0),r?(0===n._beforeHook.tabIndex&&0===n._afterHook.tabIndex||(n._beforeHook.setAttribute("tabindex","0"),n._afterHook.setAttribute("tabindex","0")),a&&i&&(0===a.tabIndex&&0===i.tabIndex||(a.setAttribute("tabindex","0"),i.setAttribute("tabindex","0")))):(-1===n._beforeHook.tabIndex&&-1===n._afterHook.tabIndex||(n._beforeHook.setAttribute("tabindex","-1"),n._afterHook.setAttribute("tabindex","-1")),a&&i&&(-1===a.tabIndex&&-1===i.tabIndex||(a.setAttribute("tabindex","-1"),i.setAttribute("tabindex","-1"))))}else n._disposeMutationObserver()},n.controlsDescendantBindings=!0;var a=n,i=a.events,r=a.observables,o=a.bindingContext,d=a.element,l=t.valueAccessor()||{},_=l,h=_.isEnabled,b=_.invert,g=n._beforeHook=s("begin"),v=n._afterHook=s("end");n._invert=!!b,h&&(p(g,{visible:h},o),p(v,{visible:h},o));var y=f.childNodes(d);f.prepend(d,g),f.insertAfter(d,v,y[y.length-1]),m(o,d);var S=l,D=S.before,I=void 0===D?r.create(v):D,x=S.after,C=void 0===x?r.create(g):x;return n._before=r.wrap(I),n._after=r.wrap(C),i.on(g,"focus",n._onFocusBeforeHook),i.on(v,"focus",n._onFocusAfterHook),!b&&l.after&&n._initializeBeforeAndAfter(),u||(n._initializeParentMutationObserver(),n._onParentMutation()),n}return Object(a.__extends)(t,e),t.prototype._onFocusBeforeHook=function(){this._invert?d(this._afterHook):l(this._before.peek())},t.prototype._onFocusAfterHook=function(){this._invert?l(this._beforeHook):d(this._after.peek())},t.prototype._onFocusBefore=function(){d(this._beforeHook)},t.prototype._onFocusAfter=function(){l(this._afterHook)},t.prototype._initializeBeforeAndAfter=function(){var e,t,n=this,a=this.events;this.observables.backgroundCompute(function(){var i=n._before(),r=n._after();i!==e&&(e&&a.off(e),i&&a.on(i,"focus",n._onFocusBefore),e=i),r!==t&&(t&&a.off(t),r&&a.on(r,"focus",n._onFocusAfter),t=r)})},t.prototype._initializeParentMutationObserver=function(){var e=this;this._parentMutationObserver||this._beforeHook&&this._beforeHook.parentElement&&(this._parentMutationObserver=new MutationObserver(function(){window.setTimeout(e._onParentMutation,0)}),this._parentMutationObserver.observe(this._beforeHook.parentElement,{subtree:!0,childList:!0,attributes:!0,characterData:!1}),i.utils.domNodeDisposal.addDisposeCallback(this._beforeHook,this._disposeMutationObserver))},t.prototype._disposeMutationObserver=function(){var e;null===(e=this._parentMutationObserver)||void 0===e||e.disconnect(),delete this._parentMutationObserver},t.supportsVirtualElements=!0,t}(o.t);t.e=_},,,,,function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",function(){return y}),n.d(t,"d",function(){return D}),n.d(t,"a",function(){return x}),n.d(t,"i",function(){return C}),n.d(t,"t",function(){return w}),n.d(t,"o",function(){return E}),n.d(t,"s",function(){return A});var a,i,r,o,s,c=n(813),d=n(302),l=n(26),u=n(1830);n.d(t,"e",function(){return u.e}),n.d(t,"n",function(){return u.t}),n.d(t,"r",function(){return u.n}),n.d(t,"l",function(){return u.a}),n.d(t,"u",function(){return u.i}),n.d(t,"f",function(){return u.r});var f="ms-word",p="onenote|UsePlain",m="ms-powerpoint",_="ms-excel",h="ms-visio",b="ms-publisher",g="ms-project",v=((a={})[f]=l.OpenInWordOnline,a[p]=l.OpenInOneNoteOnline,a[m]=l.OpenInPowerPointOnline,a[_]=l.OpenInExcelOnline,a[h]=l.OpenInVisioOnline,a);function y(e){return v[e]||""}var S=((i={})[f]=l.OpenInWord,i[p]=l.OpenInOneNote,i[m]=l.OpenInPowerPoint,i[_]=l.OpenInExcel,i[h]=l.OpenInVisio,i[b]=l.OpenInPublisher,i[g]=l.OpenInProject,i["ms-infopath"]=l.OpenInInfoPath,i);function D(e){return S[e]}var I=((r={})[f]="Word",r[p]="OneNote",r[m]="PowerPoint",r[g]="Project",r[h]="Visio",r[_]="Excel",r);function x(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":I[e.appMap]||"Word"}function C(e){return I[e]}(o={})[f]="WordLogo",o[p]="OneNoteLogo",o[m]="PowerPointLogo",o[_]="ExcelLogo",o[h]="VisioLogo",o[b]="Page";var O=((s={})[f]="svg/word_16x1.svg",s[p]="svg/onenote_16x1.svg",s[m]="svg/powerpoint_16x1.svg",s[_]="svg/excel_16x1.svg",s[h]="svg/visio_16x1.svg",s[b]="Page",s.Stream="svg/stream_16x1.svg",s),w={"svg/word_16x1.svg":"svg/word_white_stroke_18x1.svg","svg/onenote_16x1.svg":"svg/onenote_white_stroke_18x1.svg","svg/powerpoint_16x1.svg":"svg/powerpoint_white_stroke_18x1.svg","svg/excel_16x1.svg":"svg/excel_white_stroke_18x1.svg","svg/visio_16x1.svg":"svg/visio_white_stroke_18x1.svg"};function E(e){var t=O[e];return t&&new d.e(t)}function A(e){var t=c.e;return-1!==t["ms-word"].lastIndexOf(e)?"ms-word":-1!==t["ms-powerpoint"].lastIndexOf(e)?"ms-powerpoint":-1!==t["ms-excel"].lastIndexOf(e)?"ms-excel":-1!==t["ms-visio"].lastIndexOf(e)?"ms-visio":-1!==t["onenote|UsePlain"].lastIndexOf(e)?"onenote|UsePlain":-1!==t["ms-access"].lastIndexOf(e)?"ms-access":-1!==t["ms-project"].lastIndexOf(e)?"ms-project":-1!==t["ms-publisher"].lastIndexOf(e)?"ms-publisher":void 0}},,,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(1962),r=n(183),o=n(178),s=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n.wrapObservable(void 0===a||a);n._shouldRestoreFocus=i;var r=null;try{r=document.activeElement}catch(e){}for(n._activeElement=r,n._preserveActiveElementAncestors=[];r&&r!==document.body;)n._preserveActiveElementAncestors.push(r),r=Object(o.e)(r);return n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){if(this._shouldRestoreFocus.peek()){var t=null;try{t=document.activeElement}catch(e){}if(!t||t===document.body||this._isAncestorOrSelf(t,this.element))for(var n=0,a=this._preserveActiveElementAncestors;n<a.length;n++){var r=a[n];if(r&&r.focus&&(Object(i.r)(r,!0)||r===this._activeElement)&&document.body.contains(r)){r.focus();break}}}this._preserveActiveElementAncestors=[],delete this._activeElement,e.prototype.dispose.call(this)},t.prototype._isAncestorOrSelf=function(e,t){for(;e;){if(e===t)return!0;e=Object(o.e)(e)}return!1},t}(r.t);t.e=s},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(59),i=n(7),r=n(1158),o=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:r.e,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(59),i=new(n(7).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return b}),n.d(t,"t",function(){return g});var a=n(0),i=n(59),r=n(111),o=n(1626),s=n(1827),c=n(2063),d=n(32),l=n(7),u=n(135),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables;a._selectionModel=n.itemSetSelectionModel,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemsStore=n.itemsStore;var s=a.selection=new o.e({selectionMode:1===a._selectionModel.mode?r.n.single:r.n.multiple,onSelectionChanged:a._onSelectionChange.bind(a),getKey:a.getKey.bind(a),canSelectItem:a._canSelectItem.bind(a)});return a._isModal=i.create(!!s.isModal&&s.isModal()),i.compute(a._computeUpdateItems),i.backgroundCompute(a._computeUpdateReactSelection),a.isModal=i.compute({read:function(){return a._isModal()},write:function(e){return s&&s.setModal(e)},pure:!0}),a}return Object(a.__extends)(t,e),t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem("".concat(e.key)))||"".concat(t)},t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,a=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1),n.setAllSelected(!1);for(var i=0,r=a;i<r.length;i++){var o=r[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})},t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var a=0,i=e.selection();a<i.length;a++){var r=i[a];if(!t.isKeySelected(e.getItemKey(r))){n=!0;break}}return n},t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;if(e._isModal(!!n.isModal&&n.isModal()),e._shouldUpdateSelection()){if(n.mode===r.n.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var a=[],i=0,o=n.getSelection();i<o.length;i++){var s=o[i],c=e.getKey(s);a.push(c)}t.setSelectedKeys(a)}var d=e._clientSideExtensionHelper;d&&d.raiseListChangeEvent(n.getSelection())}})},t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var a=0,i=t.content().items;a<i.length;a++){var r=i[a],o=this.observables.peekUnwrap(r);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var a=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||a&&a.isStub)&&e.selection.setItems(n,!1)})},t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})},t}(i.n),p=new l.t({name:"".concat("SelectionManager",".selectionManager"),factory:new u.n(f,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemSetSelectionModel:d.C,clientSideExtensionHelper:c.e.optional,itemsStore:s.e}))}),m=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}}),_=new l.t({name:"".concat("SelectionManager",".selectionMode"),factory:{dependencies:{itemSetSelectionModel:d.C},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?r.n.multiple:r.n.single}}}}),h=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.isModal}}}}),b=new l.t({name:"SelectionManager",factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.selection}}}}),g=new l.t({name:"".concat("SelectionManager",".hasSelection"),factory:{dependencies:{itemSetSelectionModel:d.C,isSelectionModal:h,observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,a=e.isSelectionModal;return{instance:t.pureCompute(function(){return a()||n.selectedCount()>0}),disposable:t}}}})},,function(e,t,n){"use strict";function a(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}n.d(t,"e",function(){return a})},,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),r=n(27),o=n(260),s=n(1851),c=n(2032),d=function(e){function t(t){var n=e.call(this,t)||this;return t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=c.e,n.addBindingHandlers({imageLoader:s.e}),n.isVisible=r.observable(!0),n.isImageLoaded=r.observable(!1),n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif"),n}return Object(i.__extends)(t,e),t.prototype.hideSpinner=function(){this.isVisible(!1)},t}(o.t),l=n(402).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:d,synchronous:!0});t.e=l},,function(e,t,n){"use strict";var a=n(1993);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(1827),i=n(135),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.e},e}(),o=Object(i.r)("ItemParentHelper",r)},,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return u});var a,i=n(695),r=n(702),o=n(244),s=n(601);function c(e,t,n){var a=r.e[t]&&r.e[t].iconType||"png",i=e&&"png"===a;return"".concat(s.i).concat(n).concat(i?"_2x":"","/").concat(t,".").concat(a)}function d(e,t,n){return c(e.consume(o.e).isRetinaSupported,t,n)}function l(e,t,n){return d(e,i.n(t),n)}function u(e,t,n){return n&&n.vault&&n.vault.root?d(e,n.vault.isLocked?a.vaultClosed:a.vaultOpen,t):n&&n.folder&&"SamsungGallery"===n.specialFolderCanonicalName?d(e,"samsunggallery",t):void 0}!function(e){e.vaultOpen="vaultopen",e.vaultClosed="vaultclosed"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"e",function(){return $}),n.d(t,"n",function(){return ee});var a,i,r=n(0),o=n(144),s=n(33),c=n(43),d=n(489),l=n(450),u=n(449),f=n(270),p=n(2352),m=n(13),_=n(103),h=n(40),b=n(303),g=n(2187),v=n(1872),y=n(289),S=n(2173),D=n(493),I=n(119),x=n(7),C=n(135),O=n(102),w=n(82),E=n(379),A=n(10),L=n(613),k=n(25),M=n(377),P=n(716),T=n(1035),U=n(1036),F=n(95),H=n(159),R=n(309),N=n(8),B=n(1186),j=n(73),V=n(844),z=window.$Config&&window.$Config.isINT,G=window.FilesConfig&&window.FilesConfig.skyApiDomain,K=window.FilesConfig&&window.FilesConfig.storageDomain,W=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(i||(i={}));var q=N.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),Q=!N.e.isActivated("71CADB9F-8CE9-47DA-A4A3-0340D883A255","03/02/2023","Propogates redeemTokem if available in WAC open URLs"),Y=!N.e.isActivated("84da682b-95a0-41d5-96c7-c5039e03fe3d","06/14/2023","Move generating Moj url out of OdcUrlDataSource to avoid consume OdcUrlDataSource in Moj"),J=!N.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(m.isFeatureEnabled)(m.UseItemsScopeInOneDrive),X=new x.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new x.e(!q)}),Z=new x.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new x.e(J)}),$=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(w.e):a,r=t.enableFastOneUp,o=void 0===r?this.resources.consume(Z):r,s=t.useRefactoredDefaultClickUrl,c=void 0===s?this.resources.consume(X):s;this._navigation=i,this._enableFastOneUp=o,this._useRefactoredDefaultClickUrl=c,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?A.c:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new O.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(m.isFeatureEnabled)(m.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(A.y)(e)},e.getKeyParams=function(e){return Object(A.S)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(A._)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+_.n({resid:e})},e.encodeSharingUrl=function(e){return Object(k.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,h.format(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,_.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(k.f)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return I.t.signInUrl+"&"+_.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return I.t.autoRedeemSignOut+"&"+_.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(P.e)()},e.areCidsEqual=function(e,t){return Object(L.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+_.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(A.S)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+_.n(r,null,!0),s=((i={}).lru=o,i);return I.t.autoRedeemSignOut+"&"+_.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(A.h)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.L)(e)},e.prototype.getPhotoType=function(e){return Object(A.E)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(A.O)(e,this._mayBeFastOneUp||t)},e.prototype.getViewerType=function(e){return function(e){var t=e.viewer;switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}}(e)},e.prototype.saveViewerType=function(e){return function(e){var t;return(t={}).viewer=e,t}(e)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.p)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.s)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=c.e.Files),Object(A.M)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(k.E)(e):e===c.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!N.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(A.V)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(A.a)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.N)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case c.e.Files:return this.isCurrentQueryFiles();case c.e.Recent:return this.isCurrentQueryRecent();case c.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case c.e.SharedByMe:return this.isCurrentQuerySharedByMe();case c.e.RecycleBin:return this.isCurrentQueryRecycleBin();case c.e.Photos:case c.e.AllMyPhotos:return Object(A.F)(t);case c.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===c.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:s.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(F.e)(A.W)&&!Object(m.isFeatureEnabled)(m.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:s.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:s.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(r.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:s.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(r.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:s.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+_.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,i=Object(r.__assign)({},this._navigation.viewParams);return delete i.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:s.e.PhotoStream,viewParams:i}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:s.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:s.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:s.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:s.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return Y?Object(V.t)(e,t):this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:s.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return Y?Object(V.n)(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return Y?Object(V.e)(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:s.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:s.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:s.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(R.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:s.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(m.isFeatureEnabled)(m.EnableVroomDocFormatSettings)&&Object(F.e)(A.W)){var t=((e={}).v="documentoptions",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e,t=((e={}).v="NotificationOptions",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+_.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(A.C)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+_.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+_.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(U.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(U.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=I.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+_.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+_.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+_.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+_.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,r=e.dateFilter,o=e.conversationId,s=e.largestSize,c=e.filter;c||(c=Object(A.F)(this._navigation.viewParams)?g.t.photos:g.t.all);var d=((n={}).qt="search",n.q=a,n.searchsessionid=o,n.ft=A.t[g.t[c]],n);if("number"==typeof r&&r!==g.e.anyDate){var l=new Date,u=this._getDateDuration(r,l);d.df=i[i.DateCreated],d.beginDate=u.toISOString(),d.endDate=l.toISOString()}return s&&(d.sp="size"),this.getItemUrl(this.getKey(d),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(A.t[g.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:g.t[String(A.t[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.o)(e);var t=e.action||"";return f.e[t.toLowerCase()]||f.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(D.e.folder),16==(16&n)&&t.push(D.e.document),8==(8&n)&&t.push(D.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(A.K)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(k.a)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=_.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",u=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",u.id=e.id;var p=void 0;switch(t){case"w":p=f.t.createWord;break;case"x":p=f.t.createExcel;break;case"p":p=f.t.createPowerPoint;break;case"n":p=f.t.createOneNote}u.action=p&&f.t[p].toLowerCase()||""}else r="/create.aspx?",u.parId=e.id,u.nd=t+l;return o&&(u.authkey=o),s&&(u.ticket=s),c&&(u.iam=c),r+_.n(u)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+_.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=I.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+_.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){var a,i;void 0===n&&(n=this._navigation.viewParams);var o=this.getIAmParamValue(n),s=this.getAuthKeyParamValue(n),c=n.redeem,d=Object(r.__assign)(Object(r.__assign)({cid:e,resid:t,iam:o},s?((a={}).authkey=s,a):{}),Q&&c?((i={}).redeem=c,i):{});return"/versions.aspx?"+_.n(d,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(d){var l=new j.t("/".concat(a));l.setQueryParameter("resid",d);var u=this.getAuthKeyParamValue(t);u&&l.setQueryParameter("authkey",u);var f=t.redeem;if(Q&&f&&l.setQueryParameter("redeem",f),!A.e)for(var p in t)p.startsWith("wd")&&l.setQueryParameter(p,t[p]);return l.toString()}var m=Object(v.a)(e),h=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+h+_.n({app:m,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,i,o;if(void 0===t&&(t=this._navigation.viewParams),!N.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(F.e)(e.ownerId)){var s=null===(i=e.itemFromServer)||void 0===i?void 0:i.webDavUrl;return(null===(o=e.properties)||void 0===o?void 0:o.path)&&(s=e.properties.path),Object(B.t)(e.appMap,s,e.extension,!0,!1)}var c=this.getAuthKeyParamValue(t),d=this.getIAmParamValue(t),l=t.redeem,u=Object(r.__assign)({cid:n,resid:e.id,authKey:c,iam:d,autoRedirect:"false"},Q&&l?((a={}).redeem=l,a):{});return this.getCurrentPageBaseUrl()+"/openinclient?"+_.n(u,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+_.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=h.format(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+_.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,i;return this.getItemUrl(this.getKey(Object(r.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((i={}).groupId=n,i):{})))},e.prototype.getExternalUrl=function(t){var n=p.e[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?h.format(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+b.e.encodeURIComponent(n):h.format(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+b.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,i,s,c,d,l,u,p,h;void 0===t&&(t={});var b,g=t.viewParams,v=void 0===g?this._navigation.viewParams:g,y=t.itemSet,S=t.urlType,D=void 0===S?"default":S,I=t.preserveAction,x=void 0!==I&&I,C=t.action,O=void 0===C?x&&this.getAutoActionType(v)||void 0:C;if(!e||!e.key)return"";if(Object(m.isFeatureEnabled)(m.UpdateOdcVaultApiForConvergence)&&Object(F.e)(A.W)&&(_.e(e.key).cid!==e.ownerId&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:_.n(Object(r.__assign)(Object(r.__assign)({},_.e(e.key)),(n={},n.cid=e.ownerId,n)))})),(null===(d=null===(c=e.itemFromServer)||void 0===c?void 0:c.remoteItem)||void 0===d?void 0:d.containingDrivePolicyScenarioViewpoint)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:_.n((a={},a.mcid=_.e(e.key).cid,a.mid=_.e(e.key).id,a.cid=null===(l=e.graph)||void 0===l?void 0:l.driveId,a.id=null===(u=e.graph)||void 0===u?void 0:u.itemId,a))}))),v.sb&&(!this.isCurrentQuery(e.queryType,v)||(e=Object(r.__assign)(Object(r.__assign)({},e),{key:_.n(Object(r.__assign)(Object(r.__assign)({},_.e(e.key)),(i={},i.sb=v.sb,i.sd=v.sd,i)))}))),v.mcid&&this.getKeyParams(e.key).cid===(v.cid||v.parCid)&&(e=Object(r.__assign)(Object(r.__assign)({},e),{key:_.n(Object(r.__assign)(Object(r.__assign)({},_.e(e.key)),(s={},s.mcid=v.mcid,s.mid=v.mid,s)))})),this._useRefactoredDefaultClickUrl){var w=null===(h=null===(p=null==e?void 0:e.properties)||void 0===p?void 0:p.commandsSupported)||void 0===h?void 0:h.defc,E=y&&y.item.peek(),L=E&&E.key!==e.key&&E||e.UNSAFE_parent,k=L&&L.key,M=void 0;w&&(M="1"===w);var P={itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:M},parentItemInfo:L&&{itemKey:k,itemIsAlbum:L.isAlbum,itemIsPlaceholder:L.isPlaceholder,itemIsStub:L.isStub,itemVirtualItemType:L.virtualItemType,itemExtension:L.extension,itemType:L.type,itemOpenUrl:L.openUrl,itemErrorType:L.error&&L.error.type},preserveAction:x,action:O,viewParams:v,page:t.page,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:D};return Object(T.t)(P)}var U=this._getDefaultUrlFormat(e),H=!!N.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==o.e.Media;return v.mid&&H&&(U=T.e.current),b=e.type===o.e.Error?T.e.external:"existing"===D?this._getCurrentUrlFormat(v):"focus"===D||O?O&&O!==f.t.locate&&U===T.e.current?U:T.e.focus:U,this._getItemClickUrl(e,y,b,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:s.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.r)(e);var t=I.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",h.format(t,b.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(A.D)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+_.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(A.I)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.U)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+_.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.k)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+_.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,i=t.item;return Object(A.v)(Object(r.__assign)(Object(r.__assign)({},t),{itemKey:e,itemInfo:i&&{itemKey:i.key,itemIsPlaceholder:i.isPlaceholder,itemVirtualItemType:i.virtualItemType,itemExtension:i.extension,itemType:i.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(H.e)(o,s):delete o.sc,"#"+_.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+_.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return g.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=g.e.oneDay;break;case 30:t=g.e.oneMonth;break;case 7:t=g.e.oneWeek;break;case 365:t=g.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(z?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(A.z)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||I.t.si;if(!n)return"";var a=y.t(n),i=_.e(a),r=i.wreply,o=y.t(r),s=_.e(o);return s.action=f.t[e],i.wreply="".concat(y.n(r),"?").concat(_.n(s)),"".concat(y.n(n),"?").concat(_.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return _.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.i)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(k.i)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return Object(T.a)({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:s.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,o=this.getKeyParams(r&&r.key||"");i.parId=o.id;var c=_.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(W,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,i=n.page,o=n.action,s=n.preserveAction,l=void 0!==s&&s,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(r.__assign)({},_),b=Object(A.A)(m);void 0!==i&&(b.v=this._getPageParamValue(i,m));var g=!1,v=Object(E.a)(null==a?void 0:a.extension,null==a?void 0:a.type);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case u.e.Album:case u.e.AlbumRoot:case u.e.Tag:case u.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===c.e.Search||y===c.e.AllMyPhotos||y===c.e.PhotoStream||(h.v=""),!v&&Object(d.e)(y)&&("photos"!==b.v&&"photoStream"!==b.v||this.getContextualFilter(_)!==A.t.photos.toString())&&(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&f.t[o]&&f.t[o].toLowerCase()||"":l&&S&&(S===f.t.showProperties&&h.o||(h.action=f.t[S].toLowerCase())),Object(H.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case g.e.oneDay:n.setDate(n.getDate()-1);break;case g.e.oneMonth:n.setDate(n.getDate()-30);break;case g.e.oneWeek:n.setDate(n.getDate()-7);break;case g.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?T.e.focus:T.e.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case o.e.Media:t=T.e.focus;break;case o.e.Folder:case o.e.Error:t=T.e.current;break;default:t=T.e.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,o=a.page,c=void 0===o?this.getPageType(r):o;if(n!==T.e.current&&c===s.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(E.a)(e.extension,e.type))n=c===s.e.TextFileEditor?T.e.external:T.e.focus;else if(c===s.e.TextFileEditor&&this.getAutoActionType(r)===f.t.createTextDocument)return"#"+_.n(r,null,!0);switch(n){case T.e.current:d=this._getCurrentItemUrl(e,a);break;case T.e.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===f.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:f.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var m=p.action;return m?d&&d.commentId&&"showproperties"===m.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=m):f.o=e.oneUpOverlayValue,l&&Object(H.e)(f,l),"#"+_.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case s.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case s.e.TextFileEditor:n="TextFileEditor";break;case s.e.Photos:n="photos";break;case s.e.RansomwareDetection:n="RansomwareDetection";default:case s.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||l.e.requestFailed){case l.e.marketBlocked:return this.getMarketBlockedUrl();case l.e.userNotReady:return this.qualifyUrl(this.getItemUrl(t.key));case l.e.accessDenied:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case l.e.authenticationExpired:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case l.e.userSuspended:var r=this.getAutoActionType(n)===f.t.feedback?f.t.feedback:void 0;return I.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case l.e.passwordRequired:return this.getValidatePermissionUrl();case l.e.requestAccess:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,r=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,r);if(e.type===o.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(E.a)(e.extension,e.type))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,u=(null==l?void 0:l.defc)||"";a=u&&"1"!==u?this._getFocusItemUrl(e,r,{action:f.t.defaultClick,viewParams:c}):"1"===u&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,r,{action:f.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(A.d)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(A.l)():window.location.pathname},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(A.G)(e,t):t||I.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:w.e,useRefactoredDefaultClickUrl:X,enableFastOneUp:Z},e.oneUpOverlayValue=M.r,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=G+"/API/2/",e.viewerId=A.W,e.storageBaseUrl=K,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=M.i,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((a={}).photo=S.i,a.list=S.a,a.grid=S.n,a),e.placeholderId=0,e}(),ee=(t.t=$,Object(C.r)("UrlDataSource",$))},,function(e,t,n){"use strict";var a=n(2532);t.e=a.e}],Array(15),[function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(97).e);t.e=i},function(e,t,n){"use strict";var a=n(1953),i=n(27),r=n(304);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a.e(n)),this.content.equalityComparer=r.n,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},,function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(27),o=function(e){function t(t){var n=e.call(this,t)||this;return n.controlsDescendantBindings=!0,n.createComputed(n._computeRefreshChildElements),n}return Object(a.__extends)(t,e),t.prototype._computeRefreshChildElements=function(){var e=r.unwrap(this.valueAccessor());r.virtualElements.emptyNode(this.element),this.element.innerHTML=e,r.applyBindingsToDescendants(this.bindingContext,this.element)},t}(i.t);t.e=o},,function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},,,,,,,,function(e,t,n){"use strict";var a=n(402),i=n(0),r=n(260),o=n(183),s=n(2126),c=n(1973),d=function(e){function t(t){var n=e.call(this,t)||this;return new(n.managed(c.e))({element:n.element,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return n._onReceiveComponentParentContext.bind(n)}}),n.controlsDescendantBindings=!0,n}return Object(i.__extends)(t,e),t.prototype._onReceiveComponentParentContext=function(e){var t=this.valueAccessor(),n=new s.e({parentElement:t.parentElement,templateNodes:e.templateNodes,bindingContext:e.bindingContext,renderCount:t.renderCount,options:t.options});t.context(n)},t.supportsVirtualElements=!0,t}(o.t),l=n(27),u=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({transclusionContent:d}),n._provider=t.provider,n.bindingParams={context:l.observable(),parentElement:t.parentElement,renderCount:t.renderCount,options:t.options},n.createComputed(function(){var e=n.bindingParams.context();n._transclusion&&(n._transclusion.dispose(),n._transclusion=null),e&&(n._transclusion=n.addDisposable(n._provider.transclude(e)))}),n}return Object(i.__extends)(t,e),t}(r.t),f=a.e({tagName:"od-transclusion-content",template:"\x3c!--ko transclusionContent:bindingParams--\x3e\x3c!--/ko--\x3e",viewModel:u,synchronous:!0});t.e=f},,function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"t",function(){return l});var a=n(180),i=n(1946),r=n(1947),o=n(13),s=n(14),c=n(82);function d(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(s.n,s.e)})),n=null==t?void 0:t.consume(c.e);return(null==n?void 0:n.viewParams)||{}}}function l(){return function(e){var t=e(Object(a.e)(function(e){return e.demandItemFacet(r.e,i.e)}));return Object(o.isFeatureEnabled)(o.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(31).e)("photosExperimentHelperKeyFacet",{}).serialize({})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2).e)("photosExperimentHelper")},,,,,,function(e,t,n){"use strict";t.e=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return d}),n.d(t,"r",function(){return u});var a=n(178),i=n(8).e.isActivated("b506db15-aa99-4f70-a19c-8563dd85c92e","6/14/2023","Do not focus trap if nothing to focus");function r(e,t){f(e,c,t)}function o(e,t){f(e,d,t)}function s(e,t){f(e,l,t)}function c(e,t){return e&&h(e,t)}function d(e,t,n){return e&&(_(e.firstElementChild,p,h,t)||g(e,p,h,t,n))}function l(e,t){return e&&g(e,m,b,t)}function u(e,t){return!(!e||!y(e,t))}function f(e,t,n){var a=t(e,n);a&&a.focus()}function p(e){return e.nextElementSibling}function m(e){return e.previousElementSibling}function _(e,t,n,a){for(;e;e=t(e)){var i=n(e,a);if(i)return i}}function h(e,t){return y(e,t)||_(e.firstElementChild,p,h,t)}function b(e,t){return _(e.lastElementChild,m,b,t)||y(e,t)}function g(e,t,n,i,r){for(;e;e=Object(a.e)(e,!r)){var o=_(t(e),t,n,i);if(o)return o}}var v={a:1,input:1,area:1,button:1,select:1,textarea:1,object:1,iframe:1};function y(e,t){var n=e.tagName.toLowerCase();if((n in v||void 0!==e.attributes.tabindex)&&(-1!==e.tabIndex||t)&&"true"!==e.getAttribute("aria-hidden")&&"none"!==e.style.display.toLowerCase()&&"hidden"!==e.style.visibility.toLowerCase()&&(0!==e.offsetWidth||0!==e.offsetHeight)&&!e.disabled&&("input"!==n||"hidden"!==e.type.toLowerCase())&&(i||"hidden"!==getComputedStyle(e).visibility))return e}},,,,,function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"t",function(){return c});var a=n(0),i=n(59),r=n(2492),o=n(135),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?a.resources.consume(r.e):i;return a._itemCommandProvider=o,a}return Object(a.__extends)(t,e),t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)},t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,a=n&&n.getCommand(e,t);return a&&a.behavior},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemCommandProvider:r.e}),t}(i.n);t.e=s;var c=Object(o.r)("ItemCommandHelper",s)},function(e,t,n){"use strict";var a=n(1146);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},,,,function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(27),o=function(e){function t(t){var n=e.call(this,t)||this,a=n.valueAccessor(),i=n._getComponentBindingContext(),o=i.$parentContext;return function(e){return"function"==typeof e}(a)?a({bindingContext:o,templateNodes:n.bindingContext.$componentTemplateNodes}):(r.applyBindingsToDescendants(n.bindingContext.extend({$componentParentContext:i}),n.element),n.controlsDescendantBindings=!0),n}return Object(a.__extends)(t,e),t.prototype._getComponentBindingContext=function(){for(var e=this.bindingContext.$component,t=this.bindingContext;t.$data!==e&&t.$parentContext;)t=t.$parentContext;return t},t.supportsVirtualElements=!0,t}(i.t);t.e=o}],Array(19),[function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(7),i=n(135),r=n(1161),o=n(2106),s=n(1130),c=n(2052),d=n(75),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u="VroomDataRequestor",f=new a.t({name:"".concat(u,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),p=Object(i.r)(u,s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:f})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(1969),i=new a.e("Item",a.t.subject)},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(59),r=n(135),o=n(823),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.contexts=a.observables.createArray(),a._additions=[],a._removals=[],a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.transclude=function(e){var t=this;return this._needsOverlayContent.needsOverlayContent.set(!0),this._transclude(e),{dispose:function(){t._dispose(e)}}},t.prototype._transclude=function(e){this._additions.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._dispose=function(e){this._removals.push(e),this._updateContextsTimeoutId||this._updateContexts()},t.prototype._updateContexts=function(){this._updateContextsTimeoutId=this.async.requestAnimationFrame(this._onUpdateContextsTimeout);var e=this.contexts.peek(),t=this._additions.splice(0),n=this._removals.splice(0);this.contexts.valueWillMutate(),e.push.apply(e,t);for(var a=0,i=n;a<i.length;a++){var r=i[a],o=e.indexOf(r);o>-1&&e.splice(o,1)}this.contexts.valueHasMutated()},t.prototype._onUpdateContextsTimeout=function(){this.contexts.valueHasMutated(),this._updateContextsTimeoutId=void 0,(this._additions.length||this._removals.length)&&this._updateContexts()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:o.e}),t}(i.n),c=new r.n(s,i.n.dependencies)},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(59),i=new(n(7).t)({name:"".concat("UseItemCacheData.key",".useItemCacheData"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return D});var a=n(0),i=n(246),r=n(135),o=n(82),s=n(3007),c=n(8),d=n(75),l=function(){function e(e,t){this.item=e.item,this._dataSource=t.dataSource}return e.prototype.getSettings=function(){var e=this;return this._settingsPromise||(this._settingsPromise=this._dataSource.getSettings(this),this._settingsPromise.done(null,function(t){d.n.isCanceled(t)&&(e._settingsPromise=null,e._rawResponse=null)})),this._settingsPromise},e.prototype.getPermissions=function(e){return this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this)),this._permissionsPromise},e.prototype.cancelGetPermissionsPromise=function(){this._permissionsPromise&&(this._permissionsPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getLinks=function(){var e=this;return this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){return e._linksData=t,t})),this._linksPromise},e.prototype.cancelGetLinksPromise=function(){this._linksPromise&&(this._linksPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)},e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var a=n[0];a.url=e.url,a.expiration=e.expiration,a.isActive=e.isActive}}},e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()},e.prototype.getRawResponse=function(){var e=this;return this._rawResponse||(this._rawResponse=this._dataSource.getRawResponse(this),this._rawResponse.done(null,function(t){d.n.isCanceled(t)&&(e._rawResponse=null)})),this._rawResponse},e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null,this._settingsPromise=null,this._permissionsPromise=null,this._rawResponse=null},e}(),u=n(173),f=n(187),p={ODB:!c.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view")},m=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a._shareDataCache={},a._shareItemHelper=n.shareItemHelper,a}return Object(a.__extends)(t,e),t.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,"",i)},t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return n.link&&(t._invalidateCachedItem(e.items[0]),t._invalidateItem(e.items[0])),n})},t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateCachedItem(e.item),t._invalidateItem(e.item),n})},t.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateCachedItem(t),a._invalidateItem(t),e})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateCachedItem(t),r._invalidateItem(t),e})},t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)},t.prototype.getClientId=function(){return this._dataSource.getClientId()},t.prototype.parseRawSharingInformation=function(e,t){return this._dataSource.parseRawSharingInformation(e,t)},t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)},t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},t.prototype.shareLinkExpress=function(e,t){return this._dataSource.shareLinkExpress(e,t,s.e.AddressBarLink)},t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],a=n&&n.data;return a&&e.eTag===n.eTag&&!t||(a=this.scope.attach(new l({item:e},{dataSource:this.getSharingDataDataSource()})),this._shareDataCache[e.id]={eTag:e.eTag,data:a}),a},t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.stopSharing=function(e,t){var n=this;return this._dataSource.stopSharing(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){return t._invalidateCache(),t.itemProviderInvalidateParent(e),t.itemProviderInvalidate(e.key),n})},t.prototype.updatePermissions=function(e,t,n,a){var i=this;return this._dataSource.updatePermissions(e,t,n,a).then(function(e){return i._invalidateCache(),i.itemProviderInvalidateParent(t),e})},t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var a={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(a).then(function(e){return n._invalidateCachedItem(a.item),n._invalidateItem(a.item),[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var a=e[0];return a&&n.itemProviderInvalidateParent(a),t})},t.prototype._invalidateCache=function(){this._shareDataCache={}},t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)},t.prototype._invalidateItem=function(e){!this.itemProviderInvalidate||!e||e.queryType===u.e.Search&&Object(f.e)(p)||this.itemProviderInvalidateParent(e)},t}(i.e),_=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a}return Object(a.__extends)(t,e),t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)},t}(i.e),h=n(77),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.dependencies={sharingDataSource:h.de},t}(_),g=Object(r.r)("ShareItemHelper",b),v=n(106),y=n(1822),S=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._sharingDataDataSource=n.sharingDataDataSource,a._itemProvider=n.externallySharedItemProvider||n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.getSharingDataDataSource=function(){return this._sharingDataDataSource},t.prototype.itemProviderInvalidate=function(e){this._itemProvider.invalidateItem(e)},t.prototype.itemProviderInvalidateParent=function(e){var t=e&&e.UNSAFE_parent&&e.UNSAFE_parent.key;t&&this._itemProvider.invalidateItem(t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{sharingDataSource:h.de,sharingDataDataSource:h.le.optional,navigation:o.e,externallySharedItemProvider:v.i.optional,itemProvider:y.resourceKey.optional,shareItemHelper:g}),t}(m),D=(t.default=S,Object(r.r)("SharingProvider",S))},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(59),i=new(n(7).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(0),i=n(59),r=n(1863);n.d(t,"t",function(){return r.e});var o=n(809),s=n(1827),c=n(1850);n.d(t,"e",function(){return c});var d=n(7),l=n(135),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.e):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.__extends)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.__rest)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemsStore:s.e}),t}(i.n),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.n=u},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"UploadOperator.key",loader:new i.t(function(){return n.ee([217],2211).then(function(e){return e.typeResourceKey})})})}],Array(13),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(7),i=n(1136),r=n(1175),o=n(1173),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Home=1]="Home",e[e.Personal=2]="Personal",e[e.Solo=3]="Solo",e[e.Trial=4]="Trial",e[e.Storage=5]="Storage"}(a||(a={}))},,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}]);var i=n(0),r=n(260),o=n(27),s=function(e){function t(t){var n=e.call(this,t)||this;return n.icon=o.isObservable(t.icon)?t.icon:o.observable(t.icon),n.badge=o.isObservable(t.badge)?t.badge:o.observable(t.badge),n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""}),n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""}),n}return Object(i.__extends)(t,e),t}(r.t),c=n(402).e({tagName:"od-icon-glyph",template:"<i class=\"od-IconGlyph\" data-bind=\"class:iconClasses,attr:{'data-icon-name':icon},css:{'od-IconGlyph--badged':badge,'od-IconGlyph--visible':icon},with:badge\"><i class=\"od-IconGlyph-badge\" data-bind=\"class:$component.badgeClasses,attr:{'data-icon-name':$component.badge}\"></i></i>",viewModel:s,synchronous:!0});t.e=c},,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o});var a=n(7),i=(new a.t("idle"),new a.t("beforeUnload"),new a.t("syncActiveXClient"),new a.t("attributionHelper"),new a.t("educationAndUpsells"),new a.t("fileHandlerHelper")),r=new a.t("clientSideExtensionHelper"),o=new a.t("needsAttentionViewHelper");new a.t("shyConductor")},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(1996),r=new a.t({name:"OverlayProvider.key",factory:i.e})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(59),r=n(135),o=n(75),s=n(27),c=function(){function e(e){var t=this,n=e.noTitle,a=void 0!==n&&n,i=e.title,r=void 0===i?s.observable(""):i,c=e.elementDescribedBy,d=void 0===c?"":c,l=e.hasCommandBar,u=void 0!==l&&l,f=e.size,p=void 0===f?"Small":f,m=e.scrollMode,_=void 0===m?"auto":m,h=e.showCloseButton,b=void 0===h||h,g=e.includePadding,v=void 0===g||g,y=e.preserveLightDismiss,S=void 0!==y&&y,D=e.stickyCloseButton,I=void 0!==D&&D,x=e.component,C=void 0===x?null:x,O=e.maximizePanelContent,w=void 0!==O&&O,E=e.panelContentSize,A=void 0===E?s.observable({width:0,height:0}):E,L=e.isBlocking,k=e.disableEscape,M=void 0!==k&&k,P=e.overridePanelStyle;this.size=p,this.title=s.isObservable(r)?r:s.observable(r),this.elementDescribedBy=d,this.maximizePanelContent=w,this.panelContentSize=A,this.noTitle=a,this.hasCommandBar=u,this.component=C,this.scrollMode=_,this.showCloseButton=b,this.includePadding=v,this.preserveLightDismiss=S,this.stickyCloseButton=I,this.isBlocking=s.isObservable(L)?L:s.observable(L),this.disableEscape=M,this.overridePanelStyle=P,this.state=s.observable(0),this._promise=new o.n(function(e){var n=s.computed(function(){1===t.state()&&(e(!0),n.dispose())},t)})}return e.prototype.wait=function(){return this._promise},e}(),d=n(823),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.currentPanels=a.observables.createArray(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new c(e),n=this.currentPanels;n.push(t);var a=function(){return n.remove(t)};return t.wait().then(a,a),t},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:d.e}),t}(i.n),u=Object(r.r)("PanelProvider",l)}],Array(13),[function(e,t,n){"use strict";n.d(t,"t",function(){return C}),n.d(t,"e",function(){return M}),n.d(t,"n",function(){return be});var a=n(0),i=n(246),r=n(2205),o=n(1987),s=n(2372),c=n(2403),d=n(2053),l=n(106),u=n(135),f=n(8),p=n(40),m=n(13),_=107374182400,h=Object(m.isFeatureEnabled)(m.EnablePasswordProtectedLinks),b=!f.e.isActivated("6F69C5A2-D27F-42B0-808B-9188498FDFF4","09/19/2022","Use display quota for storage plans feature item in Plans & Purchase page"),g=function(e){return window&&window.require&&window.require.toUrl?window.require.toUrl(e):e},v={text:s.SecurityBulletAlternate,hasGleam:!0,indexInFeatureCardCarousel:1,category:1},y={text:s.ProductivityToolsBullet,hasGleam:!0,indexInFeatureCardCarousel:Object(m.isFeatureEnabled)(m.EnableSecurityMomentLightbox)?6:3,category:2},S={text:s.OutlookAdFreeBullet,hasGleam:!0,indexInFeatureCardCarousel:0,category:2},D={text:s.ProtectionBullet,hasGleam:!0,indexInFeatureCardCarousel:0,category:1},I={text:s.RansomwareBullet,hasGleam:!0,indexInFeatureCardCarousel:0,category:1},x={text:s.FamilySafetyBullet,hasGleam:!0,indexInFeatureCardCarousel:0,category:1},C={text:s.SupportBullet,hasGleam:!0,indexInFeatureCardCarousel:0,category:2,supportIcon:!0},O={text:o.M,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},w={text:o.k,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},E={text:o.A,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},A={text:o.P,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},L={text:o.T,hasGleam:!1,indexInFeatureCardCarousel:0,category:0},k={text:s.biggerPersonalVaultFeatureText,hasGleam:!1,indexInFeatureCardCarousel:5,category:1},M={text:r.w,hasGleam:!1,indexInFeatureCardCarousel:Object(m.isFeatureEnabled)(m.EnableSecurityMomentLightbox)?8:6,category:3},P={text:r._,hasGleam:!1,indexInFeatureCardCarousel:0,category:1},T={text:r.c,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},U={text:r.K,hasGleam:!1,indexInFeatureCardCarousel:2,category:1},F={text:r.m,hasGleam:!1,indexInFeatureCardCarousel:1,category:1},H={text:o.D,hasGleam:!1,indexInFeatureCardCarousel:6,category:2},R={type:7,imageUrl:g("odsp-media/images/premium/password-protected-links.svg"),backgroundColor:"#1A9BF5",featureName:s.SecurityBulletAlternate,headline:r.j,description:r.B,comingSoon:!h},N={type:3,imageUrl:g("odsp-media/images/premium/feature-card-expiring-links.svg"),backgroundColor:"#1A9BF5",featureName:s.SecurityBulletAlternate,headline:r.m,description:r.l,comingSoon:!1},B={type:2,imageUrl:g("odsp-media/images/premium/feature-card-personal.svg"),backgroundColor:"#30C6CC",featureName:r.P,headline:Object(m.isFeatureEnabled)(m.EnableM365Basic)?r.r:r.U,description:Object(m.isFeatureEnabled)(m.EnableM365Basic)?r.i:r.T,comingSoon:!1},j=Object(a.__assign)(Object(a.__assign)({},B),{featureName:r.V}),V={type:1,imageUrl:g("odsp-media/images/premium/feature-card-home.svg"),backgroundColor:"#FDB813",featureName:r.E,headline:r.L,description:r.A,comingSoon:!1},z={type:0,imageUrl:g("odsp-media/images/premium/feature-card-storage-only.svg"),backgroundColor:"#9C5096",featureName:s.BasicCapacityFiftyGB,headline:r.ee,description:r.Z,comingSoon:!1},G={type:0,imageUrl:g("odsp-media/images/premium/feature-card-storage-only.svg"),backgroundColor:"#9C5096",featureName:s.BasicCapacityHundredGB,headline:r.te,description:r.$,comingSoon:!1},K={type:6,imageUrl:g("odsp-media/images/premium/feature-card-sharing.svg"),backgroundColor:"#9B4F95",featureName:s.ProductivityToolsBullet,headline:r.S,description:r.Q,comingSoon:!1},W={type:5,imageUrl:g("odsp-media/images/premium/feature-card-office-apps.svg"),backgroundColor:"#FDB813",featureName:r.w,headline:r.O,description:r.C,comingSoon:!1},q=Object(a.__assign)(Object(a.__assign)({},W),{featureName:r.V}),Q={type:4,imageUrl:g("odsp-media/images/premium/feature-card-offline.svg"),backgroundColor:"#9B4F95",featureName:s.ProductivityToolsBullet,headline:o.D,description:r.W,comingSoon:!1},Y={type:9,imageUrl:g("odsp-media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:r.e,headline:r._,description:r.t,comingSoon:!1},J={type:8,imageUrl:g("odsp-media/images/premium/feature-card-files-restore.svg"),backgroundColor:"#1A9BF5",featureName:s.SecurityBulletAlternate,headline:r.b,description:r.h,comingSoon:!1},X={type:13,imageUrl:g("odsp-media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:s.SecurityBulletAlternate,headline:r.q,description:r.n,comingSoon:!1},Z={type:14,imageUrl:g("odsp-media/images/premium/feature-card-vault-unlimited.svg"),backgroundColor:"#199bf5",featureName:s.SecurityBulletAlternate,headline:r.ne,description:r.a,comingSoon:!1},$=Object(a.__assign)(Object(a.__assign)({},Z),{featureName:""}),ee={type:10,imageUrl:g("odsp-media/images/premium/feature-card-virus-protection.svg"),backgroundColor:"#1A9BF5",featureName:r.e,headline:r.c,description:r.s,comingSoon:!1},te={type:11,imageUrl:g("odsp-media/images/premium/feature-card-privacy-tools.svg"),backgroundColor:"#1A9BF5",featureName:r.e,headline:r.K,description:r.G,comingSoon:!1},ne={type:12,imageUrl:g("odsp-media/images/premium/feature-card-outlook-premium.svg"),backgroundColor:"#0078D7",featureName:r.V,headline:r.N,description:r.R,comingSoon:!1},ae={type:2,title:r.U,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:r.H,comingSoon:!1},ie={type:1,title:r.E,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:r.J,comingSoon:!1},re={type:0,title:r.te,icon:"Cloud",bubbleColor:"rgba(0, 120, 215, 0.1)",iconColor:"rgb(0, 120, 215)",bodyText:r.v,comingSoon:!1},oe={type:3,title:r.u,icon:"AlarmClock",bubbleColor:"rgba(232, 17, 35, 0.1)",iconColor:"rgb(232, 17, 35)",bodyText:r.d,comingSoon:!1},se={type:7,title:r.j,icon:"Lock",bubbleColor:"rgba(180, 0, 158, 0.1)",iconColor:"rgb(180, 0, 158)",bodyText:r.B,comingSoon:!h},ce={type:6,title:r.y,icon:"Share",bubbleColor:"rgba(255, 185, 0, 0.1)",iconColor:"rgb(255, 185, 0)",bodyText:r.Y,comingSoon:!1},de={type:5,title:s.appListWinMacTitle,icon:"ThisPC",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:r.x,comingSoon:!1},le={type:5,title:r.M,icon:"CellPhone",bubbleColor:"rgba(242, 111, 76, 0.1)",iconColor:"rgb(242, 111, 76)",bodyText:r.k,comingSoon:!1},ue={type:4,title:o.D,icon:"CloudDownload",bubbleColor:"rgba(16, 124, 16, 0.1)",iconColor:"rgb(16, 124, 16)",bodyText:r.F,comingSoon:!1},fe={type:0,features:[ae],title:r.X},pe={type:1,features:[oe,se],title:s.SecurityBulletAlternate},me={type:2,features:[ue,ce],title:s.ProductivityToolsBullet},_e={type:3,features:[de,le],title:r.I},he=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.getFeatureListItems=function(e,t,n,a){return void 0===t&&(t=""),Object(m.isFeatureEnabled)(m.EnableM365Basic)&&(e===d.e.Home||e===d.e.Personal||e===d.e.Storage&&a===_)?e===d.e.Home?[S,D,I,x,C]:e===d.e.Personal?[S,D,I,C]:e===d.e.Storage&&a===_?[S,C]:void 0:[this.getStorageFeatureByPlan(e,t,n),v,y,k]},t.prototype.getFeatureListItemsForPremiumPositioning=function(e,t){if(void 0===t&&(t=""),Object(m.isFeatureEnabled)(m.EnableM365Basic))return e===d.e.Storage?[A,S,C]:[L,D,I];var n=this.getStorageFeatureByPlan(e,t);return e===d.e.Storage?[n]:[n,v,k]},t.prototype.getStandardFeatureListItemsForPostPurchasePlansPage=function(e){return[this._getSpaceFeatureListItem(e),F,H]},t.prototype.getSecurityFeatureListItems=function(){return[P,T,U]},t.prototype.getFeatureCards=function(e,t){var n=this._getCarouselStorageFeatureCard(e,t);if(e===d.e.Storage)return[n];var i=[X,J,Z],r=Object(m.isFeatureEnabled)(m.EnableSecurityMomentLightbox)?i:[];return Object(a.__spreadArray)(Object(a.__spreadArray)([n,N,R],r,!0),[Q,K,W],!1)},t.prototype.getFeatureCardsForSecurityMomentLightbox=function(e){void 0===e&&(e=!1);var t=e?[]:[j,ne,q];return Object(a.__spreadArray)([Y,ee,te],t,!0)},t.prototype.getFeatureCardsForVaultUpsell=function(){return[$]},t.prototype.getReactFeatureCards=function(e){return{categories:this._getCategories(e),headerFooter:this._getHeaderFooter(e)}},t.prototype.getStorageFeatureByPlan=function(e,t,n){void 0===t&&(t="");var a=this._getSpaceFeatureListItem(e,n);return e!==d.e.Home&&e!==d.e.Personal&&e!==d.e.Solo&&t.length>0&&(a.text=t),a},t.prototype._getCategories=function(e){var t=this._getReactStorageFeatureCard(e),n=fe;return n.features=[t],e===d.e.Storage?[n]:[n,pe,me,_e]},t.prototype._getHeaderFooter=function(e){var t,n=e===d.e.Storage?o._:o.o,a=this._getSecondaryTitle(e),i=this._getImageAltText(e),s=r.g,c=o.t;switch(e){case d.e.Home:t=g("odsp-media/images/storageoptions/premium-home.svg");break;case d.e.Storage:t=g("odsp-media/images/premium/storage-only-badge-large.svg");break;default:t=g("odsp-media/images/premium/premium-diamond-large.svg")}return{image:t,imageAltText:i,mainTitle:n,secondaryTitle:a,buttonText:s,closeButtonAriaLabel:c}},t.prototype._getSecondaryTitle=function(e){switch(void 0===e&&(e=d.e.Personal),e){case d.e.Home:case d.e.Trial:return s.planM365FamilyHeaderText;case d.e.Storage:return o.h;case d.e.Solo:return p.format(o.O,c.M365Solo);default:return s.M365PlanPersonalHeaderText}},t.prototype._getImageAltText=function(e){switch(void 0===e&&(e=d.e.Personal),e){case d.e.Home:case d.e.Trial:return o.v;case d.e.Storage:return p.format(c.iconAltText,c.ListHundredGBPlanDescription);default:return o.x}},t.prototype._getSpaceFeatureListItem=function(e,t){switch(void 0===e&&(e=d.e.Personal),e){case d.e.Home:case d.e.Trial:return w;case d.e.Storage:return(Object(m.isFeatureEnabled)(m.Onboarding50GBStandAlonePlanRamp)||Object(m.isFeatureEnabled)(m.EnableM365Basic))&&b&&t?this._getStorageFeatureItem(t):E;default:return O}},t.prototype._getCarouselStorageFeatureCard=function(e,t){switch(void 0===e&&(e=d.e.Personal),e){case d.e.Home:case d.e.Trial:return V;case d.e.Storage:return Object(m.isFeatureEnabled)(m.Onboarding50GBStandAlonePlanRamp)&&b&&53687091200===t?z:G;default:return B}},t.prototype._getReactStorageFeatureCard=function(e){switch(void 0===e&&(e=d.e.Personal),e){case d.e.Home:case d.e.Trial:return ie;case d.e.Storage:return re;default:return ae}},t.prototype._getStorageFeatureItem=function(e){return{text:p.format(o.L,e),hasGleam:!1,indexInFeatureCardCarousel:0,category:0}},t}(i.e),be=Object(u.r)("FeatureCardsProvider",he,{userInfoProvider:l.A})},,,,,,,,,,,,function(e,t,n){"use strict";var a=n(1950);t.e=a.e},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(380),i=n(2123),r=n(75),o=n(1141),s=n(135),c=n(97),d=n(90),l=n(2107),u=n(187),f={ODB:n(1172).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:-671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===a.e.aad){if(t&&p){var i=new d.e(t).authority;return this._identityDataSource.getSharePointToken(i)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return r.n.resolve()})}else if(n===a.e.msa)return this._identityDataSource.getSessionToken();return r.n.reject(new c.e({code:l.e.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:o.e,microServiceDataSource:i.e.optional},e}(),_=Object(s.r)("SessionManagementProvider",m)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={unauthUser:"unauthUser"}},,function(e,t,n){"use strict";var a=n(3001);t.e=a.e},function(e,t,n){"use strict";var a=n(0),i=n(183),r=n(244),o=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._platform=n.resources.consume(r.e.optional),n._isPermanent="object"==typeof i&&i.isPermanent||!1,n._isReentrant="object"==typeof i&&i.isReentrant||!1,document.activeElement===n.element&&n._select();var o=Object(a.__assign)({focus:n._onFocus,focusin:n._onFocus,mouseup:n._onMouseUp},n._isReentrant?{focusout:n._onFocusOut}:{});return n.events.onAll(n.element,o),n}return Object(a.__extends)(t,e),t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}return this._hasSelected=!0,!0}return!1},t.prototype._onFocus=function(e){return this._select(),!0},t.prototype._onFocusOut=function(){return this._hasSelected=!1,!0},t.prototype._onMouseUp=function(e){if(this._select())return!1},t}(i.t);t.e=o},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("".concat("MicroServiceDataSource.key",".microServiceDataSource"))},,,function(e,t,n){"use strict";var a=n(27);t.e=function(e){this.templateNodes=e.templateNodes,this.bindingContext=e.bindingContext,this.renderCount=e.renderCount||a.observable(0),this.parentElement=e.parentElement||null,this.options=e.options||null}},,,,,,,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(1863);n.d(t,"t",function(){return r.e});var o=n(2360),s=n(75),c=n(242),d=n(1129),l=n(140),u=n(1930),f=n(482);n.d(t,"e",function(){return f.e});var p=n(814),m=n(2649),_="_BaseOperator_actionName",h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._actionsByName={};var i=n.operationProvider,r=void 0===i?a.resources.consume(d.resourceKey):i,s=n.operatorBatchMonitorType,c=void 0===s?a.resources.consume(m.e):s;return a._operationProvider=r,a._operationBatch=new p.e,a._operatorBatchMonitor=a.scope.attach(new c({operationBatch:a._operationBatch,onOperationFinished:function(e){return a.onOperationFinished(e)}})),a._operationsByKey={},a._observer=a.addDisposable(new o.e(a._onTaskChanges.bind(a))),a._throttleExecuteAllActions=a.async.debounce(a._executeAllActions),a.registerActions({cancel:a.onCancel}),a}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._observer=null,this._actionsByName={},this._getActionExecutor=null,this._onTaskChanges=null,this._operationsByKey={},this._throttleExecuteAllActions=null},t.prototype.start=function(){var e=this;return this._operatorBatchMonitor.start(function(){return e.onStart(e._observer)})},t.prototype.wait=function(){var e=this;return this._operatorBatchMonitor.wait().then(function(){e.dispose()},function(){e.dispose()})},t.prototype.onStart=function(e){return s.n.wrap()},t.prototype.onCancel=function(e,t){return e=e.map(function(e){return e.cancel()}),t.update(e),s.n.wrap()},t.prototype.registerActions=function(e){for(var t in e){var n=e[t];n?(n[_]=t,this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new c.e}):delete this._actionsByName[t]}},t.prototype.getOperationDetails=function(e){var t;return t=1===e.status?l.e.completed:2===e.status?l.e.failed:3===e.status?l.e.canceled:l.e.started,{type:f.e.multiple,name:"",iconName:null,error:e.error&&new u.e({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}},t.prototype.onOperationFinished=function(e){},t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];return n.queue.push(t),this._throttleExecuteAllActions(),n.signal.getPromise()},t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;if(t.signal=new c.e,t.queue.length){var a=t.queue.splice(0,t.queue.length);t.callback(a,this._observer).done(b(n),g(n))}}},t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];this._updateOperationForTask(a)}},t.prototype._updateOperationForTask=function(e){var t,n=e.current,a=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var r=0,o=a.actions;r<o.length;r++){var s=o[r],c=s[_],d=this._actionsByName[c];d&&d.action===s&&(t[c]=!0)}if(!i){var l={};for(var c in this._actionsByName)l[c]={isAvailable:this.createObservable(c in t),execute:this._getActionExecutor(c,n)};var u={batch:this._operationBatch,type:a.type,name:a.name,iconName:a.iconName,payloads:a.payloads,progress:a.progress,visibility:a.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(u)}for(var c in i.name!==a.name&&(i.name=a.name,i.payloads(a.payloads)),i.progress.minimum(a.progress.minimum),i.progress.maximum(a.progress.maximum),i.progress.current(a.progress.current),i.type(a.type),i.error(a.error),i.state(a.state),this._actionsByName)i.actions.peek()[c].isAvailable(c in t)},t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:d.resourceKey,operatorBatchMonitorType:m.e}),t}(i.n);function b(e){return function(){return e.complete()}}function g(e){return function(t){return e.error(t)}}t.n=h}],Array(14),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(75),i=n(47),r=n(135),o=n(77),s=function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}return e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)},e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?a.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.t.Success}}):a.n.resolve({resultType:i.t.Success})},e}(),c=Object(r.r)("ItemRedeemer",s,{ticketRedeemer:o.ve.async.optional})},function(e,t,n){"use strict";var a;!function(e){e[e.update=0]="update",e[e.leftNav=1]="leftNav",e[e.quotaBlock=2]="quotaBlock",e[e.frozenBlock=3]="frozenBlock",e[e.manageStorage=4]="manageStorage",e[e.lockedBlock=5]="lockedBlock",e[e.dragAndDrop=6]="dragAndDrop",e[e.premiumLeftNav=7]="premiumLeftNav",e[e.quotaBanner=8]="quotaBanner",e[e.quotaBannerUpsell=9]="quotaBannerUpsell",e[e.uploadProgressTile=10]="uploadProgressTile",e[e.moveCopyProgressTile=11]="moveCopyProgressTile"}(a||(a={})),t.e=a},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(135),i=n(2355),r=n(2356),o=n(1130),s=Object(a.r)("GraphDataRequestor",o.e,{sessionManagementProvider:i.resourceKey,urlDataSource:r.resourceKey});o.e},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"InAppMessagingProvider.key",loader:new i.t(function(){return n.ee(47,2735).then(function(e){return e.resourceKey})})})},,,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s});var a="List",i="CompactList",r="Grid",o="Album",s="AllPhotos"},function(e,t,n){"use strict";var a;!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a=n(0),i=n(2891),r=function(e){function t(t){void 0===t&&(t={});var n,a=e.call(this,t)||this;return n=a.useGlobalResources()?a.resources.consume(i.t):a.managed(i.e),a._loader=new n({path:a.getExecutorPath(),getModule:a.getModuleFactory(),getExecutorParams:function(){return a.selectionHelper.resolveSelection().then(function(e){return a.getExecutorParameters({selection:e})})}}),a}return Object(a.__extends)(t,e),t.prototype.useGlobalResources=function(){return!1},t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)},t}(n(3138).e);t.e=r},function(e,t,n){"use strict";var a;!function(e){e[e.unknown=0]="unknown",e[e.none=1]="none",e[e.learnMore=2]="learnMore",e[e.upgrade=3]="upgrade",e[e.cleanUpFiles=4]="cleanUpFiles",e[e.manageStorage=5]="manageStorage",e[e.wac=6]="wac",e[e.officePlans=7]="officePlans"}(a||(a={})),t.e=a},,,,,,,,,,,function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))}],Array(21),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'.od-FeatureCards-modal{font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%}@media (max-width:639.99999px){.od-FeatureCards-modal{display:block}}.od-FeatureCards-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-FeatureCards-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default}.od-FeatureCards-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.md .od-FeatureCards-main,.sm .od-FeatureCards-main{height:100%;width:100%}.od-FeatureCards-welcome{font-weight:100;opacity:1;color:'},{theme:"white",defaultValue:"#fff"},{rawString:";text-align:center;line-height:50px;font-size:32px;padding-bottom:15px}.od-Carousel-page{background:"},{theme:"menuBackground",defaultValue:"#fff"},{rawString:";box-sizing:border-box;border-radius:2px;padding:20px 0 16px}.md .od-Carousel-page,.sm .od-Carousel-page{width:100%;height:100%;display:flex;flex-direction:column}.od-FeatureCards-page{margin:0 auto;position:relative;width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:"}@media (max-width:1023.99999px){.od-FeatureCards-page{width:524px}}.xxxxlg .od-FeatureCards-page{width:840px}.xxxlg .od-FeatureCards-page{width:644px}.xxlg .od-FeatureCards-page{width:560px}.xlg .od-FeatureCards-page{width:448px}.lg .od-FeatureCards-page{width:448px}.od-FeatureCards-closeBtn{position:absolute;top:16px}html[dir=ltr] .od-FeatureCards-closeBtn{text-align:right}html[dir=rtl] .od-FeatureCards-closeBtn{text-align:left}[dir=ltr] .od-FeatureCards-closeBtn{right:16px}[dir=rtl] .od-FeatureCards-closeBtn{left:16px}.od-FeatureCards-closeBtn button{cursor:pointer;font-size:16px;background:0 0;border:0;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";width:32px;height:32px;padding:0}.md .od-FeatureCards-closeBtn button,.sm .od-FeatureCards-closeBtn button{font-size:20px}.od-FeatureCards-closeBtn button:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-FeatureCards-closeBtn button:active{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-FeatureCards-closeBtn button .ms-Icon{line-height:32px}.od-FeatureCards-paginationControls{background-color:"},{theme:"menuBackground",defaultValue:"#fff"},{rawString:";height:32px;position:relative}.od-FeatureCards-paginationControls--leftButton,.od-FeatureCards-paginationControls--rightButton{position:absolute;top:0}[dir=ltr] .od-FeatureCards-paginationControls--leftButton{left:16px}[dir=rtl] .od-FeatureCards-paginationControls--leftButton{right:16px}[dir=ltr] .od-FeatureCards-paginationControls--rightButton{right:16px}[dir=rtl] .od-FeatureCards-paginationControls--rightButton{left:16px}.od-focus--enabled .od-FeatureCards-NavigateNextButton:focus,.od-focus--enabled .od-FeatureCards-NavigatePreviousButton:focus{box-shadow:none}.od-focus--enabled .od-FeatureCards-NavigateNextButton:focus .ms-Icon,.od-focus--enabled .od-FeatureCards-NavigatePreviousButton:focus .ms-Icon{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-FeatureCards-TextNavigation{background:0 0;border:none;padding:0 8px;line-height:32px;border-radius:2px;font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-FeatureCards-TextNavigation.od-FeatureCards-FinishedButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FeatureCards-TextNavigation.od-FeatureCards-FinishedButton:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-FeatureCards-TextNavigation.od-FeatureCards-FinishedButton:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-FeatureCards-TextNavigation:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-FeatureCards-TextNavigation:active{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-FeatureCards-TextNavigation:active,.od-FeatureCards-TextNavigation:hover{text-decoration:underline;cursor:pointer}.od-FeatureCards-NavigateNextButton,.od-FeatureCards-NavigatePreviousButton{position:absolute;padding:0;background-color:transparent;display:block;border:none;top:0;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:14px}.od-FeatureCards-NavigateNextButton span,.od-FeatureCards-NavigatePreviousButton span{line-height:32px}.od-FeatureCards-NavigateNextButton .ms-Icon,.od-FeatureCards-NavigatePreviousButton .ms-Icon{border-radius:2px}.od-FeatureCards-NavigateNextButton:hover,.od-FeatureCards-NavigatePreviousButton:hover{cursor:pointer;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-FeatureCards-NavigateNextButton:hover .ms-Icon,.od-FeatureCards-NavigatePreviousButton:hover .ms-Icon{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-FeatureCards-NavigateNextButton:active,.od-FeatureCards-NavigatePreviousButton:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-FeatureCards-NavigateNextButton:active .ms-Icon,.od-FeatureCards-NavigatePreviousButton:active .ms-Icon{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.md .od-FeatureCards-NavigateNextButton span,.md .od-FeatureCards-NavigatePreviousButton span,.sm .od-FeatureCards-NavigateNextButton span,.sm .od-FeatureCards-NavigatePreviousButton span{line-height:38px}.od-FeatureCards-NavigateNextButton.is-disabled .ms-Icon,.od-FeatureCards-NavigatePreviousButton.is-disabled .ms-Icon{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-FeatureCards-NavigateNextButton .ms-Icon,.od-FeatureCards-NavigatePreviousButton .ms-Icon{cursor:pointer;background:0 0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:9px;font-size:16px}.md .od-FeatureCards-NavigateNextButton .ms-Icon,.md .od-FeatureCards-NavigatePreviousButton .ms-Icon,.sm .od-FeatureCards-NavigateNextButton .ms-Icon,.sm .od-FeatureCards-NavigatePreviousButton .ms-Icon{font-size:20px}.od-FeatureCards-NavigateNextButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-FeatureCards-NavigateNextButton{right:16px}[dir=rtl] .od-FeatureCards-NavigateNextButton{left:16px}[dir=ltr] .od-FeatureCards-NavigatePreviousButton{left:16px}[dir=rtl] .od-FeatureCards-NavigatePreviousButton{right:16px}.od-FeatureCards-NavigatePreviousButton .ms-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{float:right}html[dir=rtl] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{float:left}[dir=ltr] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{margin-left:8px}[dir=rtl] .od-FeatureCards-NavigateNextButton .ms-Icon--ChevronRight{margin-right:8px}html[dir=ltr] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{float:left}html[dir=rtl] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{float:right}[dir=ltr] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{margin-right:8px}[dir=rtl] .od-FeatureCards-NavigatePreviousButton .ms-Icon--ChevronLeft{margin-left:8px}.od-FeatureCards-carousel{height:272px;position:relative;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.md .od-FeatureCards-carousel{height:240px}.sm .od-FeatureCards-carousel{height:160px}.od-FeatureCards-animationArea{display:flex;flex-direction:column;justify-content:center;height:100%}.od-FeatureCards-image{height:215px;width:100%;margin-top:0}.od-FeatureCards-description{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html[dir=ltr] .od-FeatureCards-description{text-align:left}html[dir=rtl] .od-FeatureCards-description{text-align:right}.md .od-FeatureCards-description,.sm .od-FeatureCards-description{flex:1 1 auto}.od-FeatureCards-descriptionTitle{font-size:28px;font-weight:100;display:block;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:20px;font-weight:600;padding:0 24px 20px;line-height:20px}html[dir=ltr] .od-FeatureCards-descriptionTitle{text-align:left}html[dir=rtl] .od-FeatureCards-descriptionTitle{text-align:right}.od-FeatureCards-descriptionArea{font-size:14px;font-weight:400;display:block;line-height:20px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";padding:12px 24px;min-height:60px}.lg .od-FeatureCards-descriptionArea,.md .od-FeatureCards-descriptionArea,.sm .od-FeatureCards-descriptionArea,.xlg .od-FeatureCards-descriptionArea{min-height:80px}.od-FeatureCards-descriptionArea--includesComingSoon{padding-bottom:14px}.od-FeatureCards-comingSoon{padding-top:10px;font-weight:600}.od-FeatureCards-button{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";text-align:center}.od-FeatureCards-mainButton.od-Button{font-size:14px;font-weight:400;background-color:#107c10;border:1px solid #107c10;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";width:200px;height:40px;margin-bottom:16px}.od-FeatureCards-mainButton.od-Button:hover{background-color:#0b6a0b;border:1px solid #0b6a0b}.od-FeatureCards-mainButton.od-Button:focus{background-color:#0b6a0b;border:1px solid #004b1c}.od-FeatureCards-pagination{width:100%;height:36px}.od-FeatureCards-paginationNumbers{font-size:14px;line-height:32px}.od-FeatureCards-unselectedPage{width:12px;height:12px;margin:12px 8px;border-radius:50%;border:solid "},{theme:"white",defaultValue:"#fff"},{rawString:" 1px;display:inline-block;cursor:pointer}.od-FeatureCards-pagination .od-FeatureCards-curPage{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}"}]);var i=n(0),r=n(260),o=n(1933),s=n(1858),c=n(1880),d=n(1119),l=n(2334),u=n(1962),f=n(2248),p=n(405),m=n(32),_=n(1851),h=n(1852),b=n(1987),g=n(2205),v=n(403),y=n(2442),S=[l.e,l.n,l.a],D=function(e){function t(t){var n=e.call(this)||this;n.overlayTagName=h.e.tagName,n.includeOverlay=t.includeOverlay||!1,n.addBindingHandlers({element:d.e,imageLoader:_.e,bindableHtml:o.e,focusTrap:s.e,preserveFocus:c.e}),n.contentRoot=n.createObservable();var a=n.contentRoot.subscribe(function(e){Object(u.t)(e),a.dispose()});return n.closeButtonAriaLabel=b.t,n.skipButtonAriaLabel=b.w,n.nextButtonAriaLabel=g.D,n.previousButtonAriaLabel=g.z,n.nextButtonText=b.S,n.previousButtonText=b.C,n.skipButtonText=b.E,n.startButtonText=b.U,n.finishedButtonText=b.l,n.primaryButtonText=t.goPremiumCTA?b.m:g.g,n.comingSoonText=g.o,n.currentCardIndex=n.createObservable(t.currentIndex),n.cards=t.cards,n.currentCard=n.createPureComputed(n._computeCurrentCard),n.goPremiumSource=t.goPremiumSource,n.goPremiumCTA=t.goPremiumCTA,n._close=t.close,n._onFinishedClick=t.onFinishedClick,n._mainButtonClick=t.mainButtonClick,n.carouselComponent={name:y.e.tagName,params:{item:n.currentCard,items:n.observables.createArray(n.cards),isEnabled:!1}},n._engagement=n.resources.consume(v.e),n._numberCardsViewed=t.numberCardsViewed||0,n._logEventForFeatureCardsViewed(),n}return Object(i.__extends)(t,e),t.prototype.onNextBtnClick=function(){var e=this.currentCardIndex.peek()+1;this.currentCardIndex(e),e>0&&e<this.cards.length-1&&this._setFocusOnButton("od-FeatureCards-NavigateNextButton"),e===this.cards.length-1&&this._setFocusOnButton("od-FeatureCards-FinishedButton"),this._logEventForFeatureCardsViewed()},t.prototype.onPreviousBtnClick=function(){var e=this.currentCardIndex.peek()-1;this.currentCardIndex(e),0===e&&this._setFocusOnButton("od-FeatureCards-paginationControls--leftButton"),this._logEventForFeatureCardsViewed()},t.prototype.onPaginationClick=function(e){this.currentCardIndex(e),this._logEventForFeatureCardsViewed()},t.prototype.onCloseBtnClick=function(){this._close(this.currentCardIndex.peek(),this._numberCardsViewed)},t.prototype.onFinishedClick=function(){this._onFinishedClick?this._onFinishedClick():this._close(this.currentCardIndex.peek(),this._numberCardsViewed)},t.prototype.onGotItButtonClick=function(){this._mainButtonClick?this._mainButtonClick(this.currentCardIndex.peek(),this._numberCardsViewed):this._close(this.currentCardIndex.peek(),this._numberCardsViewed)},t.prototype.onGoPremiumButtonClick=function(){var e=this.resources.consume(f.n).getPurchaseAttribution({source:this.goPremiumSource,cta:this.goPremiumCTA});S.indexOf(this.goPremiumSource)>-1&&this._engagement.logData({name:"Vault.FeatureCard.GoPremium",extraData:{source:this.goPremiumSource}});var t=this.resources.consume(p.n).getUpgradeOptionsUrl(e,!0),n=this.resources.consume(m.e),a=new(this.resources.injected(n.NavigationAction))({url:t});this.onGotItButtonClick(),a.execute(null),a.dispose()},t.prototype.onPrimaryButtonClick=function(){this.goPremiumSource?this.onGoPremiumButtonClick():this.onGotItButtonClick()},t.prototype.setImageLoaded=function(e){var t=this.createObservable(!1);return this.createComputed(function(){t()&&e(2)}),t},t.prototype._computeCurrentCard=function(){return this.cards[this.currentCardIndex()]},t.prototype._logEventForFeatureCardsViewed=function(){this._numberCardsViewed++;var e={1:"sawOneFeatureCard",2:"sawTwoFeatureCards",3:"sawThreeFeatureCards",4:"sawFourFeatureCards",5:"sawFiveFeatureCards",6:"sawSixFeatureCards"}[this._numberCardsViewed];e&&this._engagement.logData({name:"".concat("PremiumFeatureCards",".").concat(e),isIntentional:!0})},t.prototype._setFocusOnButton=function(e){var t=document.getElementsByClassName(e);if(t&&t.length>0){var n=t[0];n.focus&&n.focus()}},t}(r.t),I=n(402).e({tagName:"od-feature-cards",template:'\x3c!--ko component:{name:overlayTagName,params:{animation:{},alignToParent:false}}--\x3e<div class="od-FeatureCards-modal">\x3c!--ko if:includeOverlay--\x3e<div class="ms-ModalOverlay"></div>\x3c!--/ko--\x3e\x3c!--ko focusTrap:{}--\x3e<div class="od-FeatureCards-main" data-bind="preserveFocus:true,element:contentRoot"><div class="od-FeatureCards-page od-Carousel-page"><div class="od-FeatureCards-descriptionTitle" data-bind="text:currentCard().headline"></div><div class="od-FeatureCards-carousel" data-bind="component:carouselComponent,style:{\'background-color\':currentCard().backgroundColor}"><div class="od-FeatureCards-animationArea" data-bind="style:{\'background-color\':$host.item.backgroundColor}"><img class="od-FeatureCards-image" data-bind="imageLoader:{src:$host.item.imageUrl,isLoaded:setImageLoaded.call($component,$host.loadState)},attr:{alt:$host.item.featureName}"></div></div><div class="od-FeatureCards-closeBtn"><button data-bind="click:onCloseBtnClick,attr:{\'aria-label\':closeButtonAriaLabel}"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div><div class="od-FeatureCards-description" role="region" aria-live="polite"><div class="od-FeatureCards-descriptionArea" data-bind="css:{\'od-FeatureCards-descriptionArea--includesComingSoon\':currentCard().comingSoon}"><div class="od-FeatureCards-descriptionText" data-bind="text:currentCard().description"></div>\x3c!--ko if:currentCard().comingSoon--\x3e<div class="od-FeatureCards-comingSoon" data-bind="text:comingSoonText"></div>\x3c!--/ko--\x3e</div></div><div class="od-FeatureCards-paginationControls">\x3c!--ko if:currentCardIndex()===0--\x3e<button class="od-FeatureCards-TextNavigation od-FeatureCards-paginationControls--leftButton" data-bind="click:onCloseBtnClick,attr:{\'aria-label\':skipButtonAriaLabel}"><span data-bind="text:skipButtonText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:currentCardIndex()!==0--\x3e<button class="od-FeatureCards-NavigatePreviousButton" data-bind="click:onPreviousBtnClick,attr:{\'aria-label\':previousButtonAriaLabel}"><i class="ms-Icon ms-Icon--ChevronLeft" data-bind="icon:true"></i><span data-bind="text:previousButtonText"></span></button>\x3c!--/ko--\x3e<div class="od-FeatureCards-paginationNumbers" data-bind="visible:cards.length>1"><span data-bind="text:currentCardIndex()+1"></span> of <span data-bind="text:cards.length"></span></div>\x3c!--ko if:currentCardIndex()===0&&cards.length>1--\x3e<button class="od-FeatureCards-NavigateNextButton" data-bind="click:onNextBtnClick,attr:{\'aria-label\':nextButtonText}"><i class="ms-Icon ms-Icon--ChevronRight" data-bind="icon:true"></i><span data-bind="text:startButtonText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:currentCardIndex()>0&&currentCardIndex()<cards.length-1--\x3e<button class="od-FeatureCards-NavigateNextButton" data-bind="click:currentCardIndex()<cards.length-1?onNextBtnClick:undefined,attr:{\'aria-label\':nextButtonAriaLabel}"><i class="ms-Icon ms-Icon--ChevronRight" data-bind="icon:true"></i><span data-bind="text:nextButtonText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:currentCardIndex()===cards.length-1--\x3e<button class="od-FeatureCards-TextNavigation od-FeatureCards-FinishedButton od-FeatureCards-paginationControls--rightButton" data-bind="click:onFinishedClick,attr:{\'aria-label\':closeButtonAriaLabel}"><span data-bind="text:finishedButtonText"></span></button>\x3c!--/ko--\x3e</div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',viewModel:D,synchronous:!0});t.e=I}],Array(17),[function(e,t,n){"use strict";var a=n(2228);function i(){}function r(){}r.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,r,o){if(o!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}],Array(19),[function(e,t,n){"use strict";n.d(t,"n",function(){return d.e}),n.d(t,"e",function(){return m});var a=n(0),i=n(59),r=n(82),o=n(106),s=n(1022),c=n(73),d=n(1023),l=n(707),u=n(1174),f={cmmskgzokmj:"LeftNav",cmmbmfcmgdo:"LeftNav",cmmugdncaui:"LeftNav",cmmfqa4dpsq:"LeftNav",cmmfk8o8cot:"HeaderDiamond"},p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._navigation=n.resources.consume(r.e),n}return Object(a.__extends)(t,e),t.prototype.appendPurchaseAttribution=function(e,t,n){var a=new c.t(t),i=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"];(!i||!l.e&&i.indexOf("PROD_OneDrive")>-1)&&(i=!l.e&&n||this.getPurchaseAttribution(e));var r=a.getQueryParameter("ru");if(r){var o=new c.t(r);o.setQueryParameter("ocid",i),a.setQueryParameter("ru",o.toString())}return a.setQueryParameter("ocid",i),a.toString()},t.prototype.getPurchaseAttribution=function(e){var t=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"];if(t)return t;if(!l.e)return Object(u.e)(e.source,e.cta);var n=this._getUserState(),a=e.attributionEndpoint||"Web";return"PROD_OneDrive-".concat(a,"_").concat(e.source,"_").concat(n,"_").concat(e.cta)},t.prototype.getSourceFromIdeasAttribution=function(e){return function(e){return f["".concat(e)]}(e)},t.prototype._getUserState=function(){return this._isUserStateProviderAvailable()&&this._userStateProvider.status?m(this._userStateProvider.status.peek()):"Unknown"},t.prototype._isUserStateProviderAvailable=function(){return this._userStateProvider=this.resources.consume(o.b.optional),this._bundleLoader=this.resources.consume(o.e.optional),!!this._bundleLoader&&this._bundleLoader.getBundleInfo(2).isLoaded()},t}(i.n);function m(e){switch(e){case s.e.normal:return"Normal";case s.e.nearing:case s.e.critical:return"Critical";case s.e.full:return"Full";case s.e.overQuota:case s.e.outOfSpace:return"OverLimit";default:case s.e.unknown:return"Unknown"}}t.t=p}],Array(59),[function(e,t,n){"use strict";var a;!function(e){e[e.allTags=0]="allTags",e[e.allPlaces=1]="allPlaces",e[e.singleTag=2]="singleTag",e[e.singlePlace=3]="singlePlace"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(0),i=n(59),r=n(304),o=n(32),s=n(135),c=n(8),d=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.itemSet;return a.itemSet=i,a.item=a.createPureComputed(a._computeItem),a.item.equalityComparer=r.n,a.isEmpty=a.createPureComputed(a._computeIsEmpty),a.hasItems=a.createPureComputed(a._computeHasItems),a.hasName=a.createPureComputed(a._computeHasName),a.hasParent=a.createPureComputed(a._computeHasParent),a.name=a.createPureComputed(a._computeName),a.isPlaceholder=a.createPureComputed(a._computeIsPlaceholder),a}return Object(a.__extends)(t,e),t.prototype._computeItem=function(){return this.itemSet().item()},t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0},t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t},t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)},t.prototype._computeHasParent=function(){return c.e.isActivated("D99057A9-4CBD-49C0-8721-0C2D2A23ADC7","06/23/2021","Use item.parentKey and itemParentHelper to get parent of item")?!!this.item().UNSAFE_parent:!!this.item().parentKey},t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name},t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemSet:o.o}),t}(i.n),l=Object(s.r)("ItemSetMonitor",d)}],Array(23),[function(e,t,n){"use strict";var a=function(){function e(t){this.id="".concat(++e._lastId),this.name=t}return e.prototype.matches=function(e){return e===this},e._lastId=0,e}();t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"i",function(){return u});var a=n(33),i=n(43),r=["","Lock","Unlock","Manage","FreDialog","Unlock","Reset","Debug","FilesRemaining"],o="PVault-IconUpsell",s="PVault-QuotaBannerLearnMore",c="PVault-QuotaBannerGoPremium",d="PVault-QuotaErrorLearnMore";function l(e){return r[e]}function u(e,t){var n;switch(e){case a.e.Files:n="Files";break;case a.e.Restore:n="Restore";break;case a.e.RansomwareDetection:n="RansomwareDetection";break;case a.e.ManageVault:n="ManageVault";break;default:n=""}return t?"".concat(n,"-").concat(i.e[t]):"".concat(n)}},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(0),i=n(358),r=n(2179),o=n(183),s={0:function(e){return e},1:function(e){return 18*e},2:function(e){return.5*window.innerHeight}},c="function"==typeof PointerEvent,d=function(e){function t(t){var n=e.call(this,t)||this,a=t.valueAccessor(),i=n.observables,o=a.allowedModes,s=void 0===o?15:o;n._transformV=a.transform||i.create(r.t.IDENTITY),n._isActive=a.isActive||i.create(!1),n._isEnabled=a.isEnabled||i.create(!0),n._mayStartPan=a.mayStartPan||l,n._constrainScale=a.constrainScale||u,n._allowedModes=s,n._useNativePan=!!a.useNativePan,n._gestureMode=i.create(0),n._touchCount=0,n._pointers={},n._pointerCount=0,n._initialTransformV=i.create(r.t.IDENTITY),n._initialTransformV.equalityComparer=p,n._incrementTransformPx=i.create(r.t.IDENTITY),n._incrementTransformPx.equalityComparer=p,n._initialCenterPx=i.create(),n._initialCenterPx.equalityComparer=f,n._initialRadius=i.create(),n._incrementTransformV=i.compute(n._computeIncrementTransformV),n._incrementTransformV.equalityComparer=p,i.compute(n._computeResetTransform),i.compute(n._computeTransform);var d={};return c&&7&s?d.pointerdown=n._onPointerDown:(1&s&&(d.touchstart=n._onTouchStart),6&s&&(d.mousedown=n._onMouseDown)),8&s&&(n._isWheeling=i.compute(n._computeIsWheeling),i.compute(n._computeStopWheeling).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}}),i.compute(n._computeEndWheel),d.wheel=n._onWheel),d.contextmenu=function(e){if(n._isEnabled.peek())return 0!=(4&s)},n.events.onAll(n.element,d),n}return Object(a.__extends)(t,e),t.prototype._computeIncrementTransformV=function(){var e=this._size||i.t.ORIGIN,t=this._incrementTransformPx();return new r.t(new i.t(t.translate.x/e.x,t.translate.y/e.y),t.scale)},t.prototype._computeResetTransform=function(){this._initialCenterPx()||(this._initialTransformV(this._transformV()),this._incrementTransformPx(r.t.IDENTITY))},t.prototype._computeTransform=function(){this._isActive()&&this._transformV(this._incrementTransformV().multiply(this._initialTransformV.peek()))},t.prototype._computeIsWheeling=function(){return 8===this._gestureMode()},t.prototype._computeStopWheeling=function(){var e=this._isWheeling();this._transformV(),e&&this._gestureMode(0)},t.prototype._computeEndWheel=function(){this._isWheeling()||(this._clearGesture(),this._isActive(!1))},t.prototype._onWheel=function(e){if(this._isEnabled.peek()){e.preventDefault(),this._updateSize();var t=this._transformToElement(e),n=s[e.deltaMode](e.deltaY);this._handleWheel(t,n)}},t.prototype._handleWheel=function(e,t){var n=Math.pow(2,-t/300);this._initialCenterPx.peek()||(this._gestureMode(8),this._resetGesture([e.add(this._size.scale(-.5)),e.add(this._size.scale(.5))]));var a=r.t.zoom(e.subtract(this._initialCenterPx.peek()),e,n);8===this._gestureMode.peek()&&this._continueGesture(this._gesturePoints.map(function(e){return a.apply(e)}))},t.prototype._onMouseDown=function(e){if(this._isEnabled.peek()&&0===e.button){this._updateSize();var t=this._transformToElement(e);this._gestureMode(4);var n=e.ctrlKey?[this._size.subtract(t),t]:[t];this._resetGesture(n),this.events.off(this.element,"mousedown",this._onMouseDown),this.events.onAll(document,{mousedown:this._onMouseDown,mouseup:this._onMouseUp,click:this._onClick,mousemove:this._onMouseMove},!0)}},t.prototype._onMouseMove=function(e){e.preventDefault(),this._updateSize(!1);var t=this._transformToElement(e),n=e.ctrlKey?[this._size.subtract(t),t]:[t];4===this._gestureMode.peek()&&this._continueGesture(n)},t.prototype._onClick=function(e){Date.now()-this._lastActiveMouseUp<100&&e.stopPropagation()},t.prototype._onMouseUp=function(e){0===e.button&&(this._isActive()&&(this._lastActiveMouseUp=Date.now(),e.preventDefault()),this._updateSize(!1),4===this._gestureMode.peek()&&(this._clearGesture(),this._gestureMode(0)),this._isActive(!1),this.events.off(document,"mousedown",this._onMouseDown,!0),this.events.off(document,"mouseup",this._onMouseUp,!0),this.events.off(document,"mousemove",this._onMouseMove,!0),this.events.on(this.element,"mousedown",this._onMouseDown))},t.prototype._onTouchStart=function(e){if(this._isEnabled.peek()){this._isActive.peek()&&(!this._useNativePan||e.touches.length>1)&&e.preventDefault(),this._updateSize(0===this._touchCount);var t=this._touchCount;this._touchCount+=e.changedTouches.length,!t&&this._touchCount?(this._gestureMode(1),this.events.off(this.element,"touchstart",this._onTouchStart),this.events.onAll(document,{touchstart:this._onTouchStart,touchmove:this._onTouchMove,touchend:this._onTouchEnd,touchcancel:this._onTouchCancel},!0)):1===this._gestureMode.peek()&&this._clearGesture(),1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))}},t.prototype._onTouchMove=function(e){(!this._useNativePan||e.touches.length>1)&&e.preventDefault(),this._updateSize(!1),this._continueGesture(this._getPointsFromTouches(e.touches))},t.prototype._onTouchEnd=function(e){this._isActive.peek()&&e.preventDefault(),this._updateSize(!1),this._removeTouches(e)},t.prototype._onTouchCancel=function(e){this._updateSize(!1),this._removeTouches(e)},t.prototype._removeTouches=function(e){var t=this._touchCount;this._touchCount-=e.changedTouches.length,1===this._gestureMode.peek()&&this._clearGesture(),t&&!this._touchCount?(1===this._gestureMode.peek()&&this._gestureMode(0),this._isActive(!1),this.events.off(document,"touchstart",this._onTouchStart,!0),this.events.off(document,"touchmove",this._onTouchMove,!0),this.events.off(document,"touchend",this._onTouchEnd,!0),this.events.off(document,"touchcancel",this._onTouchCancel,!0),this.events.on(this.element,"touchstart",this._onTouchStart)):1===this._gestureMode.peek()&&this._resetGesture(this._getPointsFromTouches(e.touches))},t.prototype._onPointerDown=function(e){if(this._isEnabled.peek()){var t=this._allowedModes,n=e.pointerType,a="mouse"===n?4:"pen"===n?2:1;if(t&a&&!this._pointers[e.pointerId]){var i=0===this._pointerCount;!this._isActive.peek()||this._useNativePan&&i||e.preventDefault(),this._updateSize(i),this._pointers[e.pointerId]=this._transformToElement(e),this._pointerCount++,i?(this._gestureMode(a),this.events.off(this.element,"pointerdown",this._onPointerDown),this.events.onAll(document,{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerup:this._onPointerUp,pointercancel:this._onPointerCancelOrLost,lostpointercapture:this._onPointerCancelOrLost},!0)):this._isPointerGesture()&&this._clearGesture(),this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers())}}},t.prototype._onPointerMove=function(e){this._pointers[e.pointerId]&&((!this._useNativePan||this._pointerCount>1)&&e.preventDefault(),this._updateSize(!1),this._pointers[e.pointerId]=this._transformToElement(e),this._isPointerGesture()&&this._continueGesture(this._getPointsFromPointers()))},t.prototype._onPointerUp=function(e){this._isActive()&&e.preventDefault(),this._onPointerCancelOrLost(e)},t.prototype._onPointerCancelOrLost=function(e){this._updateSize(!1),this._removePointers(e)},t.prototype._removePointers=function(e){this._pointers[e.pointerId]&&(delete this._pointers[e.pointerId],this._pointerCount--,this._isPointerGesture()&&this._clearGesture(),0===this._pointerCount?(this._isPointerGesture()&&this._gestureMode(0),this._isActive(!1),this.events.off(document,"pointerdown",this._onPointerDown,!0),this.events.off(document,"pointermove",this._onPointerMove,!0),this.events.off(document,"pointerup",this._onPointerUp,!0),this.events.off(document,"pointercancel",this._onPointerCancelOrLost,!0),this.events.off(document,"lostpointercapture",this._onPointerCancelOrLost,!0),this.events.on(this.element,"pointerdown",this._onPointerDown)):this._isPointerGesture()&&this._resetGesture(this._getPointsFromPointers()))},t.prototype._clearGesture=function(){this._gesturePoints=null,this._initialCenterPx(null)},t.prototype._continueGesture=function(e){this._gesturePoints=e,this._initialCenterPx.peek()||this._resetGesture(e);var t,n=i.t.getCenter(e),a=this._getRadius(e,n),o=this._initialRadius.peek();t=0!==a&&0!==o?a/o:1;var s=this._initialTransformV.peek().scale*t,c=this._constrainScale(s)/s,d=this._initialCenterPx.peek(),l=r.t.zoom(i.t.ORIGIN,d,t*c),u=new r.t(n.subtract(d));this._incrementTransformPx(u.multiply(l)),!this._isActive.peek()&&this._mayStartPan(this._incrementTransformPx.peek(),a-o,e)&&this._isActive(!0)},t.prototype._resetGesture=function(e){this._gesturePoints=e;var t=i.t.getCenter(e),n=this._getRadius(e,t);this._initialCenterPx(t),this._initialRadius(n)},t.prototype._getRadius=function(e,t){for(var n=0,a=0,i=e;a<i.length;a++)n+=i[a].distance(t);return n/e.length},t.prototype._getPointsFromTouches=function(e){for(var t=[],n=0;n<e.length;n++)t.push(this._transformToElement(e[n]));return t},t.prototype._getPointsFromPointers=function(){var e=[];for(var t in this._pointers)e.push(this._pointers[t]);return e},t.prototype._updateSize=function(e){if(void 0===e&&(e=!0),!this._size||e){var t=this.element.getBoundingClientRect();this._size=new i.t(t.width,t.height),this._clientToElementTransform=new r.t(new i.t(-t.left,-t.top))}},t.prototype._transformToElement=function(e){return this._clientToElementTransform.apply(new i.t(e.clientX,e.clientY))},t.prototype._isPointerGesture=function(){return 7&this._gestureMode.peek()},t}(o.t);function l(e,t,n){return e.translate.abs()>=10||Math.abs(t)>=10}function u(e){return e}function f(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}function p(e,t){return e===t||!(!e||!t)&&f(e.translate,t.translate)&&e.scale===t.scale}t.t=d},,,,,,,,,,function(e,t,n){"use strict";var a;!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={}));var i=a;t.e=i},function(e,t,n){"use strict";n.d(t,"n",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"t",function(){return h});var a=n(0),i=n(59),r=n(75),o=n(405),s=n(599),c=n(1912),d=n(3127),l=n(103),u=n(1147),f=n(2999),p="__New",m="__Auto",_="__WeekendRecap",h="__EventRecap",b=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(o.n),n}return Object(a.__extends)(t,e),t.prototype.addToAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.removeFromAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.createAlbum=function(e,n){var a=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),c={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new s.e).send({requestType:"POST",postData:JSON.stringify(c),apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(c.action),url:this._getModifyAlbumUrl(),isErrorExpectedCallback:f.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var s={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return a._handleRequest(o,s).then(function(t){return e},function(e){var t={errorType:u.e.other,error:new Error(e.data.message)};return r.n.wrapError(t)})},function(e){var t=u.e.other;1e3===e.data.code&&(t=u.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return r.n.wrapError(n)})},t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new s.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))},t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),a=new s.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return a.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(i.action),url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:f.e})},t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var a=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(a,void 0,!0)},t.prototype.setCoverPhoto=function(e,n){var a=this._getModifyAlbumUrl(),i=new s.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(o.action),url:a,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:f.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return r.n.wrapError(t)})},t.prototype._handleRequest=function(e,n){var a=this._getModifyAlbumUrl();return d.e.start({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(n.action),url:a,batchSize:20,items:e,isErrorExpectedCallback:f.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})},t.prototype._getModifyAlbumUrl=function(){return c.t.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME},t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})},t.ADD_TO_ALBUM_ACTION="Add",t.CREATE_ALBUM_ACTION="Create",t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename",t.REMOVE_FROM_ALBUM_ACTION="Remove",t.SET_COVER_PHOTO_ACTION="SetCoverPhoto",t.MODIFY_ALBUM_API_NAME="ModifyAlbum",t.ALBUMS_ID="albums",t}(i.n);t.i=b},,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return c});var a=n(0),i=n(246),r=n(135),o=n(1141),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(a.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{identityDataSource:o.e}),t}(i.e);t.default=s;var c=Object(r.r)("GraphTokenProvider",s)},function(e,t,n){"use strict";n.r(t),n.d(t,"GraphUrlDataSource",function(){return r}),n.d(t,"resourceKey",function(){return o});var a=n(7),i=n(135),r=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),o=new a.t({name:"GraphUrlDataSource",factory:new i.i(r)})},,,,function(e,t,n){"use strict";var a=function(){function e(e){this._tasksByKey={},this._onChanges=e}return e.map=function(e,t){return{update:function(n,a){void 0===a&&(a=!1),e.update(n.map(function(e){return t(e)}),a)}}},e.prototype.dispose=function(){this._tasksByKey={},this._onChanges=null},e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e},e.prototype.getTask=function(e){return this._tasksByKey[e]},e.prototype.update=function(e,t){var n,a,i;for(var r in void 0===t&&(t=!1),n={},this._tasksByKey)n[r]=this._tasksByKey[r];i=[];for(var o=0,s=e;o<s.length;o++){var c=s[o],d=n[c.key],l=c.compare(d);l&&i.push(l),delete n[c.key],this._tasksByKey[c.key]=c}if(t)for(var r in n)a=n[r],delete this._tasksByKey[r],i.push({previous:a,current:null});this.onChanges(i)},e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)},e}();t.e=a},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(135),i=function(){function e(e,t){this._itemRefreshMessages={},this._itemKeysRefreshed=[]}return e.prototype.getItemRefreshMessage=function(e){return this._itemRefreshMessages?this._itemRefreshMessages[e]:null},e.prototype.setRefreshMessages=function(e){this.clearRefreshMessages();for(var t=0,n=e;t<n.length;t++){var a=n[t];this._itemRefreshMessages[a.id]=a}},e.prototype.clearRefreshMessages=function(){this._itemRefreshMessages={}},e.prototype.hasItemRefreshedRecently=function(e){return-1!==this._itemKeysRefreshed.indexOf(e)},e.prototype.markRecentlyRefreshedItem=function(e){this._itemKeysRefreshed.push(e)},e.prototype.clearRecentlyRefreshedItems=function(){this._itemKeysRefreshed=[]},e.dependencies={},e}(),r=Object(a.r)("RefreshMessageHelper",i)}],Array(27),[function(e,t,n){"use strict";n.r(t),n.d(t,"REMOVE_EXTRA_QUOTA_API_CALLS",function(){return c}),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(16),r=n(106),o=n(135),s=n(59),c=!i.e.isActivated("D7D2A2B0-7E50-400F-BF47-2F17947228E8","05/16/2022","remove extra getUpgradeOptions calls"),d=107374182400,l=!c,u=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._userInfoProvider=n.userInfoProvider,a._storageOptionsProvider=n.storageOptionsProvider,a._userStateProvider=n.userStateProvider,a}return Object(a.__extends)(t,e),t.prototype.getLocalizedLowestStoragePlanPrice=function(){return this._storageOptionsProvider.getStorageOptions(l).then(function(e){var t=e.storagePlans;if(null!==t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.purchaseData&&!i.isCurrentPlan)return i.price}},function(){})},t.prototype.hasPlanWith100GBOrMore=function(){var e=this;return this._storageOptionsProvider.getStorageOptions(l).then(function(e){var t=e.storagePlans;if(null!==t){for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.isCurrentPlan&&i.durationInMonths>0)return i.planQuotaBytes>=d}return!1}},function(t){if(e._userStateProvider=e.resources.consume(r.b.optional),e._userStateProvider)return e._userStateProvider.total.peek()>=d})},t.prototype.getPremiumState=function(e){return this._checkHasOffice(e).then(function(e){return null==e?0:e?3:2})},t.prototype._checkHasOffice=function(e){var t=this;return this._userInfoProvider.getIsPremium(e).then(function(e){return e},function(n){return t._storageOptionsProvider.getHasCurrentOfficePlan(e).then(function(e){return e},function(e){if(t._userStateProvider=t.resources.consume(r.b.optional),t._userStateProvider)return t._userStateProvider.total.peek()>=1099511627776})})},t.dependencies=Object(a.__assign)(Object(a.__assign)({},s.n.dependencies),{userStateProvider:r.b.optional,userInfoProvider:r.A,storageOptionsProvider:r.D}),t}(s.n);t.default=u;var f=Object(o.r)("PremiumStateProvider",u)},function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"f",function(){return r}),n.d(t,"o",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"m",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"p",function(){return u}),n.d(t,"a",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"s",function(){return m}),n.d(t,"l",function(){return _}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return b}),n.d(t,"u",function(){return g});var a=n(2333),i=new a.e("createFolder"),r=new a.e("rename"),o=new a.e("moveFrom"),s=new a.e("copyFrom"),c=(new a.e("moveTo"),new a.e("copyTo"),new a.e("deleteItem")),d=new a.e("restoreItem"),l=new a.e("deleteAllItems"),u=new a.e("restoreAllItems"),f=new a.e("createText"),p=new a.e("changeExpiration"),m=new a.e("open"),_=new a.e("openInTextEditor"),h=new a.e("openInHtmlViewer"),b=new a.e("openInImageEditor"),g=new a.e("openPdfInBrowser");new a.e("quickEdit"),new a.e("editItem"),new a.e("createShortcut"),new a.e("pinToMru"),new a.e("printPdf")},function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"s",function(){return f});var a=n(2333),i=new a.e("share"),r=new a.e("addToShared"),o=new a.e("embed"),s=new a.e("comment"),c=new a.e("removeFromShared"),d=new a.e("addAsMountPoint"),l=new a.e("removeAsMountPoint"),u=new a.e("reportAbuse"),f=new a.e("requestReview");new a.e("alertItem"),new a.e("alertItem")}],Array(23),[function(e,t,n){"use strict";n.d(t,"e",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"r",function(){return y}),n.d(t,"i",function(){return S}),n.d(t,"n",function(){return D}),n.d(t,"a",function(){return I});var a=n(27),i=n(103),r=n(40),o=n(809),s=n(1912),c=n(144),d=n(2308),l=n(43),u=n(2353),f=n(3839),p={"pokmon":!0},m={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},_=[u.n,u.e,u.a,u.t],h=String.fromCharCode(9),b="%09",g="tagHeader",v=0;function y(e,t,n,i,o){var s=e.length,c=0,l=[];if(1!==t){for(var u=0,h=e;u<h.length;u++)w=h[u],(p[w.tag.toLowerCase()]||c<11&&m[w.tag.toLowerCase()]&&-1===_.indexOf(w.tag))&&(n.push(a.observable(D(d.e.allTags,w,null,o))),c++);if(c>0){var b={groupingId:g,startIndex:0,count:c,tagHeader:{title:f.s,countSubtitle:""}};l.push(b)}e.sort(function(e,t){var n=e.localizedTag||e.tag,a=t.localizedTag||t.tag;return n.localeCompare(a)});for(var v=0,y=e;v<y.length;v++)w=y[v],-1===_.indexOf(w.tag)?n.push(a.observable(D(d.e.allTags,w,null,o))):s--;if(s>0){var S=r.pluralSelect(s,f.i,r.format(f.a,s)),I={groupingId:g,startIndex:c,count:s,tagHeader:{title:f.e,countSubtitle:S}};l.push(I)}var x={name:"tagGrouping",itemGroups:l};i.push(x)}else for(var C=0,O=e;C<O.length;C++){var w=O[C];-1===_.indexOf(w.tag)&&n.push(a.observable(D(d.e.allTags,w,null,o)))}}function S(e,t,n,i,r,o){for(var s={},c=0,l=t;c<l.length;c++){var u=l[c];s[u.hierarchyIndex]=!0}e=e.filter(function(e){return s[e]});for(var p=[],m=[],_={name:f.r,places:[],totalPlaces:0},h=0,b=t;h<b.length;h++){var v=b[h],y=v.country;""===y?(_.places.push(v),_.totalPlaces++):m.indexOf(y)<0?(p.push(x(y,v)),m.push(y)):C(y,v,p)}p.sort(function(e,t){return t.totalPlaces-e.totalPlaces}),_.totalPlaces>0&&p.push(_);for(var S={},I=e.length,A=[],L=I,k=0,M=p;k<M.length;k++){var P=M[k],T=P.places;O(T),T.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var U=T.length,F=void 0,H=0,R=T;H<R.length;H++){var N=R[H];F=D(d.e.allPlaces,null,N,r),n.push(a.observable(F)),e.indexOf(N.hierarchyIndex)>-1&&(S[N.hierarchyIndex]=E(F))}A.push(w(L,U,P.name,o(P.name))),L+=U}var B=t.length;if(I>0&&B>=I){for(var j=I-1;j>-1;j--)n.unshift(a.observable(S[e[j]]));var V={groupingId:g,startIndex:0,count:I,tagHeader:{title:f.o,countSubtitle:""}};A.unshift(V)}var z={name:"tagGrouping",itemGroups:A};i.push(z)}function D(e,t,n,a){var i,r=((i={}).qt="allmyphotos",i.v="photos",i.id=a.rootItemId,i);switch(e){case d.e.allTags:var u;u=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag,r.tagFilter=u;break;case d.e.allPlaces:r.locationFilter=n.hierarchyIndex}r.u="".concat(v++);var f=s.t.getKey(r),p=new o.e(f);p.type=c.e.Folder,p.queryType=l.e.AllMyPhotos;var m={tagType:e};switch(p.tagInfo=m,p.folder={photoCount:0,covers:[]},e){case d.e.allTags:p.name="#"+(t.localizedTag||t.tag),p.id=t.tag,p.folder.childCount=t.count,p.childCount=t.count;break;case d.e.allPlaces:p.name=n.displayString,p.id=n.hierarchyIndex,p.folder.childCount=n.count,p.childCount=n.count;break;default:return null}return p.properties.commandsSupported={defc:"1"},p.isDraggable=!1,p}function I(e){var t="";return e.city&&(t+=e.city+", "),e.state&&(t+=e.state+", "),0===t.length?e.country||"":t.slice(0,-2)}function x(e,t){var n=[];return n.push(t),{name:e,places:n,totalPlaces:1}}function C(e,t,n){for(var a,i=n.length,r=0;r<i;r++)if(e===(a=n[r]).name){a.places.push(t),a.totalPlaces++;break}}function O(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];a.displayString=I(a)}}function w(e,t,n,a){var i=r.pluralSelect(t,f.n,r.format(f.t,t));return{groupingId:g,startIndex:e,count:t,tagHeader:{title:n,countSubtitle:i,regionUrl:a}}}function E(e){var t=i.e(e.key);t.u=v++;var n=s.t.getKey(t),a=new o.e(n);a.type=e.type,a.queryType=e.queryType;var r={tagType:e.tagInfo.tagType};a.tagInfo=r,a.name=e.name,a.id=e.id;var c={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};return a.folder=c,a.properties.commandsSupported={defc:"1"},a.isDraggable=!1,a}},,,,function(e,t,n){"use strict";var a,i,r;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),function(e){e[e.WebhookSubscription=0]="WebhookSubscription",e[e.Meta=1]="Meta",e[e.EventHub=2]="EventHub"}(a||(a={})),function(e){e[e.DriveStatusChange=0]="DriveStatusChange",e[e.QuotaAllowanceChange=1]="QuotaAllowanceChange",e[e.QuotaStateChange=2]="QuotaStateChange",e[e.Zip=3]="Zip",e[e.ProfileChange=4]="ProfileChange"}(i||(i={})),function(e){e[e.PushChannelProvider=0]="PushChannelProvider",e[e.ItemAutoRefreshProvider=1]="ItemAutoRefreshProvider",e[e.ItemAutoRefreshDataSource=2]="ItemAutoRefreshDataSource"}(r||(r={}))}],Array(16),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:'.Carousel{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.Carousel-platform{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.Carousel-platform.is-enabled{will-change:transform;backface-visibility:hidden;perspective:1000}.Carousel-slide{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.Carousel-slide.is-current.is-loaded{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.Carousel-slide.is-current.is-deleted,.Carousel-slide.is-deleted{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-enabled .Carousel-slide{will-change:transform;backface-visibility:hidden;perspective:1000}.Carousel-platform.is-flipping .Carousel-slide{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="1"]{z-index:10}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="1"].is-current.is-loaded{transition-duration:.3s,0s,.3s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="2"]{z-index:9}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="2"].is-loaded{transition-duration:.3s,0s,.3s;transition-delay:0.3s,0.6s,0s}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="3"]{z-index:8}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="4"]{z-index:7}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="5"]{z-index:6}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="6"]{z-index:5}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="7"]{z-index:4}.Carousel-platform.is-flipping .Carousel-slide[data-item-order="8"]{z-index:3}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="1"]{transform:translate(2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="1"]{transform:translate(-2%,0)}html[dir=ltr] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="-1"]{transform:translate(-2%,0)}html[dir=rtl] .Carousel-platform.is-flipping .Carousel-slide[data-item-direction="-1"]{transform:translate(2%,0)}.Carousel-platform.is-rotating .Carousel-slide{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="2"]{transform:translate(204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="1"]{transform:translate(102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-1"]{transform:translate(-102%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-2"]{transform:translate(-204%,0)}.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-1"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="-2"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="1"],.Carousel-platform.is-rotating .Carousel-slide[data-item-offset="2"]{visibility:inherit;opacity:1}.Carousel-platform.is-gliding{transition:transform .3s ease-out}.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="-1"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="-2"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="1"],.Carousel-platform.is-gliding .Carousel-slide[data-item-offset="2"]{transition-delay:0.3s,0.3s,0s}'}]);var i=n(402),r=n(0),o=n(27),s=n(358),c=n(2179),d=n(1343),l=n(2320),u=n(260),f=n(1838),p=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({host:f.e}),n.item=t.item,n.offset=t.offset,n.loadState=t.loadState||n.observables.create(0),n.order=t.order||n.observables.create(1),n.direction=n.createComputed(n._computeDirection),n}return Object(r.__extends)(t,e),t.prototype._computeDirection=function(){var e=this.offset();return e>0?1:e<0?-1:0},t}(u.t),m=n(2342),_=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.addBindingHandlers({host:f.e,pan:m.t});var i=t.item,r=t.items,o=t.isEnabled,s=void 0===o||o,c=t.isRotating,l=void 0===c?a.createObservable(!1):c,u=t.loadState,p=void 0===u?a.createObservable(0):u,_=t.allocationRange,h=void 0===_?a.createObservable({start:0,end:0}):_;return a.item=i,a._items=r,a._slideAllocationCount=a.createPureComputed(function(){return!t.canNavigate||t.canNavigate()?15:1}),a._allocationRange=h,a.isEnabled=a.wrapObservable(s),a.isRotating=l,a.loadState=p,a._rotationThreshold=.3,a._velocityThreshold=1,a._index=a.createPureComputed(a._computeIndex),a._lastValidIndex=a.createPureComputed(a._computeLastValidIndex),a._itemsInSlides=a.observables.createArray(),a._itemHistory=a.observables.createArray(),a.createBackgroundComputed(a._computeUpdateItemHistory),a.createBackgroundComputed(a._computeCleanItemHistory).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}}),a._elementsToRemove=a.observables.createArray(),a._initializeSlides(),a._initializeMotion(),a.carouselTransform=a.createPureComputed(a._computeCarouselTransform),a.carouselTransform.equalityComparer=d.e,a._initializeDirection(),a.createBackgroundComputed(a._computeSwitchItemsOnItemRemoval),a.createBackgroundComputed(a._computeAllocationRange),a.createBackgroundComputed(a._computeItemsInSlides),a.createBackgroundComputed(a._computeElementsToRemove).extend({rateLimit:{timeout:1e3,method:"notifyWhenChangesStop"}}),a.platformStyle=a.createPureComputed(a._computePlatformStyle),a.panBindingParams={isActive:a.isPowered,isEnabled:a.isEnabled,transform:a.panTransform,mayStartPan:function(e,t,n){return a.isEnabled.peek()&&Math.abs(e.translate.x)>=10&&t<5&&n.length<2},allowedModes:7},a}return Object(r.__extends)(t,e),t.prototype.onSlideRemoved=function(e){o.utils.toggleDomNodeCssClass(e,"is-deleted",!0),o.utils.toggleDomNodeCssClass(e,"is-current",!1),this._elementsToRemove.push(e)},t.prototype._initializeMotion=function(){this.isFlipping=this.createObservable(!0),this.isPowered=this.createObservable(!1),this.isGliding=this.createObservable(!1),this.panTransform=this.createObservable(c.t.IDENTITY),this.panTransform.equalityComparer=d.e,this._initializeVelocity(),this.createBackgroundComputed(this._computeStartPowered),this.createBackgroundComputed(this._computeRotateToSlide),l.e(this.createBackgroundComputed(this._computeStartGlide),this.async),this.createBackgroundComputed(this._computeEndGlide).extend({rateLimit:{timeout:600,method:"notifyWhenChangesStop"}}),this.createBackgroundComputed(this._computeEndRotation)},t.prototype._computeStartPowered=function(){this.isPowered()&&(this.isRotating(!0),this.isGliding(!1),this.isFlipping(!1))},t.prototype._computeStartGlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();e||t||(this.panTransform(c.t.IDENTITY),this.isGliding(!0),this.isRotating(!0))},t.prototype._computeEndGlide=function(){var e=this.isPowered.peek(),t=this.isGliding();!e&&t&&(this.isGliding(!1),this.isRotating(!1))},t.prototype._computeEndRotation=function(){this.isRotating()||this.isFlipping(!0)},t.prototype._initializeDirection=function(){var e=this,t=this._index.peek();this.addDisposable(this.item.subscribe(function(){t=e._index.peek()},this,"beforeChange")),this.createBackgroundComputed(function(){e.isFlipping()&&(t=e._index.peek())}),this.direction=this.createPureComputed(function(){var n=e._index();return e.isFlipping()&&n>-1&&t>-1?Math.max(-1,Math.min(1,n-t)):0})},t.prototype._initializeSlides=function(){var e=this,t=this.addDisposable(this._itemsInSlides.filter(function(t){return t&&(e._items.indexOf(t)>-1||t===e.item())}));this.slides=this.addDisposable(t.map({mappingWithDisposeCallback:function(t){var n=e.createObservable(0),a=e.createPureComputed(function(){return e._items.indexOf(t)}),i=e.createPureComputed(function(){return a()-e._index()}),r=e.createComputed(function(){i()||e.loadState(n())}),o=e.createPureComputed(function(){return e._itemHistory.indexOf(t)+1}),s=new(e.resources.injected(p))({item:t,offset:i,loadState:n,order:o});return{mappedValue:s,dispose:function(){s.dispose(),i.dispose(),a.dispose(),r.dispose(),o.dispose()}}}}))},t.prototype._computeAllocationRange=function(){var e=this.item(),t=this._items,n=t().length,a=this._itemsInSlides.peek(),i=t.indexOf(e),r=a.indexOf(e),o=this._slideAllocationCount();if((-1===r||i>=2&&r<2||i<=n-1-2&&r>a.length-1-2||n<=o&&n!==a.length)&&i>-1)if(o>1){var s=i+this.direction.peek()*(.8*(Math.floor(o/2)-2)),c=Math.max(0,Math.min(n-o,s-Math.floor(o/2))),d=Math.min(n,c+o);this._allocationRange({start:c,end:d})}else this._allocationRange({start:i,end:i+1})},t.prototype._computeItemsInSlides=function(){var e,t,n=this._allocationRange();if(this._index()>-1&&n.end-n.start>0)t=this._items.slice(n.start,n.end);else{var a=this.item();t=a?[a]:[]}(e=this._itemsInSlides).splice.apply(e,Object(r.__spreadArray)([0,this._itemsInSlides.peek().length],t,!1))},t.prototype._computeSwitchItemsOnItemRemoval=function(){var e=this.item.peek(),t=this._items.indexOf(e),n=this._lastValidIndex();if(-1===t&&e&&n>-1){var a=this._items.peek(),i=Math.max(0,Math.min(a.length-1,n));a[i]&&this.item(a[i])}},t.prototype._computeUpdateItemHistory=function(){var e=this.item();this._itemHistory.unshift(e)},t.prototype._computeCleanItemHistory=function(){this._itemHistory().length>1&&this._itemHistory.splice(1,this._itemHistory().length)},t.prototype._computeElementsToRemove=function(){var e;for(this.item(),this._itemsInSlides();e=this._elementsToRemove.shift();)o.removeNode(e)},t.prototype._initializeVelocity=function(){var e=this,t=this.panTransform.peek(),n=0;this.velocity=this.createPureComputed(function(){var a=e.panTransform(),i=(new Date).getTime(),r=a.translate.subtract(t.translate).scale(1e3/(i-n));return n=i,t=a,r}),this.velocity.equalityComparer=d.e},t.prototype._computeRotateToSlide=function(){var e=this.isPowered(),t=this.isFlipping.peek();if(!e&&!t){var n=this.panTransform.peek().translate.negate(),a=this.velocity.peek().negate(),i=this._index.peek(),r=this._calculateFractionalIndexOffset(n,a)+n.x;this.item(this._items.peek()[Math.max(0,Math.min(this._items.peek().length-1,i+Math.round(r)))]),this.panTransform(new c.t(new s.t(this._index.peek(),0).subtract(new s.t(i,0).add(n))))}},t.prototype._calculateFractionalIndexOffset=function(e,t){var n=0;return e.x>this._rotationThreshold&&e.x<.5?n+=.5:e.x<-this._rotationThreshold&&e.x>-.5&&(n-=.5),t.x>this._velocityThreshold&&e.x<.5?n+=.5:t.x<-this._velocityThreshold&&e.x>-.5&&(n-=.5),Math.max(-1,Math.min(1,n))},t.prototype._computeCarouselTransform=function(){var e=this.panTransform().translate,t=this._items.peek().length,n=this._index.peek();-1===n&&(n=0,t=1);var a=-e.x,i=a,r=n+a;if(r<0||r>t-1){var o=a>0?Math.floor:Math.ceil,d=Math.max(0-n,Math.min(t-1-n,o(a))),l=Math.PI;i=Math.atan(l*(a-d))/l+d}return new c.t(new s.t(-i,e.y))},t.prototype._computeIndex=function(){return this._items.indexOf(this.item())},t.prototype._computeLastValidIndex=function(){var e=this._items.indexOf(this.item());if(e<0){var t=this._lastValidIndex.peek();if("number"==typeof t)return t}return e},t.prototype._computePlatformStyle=function(){var e=this.carouselTransform(),t="translate(".concat(100*e.translate.x,"%, 0)");return{"-ms-transform":t,"-webkit-transform":t,transform:t}},t}(u.t),h=i.e({tagName:"ms-carousel",template:"<div class=\"Carousel\"><div class=\"Carousel-platform\" data-bind=\"template:{foreach:slides,beforeRemove:$component.onSlideRemoved.bind($component),dontLimitMoves:true},pan:panBindingParams,style:platformStyle,css:{'is-flipping':isFlipping,'is-rotating':isRotating,'is-enabled':isEnabled,'is-powered':isPowered,'is-gliding':isGliding,'is-rotating-forward':direction()>0,'is-rotating-backward':direction()<0}\"><div class=\"Carousel-slide\" data-bind=\"host:{},attr:{'data-item-offset':offset,'data-item-order':order,'data-item-direction':direction},css:{'is-current':item&&item===$component.item(),'is-loaded':!!loadState()}\"></div></div></div>",viewModel:_,synchronous:!0});t.e=h}],Array(49),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(59),r=n(77),o=n(135),s=function(e){function t(t,n){var a=e.call(this,t)||this;return a._commandDataSource=n.itemCommandDataSource,a}return Object(a.__extends)(t,e),t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemCommandDataSource:r.A}),t}(i.n),c=Object(o.r)("ItemCommandProvider",s)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(59),i=new(n(7).t)({name:"".concat("IsFiltersPaneExpanded",".isFiltersPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})}],Array(39),[function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"PushChannelProvider.key",loader:new i.t(function(){return n.ee([380],2733).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return r}),n.d(t,"t",function(){return s}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return c}),function(e){e[e.spam=0]="spam",e[e.nudityOrPornography=1]="nudityOrPornography",e[e.harassmentOrThreatening=2]="harassmentOrThreatening",e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation",e[e.other=4]="other",e[e.copyrightInfringement=5]="copyrightInfringement"}(i||(i={})),function(e){e[e.malwareOrViruses=0]="malwareOrViruses",e[e.sexuallyInappropriate=1]="sexuallyInappropriate",e[e.harassmentOrThreatening=2]="harassmentOrThreatening",e[e.childSexualExploitation=3]="childSexualExploitation",e[e.other=4]="other",e[e.terroristContent=5]="terroristContent",e[e.fraudOrSpam=6]="fraudOrSpam",e[e.hateSpeech=7]="hateSpeech",e[e.imminentHarm=8]="imminentHarm",e[e.copyrightInfringement=9]="copyrightInfringement"}(r||(r={}));var o,s={childSexualExploitation:"ChildEndangermentExploitation",copyrightInfringement:"ContentInfringement",sexuallyInappropriate:"OffensiveContent",terroristContent:"Terrorism",malwareOrViruses:"VirusSpywareMalware",other:"Other",fraudOrSpam:"Fraud",hateSpeech:"HateSpeech",imminentHarm:"ImminentHarmToPersonsOrProperty"};!function(e){e[e.File=0]="File",e[e.PhotoStreamComment=1]="PhotoStreamComment",e[e.PhotoStreamFile=2]="PhotoStreamFile"}(o||(o={}));var c=((a={})[o.PhotoStreamComment]="Comment",a[o.PhotoStreamFile]="PhotoStreamFile",a);t.i=i},function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"l",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"e",function(){return m});var a=n(2333),i=new a.e("play"),r=new a.e("rotate"),o=new a.e("editCaption"),s=new a.e("editTags"),c=new a.e("removeTags"),d=new a.e("viewOriginal"),l=new a.e("applyOfficeLens"),u=new a.e("removeOfficeLens"),f=new a.e("addToAlbum"),p=new a.e("removeFromAlbum"),m=new a.e("addPhotosToAlbum")}],Array(48),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="oneDriveQuotaDialog"},function(e,t,n){"use strict";var a;!function(e){e[e.documents=0]="documents",e[e.photos=1]="photos",e[e.favorites=2]="favorites"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"s",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"l",function(){return m});var a=n(2333),i=new a.e("createExcel"),r=new a.e("createOneNote"),o=new a.e("createPowerPoint"),s=new a.e("createWord"),c=new a.e("createSurvey"),d=new a.e("viewSurvey"),l=new a.e("editSurvey"),u=new a.e("publishSurvey"),f=new a.e("openOnline"),p=new a.e("openInClient"),m=new a.e("viewVersionHistory");new a.e("openInPowerBI"),new a.e("contentTypeNavigation"),new a.e("editNewMenu"),new a.e("uploadTemplate")},function(e,t,n){"use strict";var a;!function(e){e[e.unknown=0]="unknown",e[e.inactive=1]="inactive",e[e.delinquent=2]="delinquent",e[e.other=3]="other"}(a||(a={})),t.e=a}],Array(46),[function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(27),r=function(e){function t(t){var n=e.call(this,t)||this;return n.memoryContent=i.observable(null),n.serverContent=i.observable(null),n.outDated=i.observable(!1),n.isEditable=i.observable(!1),n.hasConflict=n.createPureComputed(n._computeHasConflict),n.hasPendingSave=n.createPureComputed(n._computeHasPendingSave),n.hasChanges=n.createPureComputed(n._computeHasChanges),n._lastSaved=i.observable(null),n._pendingSave=i.observable(null),n}return Object(a.__extends)(t,e),t.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)},t.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)},t.prototype.saveSucceded=function(){this.hasPendingSave.peek()&&(this.updateETag=!0,this._lastSaved(this._pendingSave.peek()),this._pendingSave(null))},t.prototype._computeHasPendingSave=function(){return!!this._pendingSave()},t.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();return null===t?(this._lastSaved(e.text),!1):e.text!==t},t.prototype._computeHasConflict=function(){return!!this.serverContent()},t}(n(59).n),o=n(528),s=n(135),c=function(){function e(e,t){this._itemContents={}}return e.prototype.getItemContent=function(e){var t=e.key,n=this._itemContents,a=n[t];return a||(a=new r,Object(o.e)(a,function(){delete n[t]}),n[t]=a),a},e.prototype.dispose=function(){this._itemContents={}},e}(),d=Object(s.r)("ItemContentProvider",c,{})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)({name:"ModuleLoaderDataSource.key"})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"VaultDataSource.key",loader:new i.t(function(){return n.ee(1,3351).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(59),i=new(n(7).t)({name:"".concat("IsCopilotPaneExpanded",".isCopilotPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(59),r=n(135),o=n(1129),s=n(75),c=n(242),d=n(140),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._operationProvider=n.operationProvider,a._operationBatch=t.operationBatch,a._onOperationFinished=t.onOperationFinished,a._completionSignal=new c.e,a._completionSignal.getPromise().done(function(){a.dispose()},function(){a.dispose()}),a.addDisposable(a._operationProvider.groups.subscribe(a._onOperationProviderGroupsChanged,a,"arrayChange")),a}return Object(a.__extends)(t,e),t.prototype.getGroupOperation=function(){return this._groupOperation},t.prototype.start=function(e){var t=this;return e().then(function(){t._completeIfNoGroupCreated()},function(e){return t._completeIfNoGroupCreated(),s.n.wrapError(e)})},t.prototype.wait=function(){return this._completionSignal.getPromise()},t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===d.e.completed||t===d.e.canceled||t===d.e.failed||t===d.e.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t._onOperationFinished&&t._onOperationFinished(e)})})},t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.value;i.batch===this._operationBatch&&("added"===a.status?this._groupOperation||(this._groupOperation=i,this._createGroupOperationSubscription(i)):"deleted"!==a.status||a.moved||this._completionSignal.complete())}},t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:o.resourceKey}),t}(i.n),u=Object(r.o)("OperatorBatchMonitor",l)}],Array(33),[function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(0),i=n(1122),r=n(47),o=n(27),s=n(59),c=n(75),d=n(242),l=n(1104),u=n(3304),f=function(e){function t(t){var n=e.call(this,t)||this,a=t.state,i=t.source,r=t.useToggleBehavior,o=t.useGlobalResources,s=t.getParams,d=t.useLocalBindingContext;if(function(e){return!!e.moduleDefinition}(i)){var f=i.moduleDefinition;n._getComponentDefinition=function(){return Object(l.e)(f)}}else{var p=i.component;n._getComponentDefinition=function(){return c.n.wrap(p)}}return n._useToggleBehavior=r,n._state=a,n._getParams=s,n._action=n.createObservable(),n._getHiddenDomProvider=n.resources.consume(u.e.async.lazy),n._useGlobalResources=o,n._useLocalBindingContext=!!d,n.isAvailable=n.createPureComputed(n._computeIsAvailable),n.isToggled=n.createPureComputed(n._computeIsToggled),n}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i)return i.cancel(),c.n.wrap()}var r=new d.e,s={complete:function(){r.complete()},fail:function(e){r.error(e)},cancel:function(){r.cancel()}};this._useToggleBehavior&&this._action(s);var l=null==e?void 0:e.target,u=l?o.contextFor(l):void 0;return c.n.as(this._getParams()).then(function(i){return n._getHiddenDomProvider().then(function(o){return n._getComponentDefinition().then(function(c){return t=o.requestControl({name:c.tagName,params:Object(a.__assign)(Object(a.__assign)({action:s,event:e},i||{}),n._useGlobalResources?{}:{resources:n.resources})},{bindingContext:n._useLocalBindingContext?u:void 0}),r.getPromise()}).then(function(){t&&o.disposeControl(t),n._action.peek()===s&&n._action(void 0)},function(e){return t&&o.disposeControl(t),n._action.peek()===s&&n._action(void 0),c.n.wrapError(e)})})})},t.prototype._computeIsAvailable=function(){return this._state().isAvailable},t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()},t}(s.n),p=function(e){function t(t){var n=e.call(this,t)||this,a=t.name,i=t.source,r=t.handlerType,o=t.actionParams,s=t.useToggleBehavior,c=void 0!==s&&s,d=t.useGlobalResources,l=t.useLocalBindingContext;n.name=a;var u=r?new(n.managed(r))(o):void 0,p=u&&u.state||n.createObservable({isAvailable:!0}),m=u&&u.getParams?function(){return u.getParams()}:function(){};return(null==u?void 0:u.getCustomerPromiseStartSchema)&&(n.customerPromiseStartSchema=u.getCustomerPromiseStartSchema()),n._controlExecutorLoader=new(n.managed(f))({source:i,state:p,useToggleBehavior:c,useGlobalResources:d,getParams:m,useLocalBindingContext:l}),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()},t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()},t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:r.t.Success}})},t}(i.e);function m(e){var t=e.name,n=e.source,i=e.useToggleBehavior,r=e.handlerType,o=e.useGlobalResources,s=void 0!==o&&o,c=e.useLocalBindingContext;return function(e){function o(a){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:a,handlerType:r,useGlobalResources:s,useLocalBindingContext:c})||this}return Object(a.__extends)(o,e),o}(p)}}],Array(20),[function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(1904),o=n(808),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.item,s=n.getItemSelectionHelperType,c=void 0===s?a.resources.consume(o.e.lazy):s,d=n.itemParentHelper,l=void 0===d?a.resources.consume(r.e):d;return a.isItemSpecified=!!i,a.item=i||new(a.scope.attached(c()))({canFallback:!0,ignoreSelection:!0}).currentItem,a.itemParentHelper=l,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t.prototype.getParent=function(e,t,n){var a=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(a):this.unwrapObservable(a)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:r.e}),t}(i.e);t.e=s},function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(335),i=n(134);function r(e){return e}function o(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.t.ConditionalAccessViewOnly&&e.itemStatus!==a.t.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r});var a="ListsAction",i="resetAllSurveyStatuses",r="resetSurveyStatusById"},,,,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Add=0]="Add",e[e.Update=1]="Update",e[e.Remove=2]="Remove"}(a||(a={}))},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(135),i=n(3274),r=Object(a.r)("ItemActivitiesResultProcessor",i.e,{})},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return v});var a,i=n(0),r=n(2425),o=n(59),s=n(75),c=n(1151),d=n(62),l=n(331),u=n(193),f=n(47),p=n(249),m=n(135),_=n(77),h=n(1280);!function(e){e[e.BaseUrlWaiting=0]="BaseUrlWaiting",e[e.BaseUrlReceived=1]="BaseUrlReceived",e[e.BaseUrlFail=2]="BaseUrlFail",e[e.Registered=3]="Registered",e[e.RegisterFailed=4]="RegisterFailed",e[e.SocketIoConnected=5]="SocketIoConnected",e[e.SocketIoDisconnected=6]="SocketIoDisconnected"}(a||(a={}));var b=["Due to organizational policies, you can't access these resources from this network location","One of the provided arguments is not acceptable","Session has been revoked","The access token has expired","The caller does not have permission to perform the action","The caller is not authenticated","The request is malformed or incorrect","There has been an error authenticating the request"],g=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._totalRetries=0,a._retryDelay=1e3,a._firedRegisterEvent=!1,a._firedConnectEvent=!1,a._totalConnectionAttempts=0,a._connectionIssueCount=0,a._notificationHandlers={},a._connectedHandlers=[],a._pushChannelDataSource=n.pushChannelDataSource,a._pushChannelDataSource.registerForViewUpdates(a._onViewUpdate.bind(a)),a}return Object(i.__extends)(t,e),t.prototype.isConnected=function(){return this._io&&this._io.connected},t.prototype.log=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},t.prototype.getNotificationUrl=function(){return this._registerResponse?this._registerResponse.webhookUrl:void 0},t.prototype.setupNotificationHandler=function(e,t){var n=e.source,a=e.scenarios,i=e.id,o=void 0===i?"":i,s=r.t[n];if(s)if(a&&a.length)for(var c=0,l=a;c<l.length;c++){var u=l[c];this._notificationHandlers[s.toLowerCase()+r.e[u].toLowerCase()+o]=t}else this._notificationHandlers[s.toLowerCase()+o]=t;else d.e.verbose("Attempted to add unknown notification handler ".concat(n),"PushChannelCommon.setupNotificationHandler")},t.prototype.addConnectedHandler=function(e){this._connectedHandlers.push(e)},t.prototype.getDriveSubscription=function(e){var t=this;return this._socketIoSubscription&&!1===e?s.n.wrap({supportsSocketIoSubscription:!0,socketIoSubscription:this._socketIoSubscription}):this._pushChannelDataSource.getAuthDataReceivedTime().then(function(e){if(t._lastSocketIoErrorAuthReceivedTime&&t._lastSocketIoErrorAuthReceivedTime===e)return{supportsSocketIoSubscription:!0};var n=t._pushChannelDataSource.getDriveSubscription();return n?n.then(function(e){if(!e)return{supportsSocketIoSubscription:!0};var n=!t._io||!t._io.connected||void 0===t._socketIoSubscription||t._socketIoSubscription.serverUrl!==e.serverUrl||t._socketIoSubscription.notificationUrl!==e.notificationUrl||t._socketIoSubscription.token!==e.token;return t._socketIoSubscription=e,t._lastSocketIoErrorAuthReceivedTime=void 0,n?(t.log(r.n.PushChannelProvider,"Connect to server",e),t._registerResponse={token:e.token,serverUrl:e.serverUrl,webhookUrl:e.notificationUrl},t._ensureIoDisconnected(),t._nextState(a.Registered)):t.log(r.n.PushChannelProvider,"getDriveSubscription",e),{supportsSocketIoSubscription:!0,socketIoSubscription:e}},function(n){t.log(r.n.PushChannelProvider,"getDriveSubscription error",n);var a=!1;if(Object(u.r)(n)&&(403===n.status?a=!0:n.error&&n.error.message&&(a=b.some(function(e){return 0===n.error.message.indexOf(e)}))),a)return t._lastSocketIoErrorAuthReceivedTime=e,{supportsSocketIoSubscription:!0};throw n}):{supportsSocketIoSubscription:!1}})},t.prototype._getBaseUrlThenRegister=function(e){var t=this;void 0===e&&(e=!1),e&&this.log(r.n.PushChannelProvider,"getBaseUrlThenRegister"),this.getDriveSubscription(!0).then(function(e){if(e.supportsSocketIoSubscription)e.socketIoSubscription||t._delayNextState(a.BaseUrlWaiting);else{var n=function(){return t.async.setTimeout(function(){t._getBaseUrlThenRegister()},1e3)};t._pushChannelDataSource.getBaseUrl().then(function(e){e?t._register(e):n()},function(e){n()})}},function(e){t.log(r.n.PushChannelProvider,"getDriveSubscription error",e),Object(u.r)(e)&&403===e.status?t.log(r.n.PushChannelProvider,"getDriveSubscription encountered a 403. Not retrying"):t._delayNextState(a.BaseUrlFail)})},t.prototype._onViewUpdate=function(){var e=this._pushChannelDataSource.getCurrentView();void 0!==e&&this._view!==e&&(this.log(r.n.PushChannelProvider,"onViewUpdate. '".concat(this._view,"' -> '").concat(e,"'")),this._view=e,this._socketIoSubscription=void 0,this._getBaseUrlThenRegister(!0))},t.prototype._register=function(e){var t=this;this.log(r.n.PushChannelProvider,"register",e),this._registerResponse=void 0,this._ensureIoDisconnected();var n,i="".concat(e,"/notifications/register"),o=l.e.generate();this._firedRegisterEvent||(this._firedRegisterEvent=!0,n=new p.e({name:"PushChannel.Register",url:i}));var d=function(e,r,c){if(void 0!==n){var d=void 0;(d=e instanceof Error?{resultType:s.n.isCanceled(e)?f.t.ExpectedFailure:f.t.Failure,error:e.message,extraData:{}}:{resultType:f.t.Failure,extraData:t._getExtraData(e,i)}).extraData.correlationId=o,void 0!==r&&(d.extraData.xhrStatusCode=r.toString()),void 0!==c&&(d.extraData.xhrIsTimeout=c.toString()),n.end(d)}t._delayNextState(a.RegisterFailed)};c.e.start({url:i,method:"GET",headers:{"X-Correlation-Id":o},requestTimeoutInMS:1e4}).then(function(e){if(e&&e.responseText&&e.responseText.length>0)try{var i=JSON.parse(e.responseText);i&&i.token&&i.serverUrl&&i.webhookUrl&&(t.log(r.n.PushChannelProvider,"register data",i),t._registerResponse=i)}catch(e){t.log(r.n.PushChannelProvider,"register failed",e)}t._registerResponse?(void 0!==n&&n.end({resultType:f.t.Success}),t._nextState(a.Registered)):d(e)},d)},t.prototype._connect=function(){var e=this;this._ensureIoDisconnected();var t={autoConnect:!1,reconnection:!1};-1===this._registerResponse.serverUrl.indexOf("token=")&&(t.query={token:this._registerResponse.token}),-1!==this._registerResponse.serverUrl.indexOf("pushn")?t.transports=["websocket"]:-1!==this._registerResponse.serverUrl.indexOf("-push")&&this._pushChannelDataSource.isLongPollingAllowed()&&(t.transports=["polling"]);var n,o=this._io=h.connect(this._registerResponse.serverUrl,t);this._firedConnectEvent||(this._firedConnectEvent=!0,n=new f.e({name:"PushChannel.Connect",extraData:Object(i.__assign)(Object(i.__assign)({},this._registerResponse),{totalConnectionAttempts:this._totalConnectionAttempts})})),this._io.on("connect",function(){if(o!==e._io)return e.log(r.n.PushChannelProvider,"SocketIoClientMismatch",e._io,o),n&&n.end({resultType:f.t.Failure,error:"SocketIoClientMismatch",extraData:Object(i.__assign)({},e._registerResponse)}),void o.disconnect();n&&n.end({resultType:f.t.Success,extraData:Object(i.__assign)({},e._registerResponse)}),e._connectionIssueCount=0,e._nextState(a.SocketIoConnected)}),this._io.on("connect_error",function(t){e.log(r.n.PushChannelProvider,"connect error",typeof t,t),n&&n.end({resultType:f.t.Failure,error:t,extraData:Object(i.__assign)({},e._registerResponse)}),e._onConnectionIssue()}),this._io.on("disconnect",this._onConnectionIssue.bind(this)),this._io.on("notification",function(t){var n;e.log(r.n.PushChannelProvider,"notification received",t);try{n=JSON.parse(t)}catch(n){return void e.log(r.n.PushChannelProvider,"notification received error",t)}var a=n.source,i=n.scenario?n.scenario.toLowerCase():"";a||(a=r.t[r.t.WebhookSubscription]);var o=!1,s=(a=a.toLowerCase())+i;if(!(o=e._handleMessage(n,s))){for(var c in e._notificationHandlers)-1!==c.indexOf(s)&&(o=e._handleMessage(n,c,s)||o);o||e.log(r.n.PushChannelProvider,"notification received - missing handler for message")}}),this._totalConnectionAttempts++,this._io.connect()},t.prototype._handleMessage=function(e,t,n){void 0===n&&(n=t);var a=this._notificationHandlers[t];return!!a&&(a(e.payload?e.payload:e.value),!0)},t.prototype._onConnectionIssue=function(){this._connectionIssueCount++,this._delayNextState(a.SocketIoDisconnected)},t.prototype._ensureIoDisconnected=function(){this._io&&(this._io.disconnect(),this._io=void 0)},t.prototype._nextState=function(e){if(this.log(r.n.PushChannelProvider,"nextState",(new Date).toLocaleString(),a[e]),this._clearDelayTimeout(),!this._registerResponse||this._io&&!this._io.connected&&this._connectionIssueCount>1)this._getBaseUrlThenRegister();else if(this._io&&this._io.connected){for(var t=0,n=this._connectedHandlers;t<n.length;t++)(0,n[t])();this._totalRetries=0,this._retryDelay=1e3}else this._connect()},t.prototype._delayNextState=function(e,t){var n=this;if((e===a.BaseUrlFail||e===a.RegisterFailed)&&(this._totalRetries++,this._totalRetries>100))return this.log(r.n.PushChannelProvider,"Exceeded max retry limit"),void new f.e({name:"PushChannel.RetryLimitExceeded"}).end({resultType:f.t.Success});var i=this._delayRetry(function(){return n._nextState(e)},t);this.log(r.n.PushChannelProvider,a[e],"delaying for ".concat(i,"ms"))},t.prototype._delayRetry=function(e,t){var n=this,a=t;return a||(a=this._retryDelay,this._retryDelay<12e4&&(this._retryDelay+=3001*Math.random()+2e3)),this._clearDelayTimeout(),this._delayTimeoutId=this.async.setTimeout(function(){n._delayTimeoutId=void 0,e()},a),a},t.prototype._clearDelayTimeout=function(){void 0!==this._delayTimeoutId&&(this.async.clearTimeout(this._delayTimeoutId),this._delayTimeoutId=void 0)},t.prototype._getExtraData=function(e,t){var n={};if(e){var a=e&&"function"==typeof e.getAllResponseHeaders?e.getAllResponseHeaders():void 0;a&&-1!==a.indexOf("access_token")&&(a=""),n.readyState=e.readyState,n.status=e.status,n.statusText=e.statusText,n.headers=a,n.responseText=e.responseText}return t&&(n.url=t),n},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.e.dependencies),{pushChannelDataSource:_.Y}),t}(o.e);t.default=g;var v=Object(m.r)("PushChannelProvider",g)}],Array(31),[function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.html=t.html,n}return Object(a.__extends)(t,e),t}(n(260).t),r=n(402).e({tagName:"ms-html-container",template:'<div class="HTMLContainer" data-bind="html:html"></div>',viewModel:i});t.e=r}],Array(21),[function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(1995),o=n(77),s=n(1968),c=n(2586),d=n(808),l=n(32),u=n(139),f=n(16),p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var a=t.openLocal,i=void 0!==a&&a,r=t.forceReadOnly,c=void 0!==r&&r,p=t.useDefaultAction,m=void 0!==p&&p;n._forceReadOnly=c,n._useDefaultAction=m,n._urlDataSource=n.resources.consume(o.Se),n._viewParams=n.resources.consume(l.T),n._itemSelectionHelper=new(n.child(d.e))({overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(s.t),n.item=n._itemSelectionHelper.firstItem,n._url=n.createPureComputed(n._computeUrl);var _=!1;f.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(_=Object(u.n)());var h=n.resources.consume(l.e);return n._navigationAction=new(n.managed(h.NavigationAction))({url:n._url,target:i||_?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}}),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){return e},t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,c.s)&&this._navigationAction.isAvailable()},t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(r.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})},t}(i.e);t.e=p},function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a=n(0),i=n(47),r={};function o(e){return r[e]}function s(e,t){r[e]=t}function c(e){var t=o(e);if(t&&(t.end({resultType:i.t.Failure}),t=void 0),!t){var n={name:e};s(e,t=new i.e(n))}return t}function d(e){u(e,i.t.Success)}function l(e,t){u(e,i.t.Failure,t)}function u(e,t,n){var i=o(e);if(i){var r={resultType:t};n&&(r=Object(a.__assign)(Object(a.__assign)({},r),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}})),i.end(r),s(e,void 0)}}},function(e,t,n){"use strict";n.d(t,"t",function(){return m});var a=n(0),i=n(59),r=n(47),o=n(1019),s=n(1829),c=n(75),d=n(816),l=n(7),u=n(135),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageLayoutType=n.pageLayoutType,a.layoutType=a._getLayoutType(),a._debouncer=a.scope.attach(new d.e),a}return Object(a.__extends)(t,e),t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");return t.backgroundCompute(function(){var t=e._pageLayoutType(),a=o.c[t];e._debouncer.debounce(a?a().then(function(e){return e.tagName}):c.n.wrap("")).then(function(e){n(e)})}),n},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{pageLayoutType:s.o.layoutType}),t}(i.n),p=new l.t({name:"".concat("ToggleListLayoutHelper",".layoutTypeResolver"),factory:new u.n(f)}),m=new l.t({name:"".concat("ToggleListLayoutHelper",".resolvedLayoutType"),factory:{dependencies:{layoutTypeResolver:p},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}}),_=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.pageLayoutType=n.resources.consume(s.o.layoutType),n}return Object(a.__extends)(t,e),t.prototype.changeLayout=function(e){var t=this;return(0,o.c[e])().then(function(n){return t.pageLayoutType(n.tagName),c.n.resolve({resultType:r.t.Success,extraData:{layout:e}})})},t}(i.n);t.e=_},function(e,t,n){"use strict";var a=n(3494),i=n(26),r=n(302),o=n(47),s=n(144),c=n(134),d=n(75),l=n(2139),u=n(1145),f=n(16),p=new RegExp("^".concat("Templates","$"),"i"),m=function(){function e(){}return e.isFolder=function(e,t){var n=!!e;return n&&!(n=e.type===s.e.Folder)&&t&&e.type===s.e.OneNote&&(n=!!f.e.isActivated("94B1529C-14BB-4854-B5FC-748FCEFF2681","3/29/2022","Check for OneNote note")||!e.contentTypeId||0!==e.contentTypeId.lastIndexOf("0x0101",0)),n},e.isCheckedOut=function(e){return l.e(e)},e.isCheckedOutByUser=function(e,t){return l.n(e,t)},e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)},e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:a.t,component:{name:u.e.tagName,params:{text:a.e}},actions:[{name:i.cancelActionText,execute:function(){return d.n.wrap(2)},icon:new r.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.t.Success}})},e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major},e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&!e.isPendingApproval(t,n)&&!e.isPageTemplate(t)&&(!t.properties||!t.properties._ScheduledVersion||t.properties.owshiddenversion!==t.properties._ScheduledVersion)&&c.e.hasItemPermission(t,c.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0)},e.isPublishingRelevant=function(t,n){return c.e.hasItemPermission(t,c.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)},e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)},e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var a=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:a}}return{major:0,minor:0}},e.isPendingApproval=function(t,n){return!!n.isModerated&&t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty]},e.isPageTemplate=function(e){if(!e)return!1;var t=!1,n=!1;if(e.id){var a=e.id.split("/"),i=a.length;t=p.test(a[i-2])}if(e.properties){var r=e.properties._SPSitePageFlags;n=!!r&&r.filter(function(e){return"template"===e.toLowerCase()}).length>0}return t||n},e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&c.e.hasItemPermission(t,c.e.editListItems)&&c.e.hasItemPermission(t,c.e.approveItems)},e.FileTypeProperty="FSObjType",e.PublishProperty="_ModerationStatus.",e.VersionProperty="_UIVersion",e}();t.e=m},function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(75),i=n(7),r=n(135),o=new i.t({name:"".concat("ListColumns",".columnMenuHelperType"),loader:new r.t(function(){return a.n.resolve(n.ee([68,"deferred.resx-deferred","ondemand.resx-ondemand"],3435)).then(function(e){return e.typeResourceKey.local})})}),s=new i.t({name:"".concat("ListColumns",".addColumnCommandHelperType"),loader:new r.t(function(){return a.n.resolve(n.ee([67,"deferred.resx-deferred","ondemand.resx-ondemand"],3060)).then(function(e){return e.typeResourceKey.local})})})}],Array(57),[function(e,t,n){"use strict";var a=n(0),i=n(75),r=n(380),o=n(47),s=n(302),c=n(1932),d=n(1122),l=n(17);Object(l.n)([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}]);var u=n(260),f=n(2585),p=n(27),m=function(e){function t(t){var n=e.call(this,t)||this;return n.infoPaneResx=c,n.category=t.category,n.typeDocuments=f.e[f.e.documents],n.typePhotos=f.e[f.e.photos],n.categoryText=p.observable(f.e[n.category()]),n.subscribe(n.categoryText,function(){n.category(f.e[n.categoryText()])}),n}return Object(a.__extends)(t,e),t}(u.t),_=n(402).e({tagName:"ms-folder-type-editor",template:'<div class="FolderTypeEditor"><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input class="ms-RadioButton-input" type="radio" name="folderType" id="folderTypeDocuments" data-bind="attr:{value:typeDocuments},checked:categoryText"><label for="folderTypeDocuments" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypeDocuments"></span></label></div></div><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input type="radio" name="folderType" id="folderTypePhotos" value="photos" data-bind="attr:{value:typePhotos},checked:categoryText" class="ms-RadioButton-input"><label for="folderTypePhotos" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypePhotos"></span></label></div></div></div>',viewModel:m,synchronous:!0}),h=n(77),b=n(1822),g=n(1123),v=n(808),y=n(8),S=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ChangeFolderType",a._itemProvider=a.resources.consume(b.resourceKey),a._urlDataSource=a.resources.consume(h.Se),a._identityDataSource=a.resources.consume(h.D),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!y.e.isActivated("B93166B0-4771-4455-90F3-5E582AF8CF19","10/21/2021","Disable change folder type"))return!1;var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!e||!t||void 0===e.queryType||t.type===r.e.anonymous||void 0===e.category||this._urlDataSource.isRecycleBin(e.queryType))},t.prototype.onExecute=function(e,t){return Object(a.__awaiter)(this,void 0,i.n,function(){var e,t,n,r=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=a.sent())?(t=e.category,n=this.observables.create(t),[2,this.resources.consume(g.e).requestDialog({title:c.informationChangeFolderTitle,component:{name:_.tagName,params:{category:n}},actions:[{name:c.informationSave,execute:function(){return i.n.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==n()}),isDefault:!0,icon:new s.e("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return r._itemProvider.changeFolderType({category:n(),item:e}).then(function(){return{resultType:o.t.Success}})})]):[2,i.n.resolve({resultCode:"EmptySelection",resultType:o.t.Failure})]}})})},t}(d.e);t.e=S},,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return v});var a=n(0),i=n(59),r=n(302),o=n(109),s=n(106),c=n(17);Object(c.n)([{rawString:".od-UnlockConfirmation-dialog.od-Dialog-main{width:unset}.od-UnlockConfirmation-dialog .od-Dialog-actionsRight{width:max-content}.od-UnlockConfirmation-dialog .od-Dialog-inner{width:min-content}.od-UnlockConfirmation-dialog .od-Dialog-content{min-width:320px}.od-UnlockConfirmation-dialog .od-Dialog-actionsLoading{display:none}.od-UnlockConfirmation-dialogContent{padding-top:0}.od-UnlockConfirmation-dialogContent .od-unlockConfirmation-message{font-size:14px;margin-bottom:16px}.od-UnlockConfirmation-dialogContent .od-unlockConfirmation-textInputLabel{font-size:14px;display:block;margin-bottom:4px}.od-UnlockConfirmation-dialogContent .od-unlockConfirmation-textInputLabel p{margin:0}.od-UnlockConfirmation-dialogContent .od-UnlockConfirmation-status{margin-top:8px;font-size:12px}.od-UnlockConfirmation-dialogContent .od-UnlockConfirmation-status .od-UnlockConfirmation-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var d=n(260),l=n(40),u=n(27),f=function(e){function t(t){var n=e.call(this,t)||this;return n.unlockConfirmationInputLabel=l.format(o.Ye,"<strong>"+o.m+"</strong>"),n.message=o.Qe,n.inputText=n.createObservable(""),n.isConfirmed=t.isConfirmed||u.observable(!1),n.status=t.status||u.observable(""),n.hasError=t.hasError||u.observable(!1),n.statusVisible=t.statusVisible||u.observable(!0),n.createBackgroundComputed(function(){n.inputText().trim().toLocaleLowerCase()===o.m.trim().toLocaleLowerCase()?n.isConfirmed(!0):n.isConfirmed(!1)}),n}return Object(a.__extends)(t,e),t}(d.t),p=n(402).e({tagName:"od-unlock-confirmation",template:'<div class="od-UnlockConfirmation-dialogContent"><div class="od-unlockConfirmation-message" data-bind="text:message"></div><label for="od-unlockConfirmation-Input" class="od-unlockConfirmation-textInputLabel"><p data-bind="html:unlockConfirmationInputLabel"></p></label><input type="text" id="od-unlockConfirmation-Input" class="od-TextField-field" aria-required="true" data-bind="textInput:inputText,hasFocus:true,attr:{\'aria-invalid\':(isConfirmed()===false).toString()}"><div aria-live="assertive" role="status" class="od-UnlockConfirmation-status">\x3c!--ko if:statusVisible--\x3e<p data-bind="text:status,css:hasError()?\'od-UnlockConfirmation-error\':\'\'"></p>\x3c!--/ko--\x3e</div></div>',viewModel:f,synchronous:!0}),m=n(75),_=n(1123),h=n(47),b=n(135),g=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.userStateProvider=a.resources.consume(s.b),a.dialogProvider=a.resources.consume(_.e),a}return Object(a.__extends)(t,e),t.prototype.confirmUnfreezeWithDialog=function(){var e=this,t={isConfirmed:this.createObservable(!1),status:this.createObservable(""),statusVisible:this.createObservable(!1),hasError:this.createObservable(!1)};return this.dialogProvider.requestDialog({customCssClasses:"od-UnlockConfirmation-dialog",title:o.g,component:{name:p.tagName,params:t},actions:[{name:o.je,execute:function(){return e._startUnlock(t)},isAvailable:t.isConfirmed,icon:new r.e("Unlock"),isDefault:!0},{name:o.le,execute:function(){return m.n.wrap(2)},isAvailable:this.createObservable(!0),icon:new r.e("Cancel")}]}).wait().then(function(){return{resultType:h.t.Success}})},t.prototype._startUnlock=function(e){return e.hasError(!1),e.status(o.He),e.statusVisible(!0),this.userStateProvider.unlockAccount().then(function(){return 2},function(){return e.status(o.H),e.hasError(!0),e.statusVisible(!0),1})},t}(i.n),v=(t.default=g,Object(b.r)("UnfreezeHelper",g))}],Array(36),[function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.AppleLivePhoto="AppleLivePhoto",e.SamsungMotionPhoto="SamsungMotionPhoto"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"r",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return f}),n.d(t,"l",function(){return p}),n.d(t,"u",function(){return m}),n.d(t,"f",function(){return _}),n.d(t,"p",function(){return h}),n.d(t,"m",function(){return b}),n.d(t,"_",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"b",function(){return y}),n.d(t,"g",function(){return S}),n.d(t,"v",function(){return D}),n.d(t,"y",function(){return I}),n.d(t,"S",function(){return x}),n.d(t,"D",function(){return C}),n.d(t,"I",function(){return O}),n.d(t,"x",function(){return w}),n.d(t,"C",function(){return E}),n.d(t,"O",function(){return A}),n.d(t,"w",function(){return L}),n.d(t,"E",function(){return k}),n.d(t,"A",function(){return M}),n.d(t,"k",function(){return P}),n.d(t,"L",function(){return T}),n.d(t,"M",function(){return U}),n.d(t,"P",function(){return F}),n.d(t,"T",function(){return H}),n.d(t,"U",function(){return R}),n.d(t,"F",function(){return N}),n.d(t,"H",function(){return B}),n.d(t,"R",function(){return j}),n.d(t,"N",function(){return V}),n.d(t,"B",function(){return z}),n.d(t,"j",function(){return G}),n.d(t,"V",function(){return K}),n.d(t,"z",function(){return W});var a="ab",i="acp",r="aol",o="at",s="ata",c="ats",d="ce",l="cm",u="cp",f="cxls",p="cxlsf",m="cf",_="cmp",h="con",b="cppt",g="cdoc",v="defc",y="de",S="dl",D="ef",I="em",x="erb",C="mc",O="mv",w="oo",E="pl",A="rcp",L="rfa",k="rmru",M="rmp",P="rn",T="rol",U="ra",F="orr",H="rst",R="rai",N="rot",B="sh",j="sf",V="up",z="vb",G="vo",K="pf",W="vv"},function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(75),r=n(7),o=n(59),s=n(106),c=n(1359),d=n(8),l=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a._getModule=t.getModule,a._path=t.path,a._getExecutorParams=t.getExecutorParams,d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")&&(a._bundleLoader=a.resources.consume(s.e),a._bundleLoader.queueLoad(a._path,a._getModule).done()),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(a){return"function"!=typeof a?i.n.wrapError(new Error("Cannot create action from ".concat(a,": ").concat(n._path))):i.n.as(n._getExecutorParams()).then(function(r){var o=new(n.resources.injected(a))(r);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: ".concat(this._path)))},t.prototype._loadExecutorType=function(){if(d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")){var e=this._bundleLoader.loadNow(this._path,this._getModule);return this._loadExecutorType=function(){return e},e}return this._getModule().then(function(e){return Object(c.e)(e)})},t.dependencies=Object(a.__assign)({},o.n.dependencies),t}(o.n);t.e=l;var u=new r.t({name:"ExecutorLoader",factory:{dependencies:l.dependencies,create:function(e){return{instance:function(t){function n(n){return t.call(this,n,e)||this}return Object(a.__extends)(n,t),n}(l)}}}})},,function(e,t,n){"use strict";var a;!function(e){e[e.Column=0]="Column",e[e.Order=1]="Order"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a=function(){function e(){}return e.alert=function(t,n,a,i,r){void 0===a&&(a=!1),void 0===r&&(r="alert");var o="sp_a11y_alert_"+t,s=document.querySelector("#"+o);s&&document.body.removeChild(s);var c=document.createElement("p");a||c.setAttribute("style",e._cssHidden),i&&c.classList.add(i),c.setAttribute("role",r),c.setAttribute("aria-live","assertive"),c.setAttribute("id",o);var d=document.createTextNode(n);document.body.appendChild(c),c.appendChild(d)},e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;",e}();t.e=a},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:"@keyframes commandBarBoxShadowAnimation{0%{box-shadow:none;background-color:transparent}100%{background-color:"},{theme:"listBackground",defaultValue:"#fff"},{rawString:";box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108)}}@keyframes commandBarDividerAnimation{0%{opacity:1}100%{opacity:0}}.InfoPane-sharing{margin-top:.5rem}.InfoPane-sectionHeaderText{font-size:.875rem}.od-SharingSection-ManageAccessLink{font-size:.75rem}.SharingSection-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:.5rem 0;font-size:.75rem}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:10.625rem;padding:0}.SharingSection-addPeople{font-size:1.125rem;min-height:3.125rem;margin-top:.625rem}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .SharingSection-addPeople-icon{margin-right:.625rem}[dir=rtl] .SharingSection-addPeople-icon{margin-left:.625rem}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:.9375rem}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:.9375rem}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.SharingSection-linksBox a{display:inline-block;margin-top:.3125rem}.SharingSection-link,.od-PermissionsPanel-link{padding-top:.5rem}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:.75rem}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionPile-FacePile.od-PermissionPile-Unshared{display:inline-flex;flex-wrap:wrap;justify-content:start}.od-PermissionsPanel-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionPile-accessibleLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:1rem;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-PermissionsPanel-entity{padding:.5rem 0;font-size:.75rem}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:1.0625rem;min-height:3.125rem;padding-bottom:.625rem}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:.625rem}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:.625rem}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem;left:.9375rem}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:.3125rem}.od-PermissionsPanel-link{padding-top:.5rem}.od-PermissionsPanel-container{overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}.od-PermissionsPanel-fileName{font-size:.875rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.5625rem}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:2.5rem}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:2.5rem}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:.1875rem;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';padding:0 .3125rem;font-size:.5rem;font-weight:800;content:"\\e76c"}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:"";display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:"\\e76b"}.od-PermissionsPanel-titleBar{padding-top:1rem;padding-bottom:.25rem;border-bottom:solid .0625rem '},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:1rem}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:1rem}.od-PermissionsPanel-parent{height:100%}.od-PermissionsPanel-content{padding-top:15px;padding-left:32px;padding-right:5px}.od-PermissionsPanel-linksBox,.od-PermissionsPanel-linksBox-row{right:0;bottom:0}.od-SharingSection-PermissionsPile{width:20rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box;margin-bottom:1rem;padding:1rem 1.5rem}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{cursor:default;padding-bottom:0}.od-SharingSection-PermissionsPile .od-Link:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-ManageAccessLink-Button{border:0;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:inherit;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer}.od-SharingSection-PermissionsPile-personas{margin-bottom:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:2rem;height:2rem;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:.25rem}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:.0625rem solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:1rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-HasAccessControl{text-align:center;padding:.375rem 0;height:unset;width:unset}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Pointer{cursor:auto}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-SharingSection-PermissionsPile-personas .od-Persona-image[disabled] .od-SharingSection-PermissionsPile-addFriend{cursor:default;background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 .0625rem "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:1.0625rem}.od-SharingSection-PermissionsPile-numberText{font-size:.625rem;padding-top:1rem;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:.0625rem solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-personaBorder .ms-Icon{font-size:.875rem}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:.25rem;transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:.75rem;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:.625rem;top:50%;transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:.25rem;padding:.125rem}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:.1875rem}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-Panel-button--close .ms-Icon--Cancel{font-size:1rem}.od-ShowPermissions-commandBar{outline:0;margin:0;border:0;top:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 .0625rem "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:.75rem;padding-right:.75rem}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:.0625rem solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:.125rem -.5rem}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"AlbumProvider.key",loader:new i.t(function(){return n.ee([209,"ondemand.resx-ondemand"],2350).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly",e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual",e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly",e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual",e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly",e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual",e[e.OfficeTrial=7]="OfficeTrial",e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree",e[e.OfficeSolo=9]="OfficeSolo",e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore",e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore",e[e.ChangeCurrency=12]="ChangeCurrency",e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions",e[e.FeatureCardStorage=14]="FeatureCardStorage",e[e.FeatureCardProductivity=15]="FeatureCardProductivity",e[e.FeatureCardSecurity=16]="FeatureCardSecurity",e[e.FeatureCardSharing=17]="FeatureCardSharing",e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps",e[e.LaunchFeatureCard=19]="LaunchFeatureCard",e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures",e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle",e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider",e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider",e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider",e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider",e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown",e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick",e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace",e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly",e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly",e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption",e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption",e[e.PrintPdfNative=33]="PrintPdfNative",e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown",e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked",e[e.SharedViaFacebook=36]="SharedViaFacebook",e[e.SharedViaTwitter=37]="SharedViaTwitter",e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn",e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo",e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog",e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog",e[e.Shown100GbPlanInterruptDialog=42]="Shown100GbPlanInterruptDialog",e[e.ShownRedeemSamsungBonusDialog=43]="ShownRedeemSamsungBonusDialog",e[e.InterruptO365Clicked=44]="InterruptO365Clicked",e[e.InterruptOD50Clicked=45]="InterruptOD50Clicked",e[e.DownloadOfficeApps=46]="DownloadOfficeApps",e[e.QuotaUsageClick=47]="QuotaUsageClick",e[e.GetAdditionalStorageClick=48]="GetAdditionalStorageClick",e[e.UnipuxExperiencePurchaseClick=49]="UnipuxExperiencePurchaseClick",e[e.AADCPurchaseBlock=50]="AADCPurchaseBlock",e[e.StorageInfoUpsellClick=51]="StorageInfoUpsellClick"}(a||(a={})),function(e){e[e.OfficePlansSection=1]="OfficePlansSection",e[e.StoragePlansSection=2]="StoragePlansSection",e[e.UpgradePage=3]="UpgradePage",e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar",e[e.EmbedPane=5]="EmbedPane",e[e.OneUp=6]="OneUp",e[e.SharingDialog=7]="SharingDialog",e[e.ManageStoragePage=8]="ManageStoragePage"}(i||(i={}))}],Array(101),[function(e,t,n){"use strict";function a(e){var t=!1;if(e)switch(e.errorCode){case 2:case 101:case 102:case 103:case 152:case 161:case 162:case 200:case 201:case 202:case 209:case 1e3:case 1006:case 1007:case 2006:case 3e3:case 3403:case 9017:case 10001:case 10002:case 10004:case 10006:case 10009:case 10011:case 10012:case 10013:case 10027:t=!0}return t}n.d(t,"e",function(){return a})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("InfoPaneManager.key")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("FirstRunExperienceDataSource.key")},function(e,t,n){"use strict";var a=n(43),i=n(2173),r=n(77),o=function(){function e(){this._urlDataSource=this.resources.consume(r.Se)}return e.prototype.getDefaultGetItemContext=function(e){var t=this._urlDataSource.getCurrentItemKey(e),n=this._urlDataSource.getKeyParams(t),a=this._urlDataSource.getOwnerId(t,e),i=this._urlDataSource.getQueryType(n);return{groupingType:this._getGroupingType(a),isAscending:void 0,pageSize:this._getPageSize(i),ownerId:a,parentKey:t,queryType:i,resultSetOptions:void 0,revision:0,sortField:void 0,startIndex:0,startKey:void 0}},e.prototype._getPageSize=function(e){return e===a.e.Search?50:100},e.prototype._getGroupingType=function(e){var t=this._getLocalStorageValue("".concat("ItemsStoreonedrive.web.files.filesquerytype",".").concat(e.toLowerCase())),n=JSON.parse(t||"{}");return t&&n[a.e[a.e.Files]]!==i.n?0:1},e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}},e}();t.e=o},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="officeFileOpenQuotaDialogShownThisSession"},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"SuiteNavProvider.key",loader:new i.t(function(){return n.ee(0,1153).then(function(e){return e.resourceKey})})})}],Array(84),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-Dialog.od-Dialog--close .od-QuotaBlock .od-Dialog-button.od-Dialog-button--close .ms-Icon.ms-Icon--Cancel{font-size:16px;color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-QuotaBlock-header{position:relative;width:100%;max-height:108px}.od-QuotaBlock-container{padding:18px 28px 18px 10px;background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:";box-sizing:border-box;display:flex;width:100%}html[dir=rtl] .od-QuotaBlock-container{padding:18px 10px 18px 28px}html[dir=ltr] .od-QuotaBlock-container{float:left}html[dir=rtl] .od-QuotaBlock-container{float:right}.od-QuotaBlock-blue .od-QuotaBlock-container{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-title{color:"},{theme:"white",defaultValue:"#fff"},{rawString:";align-self:center;font-weight:600;font-size:20px}[dir=ltr] .od-QuotaBlock-title{padding-left:16px}[dir=rtl] .od-QuotaBlock-title{padding-right:16px}.od-QuotaBlock-image{display:inline-block;height:76px;min-width:1px}html[dir=ltr] .od-QuotaBlock-image{float:left}html[dir=rtl] .od-QuotaBlock-image{float:right}.od-QuotaBlock-body{clear:both;position:relative;width:100%}.od-QuotaBlock-subheader{padding:22px 24px 16px 24px}html[dir=rtl] .od-QuotaBlock-subheader{padding:22px 24px 16px 24px}.od-QuotaBlock-message{font-size:14px;font-weight:400}[dir=ltr] .od-QuotaBlock-message{padding-right:4px}[dir=rtl] .od-QuotaBlock-message{padding-left:4px}.od-QuotaBlock-link{white-space:nowrap;font-size:14px;font-weight:400;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-buttons{position:relative;padding:0 24px 16px 24px}html[dir=rtl] .od-QuotaBlock-buttons{padding:0 24px 16px 24px}.od-QuotaBlock-status{padding:0}.od-QuotaBlock-status p{margin:0 24px 16px}.od-QuotaBlock-status .od-QuotaBlock-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-QuotaBlock-button{position:relative;outline:0;min-height:48px;padding:8px 0}.od-QuotaBlock-button:focus{box-shadow:0 0 0 1px #767676 inset}.od-QuotaBlock-icon{position:absolute;width:48px;height:48px}.od-QuotaBlock-outer-icon{position:relative;width:48px;height:48px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-QuotaBlock-outer-icon .od-IconGlyph.ms-Icon{font-size:48px;line-height:48px}.od-QuotaBlock-button--clickable{cursor:pointer}.od-QuotaBlock-button--clickable .od-QuotaBlock-outer-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-QuotaBlock-inner-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:";position:absolute;width:48px;top:0;bottom:0}.od-QuotaBlock-inner-icon .od-IconGlyph.ms-Icon{font-size:large;line-height:48px;width:100%;height:100%}[dir=ltr] .od-QuotaBlock-inner-icon .ms-Icon--Snowflake:before{margin-left:1px}[dir=rtl] .od-QuotaBlock-inner-icon .ms-Icon--Snowflake:before{margin-right:1px}[dir=ltr] .od-QuotaBlock-inner-icon{left:0}[dir=rtl] .od-QuotaBlock-inner-icon{right:0}.od-QuotaBlock-inner-image{position:absolute;top:0;bottom:0}[dir=ltr] .od-QuotaBlock-inner-image{left:0}[dir=rtl] .od-QuotaBlock-inner-image{right:0}.od-QuotaBlock-message-container{display:flex;min-height:48px}[dir=ltr] .od-QuotaBlock-message-container{padding-left:64px}[dir=rtl] .od-QuotaBlock-message-container{padding-right:64px}.od-QuotaBlock-text-container{align-self:center;display:block}.od-QuotaBlock-text{font-size:14px;font-weight:400;display:inline}[dir=ltr] .od-QuotaBlock-text{padding-right:4px}[dir=rtl] .od-QuotaBlock-text{padding-left:4px}.od-QuotaBlock-button-link{display:inline-block;white-space:nowrap}"}]);var i=n(402),r=n(0),o=n(260),s=n(122),c=n(40),d=n(302),l=n(2055),u=n(1022),f=n(2587),p=n(2154),m=n(1123),_=n(32),h=n(1118),b=n(2176),g=n(106),v=n(2852),y=n(709),S=n(2787),D=n(3564),I=n(109),x=n(2401),C=function(e){function t(t){var n=e.call(this,t)||this;return n.closeLabel=x.e,n._isWacEditBlock=t.isWacEditBlock,n._item=t.item,n.addBindingHandlers({keyboard:h.e}),n._userStateProvider=n.resources.consume(g.b),n._unfreezeHelper=n.resources.consume(v.resourceKey),n.circleComponent=n._getIconComponent(new d.e("FullCircleMask")),n.title=n._getTitle(),n.message=n._getMessage(),n.buttonItems=n._getButtonItems(),n.classes=n._getClasses(),n.imageUrl=n._getImageUrl(),n.statusVisible=n.createObservable(!1),n.hasError=n.createObservable(!1),n.status=n.createObservable(""),n}return Object(r.__extends)(t,e),t.prototype.dismiss=function(){var e=this.resources.consume(m.e).currentDialog();return!e||(e.dismiss(),!1)},t.prototype.onKeyEnter=function(e,t){return e&&e.onClick&&e.onClick(),!0},t.prototype._getTitle=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===f.e.delinquent)return I.L;if(e===f.e.inactive)return I.ne;var t=this._userStateProvider.status.peek();return t===u.e.overQuota?I.Ze:t===u.e.full?I.T:I.me},t.prototype._getMessage=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===f.e.delinquent){var t=this._userStateProvider.driveDeletionDate.peek();return c.format(I.S,O(t))}if(e===f.e.inactive)return t=this._userStateProvider.driveDeletionDate.peek(),c.format(I.te,O(t));var n=this._userStateProvider.status.peek();return this._isWacEditBlock?D.t:n===u.e.overQuota?I.Xe:I.ce},t.prototype._getButtonItems=function(){var e=this,t=[],n=this._userStateProvider.primaryLockedReason.peek(),a=this._userStateProvider.canUpgrade.peek();if(n===f.e.inactive)return[{link:void 0,text:I.qe,icon:this._getIconComponent(new d.e("Snowflake")),onClick:function(){e._unlockAccount()}}];a&&t.push({link:void 0,text:I.fe,icon:this._getIconComponent(new d.e("OneDrive")),onClick:function(){e._navigate(b.e.upgrade,!1)}});var i=n===f.e.delinquent,r=this._userStateProvider.lastUnlockDate.peek();return i&&(this._userStateProvider.userUnlocksRemaining.peek()?t.push({link:void 0,text:I.qe,icon:this._getIconComponent(new d.e("Snowflake")),onClick:function(){e._confirmUnfreeze()}}):r&&t.push({link:{text:I.ae,onClick:function(){e._navigate(b.e.learnMore,!0)}},text:c.format(I.ge,O(r)),icon:this._getIconComponent(new d.e("Snowflake")),onClick:void 0})),i||this._isWacEditBlock&&a||t.push({link:void 0,text:I.h,icon:this._getIconComponent(new d.e("Broom")),onClick:function(){e._navigate(b.e.cleanUpFiles,!1)}}),!i&&this._isWacEditBlock&&t.push({link:void 0,text:D.e,icon:this._getIconComponent(new d.e("Page")),onClick:function(){e._openOfficeDocument()}}),t},t.prototype._getIconComponent=function(e){return{name:l.e.tagName,params:{icon:e}}},t.prototype._getClasses=function(){return{"od-QuotaBlock-blue":this._userStateProvider.primaryLockedReason.peek()===f.e.inactive||this._userStateProvider.status.peek()===u.e.full&&!this._userStateProvider.canUpgrade.peek()}},t.prototype._getImageUrl=function(){var e=this._userStateProvider.primaryLockedReason.peek();if(e===f.e.delinquent)return window.require.toUrl("odsp-media/images/quota/frozen-files-red.svg");if(e===f.e.inactive)return window.require.toUrl("odsp-media/images/quota/frozen-files-blue.svg");var t=this._userStateProvider.status.peek();return t===u.e.full?this._userStateProvider.canUpgrade.peek()?window.require.toUrl("odsp-media/images/quota/full-glass-red.svg"):window.require.toUrl("odsp-media/images/quota/full-glass-blue.svg"):t===u.e.overQuota?window.require.toUrl("odsp-media/images/quota/freezing-files-red.svg"):window.require.toUrl("odsp-media/images/quota/speedometer-red.svg")},t.prototype._navigate=function(e,t){var n=2===this._userStateProvider.accountState.peek()?p.e.frozenBlock:p.e.quotaBlock,a=this._userStateProvider.getNavigationUrl(n,e),i=this.resources.consume(_.e),r=new(this.managed(i.NavigationAction))({target:t?"_blank":void 0,url:a});this._userStateProvider.logEvent(n,e),r.execute(void 0)},t.prototype._openOfficeDocument=function(){var e=this,t=new(this.managed(S.e))({item:this._item,forceReadOnly:!0});this._userStateProvider.logEvent(p.e.quotaBlock,b.e.wac),t.execute(void 0).then(function(){var t=e.resources.consume(m.e).currentDialog.peek();t&&t.dismiss()})},t.prototype._confirmUnfreeze=function(){this._unfreezeHelper.confirmUnfreezeWithDialog()},t.prototype._unlockAccount=function(){var e=this;this.hasError(!1),this.status(I.He),this.statusVisible(!0),this._userStateProvider.unlockAccount().then(function(){e.statusVisible(!1)},function(){e.status(I.H),e.hasError(!0),e.statusVisible(!0)})},t}(o.t);function O(e){return y.e.getLongDateStringSafe(e,s.t.language)}var w=i.e({tagName:"od-quota-block",template:'<div class="od-QuotaBlock" data-bind="css:classes"><div class="od-QuotaBlock-header"><div class="od-QuotaBlock-container"><img class="od-QuotaBlock-image" data-bind="attr:{src:imageUrl}"><div class="od-QuotaBlock-title" data-bind="text:title"></div></div></div><div class="od-QuotaBlock-body"><div class="od-QuotaBlock-subheader"><span class="od-QuotaBlock-message" data-bind="text:message"></span></div><div class="od-QuotaBlock-buttons" data-bind="foreach:buttonItems">\x3c!--ko if:link--\x3e<div class="od-QuotaBlock-button"><div class="od-QuotaBlock-icon"><div class="od-QuotaBlock-outer-icon" data-bind="component:$component.circleComponent"></div><div class="od-QuotaBlock-inner-icon" data-bind="component:icon"></div></div><div class="od-QuotaBlock-message-container"><div class="od-QuotaBlock-text-container"><div class="od-QuotaBlock-text" data-bind="text:text"></div><a class="od-QuotaBlock-button-link" href="javascript:;" data-bind="click:link.onClick,text:link.text"></a></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:link--\x3e<div class="od-QuotaBlock-button od-QuotaBlock-button--clickable" tabindex="0" data-bind="click:onClick,keyboard:{allowButtonEvents:true,mappings:{Enter:$component.onKeyEnter}}"><div class="od-QuotaBlock-icon"><div class="od-QuotaBlock-outer-icon" data-bind="component:$component.circleComponent"></div><div class="od-QuotaBlock-inner-icon" data-bind="component:icon"></div></div><div class="od-QuotaBlock-message-container"><div class="od-QuotaBlock-text-container"><div class="od-QuotaBlock-text" data-bind="text:text"></div></div></div></div>\x3c!--/ko--\x3e</div><div aria-live="assertive" role="status" class="od-QuotaBlock-status">\x3c!--ko if:statusVisible--\x3e<p data-bind="text:status,css:hasError()?\'od-QuotaBlock-error\':\'\'"></p>\x3c!--/ko--\x3e</div></div><button class="od-Dialog-button od-Dialog-button--close" data-bind="attr:{\'aria-label\':closeLabel,title:closeLabel},click:dismiss"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button></div>',viewModel:C,synchronous:!0});t.e=w}],Array(32),[function(e,t,n){"use strict";var a=n(242),i=n(599),r=function(){function e(){}return e.start=function(e){var t=new a.e(function(){for(var e=0,t=o;e<t.length;e++)t[e].cancel()}),n=e.items.slice(),r=e.parallelRequests||1,o=[];function s(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function c(){var a=new i.e,r=n.splice(0,e.batchSize),d=JSON.stringify(e.getPostData(r)),l=a.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:d,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){s(l),e.onBatchComplete&&e.onBatchComplete(r),n.length?c():t.complete()},function(e){s(l),function(e){t.error(e)}(e)});o.push(l)}for(var d=0;n.length>0&&d<r;d++)c();return t.getPromise()},e}();t.e=r},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"InAppMessagingDataSource.key",loader:new i.t(function(){return n.ee(47,3186).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("MoveCopyCapabilities")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"".concat("AlbumsInvalidator.key",".albumsInvalidator"),loader:new i.t(function(){return n.ee([225],4358).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n(0),r=n(1122),o=n(75),s=n(47),c=n(808),d=n(77),l=n(144),u=n(1030),f=n(43);!function(e){e[e.DefaultClick=0]="DefaultClick",e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline",e[e.OpenFileLocation=2]="OpenFileLocation",e[e.OpenItemActivityItem=3]="OpenItemActivityItem",e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(a||(a={}));var p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i,o=t.actionType;return n.name="OpenInDesktop",n._itemSelectionHelper=new(n.child(c.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n._urlDataSource=n.resources.consume(d.Se),n._actionType=o,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),i={id:n.id,name:n.name,actionType:a[this._actionType],queryType:f.e[n.queryType],itemType:l.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[u.t.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};return window.external.notify(JSON.stringify(i)),o.n.wrap({resultType:s.t.Success})},t}(r.e);t.t=p},function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(1968),o=n(808),s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.itemCommandHelper=new(n.managed(r.e)),n.selectionHelper=new(n.child(o.e))(Object(a.__assign)(Object(a.__assign)({},n.getSelectionOptions(t)),{overrideItem:t.item})),n}return Object(a.__extends)(t,e),t.prototype.getSelectionOptions=function(e){return void 0===e&&(e={}),{}},t}(i.e);t.e=s},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(2333),i=new a.e("upload"),r=new a.e("download");new a.e("sync")},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(77),i=n(229),r=n(378),o=n(156),s=n(123),c=n(2706);function d(e,t,n){if(e.isExposed(a.h)){var d=e.consume(i.s.optional),l=!1;if(d&&d.isSPO){var u=Number(d.webTemplate)===r.t.mySite;if(l=!!d.listBaseTemplate&&Object(s.o)(d.listBaseTemplate),u&&!l)return}var f=l?"FloodgateForLists.":"FloodgateForSPO.";try{var p=e.consume(a.h),m=n?t:l?c.e:"SPListAction";p.recordUserAction(m,t)}catch(e){o.e.logData({name:f+"error"+t,extraData:{error:e}})}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(2333),i=(new a.e("checkout"),new a.e("quickEdit"),new a.e("editItem")),r=(new a.e("viewItem"),new a.e("versionHistory"));new a.e("exportList")}],Array(107),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-DragAndDropHint-box{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}]);var i=n(0),r=n(260),o=n(2111),s=n(3008),c=n(244),d=n(403),l=n(7),u=n(135),f=new l.t({name:"".concat("DragAndDropAnimationHelper.key",".dragAndDropAnimationHelper"),loader:new u.t(function(){return n.ee([226],2816).then(function(e){return e.resourceKey})})}),p=n(614),m=n(495),_=n(139),h=n(32),b=n(106),g=function(e){function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(h.e),n._isItemSetRendered=n.resources.consume(h.S),n._platformDetection=n.resources.consume(c.e),n._bundleLoader=n.resources.consume(b.e);var a=n.resources.consume(d.e),i=new(n.managed(n._actionMap.UploadAction))({uploadProcessorType:o.e.Html5file});return n._isUploadAvailable=i.isAvailable,n._firstRunExperienceStatus=n.resources.consume(p.e),n._isOneDriveXboxApp=Object(_.t)(),n.isGridView=t.isGridView,n.showDropHint=n.createPureComputed(n._computeShowDropHint),n.dropSuggestionText=n.isRobotVisible?s.e:s.t,n.fileImageUrl=window.require.toUrl("odsp-media/images/odrobot/dragfilegrid.svg"),n.isAnimationApplicable=!1,n.isAnimationClassApplicable=n.createObservable(!1),n.isReady=n.createObservable(!1),n.isRobotVisible=t.isRobotVisible,n.isRobotVisible?(n.createBackgroundComputed(n._computeShowRobotAnimation),n.robotImageUrl=n.createPureComputed(n._computeRobotImageUrl)):n.isReady(!0),n.createBackgroundComputed(function(){n.showDropHint()&&n.isRobotVisible&&a.logData({name:"DragAndDropRobot.Show",extraData:{isGridView:n.isGridView}})}),n}return Object(i.__extends)(t,e),t.prototype._computeShowRobotAnimation=function(){var e=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded(),this.resources.consumeAsync(f).then(function(t){e._isBundleLoaded&&(!t.getInitialized()&&e.isRobotVisible&&e._firstRunExperienceStatus.get()!==m.e.visible?(t.setIsInitialized(!0),t.setIntializeTime(),e.isAnimationApplicable=!0,e._setAnimationTimer(),e.isReady(!0)):t.getInitialized()&&(e.isAnimationApplicable=!0,e.isReady(!0),e._setAnimationTimer()))})},t.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&!this._isOneDriveXboxApp&&this._isItemSetRendered()&&this.isReady()},t.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)},t.prototype._computeRobotImageUrl=function(){if(this.isReady()){var e=window.require.toUrl("odsp-media/images/odrobot/".concat(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg"));return"url('".concat(e,"')")}return""},t}(r.t),v=n(402).e({tagName:"od-drag-and-drop-hint",template:'\x3c!--ko if:showDropHint()--\x3e<div class="od-DragAndDropHint" data-bind="css:{\'od-DragAndDropHint--grid\':isGridView,\'ms-slideLeftIn40\':isAnimationClassApplicable()&&isGridView,\'ms-slideUpIn20\':isAnimationClassApplicable()&&!isGridView,\'is-animating\':isReady()&&(isAnimationApplicable&&!isAnimationClassApplicable())}"><div class="od-DragAndDropHint-box" data-bind="css:{\'od-DragAndDropHint-box--grid\':isGridView,\'od-DragAndDropHint-box--robot\':isRobotVisible}">\x3c!--ko if:isGridView--\x3e<div class="od-DragAndDropHint-fileContainer"><img class="od-DragAndDropHint-file" data-bind="attr:{src:fileImageUrl}"></div>\x3c!--/ko--\x3e<div class="od-DragAndDropHint-text" data-bind="text:dropSuggestionText,css:{\'od-DragAndDropHint-text--grid\':isGridView}"></div></div>\x3c!--ko if:isRobotVisible--\x3e<div class="od-DragAndDropHint-robot" data-bind="style:{\'background-image\':robotImageUrl},css:{\'od-DragAndDropHint-robot--grid\':isGridView,\'od-DragAndDropHint-robotAnimation\':isReady()&&isAnimationApplicable}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e',viewModel:g});t.e=v},,,,function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(75),o=n(1151),s=n(491),c=n(3485),d=n(3127),l=n(599),u=n(4190),f=n(27),p=n(2174),m=n(271),_=n(144),h=n(43),b=n(405),g=n(77),v=n(1847),y=n(1932),S=n(122),D=n(32),I=n(244);function x(e,t,n){var i;if(void 0===n&&(n={}),n){var r=function(e,t){var n,i=t.consume(I.e).isMobile&&!!t.consume(D.M.optional),r=Object(a.__assign)(Object(a.__assign)({},O("type","","FileTypeIcon",!1)),{minWidth:i?48:16,width:i?48:16,isIcon:!0,fieldType:v.e.FileIcon}),o=E(!0),s=k(!0),d=A(),l=w(!0),u=Object(a.__assign)(Object(a.__assign)({},O("_shareHeroCommand","","_shareHeroCommand",!1)),{isIcon:!0,minWidth:16,width:16,fieldType:v.e.ShareCommand}),f=E(!1),p=k(!1),m=w(!1),_=Object(a.__assign)(Object(a.__assign)({},O("dateTaken",y.informationDateTaken,"dateTaken",!0)),{fieldType:v.e.DateTime}),b=i?C(r,[[o],[s,l,d]],Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],"userArranged"===e?[L()]:[],!0),[o,s],!1),"dateTaken"===e?[_]:[],!0),[l,d],!1)):Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],"userArranged"===e?[L()]:[],!0),[r,o],!1),[u],!1),[s],!1),"dateTaken"===e?[_]:[],!0),[d,l],!1),g=i?C(r,[[o],[s,l,d]],[o,s,_,l,d]):Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],"userArranged"===e?[L()]:[],!0),[r,o],!1),[u],!1),[s,_,d,l],!1),S=Object(a.__assign)(Object(a.__assign)({},O("dateAccessed",c.n,"dateAccessed",!0)),{fieldType:v.e.DateTime}),x=Object(a.__assign)(Object(a.__assign)({},O("location",c.a,"",!1)),{showTooltip:!0}),M=i?C(r,[[o],[S,l,d]],[o,S,l,d]):[r,o,S,s,x,l],P=A(),T=[r,o,P,l],U=[r,o,P,l],F=i?C(r,[[f],[p,m,d]],[f,p,m,d]):[r,f,d,p,x,m],H=Object(a.__assign)(Object(a.__assign)({},O("location",c.o,"location",!0)),{width:300,showTooltip:!0}),R=Object(a.__assign)(Object(a.__assign)({},O("dateDeleted",c.t,"dateDeleted",!0)),{fieldType:v.e.DateTime}),N=i?C(r,[[o],[l,R,H]],[o,R,l,H]):[r,o,H,R,l];return(n={})[h.e.Files]=b,n[h.e.Photos]=g,n[h.e.Recent]=M,n[h.e.SharedWithMe]=T,n[h.e.DocsInCommon]=U,n[h.e.Search]=F,n[h.e.RecycleBin]=N,n}(n.defaultSortField,t);e.type===_.e.Folder&&(i=r[e.displayType]||r[h.e.Files]),i&&(i=i.map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),n.isSortEnabled?(e.internalName||e.key)===n.sortField?{isSorted:!0,isAscending:n.isAscending}:{isSorted:!1}:{sortable:!1})}))}return i}function C(e,t,n){for(var i=[],r=0;r<t.length;r++)for(var o=0,s=t[r];o<s.length;o++){var c=s[o];i.push(Object(a.__assign)(Object(a.__assign)({},c),{customRowNumber:r}))}for(var d=[e,Object(a.__assign)(Object(a.__assign)({},O("","","",!1)),{width:900,customFields:i})],l=0,u=n;l<u.length;l++){var f=u[l];d.push(Object(a.__assign)(Object(a.__assign)({},f),{isVisible:!1,isVisibleMobile:!1}))}return d}function O(e,t,n,a,i){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:a,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:v.e.Text,filterable:!1,isFocused:f.observable(!1)}}function w(e){return Object(a.__assign)(Object(a.__assign)({},O("size",c.c,"size",e)),{isHtml:!0,fieldType:v.e.FileSize,sortable:e})}function E(e){return Object(a.__assign)(Object(a.__assign)({},O("displayName",c.r,"displayName",e)),{isCollapsable:!1,minWidth:220,width:440,fieldType:v.e.Name,sortable:e,hasListItemMenu:!0})}function A(){return Object(a.__assign)(Object(a.__assign)({},O("defaultSubText",c.s,"",!1)),{fieldType:v.e.Shared})}function L(){return Object(a.__assign)(Object(a.__assign)({},O("",c.d,"userArranged",!0)),{isVisible:!1,isVisibleMobile:!1})}function k(e){var t=c.i;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},O("dateModified",t,"dateModified",e)),{sortable:e,sortDescFirst:e,fieldType:v.e.DateTime}),"ml"==="".concat(S.t.language).toLowerCase()?{width:150}:{})}var M=n(1827),P=n(291),T=n(3301),U=n(1912),F=n(3486),H=n(2534),R=n(489),N=n(103),B=n(3004),j=n(141),V=n(82),z=n(119),G=n(2999),K=n(213),W=n(13),q=function(){function e(){this._urlDataSource=this.resources.consume(b.n),this._navigation=this.resources.consume(V.e)}return e.prototype.getFetchUrl=function(e,t,n){var a="".concat(e.sortField?T.e[e.sortField]:T.e.defaultValue),i=null===e.isAscending||void 0===e.isAscending?P.e.defaultValue.toString():e.isAscending?P.e.ascending.toString():P.e.descending.toString(),r=this._urlDataSource.getKeyParams(e.parentKey),o=this._urlDataSource.getQueryType(r);Object(R.e)(o)&&(e.groupingType=0);var s=1===e.groupingType?"0,1,2":"0",c={caller:U.t.viewerId,sb:n?"":a,ps:e.pageSize,sd:i,gb:s,d:"1",m:z.e.mkt,iabch:"1",pi:"5",path:1,lct:1,rset:U.t.scenarioName,v:t};(n||Object(W.isFeatureEnabled)(W.UsePagingTokenForSearch)&&o===h.e.Search)&&(c.pagingToken=e.requestToken||""),K.get("BadgerAuth")||(c.urlType=0),e.startKey?c.sid=this._urlDataSource.getKeyParams(e.startKey).id:void 0!==e.startIndex&&(c.si=e.startIndex);var d=this._urlDataSource.getAuthKeyParamValue(),l=this._urlDataSource.getTicketParamValue(),u=this._urlDataSource.getReferrer();d&&(c.authKey=d),l&&(c.ticket=l),Object(R.e)(o)&&u&&(c.searchreferrer=u),e.filters&&(e.filters.tagFilter&&(c.tagFilter=e.filters.tagFilter),e.filters.locationFilter&&(c.tagFilter=e.filters.locationFilter));var f=e.parentKey||"",p=this._urlDataSource.getKeyParams(f);return delete p.u,o===h.e.Recent&&delete p.ext,Object(R.e)(o)&&!p.sp&&(c.includeSharedItems=1),p.sp&&(c.searchpassthru="sortby=largestsize",delete p.sp),n&&o===h.e.RecycleBin&&(p.qt="recyclebinv2"),5!==this._urlDataSource.getAppliedDateFilter()&&delete p.endDate,U.t.skyApiBaseUrl+"GetItems?"+N.n(p,c)},e.prototype.triggerGetItemsIfApplicable=function(e,t){var n=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams),a=this._urlDataSource.getKeyParams(n);if(this._urlDataSource.getQueryType(a)===h.e.Files&&!this._navigation.viewParams.v){var i=new l.e,r=new(this.resources.injected(B.e)),o={};o["X-SkyApiOriginId"]=t;var s=r.getDefaultGetItemContext(this._navigation.viewParams);s.skipCache=!0;var c=this.getRequestVersion(s),d=this.getFetchUrl(s,c,!1);j.n.mark("Prefetch.GetItems.Started"),e[d]=i.send({apiName:"GetItems",url:d,headers:o,isErrorExpectedCallback:G.e}).then(function(e){return j.n.mark("Prefetch.GetItems.Done"),e}),this.persistResultVersion(s,c)}},e.prototype.getRequestVersion=function(e){var t=Q(e.ownerId),n=t?JSON.parse(this._getLocalStorageValue(t)||"{}"):{},a=String(Math.random()),i=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(i);return e.skipCache||r===h.e.RecycleBin?a:n[e.parentKey&&e.parentKey.toLowerCase()]||a},e.prototype.persistResultVersion=function(e,t){if(e.ownerId){var n=Q(e.ownerId),a=JSON.parse(this._getLocalStorageValue(n)||"{}");a[e.parentKey.toLowerCase()]=t,this._persistResultVersion(n,JSON.stringify(a))}},e.prototype.removeBrowserCacheResultVersion=function(e,t){if(e){var n=Q(e),a=JSON.parse(this._getLocalStorageValue(n)||"{}");delete a[t.toLowerCase()],this._persistResultVersion(n,JSON.stringify(a))}},e.prototype._persistResultVersion=function(e,t){try{window.localStorage[e]=t}catch(e){}},e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}},e}();function Q(e){return e&&"OneDrive.GetItemsVersionLookup.".concat(e.toLowerCase())}var Y={},J=String(Math.random()),X=n(3845),Z=n(1886),$=n(2030),ee=n(1834),te=n(3136),ne=n(8),ae=n(9),ie=n(76),re=n(332),oe=n(124),se=n(95),ce=n(25),de=n(10),le=0,ue=function(e){function t(){var t=e.call(this)||this;return t._itemDataSourceHelper=new(t.managed(q)),t.isLargeRecycleBin=f.observable(!1),t._pendingGetItemRequests={},t._itemsStore=t.resources.consume(M.e),t._urlDataSource=t.resources.consume(b.n),t._identity=t.resources.consume(g.D),t._itemResultProcessor=new(t.managed(u.e))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)}),t._itemErrorProcessor=new(t.managed(F.e)),t._rotationSemaphore=new Z.e,t}return Object(a.__extends)(t,e),t.getServerDocumentType=function(e){var t;switch(e){case m.e.Word:t="w";break;case m.e.Excel:t="x";break;case m.e.PowerPoint:t="p";break;case m.e.OneNote:t="n";break;case m.e.ExcelSurvey:t="f"}return t},t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)},t.prototype.getSpecifiedItems=function(e){return null},t.prototype.getColumns=function(e,t){return void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer)),x(e,this.resources,t)},t.prototype.deleteItems=function(e){var t=this,a=this._urlDataSource.getKeyParams(e.parentKey);if(Object(se.e)(ie.l)&&Object(W.isFeatureEnabled)(W.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===a.qt||["places".toString(),"tags".toString()].indexOf(a.id)>=0)){var i=this.resources.consume(re.e);return new r.n(function(t,a){n.ee(43,4828).then(function(t){var n=t.deleteItems;return i.dispatch(n({items:Object(oe.e)(e.items,function(e){return{currentItemSetKey:e.graph.itemId}},function(e){return ae.e.serialize({endpoint:Object(ie.a)("v2.0"),driveId:e.graph.driveId,itemId:e.graph.itemId})})}))}).then(function(){t(e.items.map(function(e){return e.graph.itemId}))}).catch(function(e){a(e)})})}var o=e.items;return o&&o[0].key&&!o[0].id&&(o=o.map(function(e){return t._itemsStore.getItem(e.key).peek()})),d.e.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:o,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:p.e.Recycle,targetId:a.id,cid:U.t.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++)n[t].eTag=""}})},t.prototype.renameItem=function(e){var t=this,a=this._urlDataSource.getKeyParams(e.parentKey),i=e.item.name,o=e.newName+e.item.extension,s=e.item.extension;if(e.nameHasExtension){var c=e.newName.lastIndexOf(".");c>0&&(s=e.newName.substr(c+1),Array.isArray(z.t.createTextDocumentExts)&&z.t.createTextDocumentExts.indexOf(s)>=0&&(o=e.newName))}if(Object(se.e)(ie.l)&&Object(W.isFeatureEnabled)(W.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===a.qt||["places".toString(),"tags".toString()].indexOf(a.id)>=0)){var d=this.resources.consume(re.e),u=ae.e.serialize({endpoint:Object(ie.a)("v2.0"),driveId:e.item.graph.driveId,itemId:e.item.graph.itemId});return new r.n(function(t,a){return n.ee(9,4829).then(function(t){var n,a,i=t.renameItem;return d.dispatch(i({items:(n={},n[u]={names:(a={},a[e.item.name]={newName:e.newName,newExtension:s},a)},n)}))}).then(function(){t(e.newName)}).catch(function(e){a(e)})})}var f=this._getUpdateItemsUrl(),p=new l.e,m=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:o,lid:a.id,rset:U.t.scenarioName,ownerId:e.ownerId});return p.send({apiName:"UpdateItem",url:f,requestType:"POST",postData:m,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){if(t.resources.consume(ee.n)){var a=e.item.id;e.item.isAlbum&&void 0!==a&&t.resources.consumeAsync(te.e).then(function(e){e.invalidateAlbumName(a)})}return n},function(e){return r.n.wrapError(t._itemErrorProcessor.getError(e,i).errorTitle)})},t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new l.e).send({apiName:"GetOpenInClientDetails",url:t})},t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new l.e,a=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:U.t.viewerId});return n.sendPost("UpdateItem",t,a)},t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),a=new l.e,i=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:U.t.viewerId,group:0,desc:e.desc,ref:window.location.href,photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||H.a.File});return a.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return r.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),a=window.$Config,i=new l.e,o=JSON.stringify({email:a.email,ids:e.items.map(function(e){return e.id}),photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||H.a.File});return i.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:o,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return r.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),a=new l.e,i=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return a.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return r.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new l.e,a=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,a)},t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new l.e,a=e.items.map(function(e){return e.id}),i=JSON.stringify({items:a,targetId:e.target.id,cid:U.t.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)},t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new l.e,a=e.items.map(function(e){return e.id}),i=JSON.stringify({items:a,targetId:e.target.id,cid:U.t.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)},t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new l.e,a=JSON.stringify({id:e.item.id,category:e.category,cid:U.t.viewerId});return n.sendPost("UpdateItem",t,a)},t.prototype.updateItemProperty=function(e){var t,n,a=this._getUpdateItemsUrl(),i=new l.e;Object(W.isFeatureEnabled)(W.UseItemsScopeInOneDrive)&&(n=N.e(e.item.parentKey));var r={id:e.item.id,lid:(null===(t=e.item.UNSAFE_parent)||void 0===t?void 0:t.id)||(null==n?void 0:n.id),overrideLock:(!!e.overrideLock).toString(),rset:U.t.scenarioName};r[e.propertyName]=e.propertyValue||"";var o=e.qosPostfix?"UpdateItem_"+e.qosPostfix:"UpdateItem";return i.sendPost(o,a,JSON.stringify(r))},t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),a=this._urlDataSource.getKeyParams(e.parent.key),i=new l.e,o=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var s=0,c=e.selectedPeople;s<c.length;s++){var d=c[s];o.push({role:2,type:0,email:d.email})}var u={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:o},f=JSON.stringify({parentId:a.id,cid:a.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?u:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return i.send({apiName:"AddFolder",url:n,requestType:"POST",postData:f,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var a=new(t.resources.consume($.a)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:h.e.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:a});return a.flush(),i?a.getItem({key:i.item.key}):null},function(e){return r.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.createDocument=function(e,n,a){var i=this;if(n===m.e.Text)return r.n.wrap(this._createTextDocument(e));var o=this._getCreateDocumentUrl(),s=t.getServerDocumentType(n),c=new l.e,d=this._urlDataSource.getKeyParams(e),u=JSON.stringify({parentId:d.id,nameConflict:a?0:2,overrideLock:!1,cid:d.cid,group:0,name:a,docType:s});return c.send({apiName:"CreateDocument",url:o,requestType:"POST",postData:u,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var a="";if((t=t.items||t.item)&&t.length>0){var r=new(i.resources.consume($.a)),o=i._getItemResult({requestKey:e,itemFromServer:t[0],queryType:h.e.Files,isPrimaryRequestedItem:!0,observer:r});r.flush(),a=(a=r.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view",""),n===m.e.OneNote&&(a+="&nd=1")}return a},function(e){return r.n.wrapError(i._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.createCustomDocument=function(e,t,n){return null},t.prototype.createShortcut=function(e,t,n){return null},t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(b.n).getCreateTextDocumentUrl(t.id,t.cid)},t.prototype.createDocumentInTab=function(e,n,a){var i=t.getServerDocumentType(e);return e===m.e.Text?this._createTextDocument(n.key):this.resources.consume(b.n).getCreateDocumentInTabUrl(n,i,a)},t.prototype.getFilterData=function(e,t,n){return null},t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return d.e.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var a={targetId:t.id,cid:U.t.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===c.e?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};return e.nameConflict&&(a.nameConflict=e.nameConflict),a}})},t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new l.e;return new r.n(function(e,a){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},a)})},t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())},t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())},t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),a=new l.e,i=[],r=0;r<e.items.length;r++)i.push(e.items[r].id);return t=JSON.stringify({items:i}),a.sendPost("RemoveFromMRU",n,t)},t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),a=new l.e;return t=JSON.stringify({id:e.item.properties.ghostId||e.item.id}),a.sendPost("RemoveMountPoint",n,t)},t.prototype.createMountPoint=function(e){var t,n=this,a=this._getCreateMountPointUrl(),i=new l.e,o=this._urlDataSource.getAuthKeyParamValue();return t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:o}),i.sendPost("MountFolder",a,t).then(function(e){var t=new(n.resources.consume($.a)),a=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:h.e.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;return t.flush(),a?t.getItem({key:a.key}):null},function(e){return r.n.wrapError(e)})},t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new l.e;return(e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{progress:e.progress.map(function(e){var t,n,i;if("Completed"===e.status){var r=e.targetResourceId;if(r){var o=Object(ce.a)(((t={}).id=r,t));i={key:Object(de.y)(((n={}).cid=o,n.id=r,n))}}}return Object(a.__assign)(Object(a.__assign)({},e),{createdItem:i})})})})},t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();return(new l.e).sendPost("CancelWork",t,JSON.stringify(e)),r.n.wrap(!0)},t.prototype.getItemOcrTextContent=function(e){var t=new l.e,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",U.t.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return o.e.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})},t.prototype.updateItemOcrInfo=function(e,t,n){var a,i=this._getUpdateItemsUrl(),r=new l.e,o=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:null===(a=e.UNSAFE_parent)||void 0===a?void 0:a.id,rset:U.t.scenarioName});return r.sendPost("UpdateItem",i,o)},t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),a=new l.e,i={inviterId:e};return t&&""!==t&&(i.inviteSrc=t),a.sendPost("ProcessReferral",n,JSON.stringify(i))},t.prototype.rotateItems=function(e){for(var t=this,n=new(this.resources.consume($.a)),i=this._getRotateItemUrl(),o=[],s=function(s){var d=c.peekUnwrapObservable(c._itemsStore.getItem(s.key)),u=++le;if(d.thumbnail){var f=d.orientedThumbnail;f=f?Object(a.__assign)(Object(a.__assign)({},f),{rotation:f.rotation+e.rotation,version:u}):{rotation:e.rotation,thumbnail:Object(a.__assign)({},d.thumbnail),version:u},n.update([new $.t(s.key).succeed({item:{key:s.key,orientedThumbnail:$.e.replace(f)}})])}var p=new l.e,m=JSON.stringify({targetId:s.id,numberOfClockwiseRotations:-e.rotation,cid:U.t.viewerId,rset:U.t.scenarioName});o.push(c._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",i,m).then(function(e){var a=t.peekUnwrapObservable(t._itemsStore.getItem(s.key)),i=a.itemFromServer&&a.itemFromServer.commands;e.item.commands=i||e.item.commands,t._itemResultProcessor.processItemResult({observer:n,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:s.key});var r=a.orientedThumbnail;return r&&r.version===u&&n.update([new $.t(s.key).succeed({item:{key:s.key,orientedThumbnail:$.e.remove()}})]),a},function(a){var i=t.peekUnwrapObservable(t._itemsStore.getItem(s.key)).orientedThumbnail;i&&(i=i.version===u?$.e.remove():{rotation:i.rotation-e.rotation},n.update([new $.t(s.key).succeed({item:{key:s.key,orientedThumbnail:i}})]));var o=new Error(a.data.message);return o.data={key:s.key,error:a.data},r.n.wrapError(o)})}))},c=this,d=0,u=e.items;d<u.length;d++)s(u[d]);return n.flush(),r.n.all(o).then(function(e){if(n.flush(),t.resources.consume(ee.n))for(var a=function(e){var n=N.e(e.key);t.resources.consumeAsync(g.k).then(function(e){e.invalidateItems(N.n(n))})},i=0,r=e;i<r.length;i++)a(r[i]);return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));return n&&n.UNSAFE_parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.UNSAFE_parent.key),n})},function(e){n.flush();var t=new Error;return t.data=Object.keys(e).map(function(t){return e[t].data}),r.n.wrapError(t)})},t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),a=new l.e,i={id:e.item.id,authKey:t};return a.sendPost("RedeemPermissionToken",n,JSON.stringify(i))},t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==U.t.viewerId});return 0===t.length?r.n.wrap(null):d.e.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:U.t.viewerId,ids:e.map(function(e){return e.id})}}})},t.prototype.getRootItemTitle=function(e){return s.e},t.prototype._getRootFileId=function(){return"root"},t.prototype._getParentItemId=function(){return""},t.prototype._getItemKeyExtension=function(e,t){var n,a=this._urlDataSource.getKeyParams(t);return a.id===e.id?a:e.folder?((n={}).ft=a.ft,n.ext=a.ext,n):{}},t.prototype._handleMoveCopyApiRequest=function(e,t,n){for(var i,o=new l.e,s=t.items.map(function(e){return e.id}),c=Object(X.e)(t),d=[],u=new Z.e,f=function(){var r=s.splice(0,100);c.items=r;var l=JSON.stringify(c);!1!==t.ackMoveIfShared&&(i={prefer:"Block-Move-Into-Vault-If-Shared"});var f=u.enqueue(function(){return o.send({apiName:e,url:n,requestType:"POST",headers:i,postData:l,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[Object(a.__assign)(Object(a.__assign)({},e),{error:e.data})]}})});d.push(f)};s.length;)f();return r.n.all(d).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})},t.prototype._getItem=function(e,t,n){var i,o=this,s=String(Math.random()),c=((i={})["X-SkyApiOriginId"]=s,i),d=this._pendingGetItemRequests[e];if(!d){var u=Y[e];u&&(s=J,delete Y[e]);var f=void 0;f=!ne.e.isActivated("4AE305A7-991F-4556-87DE-C1DDF1D5F01A","10/21/2021","Override invalid SkyAPI root item request")&&this._isInvalidRootItemRequest(e)?this._getMockItemNotFoundResponse(e):!n.skipCache&&u||(new l.e).send({apiName:"GetItems",qosName:n.qosName,url:e,headers:c,isErrorExpectedCallback:G.e});var p=!1;d=f.then(function(i){p=!0,j.n.mark("ItemsDataSource.GetItems.Normalizing");var r,c=i.originId,d=i.items||i.item&&[i.item]||[];if(d&&d.length>0){for(var l=new(o.resources.consume($.a)),u=void 0,f=d.length-1;f>=0;f--){var m=0===f;if(!d[0].isBundle||m){var h=f>0,b=o._getItemResult({observer:l,requestKey:n.parentKey,itemFromServer:d[f],queryType:n.queryType,requestMetadata:{tokenNeedsRedeeming:i.tokenNeedsRedeeming,tokenType:i.tokenType,restoreAllWorkItemCount:i.restoreAllWorkItemCount||0,deleteAllWorkItemCount:i.deleteAllWorkItemCount||0},setItemKey:!h,skipSettingChildren:h,isPrimaryRequestedItem:m});m&&(u=b)}}if(l.flush(),u&&u.item){var g=l.getItem({key:u.item.key}),v=d[0],y=o._getDefaultSortInformation(v);if(n.sortField){var S=y&&y.defaultSortField;y={sortField:n.sortField,defaultSortField:S,isAscending:n.isAscending,isSortEnabled:!o.isLargeRecycleBin.peek()}}var D=void 0;y&&(D=y.isAscending);var I=c!==s;I||g.type!==_.e.Folder||o._itemDataSourceHelper.persistResultVersion(n,t);var C=x(g,o.resources,y),O=void 0;if(C&&y)for(var w=0,E=C;w<E.length;w++){var A=E[w];if(A.internalName===y.sortField){O=A.key;break}}r=Object(a.__assign)(Object(a.__assign)({},u),{schema:C,startIndex:v.folder?v.folder.startIndex:n.startIndex,isFromBrowserCache:I,sortField:O,isAscending:D})}}return delete o._pendingGetItemRequests[e],r},function(t){delete o._pendingGetItemRequests[e];var a=new(o.resources.consume($.a)),i=o._itemErrorProcessor.processError({requestKey:n.parentKey,error:t,observer:a}).error;return a.flush(),r.n.wrapError(i)}),p||(this._pendingGetItemRequests[e]=d)}return d},t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}},t.prototype._getDefaultSortInformation=function(e){var t;return e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(T.e).length/2>e.folder.defaultSort&&(t={sortField:T.e[e.folder.defaultSort],defaultSortField:T.e[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===P.e.ascending.toString(),isSortEnabled:!0}),t},t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)},t.prototype._getCreateDocumentUrl=function(){return U.t.skyApiBaseUrl+"CreateDocument"},t.prototype._getCreateFolderUrl=function(){return U.t.skyApiBaseUrl+"AddFolder?lct=1"},t.prototype._getDeleteItemsUrl=function(){return U.t.skyApiBaseUrl+"DeleteItems"},t.prototype._getUpdateViewCountUrl=function(){return U.t.skyApiBaseUrl+"UpdateViewCount"},t.prototype._getRestoreItemsUrl=function(){return U.t.skyApiBaseUrl+"RestoreItems"},t.prototype._getOpenInClientDetailsUrl=function(){return U.t.skyApiBaseUrl+"GetOpenInClientDetails"},t.prototype._getRequestReviewUrl=function(){return U.t.skyApiBaseUrl+"OwnerRequestReview"},t.prototype._getReportAbuseUrl=function(){return U.t.skyApiBaseUrl+"ReportAbuse"},t.prototype._getRemoveFromSharedListUrl=function(){return U.t.skyApiBaseUrl+"AbdicatePermissions"},t.prototype._getAddCoverPhotoUrl=function(){return U.t.skyApiBaseUrl+"AddFavorites"},t.prototype._getRemoveCoverPhotoUrl=function(){return U.t.skyApiBaseUrl+"RemoveFavorites"},t.prototype._getUpdateItemsUrl=function(){return U.t.skyApiBaseUrl+"UpdateItem?lct=1"},t.prototype._getUpdateBundleUrl=function(){return U.t.skyApiBaseUrl+"UpdateBundle"},t.prototype._getCopyItemsUrl=function(){return U.t.skyApiBaseUrl+"CopyItemsAsync"},t.prototype._getMoveItemsUrl=function(){return U.t.skyApiBaseUrl+"MoveItems"},t.prototype._getRemoveFromRecentUrl=function(){return U.t.skyApiBaseUrl+"RemoveFromMRU"},t.prototype._getRemoveMountPointUrl=function(){return U.t.skyApiBaseUrl+"RemoveMountPoint"},t.prototype._getCreateMountPointUrl=function(){return U.t.skyApiBaseUrl+"AddFolder"},t.prototype._getRestoreAllUrl=function(){return U.t.skyApiBaseUrl+"RestoreAll"},t.prototype._getWorkProgressUrl=function(e){return U.t.skyApiBaseUrl+"GetWorkProgress?type="+e.type},t.prototype._getRotateItemUrl=function(){return U.t.skyApiBaseUrl+"ChangeImageOrientation"},t.prototype._getCancelWorkUrl=function(){return U.t.skyApiBaseUrl+"CancelWork"},t.prototype._getProcessReferralUrl=function(){return U.t.skyApiBaseUrl+"ProcessReferral"},t.prototype._getRedeemPermissionTokenUrl=function(){return U.t.skyApiBaseUrl+"RedeemPermissionToken"},t.prototype._isInvalidRootItemRequest=function(e){var t=new URL(e);return"root"===t.searchParams.get("id")&&t.searchParams.has("caller")&&t.searchParams.has("cid")&&!U.t.areCidsEqual(t.searchParams.get("caller"),t.searchParams.get("cid"))},t.prototype._getMockItemNotFoundResponse=function(e){return r.n.reject({message:"Promise failed without error handler",url:e,status:500,data:{code:3e3,debugMessage:"Item not found or access denied.",isExpected:!0,message:"This item might have been deleted, expired, or you might not have permission to access it. Contact the owner of this item for more information.",stackTrace:""}})},t}(i.n);t.e=ue}],Array(17),[function(e,t,n){"use strict";n.d(t,"a",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"n",function(){return b}),n.d(t,"t",function(){return g});var a=n(75),i=n(47),r=n(77),o=n(1834),s=n(3488),c=n(3489),d=n(1914),l=n(1822),u=function(){function e(){}return e.executeOpenInClient=function(t,n){return e._item=t.item,e._provider=n.consume(l.resourceKey),t.isDavUrl?(e._openInClient(t),a.n.wrap({resultType:i.t.Success})):e._getOpenInClientDetails(t)},e._getOpenInClientDetails=function(t){return e._provider.getOpenInClientDetails(e._item).then(function(n){if(n){var r=n.davUrl;t.url=r,t.isDavUrl=!0,e._openInClient(t)}return a.n.wrap({resultType:i.t.Success})})},e._openInClient=function(e){if(!e.useDirectInvoke){var t=c.e.OpenDocumentMode.WriteOnly;e.item.sharingRole===d.e.View&&(t=c.e.OpenDocumentMode.ReadOnly),e.appType===s.e[7].toString()&&(t=c.e.OpenDocumentMode.WriteOnly);var n=c.e.OpenDocumentOptions.None;e.Mode=t,e.Options=n;var a={DocumentUrl:e.url,Mode:t,Options:n,Application:c.e.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};c.e.EditDocumentInClient(a,null,null)}},e}(),f=n(102),p=n(144),m=!n(8).e.isActivated("6FFA2C0E-77D3-4E3F-9C8D-DD5834567BC5","05/20/2022","Invalidate itemCache as part of SkyApiHelper.refreshItemWhenVisible");function _(e,t,n){return function(e,t,n){var o;return o=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a&&a.tokenNeedsRedeeming)return!0}return!1}(e)||n?function(e,t){return a.n.resolve(e.resources.consumeAsync(r.ve)).then(function(n){return n.startRedeem(e,t)},function(e){return a.n.reject({})})}(t,e[0]):a.n.wrap({resultType:i.t.Success}),o}([e],t,n)}function h(e,t,n,a,i){var r;e.type===p.e.OneNote&&(r=e.urls.oneNoteClient);var o={url:r,isDavUrl:!!r,fileName:e.name,iconType:e.iconName,appType:a,extension:a===s.e[2].toString()?".one":e.extension,item:e};return u.executeOpenInClient(o,i)}function b(e){var t=v(),n=t?t+"Hidden":"hidden",a=t+"visibilitychange",i=new f.t(this),r=window.document;if(n){var o=function(){r[n]||(i.off(r,a,o),e(!0))};i.on(r,a,o)}}function g(e,t,n){var a=v(),i=a?a+"Hidden":"hidden",s=a+"visibilitychange",c=new f.t({}),d=window.document;if(i){var u=function(){d[i]||(c.off(d,s,u),t.consume(l.resourceKey).invalidateItem(e.key,{triggerFetch:n}),m&&t.consume(o.u.lazy)&&t.consumeAsync(r.k).then(function(t){t.invalidateItems(e.key)}))};c.on(d,s,u)}}function v(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}}],Array(28),[function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a,i=n(0),r=n(2890),o=((a={})[r.n]="1",a[r.a]="1",a[r.b]="3",a[r.h]="1",a[r.g]="3",a[r.y]="3",a[r.D]="1",a[r.w]="1",a[r.k]="1",a[r.H]="1",a[r.j]="1",a),s=[".jfif",".jfif-tbnl",".jpe",".jpg",".jpeg"];function c(e){var t;return Object(i.__assign)(Object(i.__assign)({},e),{properties:{commandsSupported:Object(i.__assign)(Object(i.__assign)({},o),e.extension&&d(e.extension)?(t={},t[r.F]="1",t):{})}})}function d(e){return s.some(function(t){return e.toLowerCase()===t})}},function(e,t,n){"use strict";var a;!function(e){e[e.defaultValue=0]="defaultValue",e[e.displayName=1]="displayName",e[e.dateModified=2]="dateModified",e[e.dateCreated=3]="dateCreated",e[e.size=4]="size",e[e.itemType=5]="itemType",e[e.dateTaken=6]="dateTaken",e[e.owner=7]="owner",e[e.userArranged=8]="userArranged",e[e.dateAccessed=9]="dateAccessed",e[e.relevancy=10]="relevancy",e[e.dateDeleted=11]="dateDeleted",e[e.location=12]="location",e[e.dateShared=13]="dateShared",e[e.sharer=14]="sharer"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a;!function(e){e[e.ReferralBonus=10070]="ReferralBonus",e[e.Office3651=10100]="Office3651",e[e.OneDriveStorageAddOn=10150]="OneDriveStorageAddOn",e[e.OneDrive100=10151]="OneDrive100",e[e.OneDriveModern20=10152]="OneDriveModern20",e[e.OneDriveModern200=10153]="OneDriveModern200",e[e.BingBonus=10560]="BingBonus",e[e.CameraRollBonus=11101]="CameraRollBonus",e[e.EnthuBonus1=12007]="EnthuBonus1",e[e.EnthuBonus2=12011]="EnthuBonus2",e[e.Free=20010]="Free",e[e.Loyalty=20011]="Loyalty"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(2333),i=new a.e("removeFromRecent"),r=new a.e("addCoverPhoto"),o=new a.e("removeCoverPhoto")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(7),r=n(135),o=new i.t({name:"HiddenDomProvider.key",loader:new r.t(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([356],4691)];case 1:return[2,e.sent().resourceKey]}})})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(2333).e)("defaultClick")},function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(75),o=n(47),s=n(3492),c=n(32),d=n(1829),l=n(2893),u=function(e){function t(t){var n=e.call(this,t)||this;return n.name="Sort",n._sortManager=n.resources.consume(d.c),n._currentItemSet=n.resources.consume(c.o),n._mode=t.mode,n._column=t.column,n._ascending=t.ascending,n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=s.e.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=n);var a={sortMode:l.e[this._mode],sortAscending:"Ascending"};return this._column&&(a.sortColumn=this._column.internalName||this._column.key),this._mode===l.e.Column?this.updateCurrentSort(this._column,n.isAscending):this._mode===l.e.Order?this._currentItemSet&&this._currentItemSet().schema&&(a.sortAscending=this._ascending?"Ascending":"Descending",this.updateCurrentSort(n,this._ascending)):r.n.wrap({resultType:o.t.Failure}),r.n.wrap({resultType:o.t.Success,extraData:a})},t.prototype.onIsAvailable=function(){return!!this._currentItemSet&&!this._isVaultLocked()&&!!s.e.getSortedColumn(this._currentItemSet().schema)},t.prototype.onIsToggled=function(){var e=!1;if(this._mode===l.e.Column&&this._column)e=this._column.isSorted;else if(this._mode===l.e.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=s.e.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return!this._isVaultLocked()&&e},t.prototype.updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}},t.prototype._isVaultLocked=function(){var e=this._currentItemSet&&this._currentItemSet().item();return e&&e.vault&&e.vault.isLocked},t}(i.e);t.e=u},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(59),r=new a.t({name:"".concat("UploadedItemResourceKey",".UploadedItem"),factory:{dependencies:{observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(27),r=new a.t({name:"DeeplinkCommentId.key",factory:{dependencies:{},create:function(){return{instance:i.observable({})}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"VaultStore.key",loader:new i.t(function(){return n.ee(1,3580).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";var a=n(0),i=n(75),r=n(59),o=n(3),s=Object(o.cs)(o.Wa),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odc/DeferredControls",getModule:function(){return i.n.resolve(s?void 0:n.ee([586,"ondemand.resx-ondemand"],4138))},isLoaded:this.createObservable(!1)},e[2]={path:"../../../bundles/odc/Quota",getModule:function(){return i.n.resolve(s?void 0:n.ee(14,4154))},isLoaded:this.createObservable(s)},e[3]={path:"../../../bundles/odc/PushChannel",getModule:function(){return i.n.resolve(s?void 0:n.ee([604],3958))},isLoaded:this.createObservable(!1)},e[4]={path:"../../../bundles/odc/FirstRun",getModule:function(){return i.n.resolve(s?void 0:n.ee([595,"ondemand.resx-ondemand"],4182))},isLoaded:this.createObservable(s)},e},t}(r.n);t.e=c},function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cancelled=0]="Cancelled",e[e.CancelPending=1]="CancelPending",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed",e[e.NotStarted=4]="NotStarted",e[e.InProgress=5]="InProgress",e[e.Unknown=6]="Unknown"}(a||(a={}))}],Array(38),[function(e,t,n){"use strict";n.r(t),n.d(t,"STORAGE_KEY_EXPIRATION",function(){return H}),n.d(t,"resourceKey",function(){return V});var a=n(0),i=n(59),r=n(70),o=n(77),s=n(156),c=n(1123),d=n(152),l=n(302),u=n(193),f=n(1904),p=n(1827),m=n(1834),_=n(3580),h=n(1187),b=n(82),g=n(75),v=n(2334),y=n(43),S=n(106),D=n(1822),I=n(135),x=n(1903),C=n(1145),O=n(2765),w=n(4354),E=n(73),A=n(139),L=n(3),k=n(840),M=n(284),P=n(25),T=n(95),U=n(76),F=n(1066),H="expirationtime",R="vaultMenuCalloutMessageShow",N=1200,B=["ManageVault","Restore","RansomwareDetection"],j=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._clientName=n.clientName,a._identityDataSource=n.identityDataSource,a._vroomDataRequestor=n.vroomDataRequestor,a._itemStore=n.itemStore,a._navigation=n.navigation,a._urlDataSource=n.urlDataSource,a._itemProvider=n.itemProvider,a._dialogProvider=n.dialogProvider,a._userInfoProvider=n.userInfoProvider,a._itemParentHelper=n.itemParentHelper,a._bundleLoader=n.bundleLoader,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._vaultStore=n.vaultStore,a._storageKeyPrefix=a._vaultStore.storageKeyPrefix,a._dataStore=a._vaultStore.dataStore,a._isVaultOpen=a._vaultStore.isVaultOpen,a._vaultFreState=a._vaultStore.vaultFreState,a._vaultSuggestCardState=a.createObservable(0),a._vaultQuota=a._vaultStore.vaultQuota,a._quotaLoaded=a.createComputed(a._computeQuotaLoaded),a._isVaultDisabled=a._vaultStore.isVaultDisabled,a._isLocking=!1,a._isOneDriveWinApp=Object(A.e)(),a.isOverQuota=a._vaultStore.isOverQuota,a._showVaultLockNotification=a._vaultStore.showVaultLockNotification,a._showVaultFreMessage=a._vaultStore.showVaultFreMessage,a.createComputed(a._calculateFreMessage),a.events.on(window,"storage",a._onStorageChange),a.createBackgroundComputed(a._updateVaultQuota),a.fetchIsVaultDisabled(),a._isVaultOpen.peek()&&(a._getExpiration()<Date.now()?a.lockVault(void 0,!0):a._handleVaultUnlock()),a}return Object(a.__extends)(t,e),t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))},t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))},t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))},t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))},t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))},t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))},t.prototype.getVaultItem=function(){return this._vaultItem},t.prototype.isVaultOpen=function(){return this._isVaultOpen},t.prototype.isVaultDisabled=function(){return this._isVaultDisabled},t.prototype.freState=function(){return this._vaultFreState},t.prototype.suggestCardState=function(){return this._vaultSuggestCardState},t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()},t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1),t||this._showVaultFreMessage(e),this._setVaultIconFre(e)},t.prototype.unlockVault=function(e,t){var n=this;return this.getVault(!1,!0).then(function(i){if(!i||!i.vault||i.vault.isLocked||e){var r;r=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?g.n.resolve({wlidToken:t}):g.n.resolve({accessToken:t});var o={};return n._isOneDriveWinApp&&(o.Prefer="Include-Feature=Vault"),Object(L.cs)(L.r)&&(o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},o),{Scenario:M.e.OpenVault,ScenarioType:M.t.ActiveUserOperation}),n._clientName?{Application:n._clientName}:{})),r.then(function(t){return n._vroomDataRequestor.send(Object(a.__assign)({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:o,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}},Object(L.cs)(L.Yr)&&Object(T.e)(U.l)?n.getUnlockVaultV2RequestData():{})).then(function(){if(n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:N}),!e){var t=n._urlDataSource.getRootItemKey();n._invalidateItems(t)}return g.n.resolve({})}).catch(function(e){return n._handleVaultLock(),g.n.reject(e)})})}n.setVaultLockState(i.vault,!!t)})},t.prototype.setVaultLockState=function(e,t,n){if(void 0===t&&(t=!1),!this._isLocking){var a=this._isVaultOpen.peek(),i=e.isLocked;if(i||a)i&&a&&this._handleVaultLock(!1,n);else{var o=e.expirationInSeconds||N,s=Date.now()+1e3*o;this._dataStore.setValue(H,s,r.e.local),this._handleVaultUnlock(t)}}},t.prototype.lockVault=function(e,t){var n=this;if(this._isLocking=!0,this._navToRootIfInVault(),e){var i=this._urlDataSource.getPageType(this._navigation.viewParams),r=this._urlDataSource.getQueryType(this._navigation.viewParams);s.e.logData({name:"Vault.Autolocked",extraData:{location:Object(v.i)(i,r)}})}var o=this._vaultItem?g.n.resolve(this._vaultItem):this.getVault(),c={};return this._isOneDriveWinApp&&(c.Prefer="Include-Feature=Vault"),Object(L.cs)(L.r)&&(c=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},c),{Scenario:M.e.CloseVault,ScenarioType:M.t.ActiveUserOperation}),this._clientName?{Application:this._clientName}:{})),o.then(function(i){return n._vroomDataRequestor.send(Object(a.__assign)({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:c,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}},Object(L.cs)(L.Yr)&&Object(T.e)(U.l)?n.getLockVaultV2RequestData():{})).then(function(){n._isLocking=!1,n._handleVaultLock(t)}).catch(function(e){return n._isLocking=!1,403===e.status?n._handleVaultLock(t):n._showLockFailed(),n._isExpectedError(e)?g.n.resolve():g.n.reject(e)})})},t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)},t.prototype.extendLock=function(){return this.unlockVault(!0)},t.prototype.getVault=function(e,t,n,a){var i=this,r={};return e&&(r.Prefer="auto-create-special-folder"),this._isOneDriveWinApp&&(r.Prefer=r.Prefer+",Include-Feature=Vault"),n=n||"GET",(Object(T.e)(U.l)?Object(L.cs)(L.Yr)?i.getVaultV2(e,a):g.n.reject(new Error("vault is not supported")):this._vroomDataRequestor.send({apiName:a?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:r,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)})).then(function(e){var t,n;return e&&((null===(n=null===(t=null==e?void 0:e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.id)&&(e.createdBy.user.id=e.createdBy.user.id.toUpperCase()),i._vaultItem=e),e}).catch(function(e){return t?null:g.n.reject(e)})},t.prototype.getQuota=function(){var e=this,t={};return this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault"),this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"}).then(function(t){var n=t&&t.quota&&t.quota.vault;return e._vaultQuota(n),n})},t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===h.a.Created)return e.getVault(!0).then(function(t){e.setVaultState(h.a.Created),e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s),e._vaultSuggestCardState(n.c)})},t.prototype.fetchIsVaultDisabled=function(){var e=this;return void 0!==this._isVaultDisabledPromise||(this._isVaultDisabledPromise=this._userInfoProvider.getUserFact(46).then(function(t){return t||Object(L.cs)(L.Yr)&&Object(T.e)(U.l)?e.getVault(!1,!1,"HEAD").then(function(){return e._isVaultDisabled(!1),!1}).catch(function(t){var n=404===t.status;return e._isVaultDisabled(n),n}):(e._isVaultDisabled(!0),!0)})),this._isVaultDisabledPromise},t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),e._isVaultDisabled(!1),t})},t.prototype.disableVault=function(e){var t=this;if(Object(L.cs)(L.Yr)&&Object(T.e)(U.l))return e?this.disableVaultV2():g.n.resolve("confirmToken");var n={};return e&&(n.If="(<".concat(e,">)")),this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault"),this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new E.t(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n)return n}return g.n.reject(e)})},t.prototype.setVaultState=function(e,t){var n=void 0;void 0!==e&&e>this._vaultFreState.peek()&&(this._vaultFreState(e),n=e),t&&this._vaultSuggestCardState(t);var a={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(a))},t.prototype.reset=function(){return g.n.resolve(!1)},t.prototype.toggleDebug=function(){},t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();e&&(n&&(!e.vault&&B.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents()),e.vault&&e.vault.root?this._vaultRootLoadEventFiled||(s.e.logData({name:"Vault.Unlocked.Loaded"}),this._vaultRootLoadEventFiled=!0):this._vaultRootLoadEventFiled=!1)},t.prototype._computeQuotaLoaded=function(){return!!this._bundleLoader.getBundleInfo(2).isLoaded()&&(this._userStateProvider||(this._userStateProvider=this.resources.consume(S.b)),!0)},t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();if(this._quotaLoaded()&&e&&this._isVaultOpen()&&(this.getQuota(),L.fs)){var t=this._getCurrentItem();this.resources.consumeAsync(o.k).then(function(e){e.invalidateQuota(null==t?void 0:t.key)})}},t.prototype._isDebug=function(){return!1},t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(H,r.e.local)},t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4),this._expirationLockTimerId=this.async.setTimeout(function(){e.lockVault(!0)},this._getExpiration()-Date.now())},t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId),this.async.clearTimeout(this._expirationLockTimerId)},t.prototype._resetExpirationTimers=function(){this._stopExpirationTimers(),this._startExpirationTimers()},t.prototype._attachIdleEvents=function(){this._idleEventsAttached||("ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0),this.events.on(document,"mousemove",this._resetLastActivity,!0),this.events.on(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!0)},t.prototype._detatchIdleEvents=function(){this._idleEventsAttached&&("ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0),this.events.off(document,"mousemove",this._resetLastActivity,!0),this.events.off(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!1)},t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()},t.prototype._verifyLockExpiration=function(){var e=this;this._isDebug()?this._showLockWarning():Date.now()-this._lastActivity<9e5?this.extendLock().then(function(){e._resetExpirationTimers()}):this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){var a=Date.now()+1e3*n;e._dataStore.setValue(H,a,r.e.local),e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){return e.lockVault()})},t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:w.r,component:{name:O.e.tagName,params:{html:'<span class="ms-fontColor-error">'.concat(w.a,"</span>")}},actions:[{name:w.i,execute:function(){return g.n.resolve(2)},isAvailable:this.observables.create(!0),icon:new l.e("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){2===t.state.peek()&&(e.async.clearTimeout(e._retryLockVault),e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500))})},t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:w.n,component:{name:C.e.tagName,params:{text:w.e}},actions:[{name:w.t,execute:function(){return s.e.logData({name:"Vault.StillHere.Extend"}),e.extendLock().then(function(){return e._resetExpirationTimers(),g.n.resolve(2)})},isAvailable:this.observables.create(!0),icon:new l.e("Cancel"),isDefault:!0}],isSoftDismissable:!1}),s.e.logData({name:"Vault.StillHere.Shown"}),this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&s.e.logData({name:"Vault.StillHere.Dismiss"})})},t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t),this._showVaultLockNotification(!e)},t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1),this._dataStore.remove(H,r.e.local),this._stopExpirationTimers(),e||this._navToRootIfInVault(),this.events.off(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!1,this._getVaultIconFre()||this._showVaultFreMessage(!1),this._detatchIdleEvents(),this._warningDialog&&this._warningDialog.dismiss(),Object.keys(y.e).map(function(e){var n=t._urlDataSource.getRootItemKey(y.e[e]);t._invalidateItems(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var a=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([a])}else n&&this._invalidateItems(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()},t.prototype._navToRootIfInVault=function(){var e,t,n,a=this._getCurrentItem(),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(a,"vault")),r=Object(L.cs)(L.Yr)&&Object(T.e)(U.l)&&this._vaultItem&&(null===(e=null==a?void 0:a.graph)||void 0===e?void 0:e.driveId)===(null===(n=null===(t=this._vaultItem.remoteItem)||void 0===t?void 0:t.parentReference)||void 0===n?void 0:n.driveId);if(i||r){var o=this._urlDataSource.getRootItemKey(),s=this._urlDataSource.getItemUrl(o);this._navigation.navigateTo({url:s})}},t.prototype._invalidateItems=function(e,t){var n=this;this._isItemsScopeEnabled()?this.resources.consumeAsync(o.k).then(function(a){a.invalidateItems(e),Object(L.cs)(L.Yr)&&Object(T.e)(U.l)&&a.invalidateCurrentItemSet(),L.fs&&n._itemProvider.invalidateItem(e,t);var i=n._getCurrentItem();(null==i?void 0:i.vault)&&a.invalidateItems(i.key)}):this._itemProvider.invalidateItem(e,t)},t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1),this._isVaultOpen(!0),this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._invalidateItems(n,{triggerFetch:!0}),this._navEventAttached||(this.events.on(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!0,this._onNavigationChange()),this.getQuota(),this._warningDialog&&this._warningDialog.dismiss();var a=this._getCurrentItem();if(a&&(a.vault||a.isPlaceholder||a.error&&a.error.data&&161===a.error.data.errorCode||a.queryType===y.e.RecycleBin&&"root"===a.id)){this._invalidateItems(a.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._invalidateItems(i,{purgeCache:!0})}this._showVaultLockNotification(!1),s.e.logData({name:"Vault.Unlocked.Succeeded"}),this._getVaultIconFre()&&!e&&(this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3),this._setVaultIconFre(!1))},t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,a=e.newValue;if(t===this._storageKeyPrefix+h.e&&a)try{var i=JSON.parse(a);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}t===this._storageKeyPrefix+H&&(a?(!n||a>n)&&(this._dataStore.getValue(H,r.e.local)||this._dataStore.setValue(H,parseInt(a,10),r.e.local),this._handleVaultUnlock()):this._isVaultOpen.peek()&&this._handleVaultLock())},t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)},t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))},t.prototype._getVaultIconFre=function(){return this._dataStore.getValue(R,r.e.local)},t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue(R,e,r.e.local):this._dataStore.remove(R,r.e.local)},t.prototype._postProcessQos=function(e,t){return this._isExpectedError(t)&&(e.resultType=d.e.ExpectedFailure),e},t.prototype._postProcessUnlockQos=function(e,t){return this._isExpectedUnlockError(t)&&(e.resultType=d.e.ExpectedFailure),e},t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=Object(u.i)(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1},t.prototype._isExpectedUnlockError=function(e){var t=Object(u.i)(e);return"vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())&&(s.e.logData({name:"Vault.Unlock.MaxExtensionError"}),!0)},t.prototype.enableVaultV2=function(e){var t=this,n="POST",a="v2.1";return this._vroomDataRequestor.send({endpoint:Object(P.f)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:e?"CreateVault":"EnableVault",path:"/oneDrive.createVault",requestType:n,breakCache:!0,apiVersion:a,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this),useAuthorizationHeaders:!0}).then(function(){t.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:N})})},t.prototype.disableVaultV2=function(){var e,t=this,n="POST",a="v2.1";return(null===(e=this._identityDataSource)||void 0===e?void 0:e.getSessionToken(!0)).then(function(e){return t._vroomDataRequestor.send({endpoint:Object(P.f)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:"deleteVault",path:"/oneDrive.disableVault",requestType:n,breakCache:!0,apiVersion:a,qosExtraData:{requestType:n},postProcessQos:t._postProcessQos.bind(t),useAuthorizationHeaders:!0,accessToken:e}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){return g.n.reject(e)})})},t.prototype.getUnlockVaultV2RequestData=function(){return{endpoint:Object(P.f)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.unlockVaultV2",path:"/oneDrive.unlockVault"}},t.prototype.getLockVaultV2RequestData=function(){return{endpoint:Object(P.f)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.lockVaultV2",path:"/oneDrive.lockVault"}},t.prototype.getVaultV2=function(e,t){var n=this,i="v2.1",r={Prefer:"Include-Feature=AddToOneDrive"};return(e||t?this.enableVaultV2(e):g.n.resolve()).then(function(){return n._vroomDataRequestor.send({endpoint:Object(P.f)({apiVersion:i,driveId:"me",includeViewerId:!0}),apiName:"GetVault",path:"/drive/items/root/children?select=*,containingDrivePolicyScenarioViewpoint&filter=remoteItem/containingDrivePolicyScenarioViewpoint/PolicyScenarioId eq '".concat("fa0c6428-7a2e-4a42-a9cc-52f48021d0ba","'"),headers:r,breakCache:!0,apiVersion:i,useAuthorizationHeaders:!0})}).then(function(e){var t,n=(void 0===e?{value:[]}:e).value;if(0===n.length)return g.n.reject({status:404,message:"Vault not found"});var i=n[0];return Object(a.__assign)(Object(a.__assign)({},i),{vault:Object(F.t)(null===(t=i.remoteItem)||void 0===t?void 0:t.containingDrivePolicyScenarioViewpoint)})})},t}(i.n);t.default=j;var V=Object(I.r)("VaultDataSource",j,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{clientName:k.e.optional,identityDataSource:o.D,vroomDataRequestor:x.e,itemStore:p.e,vaultStore:_.resourceKey,urlDataSource:o.Se,navigation:b.e,itemProvider:D.resourceKey,dialogProvider:c.e,userInfoProvider:S.A,itemParentHelper:f.e,bundleLoader:S.e,isItemsScopeEnabled:m.u.lazy}))}],Array(94),[function(e,t,n){"use strict";n.d(t,"e",function(){return $});var a=n(0),i=n(335),r=n(1030),o=n(1559),s=n(1059),c=n(3508),d=n(3307),l=n(1826),u=n(695),f=n(813),p=n(135),m=n(2072),_=n(170),h=n(242),b=n(3507),g=n(159),v=n(418),y=n(1388),S=n(1552),D=n(124),I=n(2030),x=n(2585),C=n(43),O=n(144),w=n(2889),E=n(77),A=n(1914),L=new(n(7).t)("rootAuthToken"),k=n(1970),M=n(75),P=n(139),T=n(3506),U=n(73),F=n(16),H=n(4324),R=n(134),N=n(1357),B=n(13),j=n(379),V=n(1903),z=n(1066),G=!F.e.isActivated("5B212881-6C87-4D5C-A08C-B7637D070F5F","02/07/2022","Graph needs to use remote item in place to properly render shared items in previewer"),K=!F.e.isActivated("B9AD9A77-040E-461C-A8A7-7F2B1BAE7C0B","02/07/2022","Use lite version of urlDataSource, so the itemResultProcessor will work in lightspeed"),W=!F.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl"),q=!F.e.isActivated("14C6F8D3-40B1-4990-B140-4FCB78C9B93C","05/10/2023","use photo.livePhoto.totalStreamSize for livePhoto size display"),Q=function(){function e(e,t){var n=this,i=t.urlDataSourceLite,r=t.graphDataSource,o=t.itemIdentityProcessor,s=t.location,c=void 0===s?window.location:s,d=t.rootOAuthToken,l=t.vroomDataRequestor;this._urlDataSourceLite=i,this._itemIdentityProcessor=o,this._origin="".concat(c.protocol,"//").concat(c.host),this._rootToken=d,this._graphDataSource=r,this._itemKeyByUrl=new Map,this._isOneDriveWinApp=Object(P.e)(),this._async=new _.e(this),this._vroomDataRequestor=l,k.e.registerCookieChecker({isApplicable:function(e){return e.indexOf("needs_accessToken=true")>0},check:function(e){return Object(a.__awaiter)(n,void 0,M.n,function(){var n,i,r,o,s,c,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(n=this._itemKeyByUrl.get(e))?(r=this._graphDataSource.refreshAccessToken)?[4,this._graphDataSource.refreshAccessToken({key:n})]:[3,2]:[3,3];case 1:r=a.sent(),a.label=2;case 2:return o=(i=r)&&i.accessToken,s=e+"&access_token="+o,c=new t.itemTaskObserverType,d={url:s,width:window.innerWidth,height:window.innerHeight},c.update([new I.t(n).succeed({item:{key:n,thumbnail:I.e.replace(d)}})]),this._itemKeyByUrl.delete(e),c.flush(),l=new h.e,this._async.setTimeout(function(){l.error(new Error("NeedAccessToken"))},0),[2,l.getPromise()];case 3:return[2,!1]}})})}})}return e.prototype.processItem=function(e,t){var n,i=e.itemFromServer,r=e.topCollaborator,o=e.requestKey,s=e.observer,c=e.driveAccessTokenWrap,d=this._itemIdentityProcessor.processIdentity({itemFromServer:i,requestKey:o,observer:s}).key,l=Object(y.e)(i);if(l){var u=J(i),f=l.driveId,p=l.id,m=l.path;if(m||p){var _=Object(a.__assign)(Object(a.__assign)({},l),{"@odata.id":u&&(p?X(u,f,p):"".concat(u).concat(m))});n=this._itemIdentityProcessor.processIdentity({itemFromServer:_,requestKey:o,observer:s}).key}}var h=this._urlDataSourceLite.getKeyParams(o),b=this._urlDataSourceLite.getQueryType(h),g=this.buildItemFromServerResponse({itemFromServer:i,key:d,topCollaborator:r,parentKey:n,queryType:b,driveAccessTokenWrap:c},t);return s.update([new I.t(d).succeed({item:g})]),{key:d}},e.prototype.buildItemFromServerResponse=function(e,t){var n,l,p,_,h,E,L,k,M=this,P=e.itemFromServer,V=e.topCollaborator,K=e.key,Q=e.parentKey,$=e.driveAccessTokenWrap,ee=void 0===$?{}:$,te=e.queryType||C.e.Files,ne=P.sharepointIds||{},ae={key:K,parentKey:Q,properties:{listId:ne.listId,ID:ne.listItemId,uniqueId:ne.listItemUniqueId,siteId:ne.siteId,siteUrl:ne.siteUrl}};ae.queryType=te,ae.displayType=te,ae.sharingRole=function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,a=Object(D.e)(n||[],function(){return!0});return a.owner?A.e.Owner:a.write?A.e.Edit:a.read?A.e.View:A.e.None}return A.e.Owner}(P),te===C.e.SharedWithMe&&(ae.external={});var ie,re=P.id,oe=P.name,se=P.folder,ce=P.thumbnails,de=P.size,le=P.description,ue=P.root,fe=P.location,pe=P.remoteItem,me=Object(z.e)(pe),_e=(se?{extension:""}:o.n(oe)).extension,he=_e&&Object(S.e)(_e),be=Object(N.e)(P,!!he),ge="document"===(ie=null==se?void 0:se.folderType)?x.e.documents:"photo"===ie?x.e.photos:"favorites"===ie?x.e.favorites:void 0,ve=Object(y.e)(P),ye=I.e.optional(ve&&ve.driveId);ae.itemId=re;var Se=ve&&ve.driveType;ae.graph={itemId:G&&(null==pe?void 0:pe.id)||re,driveId:ye,driveType:I.e.optional(Se)},ae.statistics={views:null===(l=P.viewCount)||void 0===l?void 0:l.visitorViewCount};var De=ee.sessionToken,Ie=ee.sessionTokenV21;De&&Object(b.e)({authToken:De.accessToken,proofToken:De.proofToken})&&(De=void 0),Ie&&Object(b.e)({authToken:Ie.accessToken,proofToken:Ie.proofToken})&&(Ie=void 0),Object(g.e)(ae.graph,{sessionToken:I.e.optional(De),sessionTokenV21:I.e.optional(Ie)});var xe=ue?v.n:oe;ae.name=oe,ae.displayName=xe,ae.extension=_e,ae.caption=le||"",ae.type=be,ae.category=ge,ae.ownerId=ye,ae.geoLocation=fe,ae.isRootFolder=!!ue,ae.comments={settings:{isCommentDisabled:P.commentSettings&&P.commentSettings.commentingDisabled&&!!P.commentSettings.commentingDisabled.isDisabled}};var Ce=P.searchResult,Oe=P["@microsoft.graph.downloadUrl"]||P["@content.downloadUrl"],we=function(e){var t=e["@odata.id"];if(t)return t;var n=e.id,a=(e.parentReference||{}).driveId,i=J(e);return i&&X(i,a,n)}(P),Ee=((n={})[r.t.download]=Oe,n[r.t.itemUrl]=I.e.optional(we),n);if(Ce){var Ae=Ce.onClickTelemetryUrl;Ae&&(Ee[r.t.bingClickInstrumentation]=Ae)}if(se){var Le=se.childCount;if(ae.folder={childCount:Le},ce&&ce.length>0){ae.folder.covers=[];for(var ke=0,Me=ce;ke<Me.length;ke++){var Pe=Me[ke];ae.folder.covers.push(Pe.large)}}ae.childCount=Le}var Te=P.photo,Ue=P.image;if(Ue){var Fe=Ue.width,He=Ue.height;ae.photo=Object(a.__assign)(Object(a.__assign)({},Te?{cameraMake:I.e.optional(Te.cameraMake),cameraModel:I.e.optional(Te.cameraModel),dateTaken:I.e.optional(Y(null==Te?void 0:Te.takenDateTime)),exposureDenominator:I.e.optional(Te.exposureDenominator),exposureNumerator:I.e.optional(Te.exposureNumerator),focalLength:I.e.optional(Te.focalLength),iso:I.e.optional(Te.iso),isLivePhoto:I.e.optional(void 0!==Te.livePhoto),isSamsungMotionPhoto:I.e.optional(void 0!==Te.samsungMotionPhoto)}:{}),{width:Fe,height:He,originalUrl:Oe})}Te&&(ae.dateTaken=Te.takenDateTime,ae.dateTakenTime=(null==Te?void 0:Te.takenDateTime)?new Date(null==Te?void 0:Te.takenDateTime):void 0),ae.size=q&&(null===(p=null==Te?void 0:Te.livePhoto)||void 0===p?void 0:p.totalStreamSize)||de,ae.photoStreamItemSource=P.photoStreamItemSource;var Re=(P.file||{}).mimeType,Ne=void 0===Re?"":Re,Be=function(e,t,n){var a,i,r=e.thumbnails,o=r&&r[0],s=o&&(o.large||o.medium||o.small),c=s&&s.url;return Object(B.isFeatureEnabled)(B.FixODCOneUpPreview)&&!c&&n&&e.remoteItem&&(null===(a=e.remoteItem.parentReference)||void 0===a?void 0:a.driveId)?"".concat(n,"/drives/").concat(null===(i=e.remoteItem.parentReference)||void 0===i?void 0:i.driveId,"/items/").concat(e.remoteItem.id,"/thumbnails/0/c1500x309/content"):c&&c.replace(/[&?](width|height|cropmode)=[^&]*/g,"").replace("https://media.cloudapp.net",t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms")}(P,t&&"edog"===t.env,Object(B.isFeatureEnabled)(B.FixODCOneUpPreview)&&this._urlDataSourceLite.getApiBaseUrl?this._urlDataSourceLite.getApiBaseUrl({apiVersion:"v1.0",driveId:null===(h=null===(_=P.remoteItem)||void 0===_?void 0:_.parentReference)||void 0===h?void 0:h.driveId}):void 0),je=Be&&Be.indexOf("/transform/thumbnail?")>=0&&Be,Ve=this._rootToken,ze=function(e){return e&&("."===e[0]?e.slice(1):e).toLowerCase()}(_e),Ge="mp4"===ze||0===Ne.lastIndexOf("video/mp4",0),Ke=P.video;if(Ke){var We=Ke,qe=(Fe=We.width,He=We.height,We.bitrate),Qe=We.duration,Ye=We.manifestMetadata,Je=We.altManifestMetadata;ae.video={fourCC:Ke.fourCC||(Ge?"H264":void 0),width:Fe,height:He,bitrate:qe,duration:Qe,manifestMetadata:Ye,altManifestMetadata:Je}}var Xe=P.audio,Ze=P.lastModifiedBy,$e=(void 0===Ze?{}:Ze).user,et=void 0===$e?{}:$e,tt=et.email,nt=void 0===tt?void 0:tt,at=et.displayName,it=void 0===at?void 0:at,rt=P.createdBy,ot=(void 0===rt?{}:rt).user,st=(void 0===ot?{}:ot).displayName,ct=void 0===st?void 0:st,dt=P.lastModifiedDateTime,lt=P.createdDateTime,ut=P.shared,ft=void 0===ut?{}:ut,pt=ft.sharedBy,mt=(void 0===pt?{}:pt).user,_t=void 0===mt?{}:mt,ht=_t.email,bt=void 0===ht?void 0:ht,gt=_t.displayName,vt=void 0===gt?void 0:gt,yt=ft.sharedDateTime,St=void 0===yt?void 0:yt;ae.creatorName=ct,ae.editorName=it;var Dt=Z(dt);ae.dateModifiedTime=Dt.date,ae.dateModified=Dt.dateString,Dt=Z(lt),ae.dateCreatedTime=Dt.date,ae.dateCreated=Dt.dateString,Dt=Z(St),ae.dateSharedTime=Dt.date,ae.dateShared=Dt.dateString,ae.properties.sharedByUser={title:vt,isTopCollaborator:bt&&V&&V.indexOf(bt)>-1,sip:bt},ae.properties.editorName=[{title:it,sip:nt}];var It=".ts"===_e&&de<1<<19&&!Ke,xt=u.a({type:be,extension:_e,textEditorMimeType:It?"text/typescript":void 0});ae.iconName=xt;var Ct=!!Be||xt===u.r,Ot=Xe||xt===u.e||0===Ne.lastIndexOf("audio/",0),wt=Ke||xt===u.o||!It&&0===Ne.lastIndexOf("video/",0);if(Ot&&(ae.audio=Xe||{}),wt&&!Ke){var Et={fourCC:Ge?"H264":void 0,width:-1,height:-1,bitrate:void 0,duration:void 0,manifestMetadata:void 0,altManifestMetadata:void 0};ae.video=Et}Object(B.isFeatureEnabled)(B.EnableLivePhotoVideos)&&(null==Te?void 0:Te.livePhoto)?ae.video=Object(a.__assign)(Object(a.__assign)({},ae.video),{width:Ue.width,height:Ue.height,fourCC:"H264",burstPhotoType:w.e.AppleLivePhoto}):Object(B.isFeatureEnabled)(B.EnableSamsungMotionPhotoVideos)&&(null==Te?void 0:Te.samsungMotionPhoto)&&(ae.video=Object(a.__assign)(Object(a.__assign)({},ae.video),{width:Ue.width,height:Ue.height,fourCC:"H264",burstPhotoType:w.e.SamsungMotionPhoto})),P.malware&&(ae.lifeCycleStatus={isMalwareDetected:!0});var At=_e&&_e.toLowerCase();(".pdf"===At||".ai"===At&&Oe)&&(ae.openUrl=Oe,ae.type=O.e.Media);var Lt=P.cTag,kt=Lt&&encodeURIComponent(Lt),Mt="personal"===Se,Pt=null,Tt=P["-embed-formats"];Tt&&Tt.dash?Pt=new U.t(Tt.dash.url):(Ke||Ot||wt)&&(je?(Pt=new U.t(je.replace("/thumbnail?","/videomanifest?")),!F.e.isActivated("A5E83BB0-9292-4D0B-8C38-627484A2DA72","08/25/2022","Add cTag for video")&&kt&&Pt.setQueryParameter("cTag",kt)):Mt&&(Pt=Oe?new U.t(Oe):null)),Pt&&(Pt.setQueryParameter("action","Access"),Ee[r.t.video]=Pt.toString());var Ut=be===O.e.OneNote?"one":xt,Ft=Ut&&f.t[Ut];ae.appMap=I.e.optional(Ft);var Ht,Rt=P.ocr;if(Rt&&(ae.ocr={engineVersion:Rt.engineVersion,entityTags:[]},Ee[r.t[r.t.textContent]]=Rt.textContentUrl),ae.urls=Ee,ae.isBundle=!!P.bundle,ae.isAlbum=!!(null===(E=P.bundle)||void 0===E?void 0:E.album),F.e.isActivated("7018C5E7-1E11-4306-B532-EBE8AE96C5FF","07/26/2022","Enable gif animation in oneup")||"svg"!==ze&&"gif"!==ze){if(Be){var Nt="".concat(Be).concat(Be.indexOf("?")>=0?"&":"?","encodeFailures=1"),Bt=(Fe=Ue&&Ue.width?Ue.width:Ke&&Ke.width?Ke.width:void 0,He=Ue&&Ue.height?Ue.height:Ke&&Ke.height?Ke.height:void 0,function(e){var t=e.thumbnails,n=e.remoteItem;if(Object(B.isFeatureEnabled)(B.FixODCOneUpPreview)&&n)return!1;var a=t&&t[0];return!a||void 0===a.isPreAuth}(P));ae.thumbnail={url:Nt,width:Fe,height:He,getAligned:Bt?function(e){var t=e.width,n=void 0===t?window.innerWidth:t,a=e.height,i=void 0===a?window.innerHeight:a;return{width:n|=0,height:i|=0,url:"".concat(Nt,"&width=").concat(n,"&height=").concat(i)}}:void 0,getContents:Bt?void 0:function(e){var t=Nt;if(e){var n=e.width,a=void 0===n?window.innerWidth:n,i=e.height,r=void 0===i?window.innerHeight:i;t=Nt.replace(/c[0-9]*x[0-9]*/,"c".concat(Math.ceil(a),"x").concat(Math.ceil(r)))}return M._vroomDataRequestor.send({apiName:"getImageBlob",path:t,responseType:"blob",useAuthorizationHeaders:!0,headers:{accept:"*/*"},parseResponse:function(e){return e.response}})}}}}else ae.thumbnail={url:null!==(k=null===(L=ae.photo)||void 0===L?void 0:L.originalUrl)&&void 0!==k?k:Oe};je&&(Ht={officeBundleGenerateUrl:"".concat(je.replace("/thumbnail?","/OfficeBundle?"),"&minVersion={{minVersion}}&cTag=").concat(kt),officeBundleGetFragmentUrl:"".concat(je.replace("/thumbnail?","/OfficeBundleFragment?"),"&fragment={0}")});var jt,Vt,zt=function(e){var t=e.officeBundle;if(t)return t;var n=e.listItem,a=n&&n.fields,i=a&&a.MediaServiceFastMetadata;if(i)try{return JSON.parse(i).officeBundle}catch(e){}}(P),Gt="ms-excel"===Ft,Kt="ms-powerpoint"===Ft,Wt="ms-visio"===Ft,qt="ms-word"===Ft,Qt=P.webUrl;if("pdf"!==xt&&qt||Gt||Kt||Wt){var Yt=!(!t||!t.wopiToken)||(Ve?Object(T.e)(Object(m.e)(Object(m.a)(Ve))):Qt&&0===Qt.lastIndexOf(this._origin,0));(Kt&&Oe||qt&&Yt)&&!(Mt&&!zt)&&(ae.officeBundle=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},zt?(Vt=(jt=zt).generationTime,{bundleCTag:jt.ctag,bundleVersion:jt.version,hasBundleGenerationFailed:jt.fatalError||!1,generationTime:Vt?new Date(Vt):void 0,bundleErrorInfo:jt.errorInfo||""}):{}),Ht||{}),{cTag:Lt})),"personal"!==Se&&(ae.wopiFrameUrl=Qt)}"7z"!==ze&&"rar"!==ze&&"zip"!==ze||(ae.zip=je?{downloadZipContentsUrl:"",zipMetaDataUrl:je.replace("/thumbnail?","/zipmetadata?")}:I.e.optional(function(e,t,n,a,i){var r="personal"===(Object(y.e)(e)||{}).driveType?"odc":"spo";return n&&a?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider=".concat(r,"&inputFormat=").concat(t,"&docid=").concat(encodeURIComponent(n),"&access_token=").concat(a)}:n&&i?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider=".concat(r,"&inputFormat=").concat(t,"&docid=").concat(encodeURIComponent(n))}:void 0}(P,ze,we,Ve,this._isOneDriveWinApp))),c.t(_e)?ae.htmlConversion={}:c.e(_e)&&(ae.htmlConversion=je?{url:"".concat(je.replace("/thumbnail?","/html?"),"&inlineImages=true")}:{}),s.t(ze)?ae.model3d={canRenderNative:!0}:s.e(ze)&&(ae.model3d=je?{canConvert:!0,conversionUrl:je.replace("/thumbnail?","/glb?")}:{canConvert:!0});var Jt=(P||{}).currentUserRole,Xt=P.dataLossPrevention,Zt=F.e.isActivated("3E947568-412A-4953-9D24-E87CB8F77760","08/01/2022","Add currentUserRole check for textviewer in itemoverride scenario due to download issue");(Xt||!Zt&&Jt&&ae.extension&&Object(j.n)(ae.extension,ae.type))&&(ae.itemStatus=I.e.optional(function(e,t,n,a){if(a){if(a.blocksDownload)return i.e.ConditionalAccessBlocked;if(a.readOnly)return i.e.ConditionalAccessViewOnly}if(n&&n.blockDownload){if(e===O.e.Media||t)return i.e.ConditionalAccessViewOnly;if(e!==O.e.Folder)return i.e.ConditionalAccessBlocked}if(n&&n.viewOnly)return i.e.ConditionalAccessViewOnly}(be,Ft,Xt,Jt)));var $t=(P||{}).permMask,en=H.e.fromHexString($t),tn=R.e.hasPermission(en,R.e.openItems),nn=Xt&&(Xt.blockDownload||Xt.viewOnly)||$t&&!tn||!Zt&&Jt&&(Jt.blocksDownload||Jt.readOnly);if(d.e(ze)){var an=Mt?void 0:{};ae.pdfConversion=je?{url:je.replace("/thumbnail?","/pdf?")}:an}else d.t(ze)&&je&&nn&&(ae.pdfConversion={url:je.replace("/thumbnail?","/passthrough?")});F.e.isActivated("838fc269-6d62-4a01-aa94-8075d2e87392","01/13/2022","Add perm mask for embed.aspx to support OnePlayer")||(ae.permissions=en),ae.openUrl=Qt;var rn=P.tags,on=void 0;if(rn&&(on=[],rn.map(function(e){var t="userdefined";e.autoTagged&&(t="objectdetectors"),on.push({source:t,type:"keyword",tag:e.name})})),ae.tags=on,ae.vault=me?Object(z.t)(null==pe?void 0:pe.containingDrivePolicyScenarioViewpoint):P.vault,te===C.e.Files&&pe&&(ae.mountPoint=pe,ae.id=(null==pe?void 0:pe.id)||re),ae.itemFromServer=P,ae.isPlaceholder=!1,!ae.thumbnail&&(W?Ct:this._isOneDriveWinApp&&("jpg"===ze||"png"===ze||"jpeg"===ze))){var sn=this._graphDataSource.getItemUrl({key:K,graph:{itemId:G&&W&&(null==pe?void 0:pe.id)||re,driveId:ve&&ve.driveId,driveType:ve&&ve.driveType}},{useDirectEndpoint:!0}),cn=new U.t("".concat(sn,"/thumbnails/0/c").concat(0|window.innerWidth,"x").concat(0|window.innerHeight,"/content").concat(Object(B.isFeatureEnabled)(B.FixODCOneUpPreview)&&ae.remoteItem?"":"?needs_accessToken=true"));W&&(cn.setQueryParameter("prefer","noredirect,closestavailablesize"),cn.setQueryParameter("cb",P.eTag));var dn=cn.toString();ae.thumbnail={url:dn,width:window.innerWidth,height:window.innerHeight},this._itemKeyByUrl.set(dn,K)}return F.e.isActivated("400a50e9-3598-4690-b329-e90ffae7f8c6","03/28/2022","Add PrincipalCount for embed.aspx to support Stream")||(ae.properties.PrincipalCount=(P||{}).PrincipalCount),ae.properties.ProgId=(P||{}).ProgId,ae},e.dependencies={urlDataSourceLite:K?E.De:E.Se,itemIdentityProcessor:E.we,rootOAuthToken:L.optional,graphDataSource:E.y,itemTaskObserverType:I.a,vroomDataRequestor:V.e},e}();function Y(e){if(e)return new Date(e).getTime()}function J(e){var t=e["@odata.context"];if(t)return t.split("/$")[0];var n=e.sharepointIds;if(n){var a=n.siteUrl;if(a)return"".concat(a,"/_api/v2.1")}}function X(e,t,n){return"".concat(e,"/drive").concat(t?"s/".concat(t):"","/items/").concat(n)}function Z(e){var t=e&&e.lastIndexOf("0001-01-01T00:00:00",0)<0?new Date(e):void 0;return{date:t,dateString:t?l.s(t):""}}var $=Object(p.r)("ItemResultProcessor",Q)}],Array(28),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(116),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.ee([435],3350).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.ee([341],3921)];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.default=r},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("imageEditorDataSource")},,function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(450),o=n(144),s=n(1994),c=n(40),d=n(2030),l=n(77),u=function(e){function t(t){return e.call(this,t)||this}return Object(a.__extends)(t,e),t.prototype.processError=function(e){var t,n=e.requestKey,a=e.error,i=e.itemName,s=e.observer;switch(a&&a.data&&a.data.code||0){case 101:case 102:case 103:case 152:t=r.e.authenticationExpired;break;case 161:t=r.e.mfaRequired;break;case 162:t=r.e.insufficientVaultQuota;break;case 200:t=r.e.userSuspended;break;case 201:t=r.e.userNotReady;break;case 202:t=r.e.marketBlocked;break;case 3e3:case 10009:t=r.e.accessDenied;break;case 3403:t=r.e.passwordRequired;break;case 3404:t=r.e.requestAccess;break;case 9017:break;default:t=r.e.requestFailed}var c=this.getError(a,i);return s.update([new d.t(n).succeed({item:{key:n,type:o.e.Error,error:{type:t,data:c},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]),{error:c,key:n}},t.prototype.getError=function(e,t){var n,a,i,r=e&&e.data&&e.data.code||0;switch(r){case 209:n=s.b,a=s.h;break;case 509:n=s._;break;case 1e3:n=s.r;break;case 1006:n=s.o;break;case 2005:case 2006:n=s.f;break;case 3e3:n=s.u,a=s.d;break;case 9001:n=Object(c.format)(s.c,t);break;case 9006:n=s.m;break;default:n=s.i,a=s.a}return 161===r&&(i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null,this.resources.consumeAsync(l.xe).then(function(e){return e.setVaultLockState({root:void 0,isLocked:!0},void 0,!0)})),{errorCode:r,errorTitle:n,errorDetailedText:a,actionUrl:i}},t}(i.n);t.e=u},function(e,t,n){"use strict";var a=n(27),i=n(1953),r=n(304);t.e=function(e,t){this.key=e||"",this.content=a.observable(new i.e),this.content.equalityComparer=r.n,this.schema=a.observableArray([]),this.schema.equalityComparer=r.e,this.context=a.utils.extend({},t),this.isPlaceholder=!0}},function(e,t,n){"use strict";var a;!function(e){e[e.Excel=1]="Excel",e[e.OneNote=2]="OneNote",e[e.PowerPoint=3]="PowerPoint",e[e.Word=4]="Word",e[e.Visio=5]="Visio",e[e.Project=6]="Project",e[e.Publisher=7]="Publisher"}(a||(a={})),t.e=a},function(e,t,n){"use strict";var a=function(){var e,t,n,a,i,r,o,s,c,d="SharePoint.OpenDocuments.5",l="SharePoint.OpenDocuments.4",u="SharePoint.OpenDocuments.3",f="SharePoint.OpenDocuments.2",p="application/x-sharepoint",m="application/x-sharepoint-webkit",_="application/officelive",h="npSharePointPlugin",b="RoamingOfficeActiveX.RoamingOffice",g="",v={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},y={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},S={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},D={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},I={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function x(){return window.navigator.userAgent.indexOf("Windows")>=0}function C(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function O(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function w(){return s||(s=!0,c=O("Windows Phone")),c>=8}function E(){return"function"==typeof navigator.msLaunchUri&&!C()&&!L()}function A(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function L(){return window.navigator.userAgent.indexOf("Edge/")>=0}function k(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function M(){return!!k()&&8==window.document.documentMode}function P(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function T(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function U(){return(P()?H("firefox/"):0)>=3}function F(){return(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0?H("version/"):0)>=3}function H(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var a=n+e.length,i=t.length;return parseInt(t.substring(a,i))}return 0}function R(e,t,n){E()?navigator.msLaunchUri(e,t,n):!T()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0)||L()?function(e,t,n){var a="OICFrame",i=document.getElementById(a);null==i&&((i=document.createElement("iframe")).className="ObjectInDialog",i.style.visibility="hidden",i.src="about:blank",document.body.appendChild(i),i.id=a);try{i.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n):function(e,t,n){var a="OICLinkTag",i=document.getElementById(a);null==i&&((i=document.createElement("a")).id=a,i.style.visibility="hidden",i.href="",i.target="_top",document.body.appendChild(i),null!=i.addEventListener&&i.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1));try{i.href=e,i.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n)}function N(e){return 0!=(e.Options&y.SkipProtocolHandler)||M()}function B(){return A()&&(U()||F())||U()}function j(e){return e===v.ReadOnly||e===v.ReadWrite}function V(e,t,n,a){var r=function(e){if(e!=I.OneNote&&C()&&!w())return"office:";switch(e){case I.Excel:return"ms-excel:";case I.OneNote:return"onenote:";case I.PowerPoint:return"ms-powerpoint:";case I.Visio:return"ms-visio:";case I.Word:return"ms-word:";case I.Project:return"ms-project:";case I.Publisher:return"ms-publisher:";case I.Infopath:return"ms-infopath:";case I.Access:return"ms-access:";default:return""}}(e);if(null==r)return ie(S.Unattempted,i.Application),!1;e==I.Visio&&n==v.ReadWrite&&(n=v.WriteOnly);var o=r;if(!(a=a||C()&&!w())){var s="";j(n)?s+="ofv|":s+="ofe|",o+=z(s+="u|")}return R(o+=z(t),G,K),!0}function z(e){if(A()&&T()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function G(){ae(D.ProtocolHandler)}function K(){i.Options|=y.SkipProtocolHandler,ne(i,e,t)}function W(){if(E())return!0;if(T())return void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(P()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");return t.initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),!!e.getAttribute("installed")}if(k())try{return new ActiveXObject(b).HrExists()}catch(e){}return!1}function q(e,t,n,a,i,r){Q(e,t,function(e){switch(e){case I.Excel:return"root\\office15\\excel.exe";case I.PowerPoint:return"root\\office15\\powerpnt.exe";case I.Visio:return"root\\office15\\visio.exe";case I.Word:return"root\\office15\\winword.exe";case I.Project:return"root\\office15\\winproj.exe";case I.Publisher:return"root\\office15\\mspub.exe";case I.Infopath:return"root\\office15\\infopath.exe";case I.Access:return"root\\office15\\msaccess.exe";default:return null}}(n),a,"x86",g,i,r)}function Q(e,t,i,r,o,s,c,d){var l="";if(null!=r&&(l+=" "+r),null!=e&&(l+=' "'+e+'"'),E()||T()){n=c,a=d;var u="office:";u+=' "'+s+'"',u+=' "'+i+'"',u+=' "ROAMING"',u+=' "'+t+'"',u+=' "'+o+'"',R(u+=" "+l,Y,J)}else if(P()){var f=document.createElement("RoamingExtensionElement");f.setAttribute("cabUrl",s),f.setAttribute("app",i),f.setAttribute("licensingEntitlements",t),f.setAttribute("platform",o),f.setAttribute("args",l),document.documentElement.appendChild(f);var p=document.createEvent("Events");p.initEvent("RoamingOfficeLaunch",!0,!1),f.dispatchEvent(p),null!=c&&c(D.RoamingFFExtension)}else if(k()){var m=new ActiveXObject(b);if(null!=m)try{m.HrConfigureSingle(s,i,t,o,l),null!=c&&c(D.RoamingActiveX)}catch(e){}}else null!=d&&d(S.Failed)}function Y(){null!=n&&n(D.RoamingProtocolHandler)}function J(){null!=a&&a(S.ControlNeeded)}function X(){var e=document.getElementById(h);if(null==e){var t=p;if(A()&&F()&&$(m)&&(t=m),!$(t)){if(!A()||!$(_))return null;t=_}var n=document.createElement("object");n.id=h,n.type=t,n.style.width="0px",n.style.height="0px",n.style.setProperty("visibility","hidden",""),document.body.appendChild(n),e=document.getElementById(h)}return e}function Z(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var a=n[e];return!(!a||t&&!a.enabledPlugin)}function $(e){return Z(e,!0)}function ee(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function te(e){return e===I.OneNote?"OneNote.Notebook":""}function ne(n,a,s){if(i=n,e=a,t=s,n.DocumentUrl){var c,p=n.DocumentUrl;try{p=decodeURIComponent(n.DocumentUrl)}catch(e){}if(n.Mode===v.ReadWrite&&y.CheckoutRequired===(n.Options&y.CheckoutRequired)&&(n.Mode=v.ForceCheckout),y.HostIsEditOnly===(n.Options&y.HostIsEditOnly)&&(n.Mode=v.WriteOnly),function(e){return!N(e)&&(!!function(e){return A()&&(e.Application==I.OneNote||Z("application/x-sharepoint-protocolhandler",!1)||Z("application/x-sharepoint-webkit-protocolhandler",!1))}(e)||!!E()||!(B()||"ActiveXObject"in window&&!C()||T())||re()>=15)}(n))V(n.Application,n.DocumentUrl,n.Mode,n.Application==I.OneNote);else if(M()&&function(e,t,n,a){try{var i=new ActiveXObject(d);if(i)return i.ViewDocument3(window.self,e,t,a)}catch(e){}return!1}(p,n.Mode,n.Options,te(n.Application)))ae(D.O15ActiveX);else if(B()?c=function(e,t,n){var a=X();if(null==a)return S.Unattempted;var i=!1;try{i=a.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=j(t)?a.ViewDocument2(window.self,e,n):a.EditDocument2(window.self,e,n)}catch(e){}return i?(ae(D.NpapiPlugin),S.None):S.Failed}(p,n.Mode,te(n.Application)):(function(){try{var e=new ActiveXObject("IDBHO.IDBHOCtrl");null!=e&&e.SaveSSOCreds()}catch(e){}}(),c=function(e,t,n,a){var i;try{if(i=new ActiveXObject(l))return i.ViewDocument3(window.self,e,t,a)?(ae(D.O14ActiveX),S.None):S.Failed}catch(e){}if(y.O14Only===(n&y.O14Only))return S.Unattempted;try{if(i=new ActiveXObject(u))return i.ViewDocument3(window.self,e,t,a)?(ae(D.O12ActiveX),S.None):S.Failed}catch(e){}if(y.O12UpOnly===(n&y.O12UpOnly))return S.Unattempted;try{if(i=new ActiveXObject(f))return(j(t)?i.ViewDocument2(window.self,e,a):i.EditDocument2(window.self,e,a))?(ae(D.O11ActiveX),S.None):S.Failed}catch(e){}return S.Unattempted}(p,n.Mode,n.Options,te(n.Application))),c!=S.None){if(n.CouldUseRoamingApps&&(r||(r=!0,o=O("Windows NT")),o>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(k()||U()||T()))&&n.Application!=I.OneNote){if(!W())return void ie(S.ControlNeeded,i.Application);if(n.RoamingAppsLauncher)return void function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?q(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):Q(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):ie(S.Unattempted,i.Application)}(n);if(!n.ContinueIfLauncherIsNull)return void ie(S.LauncherNeeded,i.Application)}if(!(y.NoProtocolHandlerFallback==(n.Options&y.NoProtocolHandlerFallback)||N(n)||k()||A()&&c!=S.Unattempted))return void V(n.Application,n.DocumentUrl,n.Mode,n.Application==I.OneNote);ie(c,i.Application)}}else ie(S.Unattempted,i.Application)}function ae(t){null!=e&&e(t)}function ie(e,n){void 0===n&&(n=null),null!=t&&t(e,n)}function re(){var e=0;if(B()||T()){var t=X();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else ee(d)?e=15:ee(l)?e=14:ee(u)?e=12:ee(f)&&(e=11);return e}function oe(){return A()&&($(p)||$(m))}return{OpenDocumentMode:v,OpenDocumentOptions:y,OpenDocumentFailureType:S,OpenDocumentControl:D,OfficeApplication:I,EditDocumentInClient:ne,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=I.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl=""},OfficeVersionInstalled:re,IsO14MacPluginInstalled:oe,OfferOfficeInDialog:function(){return x()&&re()<=11},OfferOfficeNoIntrusive:function(){return x()&&re()<15},OfferMacOffice:function(){return A()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!oe()},CanUseRoamingControl:W,InitUrls:function(e,t,n){g=e},LaunchRoamingApps:q,LaunchRoamingApps2:Q,ShouldShowDialog:function(){return!C()},IsInternetExplorer:k}}();t.e=a},,,function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(75),o=n(47),s=n(1829),c=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SortAction",n.isExecutionIntentional=!0,n._sortManager=n.resources.consume(s.c),n._column=t.column,n._ascending=t.ascending,n}return Object(a.__extends)(t,e),t.getSortedColumn=function(e){var t,n=e();if(n)for(var a=0;a<n.length;a++)if(n[a]&&n[a].isSorted){t=n[a];break}return t},t.prototype.onExecute=function(e,t){return this._updateCurrentSort(this._column,this._ascending),r.n.wrap({resultType:o.t.Success})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){var e=!1;return this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending),e},t.prototype._updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}},t}(i.e);t.e=c},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(1122),r=n(75),o=n(47),s=n(1995),c=n(809),d=n(32),l=n(144),u=n(808),f=n(159),p=n(1679),m=!n(8).e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),_=new c.e,h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Open";var i=t.item,r=t.openRelation,o=void 0===r?0:r,s=t.ignoreHistory,c=void 0!==s&&s,l=t.itemSet,f=t.openLocal,p=void 0!==f&&f,m=t.urlType,_=void 0===m?"default":m,h=t.preserveAction,b=void 0!==h&&h,g=t.nonFoldersOnly,v=void 0!==g&&g;a._openRelation=o,a._nonFoldersOnly=v,a._urlType=a.wrapObservable(_),a._itemSelectionHelper=new(a.child(u.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o}),a.item=a.createComputed(a._computeItem,{deferEvaluation:!0,pure:!0});var y=a.resources.consume(d.e);return a._navigateToItemAction=new(a.managed(y.NavigateToItemAction))({item:a.item,itemSet:l,parentItem:a._itemSelectionHelper.currentItem,urlType:a._urlType,forceInSameWindow:p,isRedirect:c,shouldPreserveAction:b}),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()},t.prototype.onExecute=function(e,t){var n=this.item.peek();return n?(n.type===l.e.Folder&&t&&t.data&&(t.data.folder=!0),t.data.extraData||(t.data.extraData={}),f.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0}),this._navigateToItemAction.execute(e).then(function(){var e=m&&n.extension?Object(p.e)(n.extension):n.extension||"",t={fileType:l.e[n.type||l.e.Unknown],extension:e};return r.n.resolve({resultType:o.t.Success,extraData:t})})):r.n.resolve({resultType:o.t.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(s.e,{item:this.item})},t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case l.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case l.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}},t.prototype._computeItem=function(){var e=this._itemSelectionHelper.firstItem();return(3===this._openRelation?e&&e.UNSAFE_parent:e)||_},t}(i.e);t.t=h},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(13),r=new a.t({name:"EnableNewOneUpCommandBarResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableNewOneUpCommandBar))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(13),r=new a.t({name:"EnableDarkThemeForOneUpMediaResourceKey",factory:new a.e(Object(i.isFeatureEnabled)(i.EnableDarkThemeForOneUpMediaViewer))})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("TextViewerHelper")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("KnockoutContentShim")},,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=["00000002-0000-0ff1-ce00-000000000000","2d4d3d8e-2be3-4bef-9f87-7875a61c29de","00000007-0000-0ff1-ce00-000000000000","cc15fd57-2c6c-4117-a88c-83b1d56b4bbe","5e3ce6c0-2b1f-4285-8d4b-75ee78787346","1fec8e78-bce4-4aaf-ab1b-5451cc387264","3ab4b783-69c8-4af2-b6b3-7bb6d4bcff21","944f0bd1-117b-4b1c-af26-804ed95e767e","4345a7b9-9a63-4910-a426-35363201d503","4765445b-32c6-49b0-83e6-1d93765276ca","d3590ed6-52b3-4102-aeff-aad2292ab01c","27922004-5251-4030-b22d-91ecd9a37ea4","4b3e8f46-56d3-427f-b1e2-d239b2ea6bca"];function i(e){return!e||a.indexOf(e.toLowerCase())>=0}}],Array(73),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(0),i=n(59),r=n(135),o=n(128),s=n(70),c=n(1187),d=n(77),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a.isVaultDisabled=a.createObservable(void 0),a.vaultFreState=a.createObservable(c.a.NotCreated),a.vaultQuota=a.createObservable(void 0),a.isOverQuota=a.createPureComputed(a._computeIsOverQuota),a.showVaultLockNotification=a.createObservable(!1),a.showVaultFreMessage=a.createObservable(!1),a.storageKeyPrefix=c.t+a._identityDataSource.getIdentity().id,a.dataStore=new o.e(a.storageKeyPrefix,s.e.local),a.isVaultOpen=a.createObservable(!!a.dataStore.getValue("expirationtime",s.e.local)),a}return Object(a.__extends)(t,e),t.prototype._computeIsOverQuota=function(){var e=this.vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0},t}(i.n);t.default=l;var u=Object(r.r)("VaultStore",l,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{identityDataSource:d.D}))}],Array(160),[function(e,t,n){"use strict";n.r(t),n.d(t,"KOToItemItemCacheOperationProvider",function(){return Ae}),n.d(t,"resourceKey",function(){return Le});var a=n(1156),i=n(814),r=n(1069),o=n(887),s=n(135),c=n(0),d=n(140),l=n(1930),u=n(482),f=n(115),p=n(64),m=n(94),_=n(2708),h=n(191),b=n(59),g=n(332),v=n(2),y=n(440),S=n(31),D=n(372),I=new v.e("legacyKnockoutOperation"),x=new S.e("legacyKnockoutOperationItem",{id:D.e}),C=new v.e("legacyKnockoutOperationCommands"),O=new y.e("legacyKnockoutOperation"),w=n(600),E=n(1),A=n(22),L=n(29),k=n(487),M=n(726),P=n(184),T=n(847),U=n(1256);function F(e){switch(e){case d.e.created:return p.a.created;case d.e.started:return p.a.started;case d.e.completed:return p.a.completed;case d.e.failed:return p.a.failed;case d.e.canceled:return p.a.canceled;case d.e.expired:return p.a.expired;default:return}}function H(e){switch(e){case p.a.created:return d.e.created;case p.a.started:return d.e.started;case p.a.completed:return d.e.completed;case p.a.failed:return d.e.failed;case p.a.canceled:return d.e.canceled;case p.a.expired:return d.e.expired;default:return}}function R(e){var t=e.minimum,n=e.maximum;return{current:e.current-t,total:n-t}}var N=n(14),B=n(78),j=n(21),V=n(41),z=n(208),G=function(e){var t=e.isAvailableObservable,n=e.onExecute,a=Object(z.n)(t),i={name:e.engagementName};return E.createElement(V.e,{isAvailable:a,onExecute:n,engagement:i})},K=n(65),W=function(e){var t=e.actions,n=Object(z.a)(),a=E.useMemo(function(){return n.pureCompute(function(){return t.filter(function(e){return e.isAvailable()})})},[]),i=E.useMemo(function(){return n.pureCompute(function(){return a().length>0})},[]);return E.createElement(G,{isAvailableObservable:i,onExecute:function(){return Object(c.__awaiter)(void 0,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all(a.peek().map(function(e){return e.execute()}))];case 1:return e.sent(),[2]}})})}})},q=n(6),Q=n(3501),Y=n(2898);function J(e,t){var n=t.itemKey,a=Object(Y.e)(e,n);return e.demandItemFacet(q.h,n)&&a?{fileTypeIconAs:Q.e}:{}}var X=n(2707),Z=n(27),$=n(100),ee=n(807),te=n(8),ne=te.e.isActivated("BA29806D-E236-4C4E-937B-56D4FE09D83C","03/11/2022","Enable full Knockout bindings in titles and descriptions"),ae=te.e.isActivated("B92EF5D9-ED21-4327-AD14-759FF8032245","09/01/2022","Bump KO children key if template/view model is updated"),ie=Object(A.t)(function(){return function(e){e(Object(L.t)(O,k.e)(le)),e(Object(L.t)(O,X.e)(re)),e(Object(L.t)(x,M.e)(J))}});function re(e,t){return{isAvailable:!1}}var oe=[],se=new K.e("shouldShowErrors",function(e,t){var n=t.itemKey;if(e.demandItemFacet(B.r,n)){var a=e.demandItemFacet(j.e,n),i=null==a?void 0:a.itemKeys;if(i)for(var r=0,o=0,s=i;o<s.length;o++){var c=s[o];if(!!e.demandItemFacet(f.t,c)&&r++,r>=4)return!0}return!1}return!0}),ce=new K.e("legacyKnockoutCommands",function(e,t){var n=t.itemKey,a=[];if(e.demandItemFacet(B.r,n)){var i=e.demandItemFacet(j.e,n),r=null==i?void 0:i.itemKeys;if(r){for(var o=new Map,s=0,c=r;s<c.length;s++){var d=c[s];if(p=e.demandItemFacet(C,d))for(var l in p){var u=p[l],f=o.get(l);void 0===f&&(f=[],o.set(l,f)),f.push(u)}}o.forEach(function(e,t){var n=de(t,2,E.createElement(W,{actions:e}));a.push(n)})}}else{var p;if(p=e.demandItemFacet(C,n))for(var l in p){var m=(u=p[l]).key,_=u.isAvailable,h=u.execute,b=u.count,g=E.createElement(G,{isAvailableObservable:_,onExecute:h.bind(u),engagementName:m}),v=de(m,b.peek(),g);a.push(v)}}return a});function de(e,t,n){var a={count:fe(t),states:fe({}),payloads:fe({}),progress:null,error:fe(void 0)},i=T.e.actions[e];return{key:e,name:i&&i.name&&Object(T.n)(i.name,a),action:n,commandBarButtonAs:i&&i.commandBarButtonAs}}function le(e,t){var n=t.itemKey,a=t.format,i=function(e,t){var n=t,a=e.demandItemFacet(f.t,t);if(e.demandItemFacet(B.r,t)){var i=e.demandItemFacet(j.e,t),r=null==i?void 0:i.itemKeys,o=r&&r.length>0&&r[0];if(!o)return;if(n=o,!a)for(var s=0,d=r;s<d.length;s++){var l=d[s],u=e.demandItemFacet(f.t,l);if(u){a=u;break}}}var p=e.demandItemFacet(I,n);if(p)return Object(c.__assign)(Object(c.__assign)({progressItemKey:n},p),{error:a})}(e,n);if(!i)return{};var r=i.type,o=i.payloads,s=i.name,m=i.error,_=Object(P.n)(e,{itemKey:n}),h=H(_);if(void 0===h||void 0===r)return{};var b,g,v=e.demandItemFacet(N.n,N.e),y=d.e[h],S=u.e[r],D=u.e[u.e.multiple],x=T.e.types[S],C=T.e.types[D],O=x.states[y],w=C.states[y],A=Object(P.t)(e,{itemKey:n}),L=A[_],k=e.demandItemFacet(p.u,n),M=e.demandItemFacet(se,n),F={count:fe(L),states:fe(A),error:fe(m&&new l.e(m)),payloads:fe(o),progress:{minimum:fe(0),maximum:fe(k?k.total:1),current:fe(k?k.current:0)}};if("summary"===a){var R=O&&(O.shortTitle||O.title)||w&&(w.shortTitle||w.title)||x.shortTitle||C.shortTitle;return{title:U.e({context:F,resources:v},Object(T.n)(R,F))}}if("item"===a)s&&(b=s);else{var V=O&&O.title||w&&w.title||x.title||C.title;b=ne?U.e({context:F,resources:v},Object(T.n)(V,F)):E.createElement(ue,{viewModel:{context:F,resources:v},template:Object(T.n)(V,F)})}var z=oe;if(M){var G=O&&O.description||w&&w.description||x.description||C.description;g=ne?U.e({context:F,resources:v},Object(T.n)(G,F)):E.createElement(ue,{viewModel:{context:F,resources:v},template:Object(T.n)(G,F)}),z=e.demandItemFacet(ce,n)}return{title:b,description:g,commands:z,error:m}}function ue(e){var t=e.viewModel,n=e.template,a=E.useRef(0);E.useMemo(function(){ae||a.current++},[t,n]);var i="".concat(a.current),r=Object($.e)(function(e,a){return e.innerHTML=n,Z.applyBindings(a.extend({$data:t}),e),{dispose:function(){return Z.cleanNode(e)}}});return E.createElement(ee.e,{key:i,applyBindings:r})}function fe(e){function t(t){if(!(arguments.length>0))return e;e=t}return t.prototype.peek=function(){return e},t}var pe=n(886),me=n(108),_e=n(1910),he=n(244),be=n(304),ge=n(46),ve=n(413),ye=n(1784),Se=n(1547),De=n(74),Ie=n(488),xe=!te.t.isActivated("3DB31A1A-65ED-4E5D-9B4D-899DEEECD028","05/19/2023","Pack color and folder facet for move/copy operation"),Ce=0,Oe=new WeakMap,we=function(){function e(e,t){var n=this,a=t.itemCacheObservablesFactory,r=t.observablesFactoryType,o=t.itemCacheStore,s=t.platformDetection;this._isRetinaSupported=s.isRetinaSupported,this._scope=new h.e;var d=this._scope.attach(new r({owner:this}));this._itemCacheStore=o,this._sourceItemKey=x.serialize({id:Ce++}),this.batch=e.batch||new i.e;var l=function(e){var t=Oe.get(e),n=void 0===t;return n&&(t=w.e.serializeNext(),Oe.set(e,t)),{batchKey:t,isNew:n}}(this.batch),u=l.batchKey,f=l.isNew;this.visibility=d.create(e.visibility||0);var p=this._createItemCacheProgressItem(e,u,f);this._progressItemKey=p;var m=R(Object(c.__assign)({minimum:0,maximum:0,current:0},e.progress||{}));this._updateItemCacheProgress(m),this._initializeActions(e.actions),this._progressItemData=this._scope.attach(a.pureCompute(function(e){return Object(_.e)(e,{itemKey:n._progressItemKey,progressFormat:"item"})})),this._progressItemData.equalityComparer=be.t,this._knockoutOperationData=this._scope.attach(a.pureCompute(function(e){return e.demandItemFacet(I,n._progressItemKey)})),this._knockoutOperationData.equalityComparer=be.t,this._knockoutActions=this._scope.attach(a.pureCompute(function(e){return e.demandItemFacet(C,n._progressItemKey)||{}})),this.name=e.name,this.iconName=e.iconName,this.state=d.compute(this._createStateObservableDef()),this.warning=d.create(""),this.error=d.compute(this._createErrorObservableDef()),this.count=d.create(1);var b=Object(c.__assign)({minimum:0,maximum:0},e.progress||{});this.progress={minimum:d.create(b.minimum),maximum:d.create(b.maximum),current:d.compute(this._createCurrentProgressObservableDef())},this.type=d.compute(this._createTypeObservableDef()),this.actions=d.compute(this._createActionsObservableDef()),this.payloads=d.compute(this._createPayloadsObservableDef())}return e.getActiveProgressItemKeys=function(e){var t=e.demandItemFacet(j.e,ve.e),n=new Set;if(null==t?void 0:t.itemKeys)for(var a=0,i=t.itemKeys;a<i.length;a++){var r=i[a],o=e.demandItemFacet(j.e,r);if(null==o?void 0:o.itemKeys)for(var s=0,c=o.itemKeys;s<c.length;s++){var d=c[s];n.add(d)}}return n},e.cleanupKOOperations=function(e,t){for(var n=[],a=0,i=e.peek();a<i.length;a++){var r=i[a];t.has(r._progressItemKey)||(r.dispose(),n.push(r))}e.removeAll(n)},e.prototype._createItemCacheProgressItem=function(e,t,n){var a,i,r,o,s,d=this._itemCacheStore.dispatch,l=e.name,f=e.iconName,_=e.type,h=e.payloads;d(ie);var b=O.serializeBatchKey(t);d(Object(Ie.e)({owner:this,items:(a={},a[b]={},a)}));var g=O.serializeTaskKey(t,this._sourceItemKey,{}),y=new ge.e;if(y.resolveItems({items:(i={},i[g]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},p.y.pack({itemKey:this._sourceItemKey})),I.pack({name:l,type:_||u.e.multiple,payloads:h||{}})),p.g.pack(p.a.created)),i)}),2!==this.visibility.peek()){n&&y.resolveItems({items:(r={},r[ve.e]=Object(v.n)({childItems:j.e},{childItems:{itemKeys:new ye.e([b],function(e){return e})}}),r[b]=Object(c.__assign)({},j.r.pack({itemKey:ve.e})),r)}),y.resolveItems({items:(o={},o[b]=Object(c.__assign)(Object(c.__assign)({},Object(v.n)({childItems:j.e},{childItems:{itemKeys:new ye.e([g],function(e){return e})}})),B.r.pack(!0)),o[g]=Object(c.__assign)({},j.r.pack({itemKey:b})),o)});var S=function(e){var t,n,a=e.type,i=e.payloads;switch(a){case u.e.moveItems:return null===(t=null==i?void 0:i.moveItems)||void 0===t?void 0:t.item;case u.e.copyItems:return null===(n=null==i?void 0:i.moveItems)||void 0===n?void 0:n.item}}(e),D=null==S?void 0:S.color,x=!!(null==S?void 0:S.folder);this._itemCacheStore.dispatch(Object(m.e)({items:(s={},s[this._sourceItemKey]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},f?me.n.pack({height:48,width:48,url:Object(_e.n)(this._isRetinaSupported,f,48)}):{}),xe&&x?q.h.pack({}):{}),xe&&D?q.r.pack(D):{}),s)}))}return this._itemCacheStore.dispatch(y.execute()),g},e.prototype.dispose=function(){this.actions({}),this.payloads({}),this._itemCacheStore.dispatch(Object(Ie.n)({owner:this})),this._scope.dispose()},e.prototype._createTypeObservableDef=function(){var e=this;return{read:function(){var t;return(null===(t=e._knockoutOperationData())||void 0===t?void 0:t.type)||u.e.multiple},write:function(t){var n;e._itemCacheStore.dispatch(Object(m.e)({items:(n={},n[e._progressItemKey]=Object(c.__assign)({},I.pack({type:t})),n)}))},pure:!0}},e.prototype._createStateObservableDef=function(){var e=this;return{read:function(){return H(e._progressItemData().phase)||d.e.created},write:function(t){var n;e._itemCacheStore.dispatch(Object(m.e)({items:(n={},n[e._progressItemKey]=Object(c.__assign)({},p.g.pack(F(t))),n)}))},pure:!0}},e.prototype._createErrorObservableDef=function(){var e=this;return{read:function(){var t=e._progressItemData().error;return t&&new l.e({message:t.message})},write:function(t){var n;e._itemCacheStore.dispatch(Object(m.e)({items:(n={},n[e._progressItemKey]=Object(c.__assign)({},Object(v.n)({error:f.t},{error:t?new Se.e(t):new De.e})),n)}))},pure:!0}},e.prototype._createPayloadsObservableDef=function(){var e=this;return{read:function(){var t=e._knockoutOperationData();return t&&t.payloads||{}},write:function(t){var n;e._itemCacheStore.dispatch(Object(m.e)({items:(n={},n[e._progressItemKey]=Object(c.__assign)({},I.pack({payloads:t})),n)}))},pure:!0}},e.prototype._createCurrentProgressObservableDef=function(){var e=this;return{read:function(){var t,n,a,i=e.progress.minimum(),r=e.progress.maximum();return(t=e._progressItemData().percentComplete||0,n=i,a=r,void 0===n&&(n=0),void 0===a&&(a=1),{minimum:n,maximum:a,current:t*(a-n)+n}).current},write:function(t){var n=R({minimum:e.progress.minimum.peek(),maximum:e.progress.maximum.peek(),current:t});e._updateItemCacheProgress(n)},pure:!0}},e.prototype._createActionsObservableDef=function(){var e=this;return{read:function(){return e._knockoutActions()},write:function(t){e._updateItemCacheActions(t)},pure:!0}},e.prototype._updateItemCacheProgress=function(e){var t;this._itemCacheStore.dispatch(Object(m.e)({items:(t={},t[this._progressItemKey]=Object(c.__assign)({},p.v.pack(e)),t)}))},e.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this._scope.attach(new pe.e({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this._updateItemCacheActions(t)},e.prototype._updateItemCacheActions=function(e){var t;this._itemCacheStore.dispatch(Object(m.e)({items:(t={},t[this._progressItemKey]=Object(c.__assign)({},C.pack(e)),t)}))},e}(),Ee=Object(s.o)("KOToItemCacheOperation",we,{observablesFactoryType:b.i,itemCacheObservablesFactory:a.e,itemCacheStore:g.e,platformDetection:he.e}),Ae=function(){function e(e,t){void 0===e&&(e={});var n=t.observablesFactoryType,a=t.itemCacheObservablesFactory;this._scope=new h.e,this._observables=this._scope.attach(new n({owner:this}));var s=this._observables,c=t.itemCacheOperationType;this._itemCacheOperationType=c;var d=new i.e;this._observers=s.createArray();var l=this.operations=this._koToItemCacheOperations=s.createArray();this._activeProgressItemKeys=this._scope.attach(a.pureCompute(function(e){return we.getActiveProgressItemKeys(e)}));var u=this._scope.attached(r.e),f=this.groups=this._scope.attach(o.e.group(l,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new u({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));this.overall=new(this._scope.attach(r.e))({batch:d,operations:f}),this.isLocked=s.pureCompute(this._computeIsLocked),s.backgroundCompute(this._computeRemoveObsoleteOperations).extend({deferred:!0})}return e.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},e.prototype.register=function(e){var t=new this._itemCacheOperationType(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},e.prototype.deleteGroupOperation=function(e){},e.prototype.cleanup=function(e){void 0===e&&(e=!1)},e.prototype._computeIsLocked=function(){return this._observers().length>0},e.prototype._computeRemoveObsoleteOperations=function(){var e=this._activeProgressItemKeys();we.cleanupKOOperations(this._koToItemCacheOperations,e)},e.dependencies={itemCacheObservablesFactory:a.e,observablesFactoryType:b.i,itemCacheOperationType:Ee},e}(),Le=Object(s.r)("KOToItemCacheOperationProvider",Ae)},,function(e,t,n){"use strict";n.d(t,"e",function(){return B});var a,i=n(0),r=n(75),o=n(128),s=n(59),c=n(70),d=n(1022),l=n(333),u=n(122),f=n(8),p=n(95),m=n(25),_=n(3),h=f.e.isActivated("32EFD01C-F19C-40EE-8D8B-A1DD8E17C898","05/12/2022","This avoids 99 cap limit on return in used percentage"),b=function(e){function t(t){var n=e.call(this,t)||this;return n._data=t.data,n._isUsqForUnmigratedUserEnabled=!Object(p.e)(m.T)&&Object(_.cs)(_.Qt),n.total=n.createPureComputed(n._computeTotal),n.used=n.createPureComputed(n._computeUsed),n.overage=n.createPureComputed(n._computeOverage),n.remaining=n.createPureComputed(n._computeRemaining),n.usedPercentage=n.createPureComputed(n._computeUsedPercentage),n.status=n.createPureComputed(n._computeStatus),n.canUpgrade=n.createPureComputed(n._computeCanUpgrade),n}return Object(i.__extends)(t,e),t.prototype._computeTotal=function(){var e,t,n=this._data();return this._isUsqForUnmigratedUserEnabled?null===(e=null==n?void 0:n.unifiedStorageQuota)||void 0===e?void 0:e.total:null===(t=null==n?void 0:n.quota)||void 0===t?void 0:t.total},t.prototype._computeUsed=function(){var e=this._data(),t=this._isUsqForUnmigratedUserEnabled?null==e?void 0:e.unifiedStorageQuota:null==e?void 0:e.quota;return this.status()===d.e.full&&t&&t.used>t.total?t.total:null==t?void 0:t.used},t.prototype._computeOverage=function(){var e=this._data(),t=this._isUsqForUnmigratedUserEnabled?null==e?void 0:e.unifiedStorageQuota:null==e?void 0:e.quota,n=this._isUsqForUnmigratedUserEnabled?{language:u.t.language,numberOfDecimals:1}:{language:u.t.language};if(t){var a=t.used-t.total;return l.e.getDisplayString(a,n)}},t.prototype._computeRemaining=function(){var e,t,n,a,i=this._data(),r=this._isUsqForUnmigratedUserEnabled?null===(e=null==i?void 0:i.unifiedStorageQuota)||void 0===e?void 0:e.total:null===(t=null==i?void 0:i.quota)||void 0===t?void 0:t.total,o=this._isUsqForUnmigratedUserEnabled?null===(n=null==i?void 0:i.unifiedStorageQuota)||void 0===n?void 0:n.used:null===(a=null==i?void 0:i.quota)||void 0===a?void 0:a.used,s=this._isUsqForUnmigratedUserEnabled?{language:u.t.language,numberOfDecimals:1}:{language:u.t.language},c=r&&o?Math.max(r-o,0):0;return l.e.getDisplayString(c,s)},t.prototype._computeStatus=function(){var e,t=this._data();if(!t||!t.quota||!t.status)return d.e.unknown;var n=!t.quota.storagePlans.upgradeAvailable,a=!!t.status.lockdownDateTime,i=this._isExcludedFromLockdown(t.status.lockdownDateTime),r=this._isDelinquent(t.status.lockdownReasons);if(this._isUsqForUnmigratedUserEnabled)switch(null===(e=null==t?void 0:t.unifiedStorageQuota)||void 0===e?void 0:e.state.toLowerCase()){case"normal":return this._getServerStatusAt70ForFreeUsers();case"nearing":return d.e.nearing;case"critical":return d.e.critical;case"full":return d.e.full;case"overquota":case"overlimit":return"lockedDown"===t.status.state&&r?d.e.overQuota:a?i?d.e.outOfSpace:d.e.overQuota:d.e.outOfSpace;default:return d.e.unknown}switch(t.quota.state){case"normal":return this._getServerStatusAt70ForFreeUsers();case"nearing":case"critical":return this._getServerStatusAt99ForPaidUsers();case"exceeded":return"lockedDown"===t.status.state&&r?d.e.overQuota:a?i?d.e.outOfSpace:d.e.overQuota:n?d.e.outOfSpace:d.e.full}return d.e.unknown},t.prototype._getServerStatusAt70ForFreeUsers=function(){return(0,this.usedPercentage)()>=70&&this.canUpgrade()?d.e.nearing:d.e.normal},t.prototype._getServerStatusAt99ForPaidUsers=function(){var e=this.usedPercentage;return this.canUpgrade()?d.e.nearing:e()>=99?d.e.critical:d.e.normal},t.prototype._isExcludedFromLockdown=function(e){return!(!e||9999!==new Date(e).getFullYear())},t.prototype._isDelinquent=function(e){return!(!e||!e.length)&&e.indexOf("delinquent")>=0},t.prototype._computeUsedPercentage=function(){var e,t,n,a,i=this._data(),r=this._isUsqForUnmigratedUserEnabled?null===(e=null==i?void 0:i.unifiedStorageQuota)||void 0===e?void 0:e.total:null===(t=null==i?void 0:i.quota)||void 0===t?void 0:t.total,o=this._isUsqForUnmigratedUserEnabled?null===(n=null==i?void 0:i.unifiedStorageQuota)||void 0===n?void 0:n.used:null===(a=null==i?void 0:i.quota)||void 0===a?void 0:a.used;if(!r||!o)return 0;var s=o/r*100;return h?Math.floor(Math.min(s,99)):Math.floor(s)},t.prototype._computeCanUpgrade=function(){var e=this._data();if(e&&e.quota){var t=e.quota.storagePlans;return t?t.upgradeAvailable:e.quota.total<1099511627776}return!1},t}(s.n),g=n(242),v=n(1151),y=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.monitor=function(e){var t=this;if(!e)return r.n.wrapError(new Error("There was no monitor url provided."));var n=new g.e,a=this.async.setInterval(function(){v.e.start({url:e}).then(function(e){a&&!t._checkStatus(e,n)&&(t.async.clearInterval(a),a=null)})},3e4);return n.getPromise()},t.prototype._checkStatus=function(e,t){var n,a=e?e.responseText:"No request returned";if(e&&e.responseText)try{n=JSON.parse(e.responseText)}catch(e){}if(n.quota)return t.complete(),!1;if(!n||!n.status)return t.error(new Error("Unexpected response: "+a)),!1;switch(n.status){default:return!0;case"completed":return t.complete(),!1;case"failed":case"deleteFailed":return t.error(new Error("Operation failed: "+a)),!1}},t}(s.n),S=n(2587),D=n(709),I=function(e){function t(t){var n=e.call(this,t)||this;return n._data=t.data,n.accountState=n.createPureComputed(n._computeAccountState),n.primaryLockedReason=n.createPureComputed(n._computePrimaryLockedReason),n.lockdownDate=n.createPureComputed(n._computeLockdownDate),n.driveDeletionDate=n.createPureComputed(n._computeDriveDeletionDate),n.userUnlocksRemaining=n.createPureComputed(n._computeUserUnlocksRemaining),n.lastUnlockDate=n.createPureComputed(n._computeLastUnlockDate),n.isSoftLocked=n.createPureComputed(n._computeIsSoftLocked),n.isTemporararilyUnfrozen=n.createPureComputed(n._computeIsTemporararilyUnfrozen),n.isGoingToBeLockedSoon=n.createPureComputed(n._computeIsGoingToBeLockedSoon),n.isUnlockInProgress=n.createObservable(!1),n.createBackgroundComputed(n._computeIsUnlockInProgress),n}return Object(i.__extends)(t,e),t.prototype._computeAccountState=function(){var e=this._data();return e&&e.status?"active"===e.status.state?1:2:0},t.prototype._computeIsSoftLocked=function(){var e=this._data();return!(!e||!e.status)&&"lockedDown"===e.status.state&&"restricted"===e.status.lockdownItemAccess},t.prototype._computeIsTemporararilyUnfrozen=function(){var e=this._data();return e&&e.status&&e.status.lockdownDateTime&&"active"===e.status.state&&0===e.status.userUnlocksRemaining},t.prototype._computeIsGoingToBeLockedSoon=function(){var e=this._data();return e&&e.status&&e.status.lockdownDateTime&&"active"===e.status.state&&D.e.getDaysFromToday(e.status.lockdownDateTime)<=30},t.prototype._computePrimaryLockedReason=function(){var e=this._data();if(e&&e.status){for(var t=!1,n=!1,a=0,i=e.status.lockdownReasons||[];a<i.length;a++){var r=i[a];if("delinquent"===r)n=!0;else{if("inactive"!==r)return S.e.other;t=!0}}if(n)return S.e.delinquent;if(t)return S.e.inactive}return S.e.unknown},t.prototype._computeLockdownDate=function(){var e=this._data();return e&&e.status&&e.status.lockdownDateTime?e.status.lockdownDateTime:""},t.prototype._computeDriveDeletionDate=function(){var e=this._data();return e&&e.status&&e.status.driveDeletionDateTime?e.status.driveDeletionDateTime:""},t.prototype._computeLastUnlockDate=function(){var e=this._data();return e&&e.status&&e.status.lastUnlockDateTime?e.status.lastUnlockDateTime:""},t.prototype._computeUserUnlocksRemaining=function(){var e=this._data();if(e&&e.status)return e.status.userUnlocksRemaining},t.prototype._computeIsUnlockInProgress=function(){var e=this._data();if(e&&e.status){var t=e.status.pendingOperation;if(t&&t.type&&t.status&&"unlockdrive"===t.type.toLowerCase()&&"inprogress"===t.status.toLowerCase())return void this.isUnlockInProgress(!0)}this.isUnlockInProgress(!1)},t}(s.n),x=n(77);!function(e){e[e.normalLow=1]="normalLow",e[e.normalHigh=2]="normalHigh",e[e.inactive=3]="inactive",e[e.criticalLow=4]="criticalLow",e[e.criticalHigh=5]="criticalHigh",e[e.exceededLow=6]="exceededLow",e[e.exceededHigh=7]="exceededHigh",e[e.exceededLowCold=8]="exceededLowCold",e[e.exceededHighCold=9]="exceededHighCold",e[e.delinquentLow=10]="delinquentLow",e[e.delinquentHigh=11]="delinquentHigh",e[e.delinquentAgain=12]="delinquentAgain",e[e.delinquentSoftLocked=13]="delinquentSoftLocked"}(a||(a={}));var C=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._quotaDataSource=n.resources.consume(x.J),n.userDriveData=n.createObservable(null),n._exposeDebuggingTools(),n}return Object(i.__extends)(t,e),t.prototype.updateUserState=function(){var e=this;this._updateTimeout?this._needsUpdate=!0:(this._needsUpdate=!1,this._requestUserDriveData(),this._updateTimeout=this.async.setTimeout(function(){e._updateTimeout=null,e._needsUpdate&&e.updateUserState()},3e4))},t.prototype._requestUserDriveData=function(){var e=this;this._quotaDataSource.getQuotaInfo().then(function(t){e._updateUserDriveData(t)},function(e){}).done()},t.prototype._updateUserDriveData=function(e){if(!e)return null;if(e.quota){var t=e.quota;t.used=t.used||t.total-t.remaining,t.remaining=t.remaining>0?t.remaining:0}return this.userDriveData(e)},t.prototype._exposeDebuggingTools=function(){},t.prototype._getMessage=function(e){switch(e){case a.normalLow:return'NormalLow: Quota status is "normal" and the user does not have an office subscription.';case a.normalHigh:return'NormalHigh: Quota status is "normal" and the user has an office subscription.';case a.inactive:return"Inactive: The user's account has been locked due to inactivity.";case a.criticalLow:return'CriticalLow: Quota status is "critical" and the user does not have an office subscription.';case a.criticalHigh:return'CriticalHigh: Quota status is "critical" and the user has an office subscription.';case a.exceededLow:return'ExceededLow: Quota status is "exceeded" and the user does not have an office subscription.';case a.exceededHigh:return'ExceededHigh: Quota status is "exceeded" and the user has an office subscription.';case a.exceededLowCold:return'ExceededLowCold: Quota status is "exceeded" and the user does not have an office subscription. The user\'s account has been marked to be locked soon.';case a.exceededHighCold:return'ExceededHighCold: Quota status is "exceeded" and the user has an office subscription. The user\'s account has been marked to be locked soon.';case a.delinquentLow:return'DelinquentLow: Quota status is "exceeded" and the user does not have an office subscription. The user\'s account has been locked due to deliquency.';case a.delinquentHigh:return'DelinquentHigh: Quota status is "exceeded" and the user has an office subscription. The user\'s account has been locked due to deliquency.';case a.delinquentAgain:return'DelinquentAgain: Quota status is "exceeded" and the user does not have an office subscription. The user\'s account has been locked due to deliquency for the second time.';case a.delinquentSoftLocked:return"Account is soft locked for being over quota."}},t.prototype._updateData=function(e,t){var n=e.status,i=e.quota;if(t>=a.normalLow&&t<=a.inactive&&(i.state="normal",i.used=parseFloat((i.total/2).toFixed(2))),t!==a.criticalLow&&t!==a.criticalHigh||(i.state="critical",i.used=i.total-1),t>=a.exceededLow&&t<=a.delinquentSoftLocked&&(i.state="exceeded",i.used=parseFloat((1.2*i.total).toFixed(2))),i.remaining=i.total-i.used,t===a.exceededLowCold||t===a.exceededHighCold){var r=new Date;r.setDate(r.getDate()+7),e.status.lockdownDateTime=r.toISOString()}else e.status.lockdownDateTime=void 0;if(i.storagePlans.upgradeAvailable=!(t===a.normalHigh||t===a.criticalHigh||t===a.exceededHigh||t===a.exceededHighCold||t===a.delinquentHigh),t===a.inactive||t>=a.delinquentLow&&t<=a.delinquentSoftLocked){e.status.state="lockedDown",e.status.userUnlocksRemaining=t===a.delinquentAgain?0:1;var o=new Date;o.setDate(o.getDate()-30),e.status.lastUnlockDateTime=o.toISOString(),o.setDate(o.getDate()+60),e.status.driveDeletionDateTime=o.toISOString(),e.status.lockdownReasons=t===a.inactive?["inactive"]:["delinquent"],t===a.delinquentSoftLocked?e.status.lockdownItemAccess="restricted":e.status.lockdownItemAccess="denied"}else n.state="active",e.status.lockdownReasons=[]},t}(s.n),O=n(336),w=n(37),E=n(156),A=Object(O.e)({eventName:"QuotaUsage,Engagement,",shortEventName:"QuotaUsage"},{quotaStatus:w.e.String,quotaTotal:w.e.Number,quotaUsed:w.e.Number,accountState:w.e.String},E.e),L=n(2154),k=n(2176),M=n(1896),P=n(2425),T=n(2533),U=n(135),F=n(380),H="microsoft.od.unlocking.monitor",R=!f.e.isActivated("E435AB9B-59B2-49CC-9FBF-AC1039571D05","05/12/2022","Disable unnecessary resources for unuath users"),N=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;a._quotaDataSource=a.resources.consume(x.J),a._operationMonitor=new(a.managed(y)),a._dataStore=new o.e("UserStateProvider",c.e.local),a._identityDataSource=n.identityDataSource,a._requester=new(a.managed(C)),a._requester.updateUserState(),a._needsUpdate=a.resources.consume(M.e),R&&a._identityDataSource.getIdentity().type===F.e.anonymous||a.resources.consumeAsync(T.e.optional).then(function(e){e&&e.setupNotificationHandler({source:P.t.WebhookSubscription,scenarios:[P.e.DriveStatusChange,P.e.QuotaAllowanceChange,P.e.QuotaStateChange]},function(){a._needsUpdate(!0)})});var i=new(a.managed(I))({data:a._requester.userDriveData});a.accountState=i.accountState,a.primaryLockedReason=i.primaryLockedReason,a.lockdownDate=i.lockdownDate,a.driveDeletionDate=i.driveDeletionDate,a.userUnlocksRemaining=i.userUnlocksRemaining,a.lastUnlockDate=i.lastUnlockDate,a.isSoftLocked=i.isSoftLocked,a.isTemporararilyUnfrozen=i.isTemporararilyUnfrozen,a.isGoingToBeLockedSoon=i.isGoingToBeLockedSoon,a.isUnlockInProgress=i.isUnlockInProgress,a.quotaNeedsUpdate=a.createComputed(function(){return a._needsUpdate()});var r=new(a.managed(b))({data:a._requester.userDriveData});return a.total=r.total,a.used=r.used,a.overage=r.overage,a.remaining=r.remaining,a.status=r.status,a.usedPercentage=r.usedPercentage,a.canUpgrade=r.canUpgrade,a.createBackgroundComputed(a._computeLogStatus),a.createBackgroundComputed(a._computeMonitorUrlForActiveUnlock).extend({deferred:!0}),a.createBackgroundComputed(a._updateIfNeeded),a.isReady=a.createPureComputed(function(){return!!a._requester.userDriveData()}),a}return Object(i.__extends)(t,e),t.prototype.logEvent=function(e,t){var n=this._requester.userDriveData.peek();n&&n.quota&&(t=t||k.e.unknown,A.logData({name:k.e[t],scenario:L.e[e],quotaStatus:d.e[this.status.peek()],quotaTotal:n.quota.total,quotaUsed:n.quota.used,accountState:S.e[this.primaryLockedReason.peek()]}))},t.prototype.getNavigationUrl=function(e,t){var n=this._requester.userDriveData.peek();return this._quotaDataSource.getNavigationUrl({info:n?n.quota:null,isLocked:n&&n.status&&"active"!==n.status.state,status:this.status.peek(),destination:t,source:e})},t.prototype.unlockAccount=function(){var e=this;return this._quotaDataSource.unlockAccount().then(function(t){return e._dataStore.setValue(H,t),e._triggerUnlockingState(),e.isSoftLocked.peek()?(e._monitorUnlocking(t),r.n.resolve()):e._monitorUnlocking(t)})},t.prototype.getSuspendedUrl=function(){return this._quotaDataSource.getSuspendedUrl()},t.prototype._computeMonitorUrlForActiveUnlock=function(){var e=this.accountState();if(2===e){var t=this._dataStore.getValue(H);t&&(this._triggerUnlockingState(),this._monitorUnlocking(t))}else 1===e&&this._dataStore.remove(H)},t.prototype._triggerUnlockingState=function(){this.isUnlockInProgress(!0)},t.prototype._updateIfNeeded=function(){this._needsUpdate()&&(this._requester.updateUserState(),this._needsUpdate(!1))},t.prototype._monitorUnlocking=function(e){var t=this;if(e)return this._operationMonitor.monitor(e).then(function(){t._dataStore.remove(H),window.location.reload()});this.async.setTimeout(function(){window.location.reload()},3e4)},t.prototype._computeLogStatus=function(){this.status()!==d.e.unknown&&(this.primaryLockedReason(),this.logEvent(L.e.update,k.e.none))},t.dependencies=Object(i.__assign)(Object(i.__assign)({},s.n.dependencies),{identityDataSource:x.D}),t}(s.n),B=Object(U.r)("UserStateProvider",N)},,,,,,,,,,,,,function(e,t,n){"use strict";n(1591);var a=n(0),i=n(260),r=n(302),o=n(2055),s=n(1022),c=n(2154),d=n(2176),l=n(106),u=n(403),f=n(2852),p=n(47),m=n(122),_=n(40),h=n(333),b=n(32),g=n(109),v=n(709),y=n(3),S=Object(y.cs)(y.Qt)&&Object(y.cs)(y.Yt);function D(e){var t=1===e.accountState(),n=e.isSoftLocked(),a=e.isGoingToBeLockedSoon(),i=e.isTemporararilyUnfrozen(),r=e.status();return t&&!(i||a||n)&&r>=s.e.critical}var I=n(16),x=n(500),C=!I.e.isActivated("3DA6100B-86C1-4925-88F4-114C1B888685","02/23/2022","Show over quota component"),O=function(e){function t(t){var n=e.call(this,t)||this;n._userStateProvider=n.resources.consume(l.b),n._engagement=n.resources.consume(u.e);var a,i,r=n._userStateProvider.status(),o=[s.e.nearing,s.e.critical,s.e.full],y=[s.e.overQuota,s.e.outOfSpace],I=o.indexOf(r)>-1&&n.resources.consume(x.e),C=y.indexOf(r)>-1&&n.resources.consume(x.t);return n.isOverQuotaVisible=n.createComputed(function(){return!!C||D(n._userStateProvider)}),n.isOverQuotaVisible=n.createComputed(function(){return!!C||D(n._userStateProvider)}),n.isOverQuotaComponentReady=n.createObservable(!1),n.overQuotaComponent=n.createObservable(),n.createBackgroundComputed(n._initializeOverQuotaComponent),n._unfreezeHelper=n.resources.consume(f.resourceKey),n.displayLink=n.createComputed(function(){return n._userStateProvider.getNavigationUrl(c.e.leftNav,d.e.manageStorage)}),n.quotaMessage=n.createComputed(function(){return function(e,t,n){var a=e.status();if(t)return g.Ve;if(n)return S?g.Ve:g.D;if(e.isSoftLocked())return g.s;switch(a){case s.e.overQuota:return e.isTemporararilyUnfrozen()?g.f:g.d;case s.e.full:return g.k;case s.e.outOfSpace:return g.pe;case s.e.nearing:return g.oe;case s.e.critical:var i=e.usedPercentage();return _.format(g.v,i.toFixed(0));default:return null}}(n._userStateProvider,I,C)}),n.usedPercentage=n.createComputed(function(){return(e=n._userStateProvider.usedPercentage())?"".concat(Math.min(e,100),"%"):"0";var e}),n.iconComponent=n.createComputed(function(){return I||C?null:n._computeIconComponent()}),n.showBar=n.createComputed(function(){return n._userStateProvider.status()>s.e.unknown}),n.detailedMessage=n.createPureComputed(function(){return function(e,t){if(t)return null;if(e.isUnlockInProgress())return null;if(e.isSoftLocked()){if(e.userUnlocksRemaining()>0)return g.c;var n=e.lastUnlockDate(),a=e.lockdownDate(),i=v.e.getLongDateStringSafe(n,m.t.language),r=v.e.getLongDateStringSafe(a,m.t.language);return i&&r?_.format(g.u,i,r):(new p.e({name:"QuotaBarViewModel.ComputeDetailedMessage"}).end({resultCode:"BadUnlockDate",resultType:p.t.Failure,extraData:{unlockDate:n,lockDate:a}}),null)}return e.status()===s.e.overQuota&&e.isTemporararilyUnfrozen()&&(i=v.e.getLongDateStringSafe(this._userStateProvider.lastUnlockDate(),m.t.language))?_.format(g.p,i):null}(n._userStateProvider,C)}),n.unfreezeAction=n.createPureComputed(function(){return C?null:(e=n._userStateProvider,t=n._unfreezeHelper,e.isSoftLocked()&&e.userUnlocksRemaining()>0&&!e.isUnlockInProgress()?{text:g.Ge,onClick:function(){t.confirmUnfreezeWithDialog()}}:null);var e,t}),n.learnMoreAction=(a=n._userStateProvider,i=n.resources,{text:g.ae,onClick:function(){!function(e,t,n,a){var i=n.getNavigationUrl(c.e.leftNav,e),r=a.consume(b.e),o=new(a.injected(r.NavigationAction))({target:"_blank",url:i});n.logEvent(c.e.leftNav,e),o.execute(void 0)}(d.e.learnMore,0,a,i)}}),n.quotaDisplay=n.createComputed(function(){return function(e,t,n){var a=e.status(),i=e.used(),r=e.usedPercentage(),o=h.e.getDisplayString(e.total(),{trimDecimal:!0});if(t||n)return _.format(g.z,h.e.getDisplayString(i,{language:m.t.language,trimDecimal:!0}),o,Math.floor(r));switch(a){case s.e.unknown:return null;case s.e.overQuota:var c=e.overage();return _.format(g._e,c,o);case s.e.nearing:return h.e.getDisplayString(e.used(),{language:m.t.language,trimDecimal:!0});case s.e.critical:var d=e.remaining();return _.format(g.y,d);default:return h.e.getDisplayString(e.used(),{language:m.t.language,trimDecimal:!0})}}(n._userStateProvider,I,C)}),n.fluentQuotaDisplay=n.createPureComputed(function(){if(I||C)return n.quotaDisplay();var e=function(e){switch(e.status()){case s.e.nearing:var t=h.e.getDisplayString(e.total(),{language:m.t.language,trimDecimal:!0});return _.format(g.de,"",t);case s.e.critical:return null;default:var n=h.e.getDisplayString(e.total(),{language:m.t.language,trimDecimal:!0});return _.format(g.de,"",n)}}(n._userStateProvider);return"".concat(n.quotaDisplay()).concat(e||"")}),n.classes=n.createComputed(n._computeClasses.bind(n,I,C)),n}return Object(a.__extends)(t,e),t.prototype.logManageStorageClick=function(){return this._engagement.logData({name:"LeftNav.ManageStorage.Click"}),this._userStateProvider.logEvent(c.e.leftNav,d.e.manageStorage),!0},t.prototype._initializeOverQuotaComponent=function(){var e=this;C&&this.isOverQuotaVisible()&&(Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([601],4170)];case 1:return[2,e.sent().default]}})}).then(function(t){e.overQuotaComponent({name:t.tagName,params:{}})}),this.isOverQuotaComponentReady(!0))},t.prototype._computeIconComponent=function(){var e=this._userStateProvider.status();return this._userStateProvider.accountState().valueOf()===2..valueOf()?{name:o.e.tagName,params:{icon:new r.e("Blocked2")}}:e>=s.e.critical?{name:o.e.tagName,params:{icon:new r.e("Warning")}}:void 0},t.prototype._computeClasses=function(e,t){var n=this._userStateProvider.status(),a=n>=s.e.critical&&!this._userStateProvider.isTemporararilyUnfrozen()&&!this.isOverQuotaVisible()&&!this.unfreezeAction()||n===s.e.full;return{"od-QuotaBar-on":n>=s.e.unknown,"od-QuotaBar-full":n>=s.e.full&&n!==s.e.nearing,"od-QuotaBar-nearingOrCritical":n===s.e.critical||n===s.e.nearing,"od-QuotaBar-critical":n===s.e.critical,"od-QuotaBar-nearing":n===s.e.nearing,"od-QuotaBar-full--smallDialog":a,"od-QuotaBar-bottom--bottomPadding":!this.isOverQuotaVisible()&&!a&&!this.unfreezeAction(),"od-QuotaBar-nearingAndAbove":n>=s.e.critical,"od-QuotaBar-highOrOverQuota":e||t}},t}(i.t),w=O,E=n(402).e({tagName:"od-quota-bar",template:'<div><div class="od-QuotaBar" data-bind="css:classes">\x3c!--ko if:quotaDisplay()--\x3e\x3c!--ko if:quotaMessage()--\x3e<div class="od-QuotaBar-bottom"><div class="od-QuotaBar-primaryMessage">\x3c!--ko if:iconComponent--\x3e<div class="od-QuotaBar-icon" data-bind="component:iconComponent"></div>\x3c!--/ko--\x3e<div class="od-QuotaBar-text"><div class="od-QuotaBar-message" data-bind="text:quotaMessage"></div></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showBar--\x3e<div class="od-QuotaBar-bar"><div class="od-QuotaBar-total"></div><div class="od-QuotaBar-used" data-bind="style:{width:usedPercentage()}"></div></div>\x3c!--/ko--\x3e<div class="od-QuotaBar-top"><div class="od-QuotaBar-text"><a class="od-QuotaBar-link od-QuotaBar-link-remove-hover-text" data-bind="text:fluentQuotaDisplay,attr:{href:displayLink},css:{\'od-QuotaBar-linkRed\':quotaMessage()},click:logManageStorageClick"></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if:quotaMessage()--\x3e<div class="od-QuotaBar-bottom">\x3c!--ko if:detailedMessage--\x3e<div class="od-QuotaBar-detailedMessage"><span data-bind="text:detailedMessage"></span>\x3c!--ko if:learnMoreAction--\x3e&nbsp;<a class="od-QuotaBar-link" href="javascript:;" data-bind="text:learnMoreAction.text,click:learnMoreAction.onClick"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:unfreezeAction--\x3e<div class="od-QuotaBar-unfreezeButton"><a class="od-QuotaBar-link" href="javascript:;" data-bind="text:unfreezeAction().text,click:unfreezeAction().onClick"></a></div>\x3c!--/ko--\x3e\x3c!--ko if:isOverQuotaVisible--\x3e\x3c!--ko if:isOverQuotaComponentReady--\x3e\x3c!--ko with:overQuotaComponent--\x3e\x3c!--ko component:$data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>',viewModel:w,synchronous:!0});t.e=E},function(e,t,n){"use strict";n(1589);var a=n(0),i=n(260),r=n(824),o=n(75),s=n(133),c=n(109),d=n(156),l=n(2395),u=n(807),f=n(13),p=n(1829),m=n(32),_=n(106),h=n(40),b=n(1),g=n(2361),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return b.createElement(g.e,Object(a.__assign)({},this.props.teachingBubble),this.props.bodyText)},t}(b.Component),y=v,S=n(116),D={campaignGuid:"6fe7bade-54a3-4d36-a4dc-363e32aad2f8",flag:f.On},I=function(e){function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:u.t}),n._isLeftNavVisible=n.resources.consume(p.e.leftNav.isLeftNavVisible),n._actionMap=n.resources.consume(m.e),n._teachingBubbleProvider=n.resources.consume(_.O),n._premiumStateProvider=n.resources.consume(l.resourceKey),n._storageOptionsProvider=n.resources.consume(_.D),n._dime=n.resources.consume(r.resourceKey),n.jewelUrl=window.require.toUrl("odsp-media/images/premium/diamond-blue-24.svg"),n.isPremiumEligible=n.createObservable(!1),n.showPremiumUpsellBanner=n.createObservable(!1),n.showPremiumDescription=n.createObservable(!1),n.showTeachingBubble=n.createObservable(!1),n.learnMoreTooltip=n.createObservable(c.Re),n.containerTooltip=n.createObservable(c.ie),n.learnMoreId="od-PremiumUpsellBanner-LeftNav-link",n.ctaHeaderId="od-PremiumUpsellBanner-LeftNav-header",n.linkText=n.createObservable(Object(f.isFeatureEnabled)(f.EnableM365Basic)?c._:c.ae),n.message=n.createObservable(c.r),n.title=n.createObservable(Object(f.isFeatureEnabled)(f.EnableM365Basic)?c.R:c.i),n._installOfficeNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/?linkid=846359",target:"_blank"});var a=window.require.toUrl("odsp-media/images/premium/office-apps-upsell-teaching-bubble.svg");return n.teachingBubbleComponent=y,n.teachingBubbleComponentProps=n.createObservable({bodyText:c.j,teachingBubble:{calloutProps:{onDismiss:function(){return n.showTeachingBubble(!1)},directionalHint:s.e.rightCenter,calloutWidth:340},illustrationImage:{src:a},targetElement:null,hasCondensedHeadline:!0,hasCloseIcon:!0,headline:c.V,onDismiss:function(){return n.showTeachingBubble(!1)}}}),n._checkPremiumState(),n}return Object(a.__extends)(t,e),t.prototype.navigateToUpgradePage=function(e){void 0===e&&(e=!1),d.e.logData({name:"LeftNavUpsellClicked",isIntentional:!0});var t=e?"LearnMore":"GetMoreStorage",n=e?document.getElementById(this.learnMoreId):document.getElementById(this.ctaHeaderId);this._dime.navigate("LeftNav".concat(t),n)},t.prototype.onKeyDown=function(e,t){return t.keyCode!==S.e.enter||(this.navigateToUpgradePage(!1),!1)},t.prototype.onLinkClick=function(){this.isPremiumEligible.peek()?this.navigateToUpgradePage(!0):(this._installOfficeNavigationAction.execute(null),d.e.logData({name:"PremiumLeftNav.DownloadOfficeApps",isIntentional:!0}))},t.prototype.updateProps=function(){var e=document.getElementById("od-PremiumUpsellBanner-anchor");this.teachingBubbleComponentProps.peek().teachingBubble.targetElement=e},t.prototype._checkPremiumState=function(e){var t=this;void 0===e&&(e=!1),this._premiumStateProvider.getPremiumState(e).then(function(e){2===e?(t.isPremiumEligible(!0),t._storageOptionsProvider.getStorageOptions(!1).then(function(e){e.hasCurrentStoragePlan||(t._dime.init(),t.title(c.e),Object(f.isFeatureEnabled)(f.Onboarding50GBStandAlonePlanRamp)?t.message(c.a):t.message(c.t),t.linkText(c.ze),t.learnMoreTooltip(c.Ne),t._changeTeachingBubbleFor100GBUpsell(),t._isLeftNavVisible.peek()&&t._checkFor100GBTeachingBubble()),t._defaultShowPremiumLeftNav()}).catch(function(){t._defaultShowPremiumLeftNav()})):3===e&&(t._changeDialogStringsForOfficeUser(),t.showPremiumUpsellBanner(!0))})},t.prototype._changeDialogStringsForOfficeUser=function(){this.linkText(c.B),this.message(c.N),this.title(c.o),this.containerTooltip("")},t.prototype._changeTeachingBubbleFor100GBUpsell=function(){var e=this;this._premiumStateProvider.getLocalizedLowestStoragePlanPrice().then(function(t){t&&(e.teachingBubbleComponentProps.peek().bodyText=h.format(c.n,t),e.teachingBubbleComponentProps.peek().teachingBubble.headline="",e.teachingBubbleComponentProps.peek().teachingBubble.illustrationImage={})})},t.prototype._checkFor100GBTeachingBubble=function(){var e=this,t=this.resources.consume(_.A).datePositioningViewed(),n=!l.REMOVE_EXTRA_QUOTA_API_CALLS,a=this._teachingBubbleProvider.shouldBubbleBeAdded(D,!1,null,null,n);o.n.all({dateViewed:t,shouldViewBubble:a}).then(function(t){t.dateViewed&&t.shouldViewBubble&&Math.round(((new Date).getTime()-t.dateViewed.getTime())/1e3/60/60/24)>=14&&(e.showTeachingBubble(!0),e._teachingBubbleProvider.markBubbleAsDismissed(D))})},t.prototype._defaultShowPremiumLeftNav=function(){this.showPremiumUpsellBanner(!0),this.showPremiumDescription(!0)},t}(i.t),x=n(402).e({tagName:"od-premium-upsell-banner",template:'\x3c!--ko if:showPremiumUpsellBanner--\x3e<div class="od-PremiumUpsellBanner"><div class="od-PremiumUpsellBanner-anchor" id="od-PremiumUpsellBanner-anchor" data-bind="template:{afterRender:updateProps.bind($component)}">\x3c!--ko if:showTeachingBubble--\x3e<div data-bind="react:{componentType:teachingBubbleComponent,props:teachingBubbleComponentProps}"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:showPremiumDescription--\x3e<div class="od-PremiumUpsellBanner-details"><div class="od-PremiumUpsellBanner-message" data-bind="text:message"></div><a href="javascript:;" class="od-PremiumUpsellBanner-link" data-bind="text:linkText,click:onLinkClick,attr:{title:containerTooltip(),id:learnMoreId}"></a></div>\x3c!--/ko--\x3e<div id="od-PremiumUpsellBanner-LeftNav-header" class="od-PremiumUpsellBanner-header" data-bind="click:function(){return navigateToUpgradePage(false)},attr:{title:learnMoreTooltip(),id:ctaHeaderId},event:{keydown:onKeyDown}" tabindex="0" role="link"><div class="od-PremiumUpsellBanner-upsell"><i class="ms-Icon ms-Icon--Diamond od-PremiumUpsellBanner-jewel" data-bind="icon:true"></i><span data-bind="text:title"></span></div></div></div>\x3c!--/ko--\x3e',viewModel:I,synchronous:!0});t.e=x},function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-AppUpsell{margin:20px;padding:20px 12px 8px 12px;border:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-align:center;position:relative}.od-AppUpsell .ms-Icon.ms-Icon--Cancel{height:28px;width:28px;line-height:28px;position:absolute;top:0;border:0;background:0 0;cursor:pointer}[dir=ltr] .od-AppUpsell .ms-Icon.ms-Icon--Cancel{right:0}[dir=rtl] .od-AppUpsell .ms-Icon.ms-Icon--Cancel{left:0}.od-AppUpsell .od-Button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.lg .od-AppUpsell,.md .od-AppUpsell,.sm .od-AppUpsell{display:none}.od-AppUpsell-Message{text-align:center;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.od-AppUpsell-Image{margin:8px 0}"}]);var i=n(0),r=n(260),o=n(26),s=function(e){function t(t){var n=e.call(this,t)||this,a=t.onDismiss,i=t.action,r=t.message,s=t.buttonText;return n._onDismiss=a,n._action=i,n.message=r,n.buttonText=s,n.closeTooltip=o.CloseTooltip,n.imageUrl=window.require.toUrl("odsp-media/images/mobileappupsell/appupsellbanner.svg"),n}return Object(i.__extends)(t,e),t.prototype.onClick=function(e,t){return!this._action||(this._action.execute(t),!1)},t.prototype.onDismiss=function(e,t){return!this._onDismiss||(this._onDismiss(),!1)},t}(r.t),c=n(402).e({tagName:"od-app-upsell",template:'<div class="od-AppUpsell"><button class="od-AppUpsell-Close ms-Icon ms-Icon--Cancel" data-bind="icon:true,attr:{title:closeTooltip},click:onDismiss"></button><span class="od-AppUpsell-Message ms-font-s ms-font-weight-semilight" data-bind="text:message"></span><img class="od-AppUpsell-Image" role="presentation" data-bind="attr:{src:imageUrl}"><button class="od-Button" data-bind="attr:{\'aria-label\':buttonText},text:buttonText,click:onClick"></button></div>',viewModel:s,synchronous:!0});t.e=c},,,,function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:".od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"!important}"}]);var i=n(0),r=n(27),o=n(260),s=n(4310),c=n(2110),d=function(e){function t(t){var n=e.call(this,t)||this;return n.namePlaceholder=s.e,n.name=t.name,n.extension=t.extension,n.status=t.status||r.observable(""),n.hasError=t.hasError||r.observable(!1),n.isEnabled=t.isEnabled||r.observable(!0),n.hasFocus=t.hasFocus||r.observable(!0),n.namePlaceholder=t.namePlaceholder||n.namePlaceholder,n.nameAriaLabel=t.nameAriaLabel||"",n.addBindingHandlers({selectOnFocus:c.e}),n}return Object(i.__extends)(t,e),t.prototype.onClick=function(e,t){t.stopPropagation()},t}(o.t),l=n(402).e({tagName:"ms-item-name-editor",template:'<div class="od-ItemNameEditor" data-bind="css:{\'od-ItemNameEditor--noExtension\':!extension,\'is-focused\':hasFocus,\'is-error\':hasError}"><div class="od-TextField"><span class="od-ItemNameEditor-input"><input class="od-TextField-field" id="ItemNameEditor-input" type="text" data-bind="textInput:name,hasFocus:hasFocus,selectOnFocus,attr:{\'aria-label\':nameAriaLabel,placeholder:namePlaceholder},css:{\'od-ItemNameEditor-input--error\':hasError},click:onClick,enable:isEnabled,automation:\'itemNameEditor-Input\'"></span><span class="od-ItemNameEditor-extension" data-bind="text:extension"></span></div>\x3c!--ko if:hasError--\x3e<div class="od-ItemNameEditor-status" aria-live="assertive" role="status" data-bind="text:status,css:{\'od-ItemNameEditor-status--error\':hasError}"></div>\x3c!--/ko--\x3e</div>',viewModel:d,synchronous:!0});t.e=l}],Array(17),[function(e,t,n){"use strict";n.d(t,"e",function(){return A});var a=n(0),i=n(103),r=n(82),o=n(75),s=n(59),c=n(380),d=n(77),l=n(1903),u=n(1912),f=n(25),p=n(3),m=n(135),_=n(95),h=n(122),b="drive",g=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._pendingRequests={},a._identityDataSource=a.resources.consume(d.D),a}return Object(a.__extends)(t,e),t.prototype.getQuotaInfo=function(e){var t=this;if(void 0===e&&(e=!1),!e&&this._cachedUserDriveData)return o.n.resolve(this._cachedUserDriveData);if(Object(p.cs)(p.qr)&&Object(_.e)(f.T))return this.getQuotaInfoV2();var n=this._identityDataSource.getIdentity();if(n&&n.type===c.e.anonymous)return o.n.wrap(null);var a=this.resources.consume(l.e),i=u.t.viewerId,r=Object(p.cs)(p.Qt)?"/drive?expand=unifiedStorageQuota&select=*,quota":"/drives/".concat(i,"/"),s=Object(p.cs)(p.Qt)?{apiName:b,path:r,apiVersion:"v2.1",headers:{Prefer:"isusqenlightened","Accept-Language":h.e.language}}:{apiName:b,path:r};if(this._pendingRequests[r])return this._pendingRequests[r];var d=a.send(s).then(function(e){return delete t._pendingRequests[r],e&&e.quota?(t._cachedUserDriveData=e,e):null}).catch(function(e){return delete t._pendingRequests[r],o.n.wrapError(e)});return this._pendingRequests[r]=d,d},t.prototype.unlockAccount=function(){var e=this._identityDataSource.getIdentity();return e&&e.type===c.e.anonymous?o.n.wrap(null):this.resources.consume(l.e).send({requestType:"POST",apiName:"unlock",path:"/drive/status/action.unlockDrive/",parseResponse:function(e){return e.getResponseHeader("Location")}})},t.prototype.getQuotaInfoV2=function(){var e=this,t=this._identityDataSource.getIdentity();if(t&&t.type===c.e.anonymous)return o.n.wrap(null);var n=this.resources.consume(l.e),a="v2.1",i="/sites/root/consumerSiteAppConfigs/files";if(this._pendingRequests[i])return this._pendingRequests[i];var r=n.send({endpoint:Object(f.f)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:"driveV2",path:i,apiVersion:a,useAuthorizationHeaders:!0}).then(function(t){if(delete e._pendingRequests[i],t&&t.quota){var n={status:t.accountInfo.appStatus,quota:t.quota};return e._cachedUserDriveData=n,n}return null}).catch(function(t){return delete e._pendingRequests[i],o.n.wrapError(t)});return this._pendingRequests[i]=r,r},t.dependencies=Object(a.__assign)({},s.n.dependencies),t}(s.n),v=g,y=(Object(m.r)("QuotaService",g),n(2154)),S=n(405),D=n(2176),I=n(2248),x=n(8),C=n(1174),O=n(707),w=!x.e.isActivated("D48635C0-2579-44EE-9B3D-41D5CD50E40D","02/23/2022","Enable usage of in-app navigations instead of fwlink where possible in order to prevent unnecessary full page loads"),E=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._urlDataSource=a.resources.consume(S.n),a._navigation=a.resources.consume(r.e),a}return Object(a.__extends)(t,e),t.prototype.getNavigationUrl=function(e){switch(e.destination){case D.e.upgrade:return this._getUpgradeUrl(e);case D.e.learnMore:return e.isLocked,this._getFwlinkUrl("832804");case D.e.cleanUpFiles:return this._getCleanUpFilesUrl(e);case D.e.manageStorage:return this._getManageStorageUrl();case D.e.officePlans:return this._getOfficePlanseUrl(e)}},t.prototype.getSuspendedUrl=function(){var e=this.resources.consume(r.e).viewParams;return window.location.protocol+"//"+window.location.host+"/disabledaccounterror.aspx?"+i.n(Object(a.__assign)(Object(a.__assign)({},e),{gologin:void 0}),null,!0)},t.prototype._getManageStorageUrl=function(){return this._urlDataSource.getNewManageStorageUrl()},t.prototype._getUpgradeUrl=function(e){var t=this._getTrackingParams(e,"GetMoreStorage");return w?this._urlDataSource.getUpgradeOptionsUrl(t,!0):this._getFwlinkUrl("733395",t)},t.prototype._getOfficePlanseUrl=function(e){var t=this._getTrackingParams(e,"GetOffice365");return this._getFwlinkUrl("839555",t)},t.prototype._getCleanUpFilesUrl=function(e){var t,n=this._getTrackingParams(e,"CleanUpFiles");if(w){var a=n?{additionalViewParams:(t={},t.ocid=n,t)}:void 0;return this._urlDataSource.getSearchQueryUrl({query:"",largestSize:!0},a)}return this._getFwlinkUrl("786513",n)},t.prototype._getTrackingParams=function(e,t){var n=this._convertSource(e.source),a=this._convertStatus(e.status,e.isLocked),i=this._convertSource(e.source);return O.e?n&&a&&"PROD_OneDrive-Web_".concat(n,"_").concat(a,"_").concat(t):Object(C.e)(i,t)},t.prototype._getFwlinkUrl=function(e,t){var n={};t&&(n.hideLeftNav=!0),n.ocid=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"]||t;var a=i.n(n,null,!0);return"".concat("https://go.microsoft.com/fwlink/","?LinkId=").concat(e,"&").concat(a)},t.prototype._convertStatus=function(e,t){return t?"Frozen":Object(I.e)(e)},t.prototype._convertSource=function(e){switch(e){case y.e.leftNav:return"LeftNav";case y.e.manageStorage:return"ManageStorage";case y.e.quotaBlock:return"QuotaBlock";case y.e.lockedBlock:return"LockedBlock";case y.e.premiumLeftNav:return"PremiumLeftNav";case y.e.frozenBlock:return"FrozenBlock";case y.e.quotaBanner:return"QuotaBanner";case y.e.quotaBannerUpsell:return"HighQuotaBanner";case y.e.uploadProgressTile:return"UploadProgressTile";case y.e.moveCopyProgressTile:return"MoveCopyProgressTile";default:return null}},t.dependencies=Object(a.__assign)({},v.dependencies),t}(v),A=Object(m.r)("QuotaDataSource",E)}],Array(60),[function(e,t,n){"use strict";var a=n(17);Object(a.n)([{rawString:"html body .ms-bgColor-communicationShade30,html body .ms-bgColor-communicationShade30--hover:hover{background-color:#004578}html body .ms-bgColor-communicationShade20,html body .ms-bgColor-communicationShade20--hover:hover{background-color:#005a9e}html body .ms-bgColor-communicationShade10,html body .ms-bgColor-communicationShade10--hover:hover{background-color:#106ebe}html body .ms-bgColor-communicationPrimary,html body .ms-bgColor-communicationPrimary--hover:hover{background-color:#0078d4}html body .ms-bgColor-communicationTint10,html body .ms-bgColor-communicationTint10--hover:hover{background-color:#2b88d8}html body .ms-bgColor-communicationTint20,html body .ms-bgColor-communicationTint20--hover:hover{background-color:#c7e0f4}html body .ms-bgColor-communicationTint30,html body .ms-bgColor-communicationTint30--hover:hover{background-color:#deecf9}html body .ms-bgColor-communicationTint40,html body .ms-bgColor-communicationTint40--hover:hover{background-color:#eff6fc}html body .ms-bgColor-black,html body .ms-bgColor-black--hover:hover{background-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-bgColor-gray220,html body .ms-bgColor-gray220--hover:hover{background-color:#11100f}html body .ms-bgColor-gray210,html body .ms-bgColor-gray210--hover:hover{background-color:#161514}html body .ms-bgColor-gray200,html body .ms-bgColor-gray200--hover:hover{background-color:#1b1a19}html body .ms-bgColor-gray190,html body .ms-bgColor-gray190--hover:hover{background-color:#201f1e}html body .ms-bgColor-gray180,html body .ms-bgColor-gray180--hover:hover{background-color:#252423}html body .ms-bgColor-gray170,html body .ms-bgColor-gray170--hover:hover{background-color:#292827}html body .ms-bgColor-gray160,html body .ms-bgColor-gray160--hover:hover{background-color:#323130}html body .ms-bgColor-gray150,html body .ms-bgColor-gray150--hover:hover{background-color:#3b3a39}html body .ms-bgColor-gray140,html body .ms-bgColor-gray140--hover:hover{background-color:#484644}html body .ms-bgColor-gray130,html body .ms-bgColor-gray130--hover:hover{background-color:#605e5c}html body .ms-bgColor-gray120,html body .ms-bgColor-gray120--hover:hover{background-color:#797775}html body .ms-bgColor-gray110,html body .ms-bgColor-gray110--hover:hover{background-color:#8a8886}html body .ms-bgColor-gray100,html body .ms-bgColor-gray100--hover:hover{background-color:#979593}html body .ms-bgColor-gray90,html body .ms-bgColor-gray90--hover:hover{background-color:#a19f9d}html body .ms-bgColor-gray80,html body .ms-bgColor-gray80--hover:hover{background-color:#b3b0ad}html body .ms-bgColor-gray70,html body .ms-bgColor-gray70--hover:hover{background-color:#bebbb8}html body .ms-bgColor-gray60,html body .ms-bgColor-gray60--hover:hover{background-color:#c8c6c4}html body .ms-bgColor-gray50,html body .ms-bgColor-gray50--hover:hover{background-color:#d2d0ce}html body .ms-bgColor-gray40,html body .ms-bgColor-gray40--hover:hover{background-color:#e1dfdd}html body .ms-bgColor-gray30,html body .ms-bgColor-gray30--hover:hover{background-color:#edebe9}html body .ms-bgColor-gray20,html body .ms-bgColor-gray20--hover:hover{background-color:#f3f2f1}html body .ms-bgColor-gray10,html body .ms-bgColor-gray10--hover:hover{background-color:#faf9f8}html body .ms-bgColor-white,html body .ms-bgColor-white--hover:hover{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-bgColor-sharedPinkRed10,html body .ms-bgColor-sharedPinkRed10--hover:hover{background-color:#750b1c}html body .ms-bgColor-sharedRed20,html body .ms-bgColor-sharedRed20--hover:hover{background-color:#a4262c}html body .ms-bgColor-sharedRed10,html body .ms-bgColor-sharedRed10--hover:hover{background-color:#d13438}html body .ms-bgColor-sharedRedOrange20,html body .ms-bgColor-sharedRedOrange20--hover:hover{background-color:#603d30}html body .ms-bgColor-sharedRedOrange10,html body .ms-bgColor-sharedRedOrange10--hover:hover{background-color:#da3b01}html body .ms-bgColor-sharedOrange30,html body .ms-bgColor-sharedOrange30--hover:hover{background-color:#8e562e}html body .ms-bgColor-sharedOrange20,html body .ms-bgColor-sharedOrange20--hover:hover{background-color:#ca5010}html body .ms-bgColor-sharedOrange10,html body .ms-bgColor-sharedOrange10--hover:hover{background-color:#fa4}html body .ms-bgColor-sharedYellow10,html body .ms-bgColor-sharedYellow10--hover:hover{background-color:#fce100}html body .ms-bgColor-sharedOrangeYellow20,html body .ms-bgColor-sharedOrangeYellow20--hover:hover{background-color:#986f0b}html body .ms-bgColor-sharedOrangeYellow10,html body .ms-bgColor-sharedOrangeYellow10--hover:hover{background-color:#c19c00}html body .ms-bgColor-sharedYellowGreen10,html body .ms-bgColor-sharedYellowGreen10--hover:hover{background-color:#8cbd18}html body .ms-bgColor-sharedGreen20,html body .ms-bgColor-sharedGreen20--hover:hover{background-color:#0b6a0b}html body .ms-bgColor-sharedGreen10,html body .ms-bgColor-sharedGreen10--hover:hover{background-color:#498205}html body .ms-bgColor-sharedGreenCyan10,html body .ms-bgColor-sharedGreenCyan10--hover:hover{background-color:#00ad56}html body .ms-bgColor-sharedCyan40,html body .ms-bgColor-sharedCyan40--hover:hover{background-color:#005e50}html body .ms-bgColor-sharedCyan30,html body .ms-bgColor-sharedCyan30--hover:hover{background-color:#005b70}html body .ms-bgColor-sharedCyan20,html body .ms-bgColor-sharedCyan20--hover:hover{background-color:#038387}html body .ms-bgColor-sharedCyan10,html body .ms-bgColor-sharedCyan10--hover:hover{background-color:#00b7c3}html body .ms-bgColor-sharedCyanBlue20,html body .ms-bgColor-sharedCyanBlue20--hover:hover{background-color:#004e8c}html body .ms-bgColor-sharedCyanBlue10,html body .ms-bgColor-sharedCyanBlue10--hover:hover{background-color:#0078d4}html body .ms-bgColor-sharedBlue10,html body .ms-bgColor-sharedBlue10--hover:hover{background-color:#4f6bed}html body .ms-bgColor-sharedBlueMagenta40,html body .ms-bgColor-sharedBlueMagenta40--hover:hover{background-color:#373277}html body .ms-bgColor-sharedBlueMagenta30,html body .ms-bgColor-sharedBlueMagenta30--hover:hover{background-color:#5c2e91}html body .ms-bgColor-sharedBlueMagenta20,html body .ms-bgColor-sharedBlueMagenta20--hover:hover{background-color:#8764b8}html body .ms-bgColor-sharedBlueMagenta10,html body .ms-bgColor-sharedBlueMagenta10--hover:hover{background-color:#8378de}html body .ms-bgColor-sharedMagenta20,html body .ms-bgColor-sharedMagenta20--hover:hover{background-color:#881798}html body .ms-bgColor-sharedMagenta10,html body .ms-bgColor-sharedMagenta10--hover:hover{background-color:#c239b3}html body .ms-bgColor-sharedMagentaPink20,html body .ms-bgColor-sharedMagentaPink20--hover:hover{background-color:#9b0062}html body .ms-bgColor-sharedMagentaPink10,html body .ms-bgColor-sharedMagentaPink10--hover:hover{background-color:#e3008c}html body .ms-bgColor-sharedGray40,html body .ms-bgColor-sharedGray40--hover:hover{background-color:#393939}html body .ms-bgColor-sharedGray30,html body .ms-bgColor-sharedGray30--hover:hover{background-color:#7a7574}html body .ms-bgColor-sharedGray20,html body .ms-bgColor-sharedGray20--hover:hover{background-color:#69797e}html body .ms-bgColor-sharedGray10,html body .ms-bgColor-sharedGray10--hover:hover{background-color:#a0aeb2}html body .ms-borderColor-communicationShade30,html body .ms-borderColor-communicationShade30--hover:hover{border-color:#004578}html body .ms-borderColor-communicationShade20,html body .ms-borderColor-communicationShade20--hover:hover{border-color:#005a9e}html body .ms-borderColor-communicationShade10,html body .ms-borderColor-communicationShade10--hover:hover{border-color:#106ebe}html body .ms-borderColor-communicationPrimary,html body .ms-borderColor-communicationPrimary--hover:hover{border-color:#0078d4}html body .ms-borderColor-communicationTint10,html body .ms-borderColor-communicationTint10--hover:hover{border-color:#2b88d8}html body .ms-borderColor-communicationTint20,html body .ms-borderColor-communicationTint20--hover:hover{border-color:#c7e0f4}html body .ms-borderColor-communicationTint30,html body .ms-borderColor-communicationTint30--hover:hover{border-color:#deecf9}html body .ms-borderColor-communicationTint40,html body .ms-borderColor-communicationTint40--hover:hover{border-color:#eff6fc}html body .ms-borderColor-black,html body .ms-borderColor-black--hover:hover{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-borderColor-gray220,html body .ms-borderColor-gray220--hover:hover{border-color:#11100f}html body .ms-borderColor-gray210,html body .ms-borderColor-gray210--hover:hover{border-color:#161514}html body .ms-borderColor-gray200,html body .ms-borderColor-gray200--hover:hover{border-color:#1b1a19}html body .ms-borderColor-gray190,html body .ms-borderColor-gray190--hover:hover{border-color:#201f1e}html body .ms-borderColor-gray180,html body .ms-borderColor-gray180--hover:hover{border-color:#252423}html body .ms-borderColor-gray170,html body .ms-borderColor-gray170--hover:hover{border-color:#292827}html body .ms-borderColor-gray160,html body .ms-borderColor-gray160--hover:hover{border-color:#323130}html body .ms-borderColor-gray150,html body .ms-borderColor-gray150--hover:hover{border-color:#3b3a39}html body .ms-borderColor-gray140,html body .ms-borderColor-gray140--hover:hover{border-color:#484644}html body .ms-borderColor-gray130,html body .ms-borderColor-gray130--hover:hover{border-color:#605e5c}html body .ms-borderColor-gray120,html body .ms-borderColor-gray120--hover:hover{border-color:#797775}html body .ms-borderColor-gray110,html body .ms-borderColor-gray110--hover:hover{border-color:#8a8886}html body .ms-borderColor-gray100,html body .ms-borderColor-gray100--hover:hover{border-color:#979593}html body .ms-borderColor-gray90,html body .ms-borderColor-gray90--hover:hover{border-color:#a19f9d}html body .ms-borderColor-gray80,html body .ms-borderColor-gray80--hover:hover{border-color:#b3b0ad}html body .ms-borderColor-gray70,html body .ms-borderColor-gray70--hover:hover{border-color:#bebbb8}html body .ms-borderColor-gray60,html body .ms-borderColor-gray60--hover:hover{border-color:#c8c6c4}html body .ms-borderColor-gray50,html body .ms-borderColor-gray50--hover:hover{border-color:#d2d0ce}html body .ms-borderColor-gray40,html body .ms-borderColor-gray40--hover:hover{border-color:#e1dfdd}html body .ms-borderColor-gray30,html body .ms-borderColor-gray30--hover:hover{border-color:#edebe9}html body .ms-borderColor-gray20,html body .ms-borderColor-gray20--hover:hover{border-color:#f3f2f1}html body .ms-borderColor-gray10,html body .ms-borderColor-gray10--hover:hover{border-color:#faf9f8}html body .ms-borderColor-white,html body .ms-borderColor-white--hover:hover{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-borderColor-sharedPinkRed10,html body .ms-borderColor-sharedPinkRed10--hover:hover{border-color:#750b1c}html body .ms-borderColor-sharedRed20,html body .ms-borderColor-sharedRed20--hover:hover{border-color:#a4262c}html body .ms-borderColor-sharedRed10,html body .ms-borderColor-sharedRed10--hover:hover{border-color:#d13438}html body .ms-borderColor-sharedRedOrange20,html body .ms-borderColor-sharedRedOrange20--hover:hover{border-color:#603d30}html body .ms-borderColor-sharedRedOrange10,html body .ms-borderColor-sharedRedOrange10--hover:hover{border-color:#da3b01}html body .ms-borderColor-sharedOrange30,html body .ms-borderColor-sharedOrange30--hover:hover{border-color:#8e562e}html body .ms-borderColor-sharedOrange20,html body .ms-borderColor-sharedOrange20--hover:hover{border-color:#ca5010}html body .ms-borderColor-sharedOrange10,html body .ms-borderColor-sharedOrange10--hover:hover{border-color:#fa4}html body .ms-borderColor-sharedYellow10,html body .ms-borderColor-sharedYellow10--hover:hover{border-color:#fce100}html body .ms-borderColor-sharedOrangeYellow20,html body .ms-borderColor-sharedOrangeYellow20--hover:hover{border-color:#986f0b}html body .ms-borderColor-sharedOrangeYellow10,html body .ms-borderColor-sharedOrangeYellow10--hover:hover{border-color:#c19c00}html body .ms-borderColor-sharedYellowGreen10,html body .ms-borderColor-sharedYellowGreen10--hover:hover{border-color:#8cbd18}html body .ms-borderColor-sharedGreen20,html body .ms-borderColor-sharedGreen20--hover:hover{border-color:#0b6a0b}html body .ms-borderColor-sharedGreen10,html body .ms-borderColor-sharedGreen10--hover:hover{border-color:#498205}html body .ms-borderColor-sharedGreenCyan10,html body .ms-borderColor-sharedGreenCyan10--hover:hover{border-color:#00ad56}html body .ms-borderColor-sharedCyan40,html body .ms-borderColor-sharedCyan40--hover:hover{border-color:#005e50}html body .ms-borderColor-sharedCyan30,html body .ms-borderColor-sharedCyan30--hover:hover{border-color:#005b70}html body .ms-borderColor-sharedCyan20,html body .ms-borderColor-sharedCyan20--hover:hover{border-color:#038387}html body .ms-borderColor-sharedCyan10,html body .ms-borderColor-sharedCyan10--hover:hover{border-color:#00b7c3}html body .ms-borderColor-sharedCyanBlue20,html body .ms-borderColor-sharedCyanBlue20--hover:hover{border-color:#004e8c}html body .ms-borderColor-sharedCyanBlue10,html body .ms-borderColor-sharedCyanBlue10--hover:hover{border-color:#0078d4}html body .ms-borderColor-sharedBlue10,html body .ms-borderColor-sharedBlue10--hover:hover{border-color:#4f6bed}html body .ms-borderColor-sharedBlueMagenta40,html body .ms-borderColor-sharedBlueMagenta40--hover:hover{border-color:#373277}html body .ms-borderColor-sharedBlueMagenta30,html body .ms-borderColor-sharedBlueMagenta30--hover:hover{border-color:#5c2e91}html body .ms-borderColor-sharedBlueMagenta20,html body .ms-borderColor-sharedBlueMagenta20--hover:hover{border-color:#8764b8}html body .ms-borderColor-sharedBlueMagenta10,html body .ms-borderColor-sharedBlueMagenta10--hover:hover{border-color:#8378de}html body .ms-borderColor-sharedMagenta20,html body .ms-borderColor-sharedMagenta20--hover:hover{border-color:#881798}html body .ms-borderColor-sharedMagenta10,html body .ms-borderColor-sharedMagenta10--hover:hover{border-color:#c239b3}html body .ms-borderColor-sharedMagentaPink20,html body .ms-borderColor-sharedMagentaPink20--hover:hover{border-color:#9b0062}html body .ms-borderColor-sharedMagentaPink10,html body .ms-borderColor-sharedMagentaPink10--hover:hover{border-color:#e3008c}html body .ms-borderColor-sharedGray40,html body .ms-borderColor-sharedGray40--hover:hover{border-color:#393939}html body .ms-borderColor-sharedGray30,html body .ms-borderColor-sharedGray30--hover:hover{border-color:#7a7574}html body .ms-borderColor-sharedGray20,html body .ms-borderColor-sharedGray20--hover:hover{border-color:#69797e}html body .ms-borderColor-sharedGray10,html body .ms-borderColor-sharedGray10--hover:hover{border-color:#a0aeb2}html body .ms-fontColor-communicationShade30,html body .ms-fontColor-communicationShade30--hover:hover{color:#004578}html body .ms-fontColor-communicationShade20,html body .ms-fontColor-communicationShade20--hover:hover{color:#005a9e}html body .ms-fontColor-communicationShade10,html body .ms-fontColor-communicationShade10--hover:hover{color:#106ebe}html body .ms-fontColor-communicationPrimary,html body .ms-fontColor-communicationPrimary--hover:hover{color:#0078d4}html body .ms-fontColor-communicationTint10,html body .ms-fontColor-communicationTint10--hover:hover{color:#2b88d8}html body .ms-fontColor-communicationTint20,html body .ms-fontColor-communicationTint20--hover:hover{color:#c7e0f4}html body .ms-fontColor-communicationTint30,html body .ms-fontColor-communicationTint30--hover:hover{color:#deecf9}html body .ms-fontColor-communicationTint40,html body .ms-fontColor-communicationTint40--hover:hover{color:#eff6fc}html body .ms-fontColor-black,html body .ms-fontColor-black--hover:hover{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-fontColor-gray220,html body .ms-fontColor-gray220--hover:hover{color:#11100f}html body .ms-fontColor-gray210,html body .ms-fontColor-gray210--hover:hover{color:#161514}html body .ms-fontColor-gray200,html body .ms-fontColor-gray200--hover:hover{color:#1b1a19}html body .ms-fontColor-gray190,html body .ms-fontColor-gray190--hover:hover{color:#201f1e}html body .ms-fontColor-gray180,html body .ms-fontColor-gray180--hover:hover{color:#252423}html body .ms-fontColor-gray170,html body .ms-fontColor-gray170--hover:hover{color:#292827}html body .ms-fontColor-gray160,html body .ms-fontColor-gray160--hover:hover{color:#323130}html body .ms-fontColor-gray150,html body .ms-fontColor-gray150--hover:hover{color:#3b3a39}html body .ms-fontColor-gray140,html body .ms-fontColor-gray140--hover:hover{color:#484644}html body .ms-fontColor-gray130,html body .ms-fontColor-gray130--hover:hover{color:#605e5c}html body .ms-fontColor-gray120,html body .ms-fontColor-gray120--hover:hover{color:#797775}html body .ms-fontColor-gray110,html body .ms-fontColor-gray110--hover:hover{color:#8a8886}html body .ms-fontColor-gray100,html body .ms-fontColor-gray100--hover:hover{color:#979593}html body .ms-fontColor-gray90,html body .ms-fontColor-gray90--hover:hover{color:#a19f9d}html body .ms-fontColor-gray80,html body .ms-fontColor-gray80--hover:hover{color:#b3b0ad}html body .ms-fontColor-gray70,html body .ms-fontColor-gray70--hover:hover{color:#bebbb8}html body .ms-fontColor-gray60,html body .ms-fontColor-gray60--hover:hover{color:#c8c6c4}html body .ms-fontColor-gray50,html body .ms-fontColor-gray50--hover:hover{color:#d2d0ce}html body .ms-fontColor-gray40,html body .ms-fontColor-gray40--hover:hover{color:#e1dfdd}html body .ms-fontColor-gray30,html body .ms-fontColor-gray30--hover:hover{color:#edebe9}html body .ms-fontColor-gray20,html body .ms-fontColor-gray20--hover:hover{color:#f3f2f1}html body .ms-fontColor-gray10,html body .ms-fontColor-gray10--hover:hover{color:#faf9f8}html body .ms-fontColor-white,html body .ms-fontColor-white--hover:hover{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-fontColor-sharedPinkRed10,html body .ms-fontColor-sharedPinkRed10--hover:hover{color:#750b1c}html body .ms-fontColor-sharedRed20,html body .ms-fontColor-sharedRed20--hover:hover{color:#a4262c}html body .ms-fontColor-sharedRed10,html body .ms-fontColor-sharedRed10--hover:hover{color:#d13438}html body .ms-fontColor-sharedRedOrange20,html body .ms-fontColor-sharedRedOrange20--hover:hover{color:#603d30}html body .ms-fontColor-sharedRedOrange10,html body .ms-fontColor-sharedRedOrange10--hover:hover{color:#da3b01}html body .ms-fontColor-sharedOrange30,html body .ms-fontColor-sharedOrange30--hover:hover{color:#8e562e}html body .ms-fontColor-sharedOrange20,html body .ms-fontColor-sharedOrange20--hover:hover{color:#ca5010}html body .ms-fontColor-sharedOrange10,html body .ms-fontColor-sharedOrange10--hover:hover{color:#fa4}html body .ms-fontColor-sharedYellow10,html body .ms-fontColor-sharedYellow10--hover:hover{color:#fce100}html body .ms-fontColor-sharedOrangeYellow20,html body .ms-fontColor-sharedOrangeYellow20--hover:hover{color:#986f0b}html body .ms-fontColor-sharedOrangeYellow10,html body .ms-fontColor-sharedOrangeYellow10--hover:hover{color:#c19c00}html body .ms-fontColor-sharedYellowGreen10,html body .ms-fontColor-sharedYellowGreen10--hover:hover{color:#8cbd18}html body .ms-fontColor-sharedGreen20,html body .ms-fontColor-sharedGreen20--hover:hover{color:#0b6a0b}html body .ms-fontColor-sharedGreen10,html body .ms-fontColor-sharedGreen10--hover:hover{color:#498205}html body .ms-fontColor-sharedGreenCyan10,html body .ms-fontColor-sharedGreenCyan10--hover:hover{color:#00ad56}html body .ms-fontColor-sharedCyan40,html body .ms-fontColor-sharedCyan40--hover:hover{color:#005e50}html body .ms-fontColor-sharedCyan30,html body .ms-fontColor-sharedCyan30--hover:hover{color:#005b70}html body .ms-fontColor-sharedCyan20,html body .ms-fontColor-sharedCyan20--hover:hover{color:#038387}html body .ms-fontColor-sharedCyan10,html body .ms-fontColor-sharedCyan10--hover:hover{color:#00b7c3}html body .ms-fontColor-sharedCyanBlue20,html body .ms-fontColor-sharedCyanBlue20--hover:hover{color:#004e8c}html body .ms-fontColor-sharedCyanBlue10,html body .ms-fontColor-sharedCyanBlue10--hover:hover{color:#0078d4}html body .ms-fontColor-sharedBlue10,html body .ms-fontColor-sharedBlue10--hover:hover{color:#4f6bed}html body .ms-fontColor-sharedBlueMagenta40,html body .ms-fontColor-sharedBlueMagenta40--hover:hover{color:#373277}html body .ms-fontColor-sharedBlueMagenta30,html body .ms-fontColor-sharedBlueMagenta30--hover:hover{color:#5c2e91}html body .ms-fontColor-sharedBlueMagenta20,html body .ms-fontColor-sharedBlueMagenta20--hover:hover{color:#8764b8}html body .ms-fontColor-sharedBlueMagenta10,html body .ms-fontColor-sharedBlueMagenta10--hover:hover{color:#8378de}html body .ms-fontColor-sharedMagenta20,html body .ms-fontColor-sharedMagenta20--hover:hover{color:#881798}html body .ms-fontColor-sharedMagenta10,html body .ms-fontColor-sharedMagenta10--hover:hover{color:#c239b3}html body .ms-fontColor-sharedMagentaPink20,html body .ms-fontColor-sharedMagentaPink20--hover:hover{color:#9b0062}html body .ms-fontColor-sharedMagentaPink10,html body .ms-fontColor-sharedMagentaPink10--hover:hover{color:#e3008c}html body .ms-fontColor-sharedGray40,html body .ms-fontColor-sharedGray40--hover:hover{color:#393939}html body .ms-fontColor-sharedGray30,html body .ms-fontColor-sharedGray30--hover:hover{color:#7a7574}html body .ms-fontColor-sharedGray20,html body .ms-fontColor-sharedGray20--hover:hover{color:#69797e}html body .ms-fontColor-sharedGray10,html body .ms-fontColor-sharedGray10--hover:hover{color:#a0aeb2}html body .ms-bgColor-themeDark,html body .ms-bgColor-themeDark--hover:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}html body .ms-bgColor-themeDarkAlt,html body .ms-bgColor-themeDarkAlt--hover:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}html body .ms-bgColor-themeDarker,html body .ms-bgColor-themeDarker--hover:hover{background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}html body .ms-bgColor-themePrimary,html body .ms-bgColor-themePrimary--hover:hover{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html body .ms-bgColor-themeSecondary,html body .ms-bgColor-themeSecondary--hover:hover{background-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}html body .ms-bgColor-themeTertiary,html body .ms-bgColor-themeTertiary--hover:hover{background-color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}html body .ms-bgColor-themeLight,html body .ms-bgColor-themeLight--hover:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}html body .ms-bgColor-themeLighter,html body .ms-bgColor-themeLighter--hover:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}html body .ms-bgColor-themeLighterAlt,html body .ms-bgColor-themeLighterAlt--hover:hover{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}html body .ms-borderColor-themeDark,html body .ms-borderColor-themeDark--hover:hover{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}html body .ms-borderColor-themeDarkAlt,html body .ms-borderColor-themeDarkAlt--hover:hover{border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}html body .ms-borderColor-themeDarker,html body .ms-borderColor-themeDarker--hover:hover{border-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}html body .ms-borderColor-themePrimary,html body .ms-borderColor-themePrimary--hover:hover{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html body .ms-borderColor-themeSecondary,html body .ms-borderColor-themeSecondary--hover:hover{border-color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}html body .ms-borderColor-themeTertiary,html body .ms-borderColor-themeTertiary--hover:hover{border-color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}html body .ms-borderColor-themeLight,html body .ms-borderColor-themeLight--hover:hover{border-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}html body .ms-borderColor-themeLighter,html body .ms-borderColor-themeLighter--hover:hover{border-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}html body .ms-borderColor-themeLighterAlt,html body .ms-borderColor-themeLighterAlt--hover:hover{border-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}html body .ms-fontColor-themeDarker,html body .ms-fontColor-themeDarker--hover:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}html body .ms-fontColor-themeDark,html body .ms-fontColor-themeDark--hover:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}html body .ms-fontColor-themeDarkAlt,html body .ms-fontColor-themeDarkAlt--hover:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}html body .ms-fontColor-themePrimary,html body .ms-fontColor-themePrimary--hover:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html body .ms-fontColor-themeSecondary,html body .ms-fontColor-themeSecondary--hover:hover{color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}html body .ms-fontColor-themeTertiary,html body .ms-fontColor-themeTertiary--hover:hover{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}html body .ms-fontColor-themeLight,html body .ms-fontColor-themeLight--hover:hover{color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}html body .ms-fontColor-themeLighter,html body .ms-fontColor-themeLighter--hover:hover{color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}html body .ms-fontColor-themeLighterAlt,html body .ms-fontColor-themeLighterAlt--hover:hover{color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}html body .ms-bgColor-black,html body .ms-bgColor-black--hover:hover{background-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-bgColor-neutralDark,html body .ms-bgColor-neutralDark--hover:hover{background-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}html body .ms-bgColor-neutralPrimary,html body .ms-bgColor-neutralPrimary--hover:hover{background-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html body .ms-bgColor-neutralPrimaryAlt,html body .ms-bgColor-neutralPrimaryAlt--hover:hover{background-color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}html body .ms-bgColor-neutralSecondary,html body .ms-bgColor-neutralSecondary--hover:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html body .ms-bgColor-neutralSecondaryAlt,html body .ms-bgColor-neutralSecondaryAlt--hover:hover{background-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html body .ms-bgColor-neutralTertiary,html body .ms-bgColor-neutralTertiary--hover:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html body .ms-bgColor-neutralTertiaryAlt,html body .ms-bgColor-neutralTertiaryAlt--hover:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}html body .ms-bgColor-neutralQuaternary,html body .ms-bgColor-neutralQuaternary--hover:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}html body .ms-bgColor-neutralQuaternaryAlt,html body .ms-bgColor-neutralQuaternaryAlt--hover:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}html body .ms-bgColor-neutralLight,html body .ms-bgColor-neutralLight--hover:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html body .ms-bgColor-neutralLighter,html body .ms-bgColor-neutralLighter--hover:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html body .ms-bgColor-neutralLighterAlt,html body .ms-bgColor-neutralLighterAlt--hover:hover{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}html body .ms-bgColor-white,html body .ms-bgColor-white--hover:hover{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-borderColor-black,html body .ms-borderColor-black--hover:hover{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-borderColor-neutralDark,html body .ms-borderColor-neutralDark--hover:hover{border-color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}html body .ms-borderColor-neutralPrimary,html body .ms-borderColor-neutralPrimary--hover:hover{border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html body .ms-borderColor-neutralPrimaryAlt,html body .ms-borderColor-neutralPrimaryAlt--hover:hover{border-color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}html body .ms-borderColor-neutralSecondary,html body .ms-borderColor-neutralSecondary--hover:hover{border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html body .ms-borderColor-neutralSecondaryAlt,html body .ms-borderColor-neutralSecondaryAlt--hover:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html body .ms-borderColor-neutralTertiary,html body .ms-borderColor-neutralTertiary--hover:hover{border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html body .ms-borderColor-neutralTertiaryAlt,html body .ms-borderColor-neutralTertiaryAlt--hover:hover{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}html body .ms-borderColor-neutralQuaternary,html body .ms-borderColor-neutralQuaternary--hover:hover{border-color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}html body .ms-borderColor-neutralQuaternaryAlt,html body .ms-borderColor-neutralQuaternaryAlt--hover:hover{border-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}html body .ms-borderColor-neutralLight,html body .ms-borderColor-neutralLight--hover:hover{border-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html body .ms-borderColor-neutralLighter,html body .ms-borderColor-neutralLighter--hover:hover{border-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html body .ms-borderColor-neutralLighterAlt,html body .ms-borderColor-neutralLighterAlt--hover:hover{border-color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}html body .ms-borderColor-white,html body .ms-borderColor-white--hover:hover{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-fontColor-black,html body .ms-fontColor-black--hover:hover{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-fontColor-neutralDark,html body .ms-fontColor-neutralDark--hover:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}html body .ms-fontColor-neutralPrimary,html body .ms-fontColor-neutralPrimary--hover:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html body .ms-fontColor-neutralPrimaryAlt,html body .ms-fontColor-neutralPrimaryAlt--hover:hover{color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3b3a39"},{rawString:"}html body .ms-fontColor-neutralSecondary,html body .ms-fontColor-neutralSecondary--hover:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html body .ms-fontColor-neutralSecondaryAlt,html body .ms-fontColor-neutralSecondaryAlt--hover:hover{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html body .ms-fontColor-neutralTertiary,html body .ms-fontColor-neutralTertiary--hover:hover{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html body .ms-fontColor-neutralTertiaryAlt,html body .ms-fontColor-neutralTertiaryAlt--hover:hover{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}html body .ms-fontColor-neutralQuaternary,html body .ms-fontColor-neutralQuaternary--hover:hover{color:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}html body .ms-fontColor-neutralQuaternaryAlt,html body .ms-fontColor-neutralQuaternaryAlt--hover:hover{color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}html body .ms-fontColor-neutralLight,html body .ms-fontColor-neutralLight--hover:hover{color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html body .ms-fontColor-neutralLighter,html body .ms-fontColor-neutralLighter--hover:hover{color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html body .ms-fontColor-neutralLighterAlt,html body .ms-fontColor-neutralLighterAlt--hover:hover{color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}html body .ms-fontColor-white,html body .ms-fontColor-white--hover:hover{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-bgColor-yellow,html body .ms-bgColor-yellow--hover:hover{background-color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}html body .ms-bgColor-yellowLight,html body .ms-bgColor-yellowLight--hover:hover{background-color:"},{theme:"yellowLight",defaultValue:"#fff100"},{rawString:"}html body .ms-bgColor-orange,html body .ms-bgColor-orange--hover:hover{background-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}html body .ms-bgColor-orangeLight,html body .ms-bgColor-orangeLight--hover:hover{background-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}html body .ms-bgColor-orangeLighter,html body .ms-bgColor-orangeLighter--hover:hover{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}html body .ms-bgColor-redDark,html body .ms-bgColor-redDark--hover:hover{background-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}html body .ms-bgColor-red,html body .ms-bgColor-red--hover:hover{background-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}html body .ms-bgColor-magentaDark,html body .ms-bgColor-magentaDark--hover:hover{background-color:"},{theme:"magentaDark",defaultValue:"#5c005c"},{rawString:"}html body .ms-bgColor-magenta,html body .ms-bgColor-magenta--hover:hover{background-color:"},{theme:"magenta",defaultValue:"#b4009e"},{rawString:"}html body .ms-bgColor-magentaLight,html body .ms-bgColor-magentaLight--hover:hover{background-color:"},{theme:"magentaLight",defaultValue:"#e3008c"},{rawString:"}html body .ms-bgColor-purpleDark,html body .ms-bgColor-purpleDark--hover:hover{background-color:"},{theme:"purpleDark",defaultValue:"#32145a"},{rawString:"}html body .ms-bgColor-purple,html body .ms-bgColor-purple--hover:hover{background-color:"},{theme:"purple",defaultValue:"#5c2d91"},{rawString:"}html body .ms-bgColor-purpleLight,html body .ms-bgColor-purpleLight--hover:hover{background-color:"},{theme:"purpleLight",defaultValue:"#b4a0ff"},{rawString:"}html body .ms-bgColor-blueDark,html body .ms-bgColor-blueDark--hover:hover{background-color:"},{theme:"blueDark",defaultValue:"#002050"},{rawString:"}html body .ms-bgColor-blueMid,html body .ms-bgColor-blueMid--hover:hover{background-color:"},{theme:"blueMid",defaultValue:"#00188f"},{rawString:"}html body .ms-bgColor-blue,html body .ms-bgColor-blue--hover:hover{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}html body .ms-bgColor-blueLight,html body .ms-bgColor-blueLight--hover:hover{background-color:"},{theme:"blueLight",defaultValue:"#00bcf2"},{rawString:"}html body .ms-bgColor-tealDark,html body .ms-bgColor-tealDark--hover:hover{background-color:"},{theme:"tealDark",defaultValue:"#004b50"},{rawString:"}html body .ms-bgColor-teal,html body .ms-bgColor-teal--hover:hover{background-color:"},{theme:"teal",defaultValue:"#008272"},{rawString:"}html body .ms-bgColor-tealLight,html body .ms-bgColor-tealLight--hover:hover{background-color:"},{theme:"tealLight",defaultValue:"#00b294"},{rawString:"}html body .ms-bgColor-greenDark,html body .ms-bgColor-greenDark--hover:hover{background-color:"},{theme:"greenDark",defaultValue:"#004b1c"},{rawString:"}html body .ms-bgColor-green,html body .ms-bgColor-green--hover:hover{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}html body .ms-bgColor-greenLight,html body .ms-bgColor-greenLight--hover:hover{background-color:"},{theme:"greenLight",defaultValue:"#bad80a"},{rawString:"}html body .ms-borderColor-yellow,html body .ms-borderColor-yellow--hover:hover{border-color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}html body .ms-borderColor-yellowLight,html body .ms-borderColor-yellowLight--hover:hover{border-color:"},{theme:"yellowLight",defaultValue:"#fff100"},{rawString:"}html body .ms-borderColor-orange,html body .ms-borderColor-orange--hover:hover{border-color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}html body .ms-borderColor-orangeLight,html body .ms-borderColor-orangeLight--hover:hover{border-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}html body .ms-borderColor-orangeLighter,html body .ms-borderColor-orangeLighter--hover:hover{border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}html body .ms-borderColor-redDark,html body .ms-borderColor-redDark--hover:hover{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}html body .ms-borderColor-red,html body .ms-borderColor-red--hover:hover{border-color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}html body .ms-borderColor-magentaDark,html body .ms-borderColor-magentaDark--hover:hover{border-color:"},{theme:"magentaDark",defaultValue:"#5c005c"},{rawString:"}html body .ms-borderColor-magenta,html body .ms-borderColor-magenta--hover:hover{border-color:"},{theme:"magenta",defaultValue:"#b4009e"},{rawString:"}html body .ms-borderColor-magentaLight,html body .ms-borderColor-magentaLight--hover:hover{border-color:"},{theme:"magentaLight",defaultValue:"#e3008c"},{rawString:"}html body .ms-borderColor-purpleDark,html body .ms-borderColor-purpleDark--hover:hover{border-color:"},{theme:"purpleDark",defaultValue:"#32145a"},{rawString:"}html body .ms-borderColor-purple,html body .ms-borderColor-purple--hover:hover{border-color:"},{theme:"purple",defaultValue:"#5c2d91"},{rawString:"}html body .ms-borderColor-purpleLight,html body .ms-borderColor-purpleLight--hover:hover{border-color:"},{theme:"purpleLight",defaultValue:"#b4a0ff"},{rawString:"}html body .ms-borderColor-blueDark,html body .ms-borderColor-blueDark--hover:hover{border-color:"},{theme:"blueDark",defaultValue:"#002050"},{rawString:"}html body .ms-borderColor-blueMid,html body .ms-borderColor-blueMid--hover:hover{border-color:"},{theme:"blueMid",defaultValue:"#00188f"},{rawString:"}html body .ms-borderColor-blue,html body .ms-borderColor-blue--hover:hover{border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}html body .ms-borderColor-blueLight,html body .ms-borderColor-blueLight--hover:hover{border-color:"},{theme:"blueLight",defaultValue:"#00bcf2"},{rawString:"}html body .ms-borderColor-tealDark,html body .ms-borderColor-tealDark--hover:hover{border-color:"},{theme:"tealDark",defaultValue:"#004b50"},{rawString:"}html body .ms-borderColor-teal,html body .ms-borderColor-teal--hover:hover{border-color:"},{theme:"teal",defaultValue:"#008272"},{rawString:"}html body .ms-borderColor-tealLight,html body .ms-borderColor-tealLight--hover:hover{border-color:"},{theme:"tealLight",defaultValue:"#00b294"},{rawString:"}html body .ms-borderColor-greenDark,html body .ms-borderColor-greenDark--hover:hover{border-color:"},{theme:"greenDark",defaultValue:"#004b1c"},{rawString:"}html body .ms-borderColor-green,html body .ms-borderColor-green--hover:hover{border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}html body .ms-borderColor-greenLight,html body .ms-borderColor-greenLight--hover:hover{border-color:"},{theme:"greenLight",defaultValue:"#bad80a"},{rawString:"}html body .ms-fontColor-yellow,html body .ms-fontColor-yellow--hover:hover{color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}html body .ms-fontColor-yellowLight,html body .ms-fontColor-yellowLight--hover:hover{color:"},{theme:"yellowLight",defaultValue:"#fff100"},{rawString:"}html body .ms-fontColor-orange,html body .ms-fontColor-orange--hover:hover{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}html body .ms-fontColor-orangeLight,html body .ms-fontColor-orangeLight--hover:hover{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}html body .ms-fontColor-orangeLighter,html body .ms-fontColor-orangeLighter--hover:hover{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}html body .ms-fontColor-redDark,html body .ms-fontColor-redDark--hover:hover{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}html body .ms-fontColor-red,html body .ms-fontColor-red--hover:hover{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}html body .ms-fontColor-magentaDark,html body .ms-fontColor-magentaDark--hover:hover{color:"},{theme:"magentaDark",defaultValue:"#5c005c"},{rawString:"}html body .ms-fontColor-magenta,html body .ms-fontColor-magenta--hover:hover{color:"},{theme:"magenta",defaultValue:"#b4009e"},{rawString:"}html body .ms-fontColor-magentaLight,html body .ms-fontColor-magentaLight--hover:hover{color:"},{theme:"magentaLight",defaultValue:"#e3008c"},{rawString:"}html body .ms-fontColor-purpleDark,html body .ms-fontColor-purpleDark--hover:hover{color:"},{theme:"purpleDark",defaultValue:"#32145a"},{rawString:"}html body .ms-fontColor-purple,html body .ms-fontColor-purple--hover:hover{color:"},{theme:"purple",defaultValue:"#5c2d91"},{rawString:"}html body .ms-fontColor-purpleLight,html body .ms-fontColor-purpleLight--hover:hover{color:"},{theme:"purpleLight",defaultValue:"#b4a0ff"},{rawString:"}html body .ms-fontColor-blueDark,html body .ms-fontColor-blueDark--hover:hover{color:"},{theme:"blueDark",defaultValue:"#002050"},{rawString:"}html body .ms-fontColor-blueMid,html body .ms-fontColor-blueMid--hover:hover{color:"},{theme:"blueMid",defaultValue:"#00188f"},{rawString:"}html body .ms-fontColor-blue,html body .ms-fontColor-blue--hover:hover{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}html body .ms-fontColor-blueLight,html body .ms-fontColor-blueLight--hover:hover{color:"},{theme:"blueLight",defaultValue:"#00bcf2"},{rawString:"}html body .ms-fontColor-tealDark,html body .ms-fontColor-tealDark--hover:hover{color:"},{theme:"tealDark",defaultValue:"#004b50"},{rawString:"}html body .ms-fontColor-teal,html body .ms-fontColor-teal--hover:hover{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:"}html body .ms-fontColor-tealLight,html body .ms-fontColor-tealLight--hover:hover{color:"},{theme:"tealLight",defaultValue:"#00b294"},{rawString:"}html body .ms-fontColor-greenDark,html body .ms-fontColor-greenDark--hover:hover{color:"},{theme:"greenDark",defaultValue:"#004b1c"},{rawString:"}html body .ms-fontColor-green,html body .ms-fontColor-green--hover:hover{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}html body .ms-fontColor-greenLight,html body .ms-fontColor-greenLight--hover:hover{color:"},{theme:"greenLight",defaultValue:"#bad80a"},{rawString:"}html body .ms-bgColor-info,html body .ms-bgColor-info--hover:hover{background-color:"},{theme:"infoBackground",defaultValue:"#f4f4f4"},{rawString:"}html body .ms-bgColor-success,html body .ms-bgColor-success--hover:hover{background-color:"},{theme:"successBackground",defaultValue:"#dff6dd"},{rawString:"}html body .ms-bgColor-severeWarning,html body .ms-bgColor-severeWarning--hover:hover{background-color:"},{theme:"severeWarningBackground",defaultValue:"#fed9cc"},{rawString:"}html body .ms-bgColor-warning,html body .ms-bgColor-warning--hover:hover{background-color:"},{theme:"warningBackground",defaultValue:"#fff4ce"},{rawString:"}html body .ms-bgColor-error,html body .ms-bgColor-error--hover:hover{background-color:"},{theme:"errorBackground",defaultValue:"rgba(232,17,35,.2)"},{rawString:"}html body .ms-fontColor-info,html body .ms-fontColor-info--hover:hover{color:"},{theme:"info",defaultValue:"#666"},{rawString:"}html body .ms-fontColor-success,html body .ms-fontColor-success--hover:hover{color:"},{theme:"success",defaultValue:"#107c10"},{rawString:"}html body .ms-fontColor-alert,html body .ms-fontColor-alert--hover:hover{color:"},{theme:"alert",defaultValue:"#d83b01"},{rawString:"}html body .ms-fontColor-warning,html body .ms-fontColor-warning--hover:hover{color:"},{theme:"warning",defaultValue:"#767676"},{rawString:"}html body .ms-fontColor-severeWarning,html body .ms-fontColor-severeWarning--hover:hover{color:"},{theme:"severeWarning",defaultValue:"#a80000"},{rawString:"}html body .ms-fontColor-error,html body .ms-fontColor-error--hover:hover{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}html body .ms-bgColor-contrastBlackDisabled,html body .ms-bgColor-contrastBlackDisabled--hover:hover{background-color:#0f0}html body .ms-bgColor-contrastWhiteDisabled,html body .ms-bgColor-contrastWhiteDisabled--hover:hover{background-color:#600000}html body .ms-bgColor-contrastBlackSelected,html body .ms-bgColor-contrastBlackSelected--hover:hover{background-color:#1aebff}html body .ms-bgColor-contrastWhiteSelected,html body .ms-bgColor-contrastWhiteSelected--hover:hover{background-color:#37006e}html body .ms-fontColor-contrastBlackDisabled,html body .ms-fontColor-contrastBlackDisabled--hover:hover{color:#0f0}html body .ms-fontColor-contrastWhiteDisabled,html body .ms-fontColor-contrastWhiteDisabled--hover:hover{color:#600000}html body .ms-fontColor-contrastBlackSelected,html body .ms-fontColor-contrastBlackSelected--hover:hover{color:#1aebff}html body .ms-fontColor-contrastWhiteSelected,html body .ms-fontColor-contrastWhiteSelected--hover:hover{color:#37006e}html body .ms-borderColor-contrastBlackDisabled,html body .ms-borderColor-contrastBlackDisabled--hover:hover{border-color:#0f0}html body .ms-borderColor-contrastWhiteDisabled,html body .ms-borderColor-contrastWhiteDisabled--hover:hover{border-color:#600000}html body .ms-borderColor-contrastBlackSelected,html body .ms-borderColor-contrastBlackSelected--hover:hover{border-color:#1aebff}html body .ms-borderColor-contrastWhiteSelected,html body .ms-borderColor-contrastWhiteSelected--hover:hover{border-color:#37006e}.ms-fontSize-68{font-size:68px}.ms-fontSize-42{font-size:42px}.ms-fontSize-32{font-size:32px}.ms-fontSize-28{font-size:28px}.ms-fontSize-24{font-size:24px}.ms-fontSize-20{font-size:20px}.ms-fontSize-18{font-size:18px}.ms-fontSize-16{font-size:16px}.ms-fontSize-14{font-size:14px}.ms-fontSize-12{font-size:12px}.ms-fontSize-10{font-size:10px}.ms-fontWeight-regular{font-weight:400}.ms-fontWeight-semibold{font-weight:600}.ms-fontWeight-bold{font-weight:700}.ms-font-su{font-size:42px;font-weight:100}.ms-font-xxl{font-size:28px;font-weight:100}.ms-font-xl-plus{font-size:24px;font-weight:100}.ms-font-xl{font-size:21px;font-weight:100}.ms-font-l{font-size:17px;font-weight:300}.ms-font-m-plus{font-size:15px;font-weight:400}.ms-font-m{font-size:14px;font-weight:400}.ms-font-s-plus{font-size:13px;font-weight:400}.ms-font-s{font-size:12px;font-weight:400}.ms-font-xs{font-size:11px;font-weight:400}.ms-font-mi{font-size:10px;font-weight:600}.ms-fontWeight-light{font-weight:100}.ms-fontWeight-semilight{font-weight:300}.ms-fontSize-su{font-size:42px}.ms-fontSize-xxl{font-size:28px}.ms-fontSize-xlPlus{font-size:24px}.ms-fontSize-xl{font-size:21px}.ms-fontSize-l{font-size:17px}.ms-fontSize-mPlus{font-size:15px}.ms-fontSize-m{font-size:14px}.ms-fontSize-sPlus{font-size:13px}.ms-fontSize-s{font-size:12px}.ms-fontSize-xs{font-size:11px}.ms-fontSize-mi{font-size:10px}.ms-fontSize-68{font-size:68px}.ms-fontSize-42{font-size:42px}.ms-fontSize-32{font-size:32px}.ms-fontSize-28{font-size:28px}.ms-fontSize-24{font-size:24px}.ms-fontSize-20{font-size:20px}.ms-fontSize-18{font-size:18px}.ms-fontSize-16{font-size:16px}.ms-fontSize-14{font-size:14px}.ms-fontSize-12{font-size:12px}.ms-fontSize-10{font-size:10px}.ms-fontWeight-regular{font-weight:400}.ms-fontWeight-semibold{font-weight:600}.ms-fontWeight-bold{font-weight:700}.ms-font-su{font-size:42px;font-weight:100}.ms-font-xxl{font-size:28px;font-weight:100}.ms-font-xl-plus{font-size:24px;font-weight:100}.ms-font-xl{font-size:21px;font-weight:100}.ms-font-l{font-size:17px;font-weight:300}.ms-font-m-plus{font-size:15px;font-weight:400}.ms-font-m{font-size:14px;font-weight:400}.ms-font-s-plus{font-size:13px;font-weight:400}.ms-font-s{font-size:12px;font-weight:400}.ms-font-xs{font-size:11px;font-weight:400}.ms-font-mi{font-size:10px;font-weight:600}.ms-fontWeight-light{font-weight:100}.ms-fontWeight-semilight{font-weight:300}.ms-fontSize-su{font-size:42px}.ms-fontSize-xxl{font-size:28px}.ms-fontSize-xlPlus{font-size:24px}.ms-fontSize-xl{font-size:21px}.ms-fontSize-l{font-size:17px}.ms-fontSize-mPlus{font-size:15px}.ms-fontSize-m{font-size:14px}.ms-fontSize-sPlus{font-size:13px}.ms-fontSize-s{font-size:12px}.ms-fontSize-xs{font-size:11px}.ms-fontSize-mi{font-size:10px}html body .ms-fontColor-themeDarker,html body .ms-fontColor-themeDarker--hover:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}html body .ms-fontColor-themeDark,html body .ms-fontColor-themeDark--hover:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}html body .ms-fontColor-themeDarkAlt,html body .ms-fontColor-themeDarkAlt--hover:hover{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}html body .ms-fontColor-themePrimary,html body .ms-fontColor-themePrimary--hover:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html body .ms-fontColor-themeSecondary,html body .ms-fontColor-themeSecondary--hover:hover{color:"},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}html body .ms-fontColor-themeTertiary,html body .ms-fontColor-themeTertiary--hover:hover{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}html body .ms-fontColor-themeLight,html body .ms-fontColor-themeLight--hover:hover{color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}html body .ms-fontColor-themeLighter,html body .ms-fontColor-themeLighter--hover:hover{color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}html body .ms-fontColor-themeLighterAlt,html body .ms-fontColor-themeLighterAlt--hover:hover{color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}html body .ms-fontColor-black,html body .ms-fontColor-black--hover:hover{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}html body .ms-fontColor-neutralDark,html body .ms-fontColor-neutralDark--hover:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}html body .ms-fontColor-neutralPrimary,html body .ms-fontColor-neutralPrimary--hover:hover{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html body .ms-fontColor-neutralSecondary,html body .ms-fontColor-neutralSecondary--hover:hover{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html body .ms-fontColor-neutralSecondaryAlt,html body .ms-fontColor-neutralSecondaryAlt--hover:hover{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}html body .ms-fontColor-neutralTertiary,html body .ms-fontColor-neutralTertiary--hover:hover{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}html body .ms-fontColor-neutralTertiaryAlt,html body .ms-fontColor-neutralTertiaryAlt--hover:hover{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}html body .ms-fontColor-neutralLight,html body .ms-fontColor-neutralLight--hover:hover{color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}html body .ms-fontColor-neutralLighter,html body .ms-fontColor-neutralLighter--hover:hover{color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}html body .ms-fontColor-neutralLighterAlt,html body .ms-fontColor-neutralLighterAlt--hover:hover{color:"},{theme:"neutralLighterAlt",defaultValue:"#faf9f8"},{rawString:"}html body .ms-fontColor-white,html body .ms-fontColor-white--hover:hover{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}html body .ms-fontColor-yellow,html body .ms-fontColor-yellow--hover:hover{color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}html body .ms-fontColor-yellowLight,html body .ms-fontColor-yellowLight--hover:hover{color:"},{theme:"yellowLight",defaultValue:"#fff100"},{rawString:"}html body .ms-fontColor-orange,html body .ms-fontColor-orange--hover:hover{color:"},{theme:"orange",defaultValue:"#d83b01"},{rawString:"}html body .ms-fontColor-orangeLight,html body .ms-fontColor-orangeLight--hover:hover{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}html body .ms-fontColor-orangeLighter,html body .ms-fontColor-orangeLighter--hover:hover{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}html body .ms-fontColor-redDark,html body .ms-fontColor-redDark--hover:hover{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}html body .ms-fontColor-red,html body .ms-fontColor-red--hover:hover{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:"}html body .ms-fontColor-magentaDark,html body .ms-fontColor-magentaDark--hover:hover{color:"},{theme:"magentaDark",defaultValue:"#5c005c"},{rawString:"}html body .ms-fontColor-magenta,html body .ms-fontColor-magenta--hover:hover{color:"},{theme:"magenta",defaultValue:"#b4009e"},{rawString:"}html body .ms-fontColor-magentaLight,html body .ms-fontColor-magentaLight--hover:hover{color:"},{theme:"magentaLight",defaultValue:"#e3008c"},{rawString:"}html body .ms-fontColor-purpleDark,html body .ms-fontColor-purpleDark--hover:hover{color:"},{theme:"purpleDark",defaultValue:"#32145a"},{rawString:"}html body .ms-fontColor-purple,html body .ms-fontColor-purple--hover:hover{color:"},{theme:"purple",defaultValue:"#5c2d91"},{rawString:"}html body .ms-fontColor-purpleLight,html body .ms-fontColor-purpleLight--hover:hover{color:"},{theme:"purpleLight",defaultValue:"#b4a0ff"},{rawString:"}html body .ms-fontColor-blueDark,html body .ms-fontColor-blueDark--hover:hover{color:"},{theme:"blueDark",defaultValue:"#002050"},{rawString:"}html body .ms-fontColor-blueMid,html body .ms-fontColor-blueMid--hover:hover{color:"},{theme:"blueMid",defaultValue:"#00188f"},{rawString:"}html body .ms-fontColor-blue,html body .ms-fontColor-blue--hover:hover{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}html body .ms-fontColor-blueLight,html body .ms-fontColor-blueLight--hover:hover{color:"},{theme:"blueLight",defaultValue:"#00bcf2"},{rawString:"}html body .ms-fontColor-tealDark,html body .ms-fontColor-tealDark--hover:hover{color:"},{theme:"tealDark",defaultValue:"#004b50"},{rawString:"}html body .ms-fontColor-teal,html body .ms-fontColor-teal--hover:hover{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:"}html body .ms-fontColor-tealLight,html body .ms-fontColor-tealLight--hover:hover{color:"},{theme:"tealLight",defaultValue:"#00b294"},{rawString:"}html body .ms-fontColor-greenDark,html body .ms-fontColor-greenDark--hover:hover{color:"},{theme:"greenDark",defaultValue:"#004b1c"},{rawString:"}html body .ms-fontColor-green,html body .ms-fontColor-green--hover:hover{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}html body .ms-fontColor-greenLight,html body .ms-fontColor-greenLight--hover:hover{color:"},{theme:"greenLight",defaultValue:"#bad80a"},{rawString:"}html body .ms-fontColor-info,html body .ms-fontColor-info--hover:hover{color:"},{theme:"info",defaultValue:"#666"},{rawString:"}html body .ms-fontColor-success,html body .ms-fontColor-success--hover:hover{color:"},{theme:"success",defaultValue:"#107c10"},{rawString:"}html body .ms-fontColor-alert,html body .ms-fontColor-alert--hover:hover{color:"},{theme:"alert",defaultValue:"#d83b01"},{rawString:"}html body .ms-fontColor-error,html body .ms-fontColor-error--hover:hover{color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}@keyframes ms-motion-fadeIn{from{opacity:0}to{opacity:1}}@keyframes ms-motion-fadeOut{from{opacity:1}to{opacity:0}}@keyframes ms-motion-scaleDownIn{from{transform:scale3d(1.15,1.15,1)}to{transform:scale3d(1,1,1)}}@keyframes ms-motion-scaleDownOut{from{transform:scale3d(1,1,1)}to{transform:scale3d(.9,.9,1)}}@keyframes ms-motion-slideLeftOut{from{transform:translate3d(0,0,0)}to{transform:translate3d(-48px,0,0)}}@keyframes ms-motion-slideRightOut{from{transform:translate3d(0,0,0)}to{transform:translate3d(48px,0,0)}}@keyframes ms-motion-slideLeftIn{from{transform:translate3d(48px,0,0)}to{transform:translate3d(0,0,0)}}@keyframes ms-motion-slideRightIn{from{transform:translate3d(-48px,0,0)}to{transform:translate3d(0,0,0)}}@keyframes ms-motion-slideUpOut{from{transform:translate3d(0,0,0)}to{transform:translate3d(0,-48px,0)}}@keyframes ms-motion-slideDownOut{from{transform:translate3d(0,0,0)}to{transform:translate3d(0,48px,0)}}@keyframes ms-motion-slideUpIn{from{transform:translate3d(0,48px,0)}to{transform:translate3d(0,0,0)}}@keyframes ms-motion-slideDownIn{from{transform:translate3d(0,-48px,0)}to{transform:translate3d(0,0,0)}}.ms-motion-fadeIn{animation:ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}.ms-motion-fadeOut{animation:ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}.ms-motion-scaleDownIn{animation:ms-motion-scaleDownIn .3s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}.ms-motion-scaleDownOut{animation:ms-motion-scaleDownOut .3s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}[dir=ltr] .ms-motion-slideLeftOut{animation:ms-motion-slideLeftOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}[dir=rtl] .ms-motion-slideLeftOut{animation:ms-motion-slideRightOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}[dir=ltr] .ms-motion-slideRightOut{animation:ms-motion-slideRightOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}[dir=rtl] .ms-motion-slideRightOut{animation:ms-motion-slideLeftOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}[dir=ltr] .ms-motion-slideLeftIn{animation:ms-motion-slideLeftIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}[dir=rtl] .ms-motion-slideLeftIn{animation:ms-motion-slideRightIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}[dir=ltr] .ms-motion-slideRightIn{animation:ms-motion-slideRightIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}[dir=rtl] .ms-motion-slideRightIn{animation:ms-motion-slideLeftIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}.ms-motion-slideUpOut{animation:ms-motion-slideUpOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}.ms-motion-slideDownOut{animation:ms-motion-slideDownOut .1s cubic-bezier(.9,.1,1,.2) both,ms-motion-fadeOut .1s cubic-bezier(0,0,1,1) both}.ms-motion-slideUpIn{animation:ms-motion-slideUpIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}.ms-motion-slideDownIn{animation:ms-motion-slideDownIn .1s cubic-bezier(.1,.9,.2,1) both,ms-motion-fadeIn .1s cubic-bezier(0,0,1,1) both}.od-Link{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none;cursor:pointer;outline:0}.od-Link:focus,.od-Link:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Link:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Link[disabled]{cursor:default;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-ContextualMenu-item{box-sizing:border-box;position:relative}.od-ContextualMenu-item.od-ContextualMenu-item--divider{cursor:default;display:block;height:1px;margin:4px 0;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";position:relative}.od-ContextualMenu-item.od-ContextualMenu-item--header{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;text-transform:uppercase;height:40px;line-height:40px;padding:0 18px}.od-ContextualMenu-link{text-decoration:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";border:1px solid transparent;cursor:pointer;display:block;height:40px;line-height:40px;padding:0 18px;position:relative}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}.od-ContextualMenu-link:first-child,.od-ContextualMenu-link:last-child{height:39px}.od-ContextualMenu-link:active,.od-ContextualMenu-link:focus,.od-ContextualMenu-link:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link:hover{background-color:#1aebff;border-color:#1aebff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-ContextualMenu-link:hover:focus{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-ContextualMenu-link:hover+.od-ContextualMenu-caretRight,.od-ContextualMenu-link:hover+.od-ContextualMenu-subMenuIcon{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link:hover{background-color:#37006e;border-color:#37006e;color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ContextualMenu-link:hover+.od-ContextualMenu-caretRight,.od-ContextualMenu-link:hover+.od-ContextualMenu-subMenuIcon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}.od-ContextualMenu-link:active{border:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ContextualMenu-link:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:0}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link:focus{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link:focus{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-ContextualMenu-link.is-selected{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:";font-weight:600}.od-ContextualMenu-link.is-selected:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link.is-selected{background-color:#1aebff;border-color:#1aebff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-ContextualMenu-link.is-selected:focus{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-ContextualMenu-link.is-selected+.od-ContextualMenu-caretRight,.od-ContextualMenu-link.is-selected+.od-ContextualMenu-subMenuIcon{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link.is-selected{background-color:#37006e;border-color:#37006e;color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ContextualMenu-link.is-selected+.od-ContextualMenu-caretRight,.od-ContextualMenu-link.is-selected+.od-ContextualMenu-subMenuIcon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}.od-ContextualMenu-link.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";cursor:default;pointer-events:none}.od-ContextualMenu-link.is-disabled:active,.od-ContextualMenu-link.is-disabled:focus{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link.is-disabled:active,.od-ContextualMenu-link.is-disabled:focus{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link.is-disabled:active,.od-ContextualMenu-link.is-disabled:focus{border-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:active){.od-ContextualMenu-link.is-disabled{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-ContextualMenu-link.is-disabled{color:#600000}}.od-ContextualMenu-link.od-ContextualMenu-link--hasMenu~.od-ContextualMenu{position:absolute;top:-1px;left:178px}.od-ContextualMenu-caretRight,.od-ContextualMenu-subMenuIcon{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px;height:39px;line-height:40px;position:absolute;top:0;right:7px;z-index:1;pointer-events:none}.od-ContextualMenu.od-ContextualMenu--multiselect .od-ContextualMenu-item.od-ContextualMenu-item--header{padding:0 30px}.od-ContextualMenu.od-ContextualMenu--multiselect .od-ContextualMenu-link{padding:0 30px}.od-ContextualMenu.od-ContextualMenu--multiselect .od-ContextualMenu-link.is-selected{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ContextualMenu.od-ContextualMenu--multiselect .od-ContextualMenu-link.is-selected:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';content:"\\e041";font-size:12px;height:39px;line-height:40px;position:absolute;left:10px}.od-Label{font-size:12px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;box-sizing:border-box;display:block;padding:5px 0}.od-Label.is-required:after{content:" *";color:'},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Label.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Label.is-disabled{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-Label.is-disabled{color:#600000}}.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.is-disabled .od-Label{color:#600000}}.od-Button{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-family:inherit;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px;cursor:pointer;display:inline-block;height:32px;min-width:80px;padding:4px 20px 6px;position:relative;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";font-weight:600}.isFluentVNext .od-Button{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"buttonBorder",defaultValue:"#8a8886"},{rawString:";border-radius:4px;padding-left:12px;padding-right:12px}.is-hidden.od-Button{display:none}.od-Button:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.isFluentVNext .od-Button:hover{background-color:"},{theme:"buttonBackgroundHovered",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-Button:hover .od-Button-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.isFluentVNext .od-Button:hover .od-Button-label{color:"},{theme:"buttonTextHovered",defaultValue:"#201f1e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Button:hover{color:#1aebff;border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-Button:hover{color:#37006e;border-color:#37006e}}.od-Button:focus{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:';outline:1px solid transparent}.ms-Fabric--isFocusVisible .od-Button:focus::after{content:"";position:absolute;top:-1px;left:-1px;right:-1px;bottom:-1px;outline:1px solid '},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";outline-offset:-4px;border:2px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}.isFluentVNext .od-Button:focus{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"buttonBorder",defaultValue:"#8a8886"},{rawString:'}.ms-Fabric--isFocusVisible .isFluentVNext .od-Button:focus::after{content:"";position:absolute;border:1px solid transparent;border-radius:4px;inset:0;outline:2px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:";outline-offset:0;box-shadow:none}.od-Button:focus .od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Button:active{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.isFluentVNext .od-Button:active{background-color:"},{theme:"buttonBackgroundPressed",defaultValue:"#edebe9"},{rawString:";border-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Button:active .od-Button-label{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.isFluentVNext .od-Button:active .od-Button-label{color:"},{theme:"buttonTextPressed",defaultValue:"#201f1e"},{rawString:"}.is-disabled.od-Button,.od-Button:disabled{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";cursor:default}.isFluentVNext .is-disabled.od-Button,.isFluentVNext .od-Button:disabled{background-color:"},{theme:"buttonBackgroundDisabled",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"buttonBackgroundDisabled",defaultValue:"#f3f2f1"},{rawString:"}.is-disabled.od-Button .od-Button-label,.od-Button:disabled .od-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.isFluentVNext .is-disabled.od-Button .od-Button-label,.isFluentVNext .od-Button:disabled .od-Button-label{color:"},{theme:"buttonTextDisabled",defaultValue:"#a19f9d"},{rawString:"}.is-disabled.od-Button:focus,.is-disabled.od-Button:hover,.od-Button:disabled:focus,.od-Button:disabled:hover{outline:0}.od-Button.od-Button--primary{background-color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"primaryButtonText",defaultValue:"#fff"},{rawString:"}.od-Button.od-Button--primary .od-Button-label{color:"},{theme:"primaryButtonText",defaultValue:"#fff"},{rawString:"}.od-Button.od-Button--primary:hover{background-color:"},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.od-Button.od-Button--primary:hover .od-Button-label{color:"},{theme:"primaryButtonText",defaultValue:"#fff"},{rawString:"}.isFluentVNext .od-Button.od-Button--primary:hover .od-Button-label{color:"},{theme:"primaryButtonTextHovered",defaultValue:"#fff"},{rawString:"}.od-Button.od-Button--primary:focus{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.ms-Fabric--isFocusVisible .od-Button.od-Button--primary:focus::after{content:"";position:absolute;top:-1px;left:-1px;right:-1px;bottom:-1px;outline:1px solid '},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline-offset:-4px;border:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}.isFluentVNext .od-Button.od-Button--primary:focus{background-color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:'}.ms-Fabric--isFocusVisible .isFluentVNext .od-Button.od-Button--primary:focus::after{content:"";position:absolute;border:1px solid '},{theme:"white",defaultValue:"#fff"},{rawString:";border-radius:4px;inset:0;outline:2px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:";outline-offset:0;box-shadow:none}.od-Button.od-Button--primary:focus .od-Button-label{color:"},{theme:"primaryButtonText",defaultValue:"#fff"},{rawString:"}.od-Button.od-Button--primary:active{background-color:"},{theme:"primaryButtonBackgroundPressed",defaultValue:"#005a9e"},{rawString:";border-color:"},{theme:"primaryButtonBackgroundPressed",defaultValue:"#005a9e"},{rawString:"}.od-Button.od-Button--primary:active .od-Button-label{color:"},{theme:"primaryButtonText",defaultValue:"#fff"},{rawString:"}.isFluentVNext .od-Button.od-Button--primary:active .od-Button-label{color:"},{theme:"primaryButtonTextPressed",defaultValue:"#fff"},{rawString:"}.is-disabled.od-Button.od-Button--primary,.od-Button.od-Button--primary:disabled{background-color:"},{theme:"primaryButtonBackgroundDisabled",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"primaryButtonBackgroundDisabled",defaultValue:"#f3f2f1"},{rawString:"}.is-disabled.od-Button.od-Button--primary .od-Button-label,.od-Button.od-Button--primary:disabled .od-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.isFluentVNext .is-disabled.od-Button.od-Button--primary .od-Button-label,.isFluentVNext .od-Button.od-Button--primary:disabled .od-Button-label{color:"},{theme:"primaryButtonTextDisabled",defaultValue:"#d2d0ce"},{rawString:"}.od-Button.od-Button--hero{align-items:center;background-color:transparent;border:0;display:flex;padding:0}.od-Button.od-Button--hero .od-Button-icon{color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";display:inline-block;font-size:12px;margin-right:4px;position:relative;top:1px;text-align:center}.od-Button.od-Button--hero .od-Button-icon .ms-Icon{border-radius:18px;border:1px solid "},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";font-size:12px;height:18px;line-height:18px;width:18px}.od-Button.od-Button--hero .od-Button-label{color:"},{theme:"primaryButtonBackground",defaultValue:"#0078d4"},{rawString:";font-size:21px;font-weight:100;position:relative;text-decoration:none}.od-Button.od-Button--hero:focus .od-Button-icon,.od-Button.od-Button--hero:hover .od-Button-icon{color:"},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.od-Button.od-Button--hero:focus .od-Button-icon .ms-Icon,.od-Button.od-Button--hero:hover .od-Button-icon .ms-Icon{border:1px solid "},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.od-Button.od-Button--hero:focus .od-Button-label,.od-Button.od-Button--hero:hover .od-Button-label{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Button.od-Button--hero:active .od-Button-icon{color:"},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.od-Button.od-Button--hero:active .od-Button-icon .ms-Icon{border:1px solid "},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.od-Button.od-Button--hero:active .od-Button-label{color:"},{theme:"primaryButtonBackgroundHovered",defaultValue:"#106ebe"},{rawString:"}.is-disabled.od-Button.od-Button--hero .od-Button-icon,.od-Button.od-Button--hero:disabled .od-Button-icon{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.is-disabled.od-Button.od-Button--hero .od-Button-icon .ms-Icon,.od-Button.od-Button--hero:disabled .od-Button-icon .ms-Icon{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.is-disabled.od-Button.od-Button--hero .od-Button-label,.od-Button.od-Button--hero:disabled .od-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Button.od-Button--compound{display:block;height:auto;max-width:280px;min-height:72px;padding:20px}.od-Button.od-Button--compound .od-Button-label{display:block;font-weight:600;position:relative;text-align:left;margin-top:-5px}.od-Button.od-Button--compound .od-Button-description{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";display:block;font-weight:400;font-size:12px;position:relative;text-align:left;top:3px}.od-Button.od-Button--compound:hover .od-Button-description{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.od-Button.od-Button--compound:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-Button.od-Button--compound:focus .od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Button.od-Button--compound:focus .od-Button-description{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Button.od-Button--compound:active{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Button.od-Button--compound:active .od-Button-description,.od-Button.od-Button--compound:active .od-Button-label{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.is-disabled.od-Button.od-Button--compound .od-Button-description,.is-disabled.od-Button.od-Button--compound .od-Button-label,.od-Button.od-Button--compound:disabled .od-Button-description,.od-Button.od-Button--compound:disabled .od-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.is-disabled.od-Button.od-Button--compound:active,.is-disabled.od-Button.od-Button--compound:focus,.od-Button.od-Button--compound:disabled:active,.od-Button.od-Button--compound:disabled:focus{border-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.is-disabled.od-Button.od-Button--compound:active .od-Button-description,.is-disabled.od-Button.od-Button--compound:active .od-Button-label,.is-disabled.od-Button.od-Button--compound:focus .od-Button-description,.is-disabled.od-Button.od-Button--compound:focus .od-Button-label,.od-Button.od-Button--compound:disabled:active .od-Button-description,.od-Button.od-Button--compound:disabled:active .od-Button-label,.od-Button.od-Button--compound:disabled:focus .od-Button-description,.od-Button.od-Button--compound:disabled:focus .od-Button-label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-Button-label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600;font-size:14px}.isFluentVNext .od-Button-label{color:"},{theme:"buttonText",defaultValue:"#323130"},{rawString:'}.od-Button-description,.od-Button-icon{display:none}.od-Label{font-size:12px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;box-sizing:border-box;display:block;padding:5px 0}.od-Label.is-required:after{content:" *";color:'},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Label.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Label.is-disabled{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-Label.is-disabled{color:#600000}}.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:'}@media screen and (-ms-high-contrast:active){.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.is-disabled .od-Label{color:#600000}}.od-Toggle{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;position:relative;display:block;margin-bottom:26px}.od-Toggle .ms-Label,.od-Toggle .od-Label{position:relative;top:-1px;padding:0 0 0 50px}html[dir=rtl] .od-Toggle .ms-Label,html[dir=rtl] .od-Toggle .od-Label{padding:0 50px 0 0}.od-Toggle .od-Toggle-field:before{position:absolute;top:3px;width:10px;height:10px;border-radius:10px;content:"";left:4px;background-color:'},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";outline:1px solid transparent;transition-property:background,left;transition-duration:250ms;transition-timing-function:cubic-bezier(0.4,0,0.23,1)}@media screen and (-ms-high-contrast:active){.od-Toggle .od-Toggle-field:before{border:2.5px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";height:15px;outline:0}}@media screen and (-ms-high-contrast:black-on-white){.od-Toggle .od-Toggle-field:before{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}[dir=ltr] .od-Toggle .od-Toggle-field:before{right:auto}[dir=rtl] .od-Toggle .od-Toggle-field:before{left:auto}.od-Toggle .od-Toggle-field .ms-Label--off{display:block}.od-Toggle .od-Toggle-field .ms-Label--on{display:none}.od-Toggle .od-Toggle-field.is-selected{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:'}.od-Toggle .od-Toggle-field.is-selected:before{position:absolute;top:3px;width:10px;height:10px;border-radius:10px;content:"";right:4px;background-color:'},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";outline:1px solid transparent;transition-property:background,left;transition-duration:250ms;transition-timing-function:cubic-bezier(0.4,0,0.23,1)}@media screen and (-ms-high-contrast:active){.od-Toggle .od-Toggle-field.is-selected:before{border:2.5px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";height:15px;outline:0}}@media screen and (-ms-high-contrast:black-on-white){.od-Toggle .od-Toggle-field.is-selected:before{border-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-Toggle .od-Toggle-field.is-selected:before{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}[dir=ltr] .od-Toggle .od-Toggle-field.is-selected:before{left:28px}[dir=rtl] .od-Toggle .od-Toggle-field.is-selected:before{right:28px}.od-Toggle .od-Toggle-field.is-selected .ms-Label--off{display:none}.od-Toggle .od-Toggle-field.is-selected .ms-Label--on{display:block}@media screen and (-ms-high-contrast:active){.od-Toggle .od-Toggle-field.is-selected{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-Toggle .od-Toggle-field.is-selected{background-color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-Toggle:focus+.od-Toggle-field,.od-Toggle:hover+.od-Toggle-field{border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-Toggle:focus+.od-Toggle-field:before,.od-Toggle:hover+.od-Toggle-field:before{background-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Toggle:focus:checked+.od-Toggle-field,.od-Toggle:hover:checked+.od-Toggle-field{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Toggle:focus:checked+.od-Toggle-field:before,.od-Toggle:hover:checked+.od-Toggle-field:before{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-Toggle:active:checked+.od-Toggle-field{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-Toggle .od-Toggle-field:focus,.od-Toggle .od-Toggle-field:hover{border-color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Toggle .od-Toggle-field.is-selected:focus,.od-Toggle .od-Toggle-field.is-selected:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-Toggle .od-Toggle-field .ms-Label,.od-Toggle .od-Toggle-field .od-Label{color:"},{theme:"black",defaultValue:"#000"},{rawString:";-webkit-user-select:none;-ms-user-select:none;user-select:none}.od-Toggle .od-Toggle-field:hover .ms-Label,.od-Toggle .od-Toggle-field:hover .od-Label{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-Toggle .od-Toggle-field:active .ms-Label,.od-Toggle .od-Toggle-field:active .od-Label{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-Toggle.is-disabled .ms-Label,.od-Toggle.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Toggle.is-disabled .ms-Label,.od-Toggle.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-Toggle.is-disabled .ms-Label,.od-Toggle.is-disabled .od-Label{color:#600000}}.od-Toggle.is-disabled .od-Toggle-field{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";pointer-events:none;cursor:default}.od-Toggle.is-disabled .od-Toggle-field:before{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Toggle.is-disabled .od-Toggle-field,.od-Toggle.is-disabled .od-Toggle-field:before{border-color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-Toggle.is-disabled .od-Toggle-field,.od-Toggle.is-disabled .od-Toggle-field:before{border-color:#600000}}.od-Toggle-description{position:relative;font-size:14px;vertical-align:top;display:block;margin-bottom:8px}.od-Toggle-field{position:relative;display:inline-block;width:45px;height:20px;box-sizing:border-box;border:2px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";border-radius:20px;cursor:pointer;transition-property:background,left,border-color;transition-duration:250ms;transition-timing-function:cubic-bezier(0.4,0,0.23,1);outline:0}.od-Toggle-field:focus,.od-Toggle-field:hover{border-color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}.od-Toggle-input{display:none}.od-Toggle.od-Toggle--textLeft{width:225px;margin-bottom:40px}.od-Toggle.od-Toggle--textLeft .od-Toggle-description{display:inline-block;max-width:150px;top:-3px;margin-bottom:0}.od-Toggle.od-Toggle--textLeft .od-Toggle-field{float:right}.od-Label{font-size:12px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;box-sizing:border-box;display:block;padding:5px 0}.od-Label.is-required:after{content:" *";color:'},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-Label.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Label.is-disabled{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-Label.is-disabled{color:#600000}}.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.is-disabled .od-Label{color:#600000}}.od-TextField{box-sizing:border-box;box-shadow:none;margin:0;padding:0;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:14px;font-weight:400;margin-bottom:8px}.od-TextField .ms-Label,.od-TextField .od-Label{font-size:14px}.od-TextField.is-disabled .od-TextField-field{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";border-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";pointer-events:none;cursor:default}.od-TextField.is-disabled::placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:'}.od-TextField.is-required .ms-Label:after,.od-TextField.is-required .od-Label:after{content:" *";color:'},{theme:"error",defaultValue:"#a80000"},{rawString:'}.od-TextField.is-required::placeholder:after{content:" *";color:'},{theme:"error",defaultValue:"#a80000"},{rawString:"}.od-TextField.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-TextField-field{box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:32px;width:100%;min-width:180px;outline:0;padding:8px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";border:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-weight:400}.od-TextField-field:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-TextField-field:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-TextField-field:focus,.od-TextField-field:hover{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-TextField-field:focus,.od-TextField-field:hover{border-color:#37006e}}.od-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.isFluentVNext .od-TextField-field{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.od-TextField-field-hasDropdown{width:68%}[dir=ltr] .od-TextField-field-hasDropdown{margin-left:7px}[dir=rtl] .od-TextField-field-hasDropdown{margin-right:7px}.od-TextField-description{color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";font-size:11px}.od-TextField.od-TextField--placeholder{position:relative}.od-TextField.od-TextField--placeholder .ms-Label,.od-TextField.od-TextField--placeholder .od-Label{position:absolute;font-weight:300;font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";padding:6px 12px 7px;pointer-events:none}.od-TextField.od-TextField--placeholder.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-TextField.od-TextField--underlined{border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";display:table;width:100%;min-width:180px}.od-TextField.od-TextField--underlined:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-TextField.od-TextField--underlined:hover{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-TextField.od-TextField--underlined:hover{border-color:#37006e}}.od-TextField.od-TextField--underlined:active,.od-TextField.od-TextField--underlined:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-TextField.od-TextField--underlined .ms-Label,.od-TextField.od-TextField--underlined .od-Label{font-size:14px;display:table-cell;vertical-align:top;padding-top:10px;height:32px;width:1%;white-space:nowrap}[dir=ltr] .od-TextField.od-TextField--underlined .ms-Label,[dir=ltr] .od-TextField.od-TextField--underlined .od-Label{margin-right:8px}[dir=rtl] .od-TextField.od-TextField--underlined .ms-Label,[dir=rtl] .od-TextField.od-TextField--underlined .od-Label{margin-left:8px}[dir=ltr] .od-TextField.od-TextField--underlined .ms-Label,[dir=ltr] .od-TextField.od-TextField--underlined .od-Label{padding-left:12px}[dir=rtl] .od-TextField.od-TextField--underlined .ms-Label,[dir=rtl] .od-TextField.od-TextField--underlined .od-Label{padding-right:12px}.od-TextField.od-TextField--underlined .od-TextField-field{border:0;float:left;display:table-cell;padding-top:8px;padding-bottom:3px}html[dir=ltr] .od-TextField.od-TextField--underlined .od-TextField-field{text-align:left}html[dir=rtl] .od-TextField.od-TextField--underlined .od-TextField-field{text-align:right}.od-TextField.od-TextField--underlined .od-TextField-field:active,.od-TextField.od-TextField--underlined .od-TextField-field:focus,.od-TextField.od-TextField--underlined .od-TextField-field:hover{outline:0}.od-TextField.od-TextField--underlined.is-disabled{border-bottom-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-TextField.od-TextField--underlined.is-disabled .od-TextField-field{background-color:transparent;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-TextField.od-TextField--underlined.is-active{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-TextField.od-TextField--underlined.is-active{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-TextField.od-TextField--underlined.is-active{border-color:#37006e}}.od-TextField.od-TextField--multiline .od-TextField-field{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:14px;font-weight:400;line-height:17px;min-height:60px;overflow:auto;padding:6px 8px;min-width:254px}.od-TextField.od-TextField--textFieldUnderlined{border:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:table;width:100%;min-width:180px}.od-TextField.od-TextField--textFieldUnderlined:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-TextField.od-TextField--textFieldUnderlined:active,.od-TextField.od-TextField--textFieldUnderlined:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-TextField.od-TextField--textFieldUnderlined .od-TextField-field{border:0;display:table-cell;padding-top:8px;padding-bottom:2px}html[dir=ltr] .od-TextField.od-TextField--textFieldUnderlined .od-TextField-field{text-align:left}html[dir=rtl] .od-TextField.od-TextField--textFieldUnderlined .od-TextField-field{text-align:right}.od-TextField.od-TextField--textFieldUnderlined .od-TextField-field:active,.od-TextField.od-TextField--textFieldUnderlined .od-TextField-field:focus{outline:0}.od-TextField.od-TextField--textFieldUnderlined.is-disabled{border-bottom-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-TextField.od-TextField--textFieldUnderlined.is-disabled .od-TextField-field{background-color:transparent;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-CheckBox{font-size:14px;font-weight:400;box-sizing:border-box;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';min-height:36px;position:relative}.od-CheckBox .od-Label{font-size:14px;padding:0 0 0 26px;cursor:pointer;display:inline-block}html[dir=rtl] .od-CheckBox .od-Label{padding:0 26px 0 0}.od-CheckBox-input{position:absolute;opacity:0}.od-CheckBox-field::before{content:"";display:inline-block;border:2px solid '},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:';width:20px;height:20px;cursor:pointer;font-weight:400;position:absolute;box-sizing:border-box;transition-property:background,border,border-color;transition-duration:.2s;transition-timing-function:cubic-bezier(0.4,0,0.23,1)}.od-CheckBox-field::after{content:"\\e73e";font-family:FabricMDL2Icons;display:none;position:absolute;font-weight:900;background-color:transparent;font-size:13px;top:0;color:'},{theme:"white",defaultValue:"#fff"},{rawString:";line-height:20px;width:20px;text-align:center}@media screen and (-ms-high-contrast:active){.od-CheckBox-field::after{-ms-high-contrast-adjust:none;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-CheckBox-field::after{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}}.od-CheckBox-field{display:inline-block;cursor:pointer;margin-top:8px;position:relative;outline:0;vertical-align:top}.od-CheckBox-field:focus::before,.od-CheckBox-field:hover::before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-CheckBox-field:focus .od-Label,.od-CheckBox-field:hover .od-Label{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.od-CheckBox-field.is-disabled{cursor:default}.od-CheckBox-field.is-disabled::before{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-CheckBox-field.is-disabled::before{border-color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-CheckBox-field.is-disabled::before{border-color:#600000}}.od-CheckBox-field.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-CheckBox-field.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.od-CheckBox-field.is-disabled .od-Label{color:#600000}}.od-CheckBox-field.in-focus::before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.od-CheckBox-field.in-focus.is-disabled::before{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.od-CheckBox-field.in-focus.is-checked::before{border-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-CheckBox-field.is-checked::before{border:10px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-CheckBox-field.is-checked::before{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-CheckBox-field.is-checked::before{border-color:#37006e}}.od-CheckBox-field.is-checked::after{display:block}.od-CheckBox-field.is-checked:focus::before,.od-CheckBox-field.is-checked:hover::before{border-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-CheckBox-field.is-checked.is-disabled::before{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border:10px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-CheckBox-field.is-checked.is-disabled::before{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.od-CheckBox-field.is-checked.is-disabled::before{border-color:#37006e}}.od-CheckBox-field.is-checked.is-disabled::after{display:block}.od-CheckBox-field.is-checked.is-disabled:focus::before,.od-CheckBox-field.is-checked.is-disabled:hover::before{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border:10px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ms-RadioButton{font-size:14px;font-weight:400;box-sizing:border-box;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:';min-height:36px;position:relative}.ms-RadioButton .ms-Label,.ms-RadioButton .od-Label{font-size:14px;padding:0 0 0 26px;cursor:pointer;display:inline-block}html[dir=rtl] .ms-RadioButton .ms-Label,html[dir=rtl] .ms-RadioButton .od-Label{padding:0 26px 0 0}.ms-RadioButton-input{position:absolute;opacity:0}.ms-RadioButton-field::before{content:"";display:inline-block;border:2px solid '},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:';width:20px;height:20px;cursor:pointer;font-weight:400;position:absolute;box-sizing:border-box;transition-property:border-color;transition-duration:.2s;transition-timing-function:cubic-bezier(0.4,0,0.23,1);border-radius:50%}.ms-RadioButton-field::after{content:"";width:0;height:0;border-radius:50%;position:absolute;top:8px;bottom:0;transition-property:top,left,width,height;transition-duration:150ms;transition-timing-function:cubic-bezier(0.4,0,0.23,1);box-sizing:border-box}[dir=ltr] .ms-RadioButton-field::after{left:8px}[dir=rtl] .ms-RadioButton-field::after{right:8px}[dir=ltr] .ms-RadioButton-field::after{right:0}[dir=rtl] .ms-RadioButton-field::after{left:0}@media screen and (-ms-high-contrast:active){.ms-RadioButton-field::after{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-RadioButton-field::after{color:#600000}}.ms-RadioButton-field{display:inline-block;cursor:pointer;margin-top:8px;position:relative;outline:0;vertical-align:top}.ms-RadioButton-field:focus::before,.ms-RadioButton-field:hover::before{border-color:'},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.ms-RadioButton-field:focus .ms-Label,.ms-RadioButton-field:focus .od-Label,.ms-RadioButton-field:hover .ms-Label,.ms-RadioButton-field:hover .od-Label{color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.ms-RadioButton-field.is-disabled{cursor:default}.ms-RadioButton-field.is-disabled::before{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-RadioButton-field.is-disabled::before{border-color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-RadioButton-field.is-disabled::before{border-color:#600000}}.ms-RadioButton-field.is-disabled .ms-Label,.ms-RadioButton-field.is-disabled .od-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-RadioButton-field.is-disabled .ms-Label,.ms-RadioButton-field.is-disabled .od-Label{color:#0f0}}@media screen and (-ms-high-contrast:black-on-white){.ms-RadioButton-field.is-disabled .ms-Label,.ms-RadioButton-field.is-disabled .od-Label{color:#600000}}.ms-RadioButton-field.is-disabled:focus::before,.ms-RadioButton-field.is-disabled:hover::before{border-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ms-RadioButton-field.in-focus::before{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.ms-RadioButton-field.is-checked::before,.ms-RadioButton-input:checked+.ms-RadioButton-field::before{border:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:transparent}@media screen and (-ms-high-contrast:active){.ms-RadioButton-field.is-checked::before,.ms-RadioButton-input:checked+.ms-RadioButton-field::before{border-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-RadioButton-field.is-checked::before,.ms-RadioButton-input:checked+.ms-RadioButton-field::before{border-color:#37006e}}.ms-RadioButton-field.is-checked::after,.ms-RadioButton-input:checked+.ms-RadioButton-field::after{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";top:5px;width:10px;height:10px}[dir=ltr] .ms-RadioButton-field.is-checked::after,[dir=ltr] .ms-RadioButton-input:checked+.ms-RadioButton-field::after{left:5px}[dir=rtl] .ms-RadioButton-field.is-checked::after,[dir=rtl] .ms-RadioButton-input:checked+.ms-RadioButton-field::after{right:5px}@media screen and (-ms-high-contrast:active){.ms-RadioButton-field.is-checked::after,.ms-RadioButton-input:checked+.ms-RadioButton-field::after{background-color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.ms-RadioButton-field.is-checked::after,.ms-RadioButton-input:checked+.ms-RadioButton-field::after{background-color:#37006e}}.ms-RadioButton-field.is-checked:focus::before,.ms-RadioButton-field.is-checked:hover::before,.ms-RadioButton-input:checked+.ms-RadioButton-field:focus::before,.ms-RadioButton-input:checked+.ms-RadioButton-field:hover::before{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-RadioButton-field.is-checked.in-focus::before,.ms-RadioButton-input:checked+.ms-RadioButton-field.in-focus::before{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-accessible{position:absolute;top:-9001px;left:-9001px;height:1px;width:1px}"}])},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("rootItems")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(7),i=n(135),r=new a.t({name:"NotificationManager.key",loader:new i.t(function(){return n.ee([367],4356).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(7).t)("RootItemsTypeFilter.key")},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(59),r=n(599),o=n(1912),s=n(3135),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getCapabilities=function(){return this.resources.consume(s.e)},t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())},t.prototype.hasMatchingId=function(e,t){return e===t.id},t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new r.e,a=d(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(a),isErrorExpectedCallback:function(e){return 2001===e.errorCode}})},t.prototype._getCopyItemsAsyncUrl=function(){return o.t.skyApiBaseUrl+"CopyItemsAsync"},t}(i.n);function d(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}t.t=c},,function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(75),o=n(47),s=n(362),c=n(82),d=n(128),l=n(70),u=n(2584),f=n(861),p=n(3005),m=function(e){function t(t){var n=e.call(this,t)||this;n.name="SignOut",n.url=t.url,n.target=t.target||"_top",n._navigation=n.resources.consume(c.e),n._sessionProvider=n.resources.consume(s.e);var a=u.e+n._sessionProvider.getIdentity().id;return n._dataStore=new d.e(a,l.e.local),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}return this._dataStore.remove(f.t,l.e.session),this._dataStore.remove(p.e,l.e.session),this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target}),r.n.wrap({resultType:o.t.Success})},t.prototype.onIsAvailable=function(){return!0},t}(i.e);t.e=m},,function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(47),o=n(75),s=n(3475),c=n(32),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="ToggleDebugWindow",t}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){if(s.default.isInitialized()){var n=this.resources.consume(c.v);n(!n())}else s.default.init(this.resources);return o.n.wrap({resultType:r.t.Success})},t}(i.e);t.e=d},,function(e,t,n){"use strict";var a=n(2106);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n(0),i=n(59),r=n(135),o=n(82),s=n(106),c=n(77),d=n(32),l=n(33),u=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a.pageType=n.pageType,a._urlDataSource=n.urlDataSource,a._navigation=n.navigation,a._ransomwareDetectionDataSource=n.ransomwareDataSource,a.activeAnomaly=a.observables.create(),a.createBackgroundComputed(function(){var e=a.activeAnomaly.peek()||a.activeAnomaly();a._redirectByAnomalyState(e&&e.state)}),a}return Object(a.__extends)(t,e),t.prototype.checkActiveAnomalies=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly().then(function(t){return e.activeAnomaly(t),t})},t.prototype.getAnomalyDetectedDate=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly(!0).then(function(t){if(t&&t.detectedDateTime){var n=e.activeAnomaly.peek();n.detectedDateTime=t.detectedDateTime,n.id=t.id,e.activeAnomaly(n)}return t&&t.detectedDateTime})},t.prototype.updateActiveAnomalyState=function(e){var t=this.activeAnomaly();return t?this._ransomwareDetectionDataSource.updateAnomalyState(t.id,e):Promise.resolve(null)},t.prototype._redirectByAnomalyState=function(e){switch(e){case 0:case 1:this.pageType()!==l.e.RansomwareDetection&&this._navigation.updateViewParams({v:"RansomwareDetection"},{ignoreHistory:!0});break;case 2:this.pageType()!==l.e.Restore&&this._navigation.updateViewParams({v:"restore"},{ignoreHistory:!0});break;case 4:case 3:case 5:this.pageType()===l.e.RansomwareDetection&&this._navigation.navigateTo({url:this._urlDataSource.getCurrentPageBaseUrl()});break;default:return}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{bundleLoaderProvider:s.e,pageType:d.s,urlDataSource:c.Se,navigation:o.e,ransomwareDataSource:c.X}),t}(i.n),f=Object(r.r)("RansomwareDetectionProvider",u)},function(e,t,n){"use strict";var a=n(0),i=n(213),r=n(75),o=n(2175),s=n(32),c=n(43),d=n(3139),l=n(1968),u=n(139),f=n(8),p=function(e){function t(t){void 0===t&&(t={});var n,a=this;return(a=e.call(this,t)||this)._itemCommandHelper=new(a.managed(l.e)),a.name="Download",a._focusItem=null===(n=t.item)||void 0===n?void 0:n.peek(),a._currentItem=f.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?a.resources.consume(s.r):a.selectionHelper.currentItem,a._itemCommandHelper=new(a.managed(l.e)),a._isOneDriveWinApp=Object(u.e)(),a._isOneDriveXboxApp=Object(u.t)(),a}return Object(a.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DownloadExecutor"},t.prototype.getModuleFactory=function(){return function(){return r.n.resolve(n.ee([592,"ondemand.resx-ondemand"],4688))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!this._isOneDriveWinApp,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name,focusItem:this._focusItem}},t.prototype.onIsAvailable=function(){var e=this,t=this.selectionHelper.selection(),n=this.selectionHelper.firstItem();if((t.length>1||n&&n.folder)&&i.get("BadgerAuth"))return!1;var a=this._currentItem();return!(t.length>1&&a.queryType===c.e.SharedWithMe&&a.isRootFolder)&&!this._isOneDriveXboxApp&&this.selectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,d.e)})},t}(o.e);t.e=p},function(e,t,n){"use strict";n.r(t),n.d(t,"ShowPropertiesAction",function(){return y});var a=n(0),i=n(1122),r=n(1892),o=n(2493),s=n(2648),c=n(75),d=n(808),l=n(1829),u=n(32),f=n(408),p=n(403),m=n(47),_=n(102),h=n(43),b=n(2789),g=n(1995),v=n(13),y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="ShowProperties";var i=n.isInfoPaneExpanded,c=void 0===i?a.resources.consume(r.resourceKey):i,m=n.isSharingSectionExpanded,_=void 0===m?a.resources.consume(u.I.optional):m,h=n.isInfoPaneAvailable,b=void 0===h?a.resources.consume(l.e.infoPane.isInfoPaneAvailable.optional):h,g=n.isFiltersPaneExpanded,v=void 0===g?a.resources.consume(o.e):g,y=n.isCopilotPaneExpanded,S=void 0===y?a.resources.consume(s.e):y,D=n.isColumnCustomizationPaneExpanded,I=void 0===D?a.resources.consume(l.e.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):D,x=n.rumOneHelper,C=void 0===x?a.resources.consume(f.e.optional):x,O=n.itemSelectionHelperType,w=void 0===O?a.resources.consume(d.e):O,E=n.engagement,A=void 0===E?a.resources.consume(p.e):E,L=t.useToggleBehavior,k=void 0!==L&&L,M=t.isSharingSectionExpanded,P=void 0!==M&&M,T=t.allowMultiSelect,U=void 0!==T&&T;return a._isInfoPaneExpanded=c,a._isSharingSectionExpanded=_,a._isInfoPaneAvailable=b||a.observables.create(!0),a._isFiltersPaneExpanded=v,a._isCopilotPaneExpanded=S,a._isColumnCustomizationPaneExpanded=I,a._rumOneHelper=C,a._useToggleBehavior=k,a._allowMultiSelect=U,a._shouldExpandSharingSection=P,a._itemSelectionHelper=new(a.scope.attached(w))({allowMultiSelect:a._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0}),a._engagement=A,a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e){this.isToggled.peek()||(this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch(),this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1),this._isCopilotPaneExpanded&&this._isCopilotPaneExpanded(!1),this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)),this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);var t=!this._useToggleBehavior||!this._isInfoPaneExpanded.peek();return t&&b.e("LaunchInfoPane"),this._engagement.logData({name:"DetailsPane.Click.".concat(t?"Open":"Close"),isIntentional:!0}),this._isInfoPaneExpanded(t),_.t.raise(document.body,"resize",void 0,!0),c.n.wrap({resultType:m.t.Success})},t.prototype.onIsAvailable=function(){var e=this._isInfoPaneAvailable();if(this._useToggleBehavior&&this._isInfoPaneExpanded())return!0;if(!e)return!1;var t=this._itemSelectionHelper.firstItem;if(!t())return!1;var n=[t];this._allowMultiSelect&&(n=this._itemSelectionHelper.selection());for(var a=0,i=n;a<i.length;a++){var r=i[a];if(r){var o=r();if(o&&(o.error||o.isPlaceholder&&o.queryType!==h.e.Search))return!1}}return!0},t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()},t.prototype.getEngagement=function(){return Object(v.isFeatureEnabled)(v.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(g.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t}(i.e);t.default=y},function(e,t,n){"use strict";var a=n(0),i=n(75),r=n(1122),o=n(43),s=n(1019),c=n(32),d=n(103),l=n(2790),u=n(77),f=n(159),p=n(1834),m=n(449),_=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ToggleListLayout",n._layoutType=s.m(t.layoutType),n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter,n._currentItem=n.resources.consume(c.r),n._viewParams=n.resources.consume(c.T),n._actionMap=n.resources.consume(c.e),n._urlDataSource=n.resources.consume(u.Se),n._helper=new(n.managed(l.e)),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.resources.consume(p.n),t=this._currentItem(),n=t&&t.queryType,a=t.key!==this._urlDataSource.getRootItemKey(o.e.SharedWithMe)&&n!==o.e.DocsInCommon;e||(a=a&&n!==o.e.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),r=t.virtualItemType!==m.e.Album;return this._layoutType===s.l&&(r=n===o.e.Files),e&&n===o.e.AllMyPhotos&&(r=!("allmyphotos"!==i.qt||i.tagFilter||i.locationFilter||i.onThisDay||i.onThisMonth||i.lastWeekPreviousYears)),"allmyphotos"===i.qt&&(r=this._layoutType!==s.r&&this._layoutType!==s.n),a&&r},t.prototype.onExecute=function(e,t){var n,a=this;if(this._shouldClearContextualFilter){var r=f.e({},this._viewParams.peek());delete r.ft,n=new(this.managed(this._actionMap.NavigationAction))({url:"#".concat(d.n(r))}).execute(e)}else n=i.n.wrap();return n.then(function(){return a._helper.changeLayout(a._layoutType)},function(){return a._helper.changeLayout(a._layoutType)})},t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()},t}(r.e);t.e=_},,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(2138),r=n(1822),o=n(482),s=n(135),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._context=t,a._itemProvider=n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),a=t.input;return n.type=o.e.updateBundle,n.name=a.name,n.iconName=a.iconName,n.payloads.updateBundle={item:a,parent:a.UNSAFE_parent},n},t.prototype.onStart=function(e){var t=[new i.t(this._context.item.key,this._context.item)];return e.update(t),this._itemProvider.updateBundle(this._context,e)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemProvider:r.resourceKey}),t}(i.n),d=Object(s.o)("UpdateBundleOperator",c)},function(e,t,n){"use strict";var a=n(0),i=n(75),r=n(32),o=n(77),s=n(156),c=n(2175),d=n(264),l=n(1904),u=n(1187),f=n(2334),p=n(3310),m=n(47),_=n(490),h=n(3859),b=n(808),g=n(33),v=n(43),y=n(139),S=n(3),D=n(95),I=n(76),x=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(l.e),n._itemSelectionHelper=new(n.child(b.e))({allowMultiSelect:!0,overrideItem:t.item}),n._urlDataSource=n.resources.consume(o.Se),n._viewParams=n.resources.consume(r.T),n._vaultActionType=t.actionType,n._isGlobal=t.isGlobal,n._goPremiumSource=t.goPremiumSource,n._shouldShowFRE=!1!==t.shouldShowFRE,n._vaultHelper=new(n.managed(h.e))({}),n._isVaultUnlocked=n.observables.createCallback(Object(d.t)(!1)),n._vaultFreState=n.observables.createCallback(Object(d.t)(u.a.NotCreated)),n._isVaultDisabled=n.observables.createCallback(Object(d.t)(!1)),n.resources.isDefined(p.e)&&n.resources.consumeAsync(p.e).then(function(e){n._isVaultUnlocked.register(e.isVaultOpen),n._vaultFreState.register(e.vaultFreState),n._isVaultDisabled.register(e.isVaultDisabled)}),n._isOneDriveWinApp=Object(y.e)(),n}return Object(a.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./VaultExecutor"},t.prototype.getModuleFactory=function(){return function(){return i.n.resolve(n.ee([64,"ondemand.resx-ondemand"],4690))}},t.prototype.getSelectionOptions=function(e){return e.actionType===_.e.ShowFiles?{allowMultiSelect:!0,canFallback:!1}:{allowMultiSelect:!1,canFallback:!0}},t.prototype.onIsAvailable=function(){var e,t=this.selectionHelper.firstItem(),n=t&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"vault"));if(this._isVaultDisabled())return!1;var a=Object(S.cs)(S.Yr)&&Object(D.e)(I.l)?!this._isVaultUnlocked():(null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.isLocked)||!1;if(this._vaultActionType===_.e.ShowFiles){var i=this._itemSelectionHelper.currentItem(),r=this._urlDataSource.getKeyParams(i.key),o=this._urlDataSource.getQueryType(r),s=this.selectionHelper.selection();return!(o!==v.e.RecycleBin||this._vaultFreState()!==u.a.FreShown||this._isOneDriveWinApp||s.length>0||this._isVaultUnlocked())}if(this._vaultActionType===_.e.Unlock)return!!(n&&n.vault&&a);if(this._vaultActionType===_.e.Lock){var c=this._isGlobal&&this._isVaultUnlocked(),d=t&&t.vault&&t.vault.root&&!a;return!(!c&&!d)}return n&&!n.error||this._isVaultUnlocked()},t.prototype.getExecutorParameters=function(){return{actionType:this._vaultActionType,isPickerPage:this._isPickerPage,goPremiumSource:this._goPremiumSource}},t.prototype.onExecute=function(t,n){var a=this._urlDataSource.getPageType(this._viewParams.peek()),r=this._urlDataSource.getQueryType(this._viewParams.peek());if(this._isPickerPage=a===g.e.FilePicker||a===g.e.FolderPicker,s.e.logData({name:"Vault.".concat(Object(f.r)(this._vaultActionType)),extraData:{location:Object(f.i)(a,r)}}),this._vaultActionType===_.e.Unlock&&!this._isOneDriveWinApp&&!this._isPickerPage){var o=this._vaultFreState.peek();if(this._shouldShowFRE&&(o===u.a.BubbleShown||o===u.a.Created))return this._vaultActionType=_.e.FreDialog,e.prototype.onExecute.call(this,t,n);var c=this._vaultActionType.toString();return this._vaultHelper.unlockPopup().then(function(e){return e?i.n.resolve({name:c,resultType:m.t.Success}):i.n.reject({name:c,resultType:m.t.Failure})})}return e.prototype.onExecute.call(this,t,n)},t}(c.e);t.e=x},function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(156),o=n(302),s=n(1123),c=n(77),d=n(75),l=n(47),u=n(242),f=n(2765),p=n(4313),m=n(2647),_=n(139),h=function(e){function t(t){var n=e.call(this,t)||this;return n._identityDataSource=n.resources.consume(c.D),n._isOneDriveWinApp=Object(_.e)(),n}return Object(a.__extends)(t,e),t.prototype.unlockPopup=function(){var e=this;return this._unlockSignal=new u.e,this.async.setTimeout(function(){e._showPopupNotice()},500),this._isOneDriveWinApp?(this.events.on(window,"StrongAuthTokenFromWinApp",this._onReceivedTokenFromWinApp),this._showLoginPopupForWinApp()):(this.events.on(window,"message",this._onReceivedMessage),this._createLoginPopup()),this._unlockSignal.getPromise()},t.prototype._onReceivedMessage=function(e){var t=this;if(this._loginPopup&&e.origin===window.location.origin&&e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}if(n&&n.isVault){this.async.clearInterval(this._popupInterval),this._popupInterval=0;var a=new l.e({name:"VaultHelper.FinalizeUnlock"});n.success?(n.canary&&(FilesConfig.canary=n.canary),n.navCanary&&(FilesConfig.navCanary=n.navCanary),this.resources.consumeAsync(m.e).then(function(e){e.unlockVault().then(function(){a.end({resultType:l.t.Success}),t._popupNoticeDialog.complete(),t._unlockSignal.complete(n.success),t._loginPopup.close(),t._loginPopup=null}).catch(function(){a.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:n.error&&n.error.message||"Unknown"}),t._showUnlockError()})})):(a.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:n.error&&n.error.message||"Unknown"}),this._showUnlockError())}}},t.prototype._showUnlockPopBlockError=function(){this._popupNoticeDialogText("".concat(p.a,'<p class="ms-fontColor-error">').concat(p.e,"</p>")),r.e.logData({name:"Vault.VerificationNeeded.Blocked"}),this._loginPopup=null},t.prototype._showUnlockError=function(){this._popupNoticeDialogText("".concat(p.a,'<p class="ms-fontColor-error">').concat(p.t,"</p>")),r.e.logData({name:"Vault.Unlock.Failed"}),this._unlockSignal.complete(!1),this._loginPopup&&(this._loginPopup.close(),this._loginPopup=null)},t.prototype._createLoginPopup=function(){var e=this._identityDataSource.getAuthUrl("msa_strong_auth:"),t=window.screenX,n=window.screenY,a=window.outerWidth,i=window.outerHeight,r=t+Math.max(a-500,0)/2,o=n+Math.max(i-500,0)/2;this._loginPopup=window.open(e,"vaultPopup","width=".concat(500,",height=").concat(500,",top=").concat(o,",left=").concat(r,",status=no,resizeable=yes,toolbar=no,menubar=no,scrollbars=yes")),this._monitorLoginPopup()},t.prototype._monitorLoginPopup=function(){var e=this;this._popupInterval||(this._popupInterval=this.async.setInterval(function(){if(e._loginPopup)if(e._loginPopup.closed)e.async.clearInterval(e._popupInterval),e._popupInterval=0;else try{e._loginPopup.postMessage("updating reference of parent to support navigations in auth popup",window.location.origin)}catch(t){t&&"TypeError"===t.name&&e._showUnlockPopBlockError()}else e.async.clearInterval(e._popupInterval),e._popupInterval=0},500))},t.prototype._showPopupNotice=function(){var e=this;if(!this._popupNoticeDialog||1!==this._popupNoticeDialog.state.peek()){var t=this.resources.consume(s.e),n=p.i;this._popupNoticeDialogText=this.observables.create(p.a),this._popupNoticeDialog=t.requestDialog({title:n,isSoftDismissable:!1,focusOnPrimaryAction:!0,component:{name:f.e.tagName,params:{html:this._popupNoticeDialogText}},actions:[{name:p.n,execute:function(){return e.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new o.e("CheckMark"),isDefault:!0}]}),this._logVaultEvent("Vault.VerificationNeeded.Shown"),this._popupNoticeDialog.wait().catch(function(){e._loginPopup&&3===e._popupNoticeDialog.state.peek()&&(e._logVaultEvent("Vault.VerificationNeeded.Dismiss"),e._unlockSignal.cancel(),e._loginPopup.close(),e._loginPopup=null)}),this._popupNoticeDialog.wait().then(function(){e._loginPopup&&2===e._popupNoticeDialog.state.peek()&&e._logVaultEvent("Vault.VerificationNeeded.Succeeded")})}},t.prototype.onDialogExecute=function(){if(this._logVaultEvent("Vault.VerificationNeeded.ShowPopup"),this._loginPopup&&!this._loginPopup.closed)try{this._loginPopup.focus()}catch(e){}else this._isOneDriveWinApp?this._showLoginPopupForWinApp():this._createLoginPopup();return d.n.resolve(1)},t.prototype._logVaultEvent=function(e){r.e.logData({name:e})},t.prototype._showLoginPopupForWinApp=function(){this._identityDataSource.getSessionToken(void 0,!0)},t.prototype._onReceivedTokenFromWinApp=function(e){var t=this,n=new l.e({name:"VaultHelper.PWA.FinalizeUnlock"});e.detail.error||!e.detail.token?(n.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:e.detail.error||"Unknown"}),this._showUnlockError()):this.resources.consumeAsync(m.e).then(function(a){a.unlockVault(!1,e.detail.token).then(function(){n.end({resultType:l.t.Success}),t._popupNoticeDialog.complete(),t._unlockSignal.complete(!0)}).catch(function(){n.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:e.detail.error||"Unknown"}),t._showUnlockError()})})},t}(i.n);t.e=h},function(e,t,n){"use strict";n.d(t,"t",function(){return l});var a=n(0),i=n(59),r=n(7),o=n(82),s=n(75),c=n(2166),d=n(10),l=new r.t("EducationAndUpsells"),u=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=n.resources.consume(o.e);return n._newUserOverride=a.viewParams.forceNewUser,n}return Object(a.__extends)(t,e),t.prototype.getExistingUserTypeOfPremiumUpsell=function(e){var t=this;return this._checkIsRootAndValid(e)?this.getIsNewUser(e).then(function(e){return e?s.n.wrap():t.resources.consumeAsync(c.e).then(function(e){return e.getPremiumUpsellType()})}):s.n.wrap()},t.prototype.getAreNoFilesAdded=function(e){if(this._newUserOverride)return!0;for(var t=0,n=0,a=0,i=e.content().items;a<i.length;a++){var r=i[a];if(void 0===r)return!1;if(r().folder){if(t++,r().childCount>0)return!1}else n++;if(t>2||n>1)return!1}return!0},t.prototype.getIsNewUser=function(e){return this._checkIsRootAndValid(e)?s.n.resolve(this.resources.consumeAsync(c.e)).then(function(e){return e.isAnyMessageActive(206)}):s.n.resolve(!1)},t.prototype._checkIsRootAndValid=function(e){var t=e.itemKey,n=e.isItemSetPlaceHolder,a=e.isItemSetExpired;return t===Object(d.M)()&&!n&&!a},t}(i.n);t.e=u},function(e,t,n){"use strict";t.e="D41D8CD98F00B204E9800998ECF8427E0C818072"},,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(135),i=n(4314),r=n(1129),o=n(75),s=n(2138),c=n(140),d=n(1930),l=function(){function e(e,t){this._operationProvider=t.operationProvider,this._requestReviewVroomDataSource=t.requestReviewVroomDataSource}return e.prototype.requestReview=function(e){var t=e.item,n=this._operationProvider.register({name:t.name,type:s.e.requestReview,iconName:t.iconName,payloads:{requestReview:{item:t}}}),a=this._requestReviewVroomDataSource.requestReview(e);return n.state(c.e.started),n.progress.maximum(1),a.then(function(e){return n.state(c.e.completed),n.progress.current(1),e},function(e){return n.state(c.e.failed),n.error(new d.e({message:e})),o.n.wrapError(e)})},e.dependencies={operationProvider:r.resourceKey,requestReviewVroomDataSource:i.resourceKey},e}(),u=Object(a.r)("RequestReviewProvider",l)},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a="scenario=PointInTimeRestore";function i(e){var t;return e?(e.RequestFacts=a,e):((t={}).RequestFacts=a,t)}}],Array(61),[function(e,t,n){"use strict";var a=n(2107);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return f});var a=n(0),i=n(75),r=n(135),o=n(59),s=n(284),c=n(1903),d=n(3),l=n(840),u=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._vroomDataRequester=n.vroomDataRequestor,a._clientName=n.clientName,a}return Object(a.__extends)(t,e),t.prototype.getBaseUrl=function(){return i.n.wrap(void 0)},t.prototype.isLongPollingAllowed=function(){return!1},t.prototype.getDriveSubscription=function(){return this._vroomDataRequester.send(Object(a.__assign)({apiName:"socketIo",path:"/drive/root/subscriptions/socketIo",useAuthorizationHeaders:!0},Object(d.cs)(d.zi)?{headers:Object(a.__assign)({scenario:s.e.CheckForChanges,scenarioType:s.t.PassiveOperation},this._clientName?{Application:this._clientName}:{})}:{})).then(function(e){if(e){if(!e.token){var t=e.notificationUrl.indexOf("token=");if(-1===t)return;e.token=e.notificationUrl.substring(t+6)}if(-1===e.notificationUrl.indexOf("/callback")&&(e.serverUrl=e.notificationUrl),!e.serverUrl){var n=e.notificationUrl.indexOf("/callback");if(-1===n)return;e.serverUrl=e.notificationUrl.substring(0,n)}return e}})},t.prototype.getCurrentView=function(){return"ODC"},t.prototype.registerForViewUpdates=function(e){e()},t.prototype.getAuthDataReceivedTime=function(){return i.n.wrap(new Date)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.n.dependencies),{vroomDataRequestor:c.e,clientName:l.e.optional}),t}(o.n);t.default=u;var f=Object(r.r)("PushChannelDataSource",u)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return b});var a=n(0),i=n(2713),r=n(59),o=n(135),s=n(380),c=n(13),d=n(139),l=n(1827),u=n(2425),f=n(2533),p=n(1896),m=n(77),_=!n(8).e.isActivated("E435AB9B-59B2-49CC-9FBF-AC1039571D05","05/12/2022","Disable unnecessary resources for unuath users"),h=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._itemsStore=n.itemsStore,a._urlDataSource=n.urlDataSource,a._vaultDataSource=n.vaultDataSource,a._identityDataSource=n.identityDataSource,a._pushChannelProvider=n.pushChannelProvider,a._updateQuota=n.updateQuota,a._isOneDriveWinApp=Object(d.e)(),a}return Object(a.__extends)(t,e),t.prototype.isEnabled=function(){return Object(c.isFeatureEnabled)(c.EnablePushChannelAutoRefresh)&&this.isAuthValid()},t.prototype.isAuthValid=function(){return!_||this._identityDataSource.getIdentity().type!==s.e.anonymous},t.prototype.onGetChanges=function(e){},t.prototype.createSubscription=function(e,t,n){},t.prototype.onSubscriptionCreated=function(){},t.prototype.deleteSubscription=function(e){},t.prototype.getChangesHeaders=function(){var e;if(this._isOneDriveWinApp&&this._vaultDataSource.isVaultOpen().peek())return(e={}).Prefer="Include-Feature=Vault",e},t.prototype.parseChangesResponse=function(e){for(var t=[],n=!1,a=0,i=e.value;a<i.length;a++){var r=i[a];r.vault&&(n=!0),"!0"===r.id.substring(r.id.length-2)&&(r.id=this._urlDataSource.getDefaultRootItemId());var o=null;r.parentReference&&(o=r.parentReference.id)&&"!0"===o.substring(o.length-2)&&(o=this._urlDataSource.getDefaultRootItemId()),o||this._pushChannelProvider.log(u.n.ItemAutoRefreshDataSource,"Invalid parent resource id for item",r);var s=null;if(r.eTag&&"function"==typeof atob)try{s=atob(r.eTag.substr(1))}catch(e){this._pushChannelProvider.log(u.n.ItemAutoRefreshDataSource,"Failed to decode eTag for item",r)}t.push({deleted:!!r.deleted,id:r.id,eTag:s,parentId:o,dateModified:r.lastModifiedDateTime})}return n&&this._updateQuota(n),t},t.prototype.onMessage=function(e){var t,n,a=[],r=this._urlDataSource.getDefaultRootItemId();e.sort(function(e,t){return e.parentId===r?1:t.parentId===r?-1:0});for(var o=0;o<e.length;o++){var s=e[o];this._pushChannelProvider.log(u.n.ItemAutoRefreshDataSource,"onMessage",s);var c=this._urlDataSource.getKey(((t={}).id=s.id,t)),d=this._itemsStore.getItem(c);if(d){var l=d();if(this._pushChannelProvider.log(u.n.ItemAutoRefreshDataSource,"Changed Item",l),l.eTag===s.eTag||s.deleted&&""===l.eTag){for(var f=o+1;f<e.length;f++)if(e[f].id===s.parentId){this._pushChannelProvider.log(u.n.ItemAutoRefreshDataSource,"Removing parent to prevent a refresh"),e.splice(f,1);break}}else s.deleted?a.push({type:i.e.Remove,parentKey:l.parentKey,item:l}):a.push({type:i.e.Update,parentKey:l.parentKey,item:l})}else s.parentId&&(c=this._urlDataSource.getKey(((n={}).id=s.parentId,n)),a.push({type:i.e.Add,parentKey:c}))}return a},t.dependencies=Object(a.__assign)(Object(a.__assign)({},r.e.dependencies),{itemsStore:l.e,urlDataSource:m.Se,vaultDataSource:m.xe,pushChannelProvider:f.e,updateQuota:p.e,identityDataSource:m.D}),t}(r.e);t.default=h;var b=Object(o.r)("ItemAutoRefreshDataSource",h)},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return O});var a,i=n(0),r=n(59),o=n(75),s=n(73),c=n(303),d=n(62),l=n(47),u=n(7),f=n(135),p=n(1827),m=n(2367),_=n(2425),h=n(2733),b=n(2713),g=n(193),v=n(1903),y=n(77),S=n(1834),D=n(8),I=!D.e.isActivated("27D670CF-B951-418E-92D0-540976A234F4","05/20/2022","Disable the ItemInvalidator in ItemAutoRefreshProvider to prevent duplicative screen re-paints in ODC itemsscope/lightspeed"),x=12e4;!function(e){e[e.Connected=0]="Connected",e[e.SyncTokenRetrieved=1]="SyncTokenRetrieved",e[e.GetChangesFailed=2]="GetChangesFailed",e[e.CreatedSubscription=3]="CreatedSubscription",e[e.CreateSubscriptionFailed=4]="CreateSubscriptionFailed",e[e.SocketIoConnected=5]="SocketIoConnected",e[e.SocketIoDisconnected=6]="SocketIoDisconnected"}(a||(a={}));var C=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._totalRetries=0,a._delayTimeoutId=[],a._retryDelay=[],a._syncToken="latest",a._itemsStore=n.itemsStore,a._itemAutoRefreshDataSource=n.itemAutoRefreshDataSource,a._pushChannelProvider=n.pushChannelProvider,a._vroomDataRequester=n.vroomDataRequestor,a._refreshMessageHelper=n.refreshMessageHelper,a._resources=n.resources,a.initialize(),a}return Object(i.__extends)(t,e),t.prototype.initialize=function(){var e=this;this._itemAutoRefreshDataSource.isEnabled()?(this._notificationHandlerDebounce=this.async.debounce(function(){e._handleWebhookSubscriptionMessage()},1e4,{leading:!0,maxWait:1e4}),this._pushChannelProvider.setupNotificationHandler({source:_.t.WebhookSubscription},function(){e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"PushChannelMessageSource",_.t.WebhookSubscription),e._notificationHandlerDebounce()}),this._pushChannelProvider.setupNotificationHandler({source:_.t.EventHub},function(){e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"PushChannelMessageSource",_.t.EventHub),e._notificationHandlerDebounce()}),this._pushChannelProvider.addConnectedHandler(function(){var t=e._pushChannelProvider.getNotificationUrl();e._notificationUrl!==t&&(e._notificationUrl=t,e._reset()),e._nextState(a.Connected)})):this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Not enabled")},t.prototype._reset=function(){var e=this;if(this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Reset"),this._subscriptionId){var t=this._itemAutoRefreshDataSource.deleteSubscription(this._subscriptionId);t&&t.then(function(){e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"deleteSubscription")},function(t){e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"deleteSubscription failed",t)})}this._syncToken="latest",this._subscriptionId=void 0,this._clearDelayTimeout(1)},t.prototype._retrieveSyncToken=function(){var e=this;this._getChanges().then(function(){e._nextState(a.SyncTokenRetrieved)},function(t){e._logError("GetChangesFailed",t),e._delayNextState(a.GetChangesFailed)})},t.prototype._getDriveSubscriptionResubscribeDelay=function(e){var t=255001*Math.random()+15e3;return Date.parse(e.expirationDateTime)-Date.now()-t},t.prototype._createSubscription=function(){var e=this;this._pushChannelProvider.getDriveSubscription(!1).then(function(t){if(t.supportsSocketIoSubscription){if(t.socketIoSubscription){var n=e._getDriveSubscriptionResubscribeDelay(t.socketIoSubscription);return n>0?n:e._pushChannelProvider.getDriveSubscription(!0).then(function(t){if(void 0!==t.socketIoSubscription){var n=e._getDriveSubscriptionResubscribeDelay(t.socketIoSubscription);return!D.e.isActivated("C192A725-B55F-4CA9-8ED1-44B3403B9309","10/21/2021","Wait before SocketIO API call")&&n<0&&(n=x),n}})}}else{var a=e._pushChannelProvider.getNotificationUrl(),i=new Date(Date.now()+3e5),r=e._itemAutoRefreshDataSource.createSubscription(e._subscriptionId,a,i);if(r)return r.then(function(t){return e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"_onSubscriptionCreated",t),e._subscriptionId=t.id,295e3},function(t){e._subscriptionId=void 0,e._logError("CreateSubscriptionFailed",t)})}},function(t){e._logError("CreateSubscriptionFailed",t)}).then(function(t){void 0!==t?(e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"_onSubscriptionCreated"),e._retryDelay[0]=1e3,e._totalRetries=0,e._delayNextState(a.CreatedSubscription,t)):e._delayNextState(a.CreateSubscriptionFailed)})},t.prototype._getChanges=function(){var e=this,t=this._itemAutoRefreshDataSource.onGetChanges(this._syncToken);if(!t){if(this._syncToken&&"SPO_LIST,"===this._syncToken.substr(0,9))return o.n.wrap(void 0);t=this._vroomDataRequester.send({apiName:"viewDelta",path:"/drive/root/view.delta?token=".concat(c.e.encodeURIComponent(this._syncToken)),useAuthorizationHeaders:!0,headers:this._itemAutoRefreshDataSource.getChangesHeaders()})}return t.then(function(t){return e._syncToken=t?t["@delta.token"]:void 0,t})},t.prototype._handleWebhookSubscriptionMessage=function(){var e=this;if(this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"handleWebhookSubscriptionMessage"),this._itemAutoRefreshDataSource.isAuthValid()){var t={},n=new l.e({name:"PushChannel.WebhookSubscriptionMessage"});this._getChanges().then(function(a){if(a){e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Ran getChanges",a.value);var i=0,r=e._itemAutoRefreshDataSource.parseChangesResponse(a);if(r){for(var o=e._itemAutoRefreshDataSource.onMessage(r),s=[],c=0,d=o;c<d.length;c++){var u=d[c];e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"itemChange",b.e[u.type],u);var f=u.parentKey;-1===s.indexOf(f)&&(s.push(f),e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Invalidating item ".concat(f)),e._refreshMessageHelper.markRecentlyRefreshedItem(f),e._itemsStore.invalidateItem(f))}I||o.length>0&&e.resources.consume(S.n)&&e._resources.consumeAsync(y.k).then(function(t){e._itemsStore.invalidateAllPhotos(),t.invalidateCurrentItemSet()}),e._refreshMessageHelper.setRefreshMessages(r),i=s.length}t.itemsInvalidated=i.toString(),n.end({resultType:l.t.Success,extraData:t}),a["@odata.nextLink"]&&e._handleWebhookSubscriptionMessage()}},function(a){var i,r=!1;if(Object(g.r)(a)){switch(a.status){case 404:r=!0,e._syncToken="latest";break;case 410:r=!0;var o="latest",c=a.request.getResponseHeader("Location");if(c){var d=new s.t(c).getQueryParameter("token");d&&(o=decodeURIComponent(d))}e._syncToken=o;break;case 401:case 403:case 500:e._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Invalid token",e._itemAutoRefreshDataSource.isAuthValid())}i=JSON.stringify(Object(g.a)(a))}else i=JSON.stringify(a.message);n.end({resultType:l.t.Failure,error:i,extraData:t}),r&&e._delayRetry(1,function(){e._handleWebhookSubscriptionMessage()})})}},t.prototype._logError=function(e,t){var n;e="ItemAutoRefreshProvider.".concat(e),this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,e,t),Object(g.r)(t)&&(n=JSON.stringify(Object(g.a)(t))),d.e.log({message:n},e)},t.prototype._nextState=function(e){this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"nextState",(new Date).toLocaleString(),a[e]),this._clearDelayTimeout(0),this._pushChannelProvider.isConnected()?this._itemAutoRefreshDataSource.isAuthValid()?void 0===this._syncToken||"latest"===this._syncToken?this._retrieveSyncToken():this._createSubscription():this._delayNextState(e,5e3):this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"nextState","Not connected")},t.prototype._delayNextState=function(e,t){var n=this;if(this._incrementRetryCount(0,e)){var i=this._delayRetry(0,function(){return n._nextState(e)},t);this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,a[e],"delaying for ".concat(i,"ms"))}},t.prototype._delayRetry=function(e,t,n){var a=this;if(this._incrementRetryCount(e)){var i=n;return i||(void 0===(i=this._retryDelay[e])&&(i=this._retryDelay[e]=1e3),i<x&&(this._retryDelay[e]+=3001*Math.random()+2e3)),this._clearDelayTimeout(e),this._delayTimeoutId[e]=this.async.setTimeout(function(){a._delayTimeoutId[e]=void 0,t()},i),i}},t.prototype._clearDelayTimeout=function(e){void 0!==this._delayTimeoutId[e]&&(this.async.clearTimeout(this._delayTimeoutId[e]),this._delayTimeoutId[e]=void 0)},t.prototype._incrementRetryCount=function(e,t){return 1!==e&&t!==a.GetChangesFailed&&t!==a.CreateSubscriptionFailed||(this._totalRetries++,!(this._totalRetries>100))||(this._pushChannelProvider.log(_.n.ItemAutoRefreshProvider,"Exceeded max retry limit"),new l.e({name:"ItemAutoRefreshProvider.RetryLimitExceeded"}).end({resultType:l.t.Success}),!1)},t.dependencies={itemsStore:p.e,itemAutoRefreshDataSource:y.E,pushChannelProvider:h.resourceKey,vroomDataRequestor:v.e,refreshMessageHelper:m.e,resources:u.r,urlDataSource:y.Se},t}(r.e);t.default=C;var O=Object(f.r)("ItemAutoRefreshProvider",C)},,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(0),i=n(59),r=n(135),o=n(2425),s=n(2533),c=n(362),d=n(380),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a._pushChannelProvider=n.pushChannelProvider,a._identityDataSource.getIdentity().type!==d.e.anonymous&&(a._notificationHandlerDebounce=a.async.debounce(function(){a._handleWebhookSubscriptionMessage()},5e4,{leading:!0,maxWait:5e4}),a._pushChannelProvider.setupNotificationHandler({source:o.t.WebhookSubscription,scenarios:[o.e.ProfileChange]},function(){a._notificationHandlerDebounce()})),a}return Object(a.__extends)(t,e),t.prototype._handleWebhookSubscriptionMessage=function(){this._pushChannelProvider.log(o.n.PushChannelProvider,"handling profile change event"),this._identityDataSource.refreshAuthTicket()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{identityDataSource:c.e,pushChannelProvider:s.e}),t}(i.n);t.default=l;var u=Object(r.r)("ProfileChangeHandler",l,{identityDataSource:c.e,pushChannelProvider:s.e})}],Array(201),[function(e,t,n){"use strict";var a,i,r=n(0),o=n(4185),s=n(75),c=n(47),d=n(1122),l=n(405),u=n(813),f=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ExternalNavigate",n._item=t.item,n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank"),a=this._item.peek();return s.n.resolve(this.resources.consumeAsync(l.n)).then(function(e){var i;return(i=t._isOfficeItem()&&a.openUrl?a.openUrl:e.getItemUrl(a.key,{item:a}))?(n.location.href=i,{resultType:c.t.Success}):(n.close(),{resultType:c.t.Failure})})},t.prototype._isOfficeItem=function(){var e=this._item.peek(),t=e.extension&&e.extension.replace(/^\./,"");return t&&u.t[t]&&".pdf"!==e.extension},t}(d.e),p=n(3137),m=n(2153),_=n(43),h=n(10),b=n(1968),g=n(1822),v=n(808),y=n(3303),S=n(3),D=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="AddCoverPhotoAction",a._itemReedemer=a.resources.consume(m.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t=this,n=this._itemSelectionHelper.currentItem(),a=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==_.e.Search&&n.queryType!==_.e.SharedWithMe&&!a&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,y.e)})},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t.resources.consume(g.resourceKey),i=e[0].UNSAFE_parent;if(Object(S.cs)(S.yo)){var r=e[0],o=(null==r?void 0:r.parentKey)&&Object(h.S)(r.parentKey);n={key:e[0].parentKey,id:o.id}}return a.addCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:c.t.Success}})})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),I=n(2175),x=n(77),C=n(2071),O=n(2535),w=n(16),E=n(13),A=n(95),L=n(76),k=!w.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),M=!w.e.isActivated("12240148-D376-40BA-91CD-7D460F2D6DA2","04/18/2022","Disable AddToAlbumAction in vault since it is not working, because of access denied"),P=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToAlbum",n._panelProvider=n.resources.consume(C.e),n._urlDataSource=n.resources.consume(x.Se),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([5,"ondemand.resx-ondemand"],5196))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.onIsAvailable=function(){if(!Object(E.isFeatureEnabled)(E.EnableAddToAlbum)&&!0===Object(A.e)(L.l))return!1;var e=this.selectionHelper.firstItem(),t=null==e?void 0:e.vault;return!(M&&t)&&(!k||(null==e?void 0:e.ownerId)&&Object(h.B)(e.ownerId))&&this.itemCommandHelper.isCommandSupported(e,O.t)&&e.queryType!==_.e.RecycleBin},t}(I.e),T=n(1904),U=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToFolderAction",n._itemParentHelper=n.resources.consume(T.e),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([7,"ondemand.resx-ondemand"],4885))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault","root"));return!!t&&!t.vault.isLocked},t}(I.e),F=n(2850),H=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="ClearSelection";var i=a.resources;return a._urlDataSource=i.consume(x.Se),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper,t=this._urlDataSource,n=t.getKeyParams(e.currentItem().key),a=t.getQueryType(n);return e.selection().length>0&&!t.isRecycleBin(a)},t.prototype.onExecute=function(e,t){return this._itemSelectionHelper.clearSelection(),s.n.resolve({resultType:c.t.Success})},t}(d.e),R=n(2704),N=n(82),B=n(271),j=n(3762),V=n(26),z=n(302),G=n(1123),K=n(244),W=n(7),q=n(135),Q=n(2892),Y=n(139),J=new W.t({name:"".concat("CreateDocumentAction",".createItemOperator"),loader:new q.t(function(){return s.n.resolve(n.ee([214],4886)).then(function(e){return e.typeResourceKey})})}),X=function(e){function t(t){var n=e.call(this,t)||this;return n._isRunningTABTest=!1,n.docType=t.docType,n.templateUrl=t.templateUrl,n.name="Create"+(B.e[n.docType]||"")+"DocumentAction",n.navigation=n.resources.consume(N.e),n.itemProvider=n.resources.consume(g.resourceKey),n._dialogProvider=n.resources.consume(G.e),n.platformDetection=n.resources.consume(K.e),n.redirect=!0,n.openInNewTab=!1,n.askForFileName=n.docType===B.e.OneNote,n._isOneDriveWinApp=Object(Y.e)(),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(n._isRunningTABTest=!0),n}return Object(r.__extends)(t,e),t.prototype.createDocument=function(e,t){var n=this,a=this.navigation,i=this.itemProvider,r=null,o=i.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){return e&&(r=e),s.n.wrap({resultType:c.t.Success})});return o.done(function(e){r&&!window._isRunningTABTest&&n.async.setImmediate(function(){return a.navigateTo({url:r,frameId:n.openInNewTab?"_blank":null})})}),o},t.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad||this._isOneDriveWinApp)&&this.item().queryType===_.e.Files},t.prototype.isCommandSupported=function(){return!0},t.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():s.n.wrap({resultType:c.t.Success})},t.prototype.onExecuteCore=function(){if(!this._isCreatingFile){var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}},t.prototype.onCreateDocumentPromise=function(e,t,n){return null},t.prototype.createNewFile=function(e,t){var n=this;return s.n.resolve(this.resources.consumeAsync(J)).then(function(t){var a=new t({fileName:e,parentItem:n.item.peek()});return n.trackPromise(a.start())})},t.prototype._createDocumentWithDialog=function(e){var t=this,n=this._dialogProvider,a=this.observables.create(""),i=this.observables.create(""),r=this.observables.create(!1),o=this.observables.create(!0),s=null,d=Object(Q.t)(this.docType);this._isCreatingFile=!0;var l,u=function(e){return r(!0),o(!0),i(e),1},f=n.requestDialog({title:Object(Q.e)(this.docType,V),isDismissable:this.docType!==B.e.Text||Object(E.isFeatureEnabled)(E.CreateDocumentPromptSameTab),component:{name:j.e.tagName,params:{name:a,automationId:"createDocumentDialog",extension:d,status:i,hasError:r,isEnabled:o}},actions:[{name:V.CreateCommit,execute:function(){return i(V.Saving),o(!1),r(!1),n=t.docType===B.e.OneNote||t.docType===B.e.ExcelSurvey||t.docType===B.e.ExcelForm?a.peek():a.peek()+d,(c=t.onCreateDocumentPromise(t.docType,e,n))?c.then(function(e){return s=e,2},u):t.redirect?t.itemProvider.createDocument(e.key,t.docType,n,t.templateUrl).then(function(e){return s=e,2},u):t.createNewFile(n,e).then(function(){return 2},u);var n,c},isAvailable:this.observables.pureCompute(function(){return t._isCreateAvailable(o,a)}),isDefault:!0,icon:new z.e("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return Object(E.isFeatureEnabled)(E.CreateDocumentPromptSameTab)&&t.docType!==B.e.Text&&(l=window.open("",t._isRunningTABTest?"_self":"_blank")),{resultType:c.t.Success}},function(){return{resultType:c.t.ExpectedFailure}});return f.done(function(){if(t._isCreatingFile=!1,s)if(l)l.location.href=s;else{var e=t.navigation;t.async.setImmediate(function(){return e.navigateTo({url:s,frameId:t.openInNewTab?"_blank":null})})}}),f},t.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var n=t();return!!n&&" "!==n[0]},t}(R.e),Z=n(260),$=function(e){function t(t){var n=e.call(this,t)||this;return n._platform=n.resources.consume(K.e),n.formAction=t.formAction,n.canary=t.canary,n.target=t.target||(n._platform.isMobile?"":"_blank"),n}return Object(r.__extends)(t,e),t}(Z.t),ee=n(402),te=ee.e({tagName:"ms-create-doc-form",template:'<form class="CreateDocumentForm" id="create_form" name="create_form" method="post" data-bind="attr:{action:formAction,target:target}"><input name="canary" type="hidden" data-bind="value:canary"></form>',viewModel:$,synchronous:!0}),ne=n(3271),ae=n(362),ie=n(3304),re=n(2586),oe=n(3139),se=n(106),ce=n(1129),de=n(59),le=n(1903),ue=n(3490),fe=n(73),pe=n(377),me=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._vroomDataRequestor=n.vroomDataRequestor,a}return Object(r.__extends)(t,e),t.prototype.create=function(e,t,n,a){var i=this;return a?t===B.e.OneNote?this.getCreateUrl(e,t,!0).then(function(t){var a={name:n,folder:{},package:{type:"oneNote"},"@microsoft.graph.conflictBehavior":"fail"};return i._vroomDataRequestor.send({apiName:"createFolder",path:t,requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a),headers:{Prefer:"allow-zerobyte"}}).then(function(t){return i._invalidateItem(e),i._buildOpenUrl(t)},function(e){return s.n.reject(e.message)})}):this.getCreateUrl(e,t,!0).then(function(t){return i._vroomCreateDoc(t).then(function(t){return i._invalidateItem(e),i._setItemCache(t),i._buildOpenUrl(t)})}):this.getCreateUrl(e,t).then(function(e){return i._vroomCreateDoc(e).then(function(e){return e.webUrl})})},t.prototype.getCreateUrl=function(e,t,n){var a=this,i="@name.conflictBehavior=defaultName";if(n){var r=Object(E.isFeatureEnabled)(E.EnableItemCacheCreateDocument);return i=r?i+"&action=edit&$select=*,openWith,webDavUrl":i,t===B.e.OneNote?this.getGraphItemUrl(e,!1).then(function(e){return e+"/children"}):this.getGraphItemUrl(e,!0).then(function(e){return Object(E.isFeatureEnabled)(E.CreateODFDocumentViaVroom)&&Object(E.isFeatureEnabled)(E.EnableCreateODFDocument)?s.n.resolve(a.resources.consumeAsync(x.c)).then(function(n){return n.getDocumentExtension(t).then(function(t){return e+"/"+t+":/content?".concat(i)})}):e+"/"+Object(ue.e)(t)+":/content?".concat(i)})}return this.getGraphItemUrl(e,!0).then(function(e){return e+"/"+Object(ue.e)(t)+":/content?".concat(i)})},t.prototype.getGraphItemUrl=function(e,t){return s.n.resolve(this.resources.consumeAsync(x.y)).then(function(n){return n.getItemUrl(e,{isPath:t,useDirectEndpoint:!0})})},t.prototype._vroomCreateDoc=function(e){return this._vroomDataRequestor.send({apiName:"CreateDocument",path:e,requestType:"PUT",useAuthorizationHeaders:!0,headers:{Prefer:"allow-zerobyte"}})},t.prototype._invalidateItem=function(e){this.resources.consumeAsync(x.k).then(function(t){e.key&&t.invalidateItems(e.key)})},t.prototype._setItemCache=function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),Object(E.isFeatureEnabled)(E.EnableItemCacheCreateDocument)?[4,n.ee(63,5190)]:[3,2];case 1:t.sent().wacItemProvider.setItemCache(e,"createNew"),t.label=2;case 2:return[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}})})},t.prototype._buildOpenUrl=function(e){var t,n=e.id,a=null===(t=e.parentReference)||void 0===t?void 0:t.driveId,i=new fe.t(pe.o);return n&&i.setQueryParameter("resid",n,!0),a&&0===a.indexOf(pe.t)&&i.setQueryParameter("driveId".toLowerCase(),a,!0),i.setQueryParameter("nd","1",!0),i.toString()},t.dependencies=Object(r.__assign)(Object(r.__assign)({},de.n.dependencies),{vroomDataRequestor:le.e}),t}(de.n),_e=Object(q.r)("CreateDocumentDataSource",me,Object(r.__assign)(Object(r.__assign)({},de.n.dependencies),{vroomDataRequestor:le.e})),he=n(4311),be=n(1930),ge=n(140),ve=n(482),ye=n(695),Se=n(144),De=n(3491),Ie=n(36),xe=n(1912),Ce=n(423),Oe=n(8),we=!Oe.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),Ee=0,Ae=!1,Le=function(e){function t(t){var n=e.call(this,t)||this;return n._enableCreateDocumentForCOB=!1,n.c_pathLimitError="folderPathLimitExceeded",n.c_accessDeniedError="accessDenied",n.c_pathLengthErrorLearnMoreLink="https://support.office.com/article/0b10108f-8459-4a7a-b912-28f8adec5a81",n._identityDataSource=n.resources.consume(ae.e),n._itemDataSource=n.resources.consume(l.e),n._getHiddenDomProvider=n.resources.consume(ie.e.async.lazy),n._createDocumentDataSource=n.resources.consume(_e),n._forceRedeem=!n.resources.consume(se.A).isAuthenticated(),n._operationProvider=n.resources.consume(ce.resourceKey),n._itemCommandHelper=new(n.managed(b.e)),n._itemReedemer=n.resources.consume(m.e),n.askForFileName=!!t.autoInvokedItem,t.docType===B.e.Text&&(n.redirect=!1),n._itemCommandKey=n._getItemCommandKey(n.docType),n.docType===B.e.ExcelSurvey&&Object(E.isFeatureEnabled)(E.RedirectExcelSurveysToFormsV2)&&(n.name="CreateFormsSurveyDocumentAction"),Object(E.isFeatureEnabled)(E.CreateDocumentToVroom)&&(n._vroomDocTypes=[B.e.Word,B.e.Excel,B.e.PowerPoint]),n}return Object(r.__extends)(t,e),t.prototype.onCreateDocumentPromise=function(e,t,n){if(this._enableCreateDocumentForCOB&&Object(De.t)(e,!0)){if(Oe.e.isActivated("9744B736-537F-4A3E-9C11-B60273E2D1BA","07/01/2022","create onenote via vroom api")){var a=this._createDocumentForCOB(e,t,n);return s.n.resolve(null==a?void 0:a.toString())}return this._createDocumentDataSource.create(t,e,n,!0).then(function(e){return s.n.resolve(e)},function(e){return s.n.reject(e)})}return null},t.prototype.onIsAvailable=function(){var t=this.item();if(t&&t.vault&&t.vault.isLocked||!this._itemCommandKey)return!1;var n=this._itemCommandHelper.getCommandBehavior(t,this._itemCommandKey);return(we&&n?1===n:this._itemCommandHelper.isCommandSupported(t,this._itemCommandKey))&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(e,t){var n,i,r=this,o=this.item.peek();if(Ce.e&&!Ie.e.isAuthenticated()){var d=this.navigation;return d.navigateTo(xe.t.getAutoRedeemLoginUrl(o.id,o.ownerId,this.name,d)),s.n.resolve({resultType:c.t.Success})}this._checkCreateDocumentForCOB(o);var l=Object(E.isFeatureEnabled)(E.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);return Object(E.isFeatureEnabled)(E.UseItemsScopeInOneDrive)&&l&&!Ae&&!this._enableCreateDocumentForCOB?(this._isRunningTABTest?(n="_self",i=window.open("",n)):(n="newDocumentTab_".concat(Ee),i=window.open("",n),Ee++),this._itemDataSource.getItem({parentKey:o.key,startIndex:0,pageSize:0,skipInMemoryCache:!0}).then(function(o){var s;return a=null===(s=null==o?void 0:o.item)||void 0===s?void 0:s.documentFormat,Ae=!0,r._executeAction(e,t,n,a,i)}).catch(function(){return r._executeAction(e,t,n,a,i)})):this._executeAction(e,t,void 0,a)},t.prototype._executeAction=function(t,n,a,i,r){var o=this,d=this.item.peek(),l=1!==(i||(null==d?void 0:d.documentFormat))&&Object(E.isFeatureEnabled)(E.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);return!l||a||this._enableCreateDocumentForCOB||(r=window.open("",this._getTargetId())),this._itemReedemer.redeemItem(d,this,this._forceRedeem).then(function(){var i=o._itemDataSource;if(o.askForFileName)return e.prototype.onExecute.call(o,t,n);if(o.docType===B.e.OneNote||o.docType===B.e.Text||2===o._itemCommandHelper.getCommandBehavior(d,o._itemCommandKey)){if(Object(E.isFeatureEnabled)(E.CreateDocumentPromptSameTab))return o.askForFileName=!0,e.prototype.onExecute.call(o,t,n);var u=o.navigation,f=i.createDocumentInTab(o.docType,d,!0);return u.navigateTo({url:f,frameId:o._getTargetId()}),ne.t(d,o.resources),{resultType:c.t.Success}}if(o.docType===B.e.ExcelSurvey&&Object(E.isFeatureEnabled)(E.RedirectExcelSurveysToFormsV2)){u=o.navigation;var p=o._identityDataSource.getIdentity(),m="Action=Create&Host=ODC&Title="+encodeURIComponent(V.FormDefaultName),_="https://forms.office.com/Pages/DesignPage.aspx?Action=Create&auth_pvr=WindowsLiveId"+(p.email?"&auth_upn="+encodeURIComponent(p.email):"")+"&Fragment="+encodeURIComponent(m);return u.navigateTo({url:_,frameId:o._getTargetId()}),{resultType:c.t.Success}}if(o._enableCreateDocumentForCOB){if(!Oe.e.isActivated("45955574-DA27-457D-BF90-A452A8068680","09/05/2022","COB account use Vroom to create new file")&&Object(E.isFeatureEnabled)(E.CreateConvergenceViaVroom))return r=null!=r?r:window.open("",o._getTargetId()),o._createDocumentDataSource.create(d,o.docType,null,!0).then(function(e){return r.location.href=e,o._writePerfForWac(),{resultType:c.t.Success}}).catch(function(e){r.close();var t=Object(ue.e)(o.docType);return o._showError(e,d,t),{resultType:c.t.Failure}});var h=o._createDocumentForCOB(o.docType,d);return o.navigation.navigateTo({url:null==h?void 0:h.toString(),frameId:o._getTargetId()}),o._writePerfForWac(),{resultType:c.t.Success}}return l?o._createDocumentDataSource.create(d,o.docType).then(function(e){return r?r.location.href=e:o.navigation.navigateTo({url:e}),o._writePerfForWac(),ne.t(d,o.resources),{resultType:c.t.Success}}).catch(function(e){r&&r.close();var t=Object(ue.e)(o.docType);return o._showError(e,d,t),{resultType:c.t.Failure}}):o._getHiddenDomProvider().then(function(e){var t=i.createDocumentInTab(o.docType,d,!1),n=e.requestControl({name:te.tagName,params:{canary:FilesConfig.navCanary,formAction:t,resources:o.resources,target:a}});return o._writePerfForWac(),document.getElementById("create_form").submit(),e.disposeControl(n),ne.t(d,o.resources),s.n.wrap({resultType:c.t.Success})})})},t.prototype._showError=function(e,t,n){var a,i=this,r=this.observables;(a=this._operationProvider.register({iconName:ye.a({type:Se.e.File,extension:n}),name:"",type:ve.e.createItem,payloads:{uploadItems:{name:"New file",parent:t}},actions:{close:{isAvailable:r.create(!0),execute:function(){return a.actions().learnMore.isAvailable(!1),a.state(ge.e.canceled),s.n.wrap(null)}},learnMore:{isAvailable:r.create(!0),execute:function(){return window.open(i.c_pathLengthErrorLearnMoreLink,i._getTargetId()),s.n.wrap()}}}})).progress.maximum(1),a.progress.current(0);var o=a.actions().learnMore;switch(e.code){case this.c_pathLimitError:o.isAvailable(!0),a.error(new be.e({message:he.n}));break;case this.c_accessDeniedError:o.isAvailable(!1),a.error(new be.e({message:he.e}));break;default:o.isAvailable(!1),a.error(new be.e({message:he.t}))}a.state(ge.e.failed)},t.prototype._writePerfForWac=function(){try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}},t.prototype._getTargetId=function(){return this._isRunningTABTest?"_self":"_blank"},t.prototype._getItemCommandKey=function(e){var t;switch(e){case B.e.Word:t=re.i;break;case B.e.Excel:t=re.e;break;case B.e.PowerPoint:t=re.n;break;case B.e.ExcelSurvey:t=re.a;break;case B.e.OneNote:t=re.t;break;case B.e.Text:t=oe.t}return t},t.prototype._checkCreateDocumentForCOB=function(e){this._enableCreateDocumentForCOB=!Oe.e.isActivated("25D2DD67-8AD1-4CF3-9AB1-0662C8CB3588","3/24/2022","create new codument for COB")&&Object(E.isFeatureEnabled)(E.CreateConvergenceEnabled)&&Object(A.e)(e.ownerId)},t.prototype._createDocumentForCOB=function(e,t,n){var a,i;try{if(e===B.e.Visio)return null;var r="".concat(L.d,"/personal/").concat(null===(a=t.ownerId)||void 0===a?void 0:a.toUpperCase(),"/Documents"),o="".concat(r,"/_layouts/15/doc.aspx"),s=void 0;t.itemFromServer.sharepointIds&&(s=t.itemFromServer.sharepointIds.listItemUniqueId);var c=this._getDocAspxUrlForCOB(o,r+"/Documents",e,s),d=new fe.t(new fe.t(window.location.href).getStringWithoutQueryAndFragment()+"edit.aspx?"+c.getQuery(!0));return n&&d.setQueryParameter("fn",n,!0),e===B.e.OneNote&&d.setQueryParameter("progId","OneNote.Notebook",!0),d.setQueryParameter("cid",null===(i=t.ownerId)||void 0===i?void 0:i.toUpperCase(),!0),d}catch(e){return console.log(e),null}},t.prototype._getDocAspxUrlForCOB=function(e,t,n,a){var i=Object(De.e)(e,t,n,a,!0),r=new fe.t(i);return r.setQueryParameter("CT",(new Date).getTime().toString(),!0),r.setQueryParameter("OR","DocLib",!0),r},t}(X),ke=n(2396),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="CreateFolder",t}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([585,"ondemand.resx-ondemand"],4887))}},t.prototype.getSelectionOptions=function(){return{canFallback:!0}},t.prototype.getExecutorParameters=function(){var e=this;return this.selectionHelper.resolveFirst().then(function(t){return{actionName:e.name,item:t}})},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!(e&&e.vault&&e.vault.isLocked)&&e&&e.queryType===_.e.Files&&this.itemCommandHelper.isCommandSupported(e,ke.n)},t}(I.e),Pe=Me,Te=function(e){function t(n){var a=e.call(this,n)||this;return a.text=n.text,a.isLearnMoreVisible=n.isLearnMoreVisible,a.learnMoreText=V.CreateMountPointLearnMore,a.learnMoreUrl=t.LEARNMORE_URL,a}return Object(r.__extends)(t,e),t.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986",t}(Z.t),Ue=ee.e({tagName:"ms-create-mp",template:'<div class="CreateMountPoint"><span data-bind="text:text"></span>\x3c!--ko if:isLearnMoreVisible--\x3e&nbsp;<a data-bind="attr:{href:learnMoreUrl},text:learnMoreText"></a>\x3c!--/ko--\x3e</div>',viewModel:Te,synchronous:!0}),Fe=n(40),He=n(2397),Re=n(191),Ne=n(32),Be=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.isSingleSelectAction=!0,a.canFallbackToParent=!0,a.name="CreateMountPoint",a._actionMap=a.resources.consume(Ne.e),a._itemReedemer=a.resources.consume(m.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,He.e)},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t,n,a,i,o,d,l,u,f=this;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return e=this.resources.consume(G.e),[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=p.sent())?[4,this._itemReedemer.redeemItem(t,this)]:[2,{resultType:c.t.ExpectedFailure}];case 2:p.sent(),n=new(this.scope.attached(Re.e)),a=this.observables.create(!0),i=this.observables.create(!0),o=this.observables.create(V.CreateMountPointDetails),d=Fe.format(V.CreateMountPointTitle,t.name),l=function(){return Object(r.__awaiter)(f,void 0,s.n,function(){var e,n,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=this.resources.consume(g.resourceKey),a(!1),i(!1),o(V.CreateMountPointWait),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.createMountPoint({item:t})];case 2:return n=r.sent(),new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this.createObservable(n)}).execute(null),[2,2];case 3:return(s=r.sent()).data&&s.data.message?(o(s.data.message),[2,1]):[2,1];case 4:return[2]}})})},u=e.requestDialog({title:d,component:{name:Ue.tagName,params:{text:o,isLearnMoreVisible:a}},actions:[{name:V.CreateMountPointConfirm,execute:function(){return l()},isAvailable:a,isVisible:a,icon:new z.e("FabricFolderLink"),isDefault:!0},{name:V.Close,execute:function(){return s.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:n.attach(this.observables.pureCompute(function(){return!a()})),icon:new z.e("Cancel"),isDefault:!0}]}),p.label=3;case 3:return p.trys.push([3,,5,6]),[4,u.wait()];case 4:return p.sent(),this._itemSelectionHelper.clearSelection(),[3,6];case 5:return n.dispose(),[7];case 6:return[2,{resultType:c.t.Success}]}})})},t}(d.e),je=n(304),Ve=n(33),ze=n(1995),Ge=n(3006),Ke=n(1969),We=n(403),qe=new Ke.e("Open",Ke.t.intent),Qe=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="DefaultClick",a.isQosLogged=!1;var i=t.item,r=t.userInvokedItem,o=void 0!==r&&r,s=t.hideIfDefaultIsDownload,c=void 0!==s&&s,d=t.sourceEngagement,l=void 0===d?"":d,u=a,f=u.resources,p=u.observables;return f.expose(Ke.n,f.consume(Ke.n).withPart(qe)),a._itemSelectionHelper=new(a.child(v.e))({overrideItem:i,allowMultiSelect:!1,canFallback:!1}),a.item=a._itemSelectionHelper.firstItem,a.sourceEngagement=l,a.userInvokedItem=o,a.hideIfDefaultIsDownload=c,a.actionMap=f.consume(Ne.e),a.urlDataSource=f.consume(x.Se),a.viewParams=f.consume(Ne.T),a._isFilePickerPage=p.pureCompute(a._computeIsFilePickerPage),a._action=p.pureCompute(a._computeAction),a._action.equalityComparer=je.n,a._instrumentationProvider=f.consume(se.o),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()},t.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var a=this._instrumentationProvider;a&&n&&a.userClickItem(n);var i=t.peekUnwrap(this._action);return i&&i.execute(e)||s.n.resolve({resultType:c.t.ExpectedFailure})},t.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})},t.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===Ve.e.FilePicker},t.prototype._computeAction=function(){var e,t=this._lastAction;t&&(t.dispose(),this._lastAction=void 0);var n=this.item();return this._isFilePickerPage()&&n&&n.type!==Se.e.Folder||(e=this.onComputeAction()),this._lastAction=e,e},t.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var a;if(e)switch(e.type){case Se.e.File:a="FileOpen.".concat(n);break;case Se.e.Folder:a="FolderOpen.".concat(n);break;case Se.e.App:a="AppOpen.".concat(n);break;case Se.e.Subsite:a="SubsiteOpen.".concat(n);break;default:a="Open.".concat(n)}else a="Open.".concat(n);this.resources.consume(We.e).withPart(Ge.e).withPart(ze.e,{item:e}).logData({name:a,extraData:{action:t?t.type:"unknown"}})}},t}(d.e),Ye=n(4312),Je=n(1145),Xe=function(e){function t(){var t=e.call(this,{})||this;return t.name="ShowNotShared",t._dialogProvider=t.resources.consume(G.e),t}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:Ye.t,component:{name:Je.e.tagName,params:{text:Ye.e}},actions:[]}).wait().then(function(){return s.n.wrap({resultType:c.t.Success})})},t}(d.e),Ze=n(270),$e=n(3305),et=function(e){function t(t){var n=e.call(this,t)||this;return n._odcUrlDataSource=n.resources.consume(l.n),n._itemCommandHelper=new(n.managed(b.e)),n._defaultClickBehavior=n.createPureComputed(n._computeDefaultClickBehavior),n._isOneDriveWinApp=Object(Y.e)(),n._isOneDriveXboxApp=Object(Y.t)(),n._isPWA=n.resources.consume(K.e).isPWA,n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item(),n=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(t,$e.e);return e.prototype.onIsAvailable.call(this)&&!n},t.prototype.onComputeAction=function(){var t,n=this;switch(this._defaultClickBehavior()){case 1:t=e.prototype.onComputeAction.call(this);break;case 2:case 3:t=this._isOneDriveWinApp||this._isPWA?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 7:t=this._isOneDriveXboxApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 10:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 11:t=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=n._odcUrlDataSource.qualifyUrl(n._odcUrlDataSource.getDefaultClickUrl(n.item(),{action:Ze.t.defaultClick,viewParams:n.viewParams()}));return n._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 15:t=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 50:t=new(this.managed(Xe))}return t},t.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),$e.e)},t}(Qe),tt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Delete",n.logStartEnd=!0,n._currentItem=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DeleteExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([587,"ondemand.resx-ondemand"],4143))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this;return this._currentItem()&&this.selectionHelper.filterItems(function(t){var n=!!t.UNSAFE_parent&&t.UNSAFE_parent.isBundle,a=!!t.UNSAFE_parent&&t.UNSAFE_parent.isAlbum;return e.itemCommandHelper.isCommandSupported(t,ke.r)&&t.queryType!==_.e.SharedWithMe&&t.queryType!==_.e.DocsInCommon&&!n&&!a})},t}(I.e),nt=n(3853),at=n(1914),it=function(e){function t(t){var n=e.call(this,t)||this;return n.name="EditTagsAction",n._itemCommandHelper=new(n.managed(b.e)),n._currentItem=Oe.e.isActivated("5E6E4463-F472-41DE-9873-C1A437FCA008","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(Ne.r):n.selectionHelper.currentItem,n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EditTagsExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([14,"ondemand.resx-ondemand"],4888))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this;return(!Object(A.e)(L.l)||Object(E.isFeatureEnabled)(E.HideTaggingFeatures))&&this.selectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===at.e.Owner&&(!t.queryType||t.queryType!==_.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,O.i)})},t}(I.e),rt=n(2683),ot=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!0,canFallback:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(b.e)),n._currentItem=Object(E.isFeatureEnabled)(E.CurrentItemUsingItemSelectionHelper)?n._itemSelectionHelper.currentItem:n.resources.consume(Ne.r),n}return Object(r.__extends)(t,e),t.prototype.getParams=function(){return{actionName:"ShowTagsEditor",selectionHelper:this._itemSelectionHelper,currentItem:this._currentItem.peek()}},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){var e=this;return(!Object(A.e)(L.l)||Object(E.isFeatureEnabled)(E.HideTaggingFeatures))&&this._itemSelectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===at.e.Owner&&(!t.queryType||t.queryType!==_.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,O.i)})},t}(de.n),st=Object(rt.e)({name:"ShowTagsEditor",source:{moduleDefinition:{path:"./ShowTagsEditorExecutor",getModule:function(){return s.n.resolve(n.ee([15,"ondemand.resx-ondemand"],5197))}}},handlerType:ot}),ct=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Embed",n._isOneDriveXboxApp=Object(Y.t)(),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EmbedExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([16,"ondemand.resx-ondemand"],5170))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){if(!Object(E.isFeatureEnabled)(E.HideEmbedButton)&&!0===Object(A.e)(L.l))return!1;var e=this.selectionHelper.firstItem();return!this._isOneDriveXboxApp&&e&&this.itemCommandHelper.isCommandSupported(e,He.a)},t}(I.e),dt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="EmptyRecycleBin",n._urlDataSource=n.resources.consume(x.Se),n._strings=V,n._usePollGetItemsForDeletion=t.usePollGetItemsForDeletion,n._currentItem=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EmptyRecycleBinExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([593,"ondemand.resx-ondemand"],4889))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,ke.i)&&this._urlDataSource.isRecycleBin(t.queryType)&&t.childCount>0&&0===e.length},t.prototype.onExecute=function(t){var n=this;return this._usePollGetItemsForDeletion?e.prototype.onExecute.call(this,t):this.resources.consume(G.e).requestDialog({title:this._strings.emptyRecycleBin,component:{name:Je.e.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return s.n.wrap(2)},isAvailable:this.createObservable(!0),icon:new z.e("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return s.n.wrap(3)},isAvailable:this.createObservable(!0),icon:new z.e("Cancel"),isDefault:!0}]}).wait().then(function(){return e.prototype.onExecute.call(n,t)}).then(function(){return{resultType:c.t.Success}})},t}(I.e),lt=n(2891),ut=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.name="Feedback",a._executorLoader=new(a.managed(lt.e))({path:"./FeedbackExecutor",getModule:function(){return s.n.resolve(n.ee([17,"ondemand.resx-ondemand"],5171))},getExecutorParams:function(){return{}}}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t}(d.e),ft=n(4155),pt=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;a.name="NavigateToItem",a._urlDataSource=a.resources.consume(x.Se),a._viewParams=a.resources.consume(Ne.T);var i=t.item,r=t.itemSet,o=void 0===r?a.resources.consume(Ne.o.optional):r,s=t.parentItem,c=t.urlType,d=t.isRedirect,l=void 0!==d&&d,u=t.forceInSameWindow,f=void 0!==u&&u,p=t.shouldPreserveAction,m=void 0!==p&&p;a._itemSet=o,a._parentItem=s,a._urlType=a.wrapObservable(c),a._isRedirect=l,a._forceInSameWindow=a.wrapObservable(f),a._shouldPreserveAction=a.wrapObservable(m);var _=n.itemSelectionHelperType,h=void 0===_?a.resources.consume(v.e):_;a._itemSelectionHelper=new(a.scope.attached(h))({overrideItem:i,allowMultiSelect:!1,canFallback:!0}),a._url=a.createPureComputed(a._computeUrl),a._target=a.createPureComputed(a._computeTarget);var b=a.resources.consume(Ne.e);return a._navigationAction=new(a.managed(b.NavigationAction))({url:a._url,ignoreHistory:a._isRedirect,target:a._target}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return Object(E.isFeatureEnabled)(E.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(ze.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{urlType:this._urlType(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""},t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"},t}(d.e),mt=n(833),_t=n(3306),ht=n(3493),bt=n(490),gt=function(e){function t(t){var n=e.call(this,t)||this;return n._itemCommandHelper=new(n.managed(b.e)),n._skipVaultChecks=!!t.ignoreHistory,n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,$e.e)},t.prototype.onExecute=function(t,n){var a=this,i=this.item.peek();if(i&&i.vault&&!this._skipVaultChecks){var r=this.resources.consume(x.Se),o=this.resources.consume(Ne.T),s=r.getPageType(o.peek()),d=s===Ve.e.FilePicker||s===Ve.e.FolderPicker;if(i.vault.isLocked||d){var l=this.resources.consume(Ne.e);return new(this.managed(l.VaultAction))({actionType:bt.e.Unlock,item:this.item}).execute(null).then(function(i){if(i.resultType===c.t.Success)return e.prototype.onExecute.call(a,t,n)})}}return e.prototype.onExecute.call(this,t,n)},t}(ht.t),vt=n(128),yt=n(70),St=n(1199),Dt=!Oe.e.isActivated("A61307C5-CA5C-474C-99AB-E9F954A94351","06/06/2022","Hide preview button for loop powered files"),It=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var a=n.resources.consume(Ne.e);return n._dataStore=new vt.e("",yt.e.local),n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._openAction=new(n.managed(a.OpenAction))({urlType:n.observables.compute(n._computeUrlType),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0}),n._itemParentHelper=n.resources.consume(T.e),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=void 0;return e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"))),!(Dt&&this._isBFile()||!e||e.external||!this._openAction.isAvailable()||e.type===Se.e.OneNote||Object(St.i)()&&e.queryType===_.e.SharedWithMe||t&&t.list&&!t.list.isDocumentLibrary)},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();return!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date),this._openAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(ze.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrlType=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.queryType===_.e.Recent?"default":"focus"},t.prototype._isBFile=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=e.extension,n=e.properties,a=t?t.toLowerCase():"",i=n&&n.ProgId?n.ProgId:"";return".fluid"===a||".note"===a||".whiteboard"===a||".loop"===a||"Fluid."===i.substring(0,6)}return!1},t}(d.e),xt=n(159),Ct=n(3488),Ot=n(1679),wt=!Oe.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Et=((i={})[1]=Ct.e.Excel,i[2]=Ct.e.OneNote,i[3]=Ct.e.PowerPoint,i[4]=Ct.e.Word,i[5]=Ct.e.Visio,i[6]=Ct.e.Project,i[7]=Ct.e.Publisher,i),At=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenInOfficeClient",a._itemReedemer=a.resources.consume(m.e),a._navigation=a.resources.consume(N.e),a._platform=a.resources.consume(K.e),a._itemCommandHelper=new(a.managed(b.e)),a._urlDataSource=a.resources.consume(l.n),a._isOneDriveXboxApp=Object(Y.t)(),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();return(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)&&!this._isOneDriveXboxApp&&!!t&&this._itemCommandHelper.isCommandSupported(t,re.o)},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,n,a=this;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=i.sent())?(t.data.extraData||(t.data.extraData={}),n=e.extension?e.extension.toLowerCase():void 0,xt.e(t.data.extraData,{fileType:wt&&n?Object(Ot.e)(n):n}),[2,this._itemReedemer.redeemItem(e,this).then(function(){if(a._platform.isMobile){var t=a._navigation,n=a._urlDataSource;return t.navigateTo(n.getOpenInOfficeClientUrl(e,a._navigation.viewParams,xe.t.viewerId)),{resultType:c.t.Success}}var i=a._itemCommandHelper.getCommandBehavior(e,re.o),r=Et[i];return ne.e(e,xe.t.viewerId,!!e.isGroup,Ct.e[r],a.resources)})]):[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),Lt=n(2705),kt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var a=n,i=a.observables,r=a.resources;n._itemCommandHelper=r.consume(b.t),n._itemSelectionHelper=new(n.child(v.e))({overrideItem:t.item}),n._urlDataSource=r.consume(x.Se);var o=i.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),s=r.consume(Ne.e);return n._navigationAction=new(n.managed(s.NavigationAction))({url:o,target:"_blank"}),Object(Y.e)()&&(n._openInDesktopAction=new(n.managed(s.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:p.e.OpenPdfInBrowser})),n._pdfViewerHelper=t.pdfViewerHelper,n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&!!e&&Object(Lt.e)(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,ke.u)&&".pdf"===e.extension.toLowerCase()&&(!this._pdfViewerHelper||!this._pdfViewerHelper.isPdfEditAvailable(e))},t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(ze.e,{item:this._itemSelectionHelper.firstItem})},t}(d.e),Mt=n(2787),Pt=n(2018),Tt=!Oe.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Ut=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return!!e&&(e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,re.s))&&e.queryType!==_.e.RecycleBin},t.prototype.onExecute=function(t,n){var a,i=this.item.peek();if(i.queryType!==_.e.Search){var r=void 0;this.resources.consume(Pt.e)()&&(r={key:null==i?void 0:i.parentKey}),ne.t((null===(a=null==i?void 0:i.UNSAFE_parent)||void 0===a?void 0:a.isStub)?i:i.UNSAFE_parent||r,this.resources,!0)}n.data.extraData||(n.data.extraData={});var o=i.extension?i.extension.toLowerCase():void 0;xt.e(n.data.extraData,{fileType:Tt&&o?Object(Ot.e)(o):o});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return e.prototype.onExecute.call(this,t,n)},t}(Mt.e),Ft=n(335),Ht=n(379),Rt=n(2788),Nt=n(2894),Bt=w.e.isActivated("995DA390-4F3E-4CA5-A276-9DAB53FEE8A8","10/21/2022","Enables the openInTextEditor Command for html files"),jt=w.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),Vt=w.e.isActivated("BB09B7DC-B8E9-4FA4-B25F-306EBCBE147A","04/18/2023","Allows the Command to appear in SWM"),zt=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInTextEditor";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(x.Se):r,s=n.viewParams,c=void 0===s?i.consume(Ne.T):s,d=n.itemCommandHelper,l=void 0===d?i.consume(b.t):d,u=n.platformDetection,f=void 0===u?i.consume(K.e):u,p=n.actionMap,m=void 0===p?i.consume(Ne.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(v.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a._isOneDriveWinApp=Object(Y.e)(),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(!this._availableForHtml(e))return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),a=this._urlDataSource.getQueryType(n),i=w.e.isActivated("35BD4D5C-F09B-4F80-BBFD-1080AFB2EBC1","11/10/2021","Use item.parentKey as fallback since item.UNSAFE_parent will not be set in ItemsScope pivots")?!!e.UNSAFE_parent||Object(S.cs)(S.jo)&&!!e.parentKey:!!e.UNSAFE_parent||!!e.parentKey;return this._itemCommandHelper.isCommandSupported(e,ke.l)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&i&&Object(Ht.a)(e.extension,e.type)&&(!Vt||a!==_.e.SharedWithMe)&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(a)&&e.itemStatus!==Ft.t.ConditionalAccessViewOnly&&e.itemStatus!==Ft.t.ConditionalAccessBlocked},t.prototype.onExecute=function(e){var t=this;return jt?this._navigationAction.execute(e):new s.n(function(n){setTimeout(function(){Nt.e.alert("OpenInTextEditor",V.OpenInTextEditorAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(ze.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._availableForHtml(e)?this._urlDataSource.saveViewerType("TextFile"):{};return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t.prototype._availableForHtml=function(e){var t=e&&e.htmlConversion&&Object(S.cs)(E.UseSandboxHtmlViewer)&&(Object(Rt.e)()||this._platformDetection.isEdge),n="TextFile"===this._urlDataSource.getViewerType(this._viewParams());return t&&!n&&!Bt},t}(d.e),Gt=w.e.isActivated("17DB17D7-FC3F-4243-B2CE-A54D5E531404","10/27/2022","Enable OpenInHtmlViewer Action"),Kt=w.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),Wt=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInHtmlViewer";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(x.Se):r,s=n.viewParams,c=void 0===s?i.consume(Ne.T):s,d=n.itemCommandHelper,l=void 0===d?i.consume(b.t):d,u=n.platformDetection,f=void 0===u?i.consume(K.e):u,p=n.actionMap,m=void 0===p?i.consume(Ne.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(v.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;var t=e&&e.htmlConversion&&Object(S.cs)(E.UseSandboxHtmlViewer)&&(Object(Rt.e)()||this._platformDetection.isEdge),n="TextFile"!==this._urlDataSource.getViewerType(this._viewParams());return this._itemCommandHelper.isCommandSupported(e,ke.c)&&t&&!n&&!Gt},t.prototype.onExecute=function(e){var t=this;return Kt?this._navigationAction.execute(e):new s.n(function(n){setTimeout(function(){Nt.e.alert("OpenInHTMLViewer",V.OpenInHtmlViewerAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(ze.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._urlDataSource.saveViewerType("Html");return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t}(d.e),qt=n(380),Qt=n(489),Yt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OrderPrints",n._platformDetection=n.resources.consume(K.e),n._identity=n.resources.consume(x.D).getIdentity(),n._isOneDriveXboxApp=Object(Y.t)(),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./OrderPrintsExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([42,"ondemand.resx-ondemand"],5181))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.onIsAvailable=function(){if(!Object(E.isFeatureEnabled)(E.EnableOrderPrints))return!1;if(this._identity.type===qt.e.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,n=e&&e.queryType,a=n===_.e.Files||n===_.e.Photos||Object(Qt.e)(n)||n===_.e.AllMyPhotos||n===_.e.SharedWithMe;return!(!t||!a||this._isOneDriveXboxApp)&&this._identity.type!==qt.e.aad&&e.photo&&t>=1&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac},t}(I.e),Jt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PlayAudio";var a=n.resources.consume(Ne.e),i=n.observables;n._item=new(n.child(v.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}).firstItem;var r=new(n.managed(a.OpenAction))({urlType:i.pureCompute(n._computeUrlType),item:t.item,nonFoldersOnly:!0});return n._action=r,n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()},t.prototype.onExecute=function(e,t){return this._action.execute(e)},t.prototype._computeUrlType=function(){var e=this._item();return e&&e.queryType===_.e.Recent?"default":"focus"},t}(d.e),Xt=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="PlaySlideShow",a._slideshowState=a.resources.consume(Ne.k),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t,n=this._itemSelectionHelper.firstItem(),a=!(!Object(E.isFeatureEnabled)(E.EnableLivePhotoVideos)||!(null===(e=null==n?void 0:n.photo)||void 0===e?void 0:e.isLivePhoto)),i=!(!Object(E.isFeatureEnabled)(E.EnableSamsungMotionPhotoVideos)||!(null===(t=null==n?void 0:n.photo)||void 0===t?void 0:t.isSamsungMotionPhoto));return!(!n||!n.photo||a||i||this._slideshowState.isSlideShowModeEnabled())},t.prototype.onExecute=function(e,t){return this._slideshowState.isSlideShowModeEnabled(!0),this._slideshowState.enterSlideshowMode()?s.n.resolve({resultType:c.t.Success}):s.n.resolve({resultType:c.t.Failure})},t}(d.e),Zt=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="StopSlideShow",a._slideshowState=a.resources.consume(Ne.k),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._itemSelectionHelper.firstItem()&&this._slideshowState.isSlideShowModeEnabled()},t.prototype.onExecute=function(e,t){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?s.n.resolve({resultType:c.t.Success}):s.n.resolve({resultType:c.t.Failure})},t}(d.e),$t=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveCoverPhotoAction",a._itemReedemer=a.resources.consume(m.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t=this,n=this._itemSelectionHelper.currentItem(),a=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==_.e.SharedWithMe&&!a&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,y.t)})},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t.resources.consume(g.resourceKey),i=e[0].UNSAFE_parent;if(Object(S.cs)(S.yo)){var r=e[0],o=(null==r?void 0:r.parentKey)&&Object(h.S)(r.parentKey);n={key:e[0].parentKey,id:o.id}}return a.removeCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:c.t.Success}})})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),en=n(3307),tn=n(251),nn=n(554),an=function(e){function t(t,n){var a=e.call(this,t)||this;a._dataSource=n.mruRecentDataSource,a._itemProvider=n.itemProvider;var i=n.location,r=void 0===i?window.location:i;return a._origin=new tn.e(r.href).authority,a}return Object(r.__extends)(t,e),t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)},t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()},t.prototype.removeFromRecent=function(e){var t=this;return Object(E.isFeatureEnabled)(E.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){return t._itemProvider.invalidateItem(e.parentKey),n}):this._itemProvider.removeFromRecent(e)},t.prototype.recordDocumentView=function(e){var t=e.graph,n=new tn.e(e.openUrl),a="".concat(n.authority||this._origin).concat(n.path),i=e.sharingType,o=e.dateCreatedTime,s=e.dateModifiedTime,c=e.mruState,d=e.properties,l=void 0===d?{}:d,u=l.editorName,f=void 0===u?[]:u,p=l.creatorName,m=void 0===p?[]:p,_=c&&c.mruId,h=f[0],b=m[0],g=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({category:"Document",type:"DocumentUrl",app:rn(e),url:a},function(e){var t=e.name,n=e.extension,a=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp(".".concat(a,"$")),""):t),extension:a}}(e)),{file_size:e.size}),_?{mru_id:_}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.UNSAFE_parent&&e.UNSAFE_parent.graph&&e.UNSAFE_parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId}),{sharing_info:{state:"number"==typeof i&&i<nn.e.Private?1:0},modification_info:on(h,s),creation_info:on(b,o)});return this._dataSource.recordDocumentView(e,g)},t.dependencies=Object(r.__assign)(Object(r.__assign)({},de.n.dependencies),{itemProvider:g.resourceKey,mruRecentDataSource:x.B}),t}(de.n);function rn(e){return Object(en.t)(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function on(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}var sn=Object(q.r)("MruRecentProvider",an),cn=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromRecent",a._urlDataSource=a.resources.consume(x.Se),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!Object(E.isFeatureEnabled)(E.MruToMruPlusPlusSkyApi),canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this._itemSelectionHelper.currentItem().key),t=this._urlDataSource.getQueryType(e),n=this._itemSelectionHelper.firstItem();return t===_.e.Recent&&!!n&&this._itemCommandHelper.isCommandSupported(n,y.n)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem.peek();return this._itemSelectionHelper.resolveSelection().then(function(e){return n._itemSelectionHelper.clearSelection(),n.resources.consumeAsync(sn).then(function(t){return t.removeFromRecent({parentKey:a.key,items:e})})}).then(function(){return{resultType:c.t.Success}})},t}(d.e),dn=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveTag",a._tag=t.tag,a._itemReedemer=a.resources.consume(m.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSet=a.resources.consume(Ne.o.optional),a._tagProvider=a.resources.consume(se.C),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this;return(!Object(A.e)(L.l)||Object(E.isFeatureEnabled)(E.HideTaggingFeatures)||"objectdetectors"===this._tag().source)&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,O.c)})},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t._tag.peek(),i=t.resources.consume(se.f).getAllPhotosSettings().peek(),r=t._itemSet&&(null===(n=t._itemSet.peek())||void 0===n?void 0:n.key);return t._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[a],parentKey:r,rootItemId:i.rootId}).then(function(){return{resultType:c.t.Success}})})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),ln=function(e){function t(t){var n=e.call(this,t)||this;return n.name="Rename",n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RenameExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([609],5250))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,ke.f)},t}(I.e),un=new W.t({name:"".concat("RestoreAction",".restoreItemsOperator"),loader:new q.t(function(){return s.n.resolve(n.ee([50],4890)).then(function(e){return e.typeResourceKey})})}),fn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(x.Se),n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(b.e)),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(n))&&this._itemCommandHelper.isCommandSupported(e,ke.m)},t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t.resources.consumeAsync(un).then(function(a){var i=new a({parentKey:n,items:e});return t.trackPromise(i.start()),i.wait()})}).then(function(){return{resultType:c.t.Success}})},t}(d.e),pn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RestoreAll",n._itemCommandHelper=new(n.managed(b.e)),n._currentItem=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RestoreAllExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([49],4891))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&t.childCount>0&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,ke.p)},t}(I.e),mn=n(1869),_n=new W.t({name:"RotateAction",loader:new q.t(function(){return s.n.resolve(n.ee([51],4892)).then(function(e){return e.typeResourceKey})})}),hn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(b.e)),n._itemRedeemer=n.resources.consume(m.e),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Object(E.isFeatureEnabled)(E.EnableRotatePhotoInCob)&&Object(A.e)(L.l))return!1;var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,O.d)},t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemRedeemer.redeemItems(e,t).then(function(){return s.n.resolve(t.resources.consumeAsync(_n))}).then(function(a){var i=new a({items:e,parentKey:n,rotation:mn.e.right});return t.trackPromise(i.start())})}).then(function(){return{resultType:c.t.Success}})},t}(d.e),bn=n(3492),gn=n(3301),vn=n(291),yn=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SaveSort",n._item=n.resources.consume(Ne.r),n._currentItemSet=n.resources.consume(Ne.o),n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=bn.e.getSortedColumn(this._currentItemSet().schema);if(!n)return s.n.wrapError({resultType:c.t.Failure});var a=n.isAscending,i=gn.e[n.internalName||n.key].toString(),r=null===a?vn.e.defaultValue.toString():a?vn.e.ascending.toString():vn.e.descending.toString();return this.resources.consume(g.resourceKey).saveSortOrder({sortOrder:i,sortDirection:r,item:this._item()}).then(function(){return{resultType:c.t.Success}})},t.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return!(e&&e.vault&&e.vault.isLocked||t!==_.e.Files&&t!==_.e.Photos)},t}(d.e),Sn=n(263),Dn=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetFocus",n._selector=t.selector,n._shouldClick=t.shouldClick,n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);return n&&(n.focus(),this._shouldClick&&Sn.e.clickElement(n)),s.n.wrap({resultType:c.t.Success})},t}(R.e),In=function(e){function t(t){var n=e.call(this,t)||this;return n.sharingMethod=t&&t.sharingMethod?t.sharingMethod:null,n._alreadyRedeemed=t&&t.alreadyRedeemed?t.alreadyRedeemed:null,n.name="ShareByLink",n._urlDataSource=n.resources.consume(x.Se),n._itemCommandHelper=new(n.managed(b.e)),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,n=t>1&&e.queryType===_.e.SharedWithMe&&e.isRootFolder,a=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return(this._itemCommandHelper.isCommandSupported(e,He.c)||e.vault)&&!n&&!a&&!i&&this._allItemsSupportShare()},t.prototype.getExecutorPath=function(){return"./ShareByLinkExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([612,"ondemand.resx-ondemand"],5113))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}},t.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a){var i=a();if(!i)return!0;if(!this._itemCommandHelper.isCommandSupported(i,He.c)&&(!i.vault||i.vault.isLocked))return!1}}return!0},t}(I.e),xn=function(e){function t(t){var a=e.call(this,t)||this;return a.name="ShowKeymap",a._executorLoader=new(a.managed(lt.e))({path:"./ShowKeyboardMapExecutor",getModule:function(){return s.n.resolve(n.ee([56,"ondemand.resx-ondemand"],5198))},getExecutorParams:function(){return{}}}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t}(d.e),Cn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._operationProvider=n.resources.consume(ce.resourceKey),n.state=n.createPureComputed(n._computeState),n}return Object(r.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==ge.e.expired,isToggled:this._operationProvider.isLocked()}},t}(de.n),On=Object(rt.e)({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return s.n.resolve(n.ee([57,"ondemand.resx-ondemand"],5251))}}},handlerType:Cn}),wn=(n(2895),function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(b.t),n.engagementSource=t.engagementSource,n}return Object(r.__extends)(t,e),t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this._itemCommandHelper.isCommandSupported(e,He.c),n=e&&e.remoteItem;return{isAvailable:!!e&&t&&!n}},t}(de.n)),En=Object(rt.e)({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return s.n.resolve(n.ee([58,"ondemand.resx-ondemand"],5182))}}},handlerType:wn}),An=n(17);Object(An.n)([{rawString:".od-SuggestedFiles-titleBar{padding-bottom:8px}.od-SuggestedFiles-head{font-size:20px;font-weight:600}.od-SuggestedFiles-description{padding:4px 0 12px;font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}"}]);var Ln=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n}return Object(r.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:!0}},t}(de.n),kn=Object(rt.e)({name:"ShowSuggestedFiles",source:{moduleDefinition:{path:"./ShowSuggestedFilesExecutor",getModule:function(){return s.n.resolve(n.ee([59,"ondemand.resx-ondemand"],5199))}}},handlerType:Ln}),Mn=n(3854),Pn=n(1892),Tn=n(2493),Un=n(2648),Fn=n(1829),Hn=n(102),Rn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="ShowCopilot",t}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){try{var n=this.resources.consume(Un.e);return n(!n()),this.resources.consume(Tn.e)(!1),this.resources.consume(Pn.resourceKey)(!1),this.resources.consume(Fn.e.columnCustomizationPane.isColumnCustomizationPaneExpanded)(!1),Hn.t.raise(document.body,"resize",void 0,!0),s.n.wrap({resultType:c.t.Success})}catch(e){return s.n.wrap({resultType:c.t.Failure})}},t.prototype.onIsAvailable=function(){return Object(S.cs)(S.xr)},t.prototype.onIsToggled=function(){return!1},t}(d.e),Nn=Rn,Bn=n(1897),jn=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ShowSelection",a._urlDataSource=a.resources.consume(x.Se),a._isSelectionModal=a.resources.consume(Bn.n),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return(this._itemSelectionHelper.selection().length>0||this._isSelectionModal())&&this._urlDataSource.getPageType()!==Ve.e.TextFileEditor},t.prototype.onExecute=function(e,t){return this._itemSelectionHelper.clearSelection(),this._isSelectionModal(!1),s.n.resolve({resultType:c.t.Success})},t}(d.e),Vn=n(3855),zn=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ViewOriginal",n._itemCommandHelper=new(n.managed(b.e)),n._selectionHelper=new(n.child(v.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),n._url=n.observables.pureCompute(function(){var e=n._selectionHelper.firstItem(),t=e&&e.photo&&e.photo.originalUrl;return t&&t.replace(/#/g,"%23")}),n._navigationAction=new(n.managed(mt.e))({url:n._url,target:"_blank"}),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,O.l)},t.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):s.n.reject({})},t}(d.e),Gn=n(2111),Kn=n(242),Wn=n(2038),qn=n(3308),Qn=n(3140),Yn=function(e){function t(t){var n=e.call(this,t)||this;return n.logStartEnd=!0,n.name="Upload."+Gn.e[n.uploadProcessorType],n._itemRedeemer=n.resources.consume(m.e),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var t=this.item();return e.prototype.onIsAvailable.call(this)&&t.type===Se.e.Folder},t.prototype.onExecute=function(t,n){var a=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return e.prototype.onExecute.call(a,t,n)})},t.prototype._isPlatformSupported=function(){var e=!1,t=this.platform.isIPad&&this.platform.browserMajor<6;if(this.platform.isWinAppWipEnabled)return!1;if(!t)switch(this.uploadProcessorType){case Gn.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Gn.e.Folder:e=this.platform.isFolderUploadSupported}return e},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.name="Upload",n.platform=n.resources.consume(K.e),n.uploadProcessorType=t.uploadProcessorType,n._resetInputElement(),n.addDisposable({dispose:function(){n._inputElement&&(document.body.removeChild(n._inputElement),n._inputElement=void 0)}}),n.itemCommandHelper=n.resources.consume(b.t),n.skipInvalidation=!1,n._currentItemSet=n.resources.consume(Ne.o.optional),n._createUploadObserver=t.createUploadObserver,n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){this.resources.consume(We.e).logData({name:"Upload.TopMenu.Click",isIntentional:!0});var n=new Kn.e;return window.sessionStorage.getItem("_isRunningTABTest")||this._clickHiddenInput(n),n.getPromise()},t.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this.itemCommandHelper.isCommandSupported(t,oe.t))return!1;switch(this.uploadProcessorType){case Gn.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Gn.e.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===_.e.Files},t.prototype._resetInputElement=function(){var e=this;this._inputElement&&document.body.removeChild(this._inputElement);var t=document.createElement("input");this._inputElement=t,t.style.display="none",t.type="file";var n="commandFileInput";this.uploadProcessorType===Gn.e.Folder&&(n="commandFolderInput",t.webkitdirectory=!0),t.className=n,t.multiple=!0,t.onchange=function(n){e._uploadFiles(t).done(function(){e._resetInputElement()})},document.body.appendChild(t)},t.prototype._clickHiddenInput=function(e){var t=this,n=this._inputElement;n.onchange=function(a){t._uploadFiles(n).then(function(t){e.complete(t)},function(t){e.error(t)}).then(function(){t._resetInputElement()})},n.click()},t.prototype._uploadFiles=function(e){var t=this,n=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);if(n){var a=this._createUploadObserver&&this._createUploadObserver(),i=w.e.isActivated("5C4BC63E-54D5-4F24-8333-E6905633B445","9/4/2020","Wait for KO item to resolve before upload")?void 0:a&&a.resolveParentItem();return s.n.resolve(i).then(function(){return s.n.resolve(t.resources.consumeAsync(Wn.e))}).then(function(e){var i=new e({files:n,parentItem:t.item.peek(),wasDragAndDropped:!1,type:t.uploadProcessorType,itemSet:t._currentItemSet&&t._currentItemSet.peek(),skipInvalidation:t.skipInvalidation,isTemplate:t.isTemplate,onItemUploaded:function(e){a&&a.onItemUploaded(e),t.resources.consume(qn.e)(e)}});return i.start(),i.wait()}).then(function(){return a&&a.onUploadCompleted(),Object(Qn.e)(t.resources,"uploadAction"),{resultType:c.t.Success}},function(e){return a&&a.onUploadCompleted(),s.n.reject(e)})}return s.n.wrap({resultType:c.t.ExpectedFailure})},t}(R.e)),Jn=n(25),Xn="caption",Zn={scenario:"updateDescription"},$n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._itemCommandHelper=new(t.managed(b.e)),t}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,O.a)&&!(t.vault&&t.vault.root&&t.vault.isLocked)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.name="UpdateCaption",n.caption=t.caption,n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a,i,r,o;if(!Object(E.isFeatureEnabled)(E.UseVroomUpdateCaption))return this.resources.consume(g.resourceKey).updateItemProperty({item:this.item(),propertyName:Xn,propertyValue:this.caption(),overrideLock:!0,qosPostfix:Xn}).then(function(){return{resultType:c.t.Success}});var d=this.resources.consume(le.e),l=((n={}).description=this.caption(),n),u=this.item();if(!(null===(a=u.graph)||void 0===a?void 0:a.itemId))return s.n.wrapError(new Error("invalid itemId"));var f="".concat(Object(Jn.f)({apiVersion:"v2.1",driveId:(null===(i=u.graph)||void 0===i?void 0:i.driveId)||"me"}),"/drives/").concat((null===(r=u.graph)||void 0===r?void 0:r.driveId)||"me","/items/").concat(null===(o=u.graph)||void 0===o?void 0:o.itemId);d.send({apiName:"updateItem_".concat("description").concat(Object(A.e)(h.W)?".migratedUser":""),path:f,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(l),headers:Zn}).then(function(){return{resultType:c.t.Success}})},t.prototype.onIsAvailable=function(){if(Object(E.isFeatureEnabled)(E.EnableSamsungMotionPhotoVideos)){var e=this.item();return!(e&&e.photo&&e.photo.isSamsungMotionPhoto)}return!0},t}(R.e)),ea=$n;Object(An.n)([{rawString:"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var ta=n(27),na=n(2011),aa=n(2110),ia=n(3856),ra=n(2109),oa=n(1901),sa=function(e){function t(t){var n=e.call(this,t)||this;return n.loadingSpinnerTagName=oa.e.tagName,n._item=t.item,n.previewSrc=t.previewSrc,n.isLoading=ta.observable(!0),n.sharingLink=ta.observable(null),n.hasError=ta.observable(!1),n.instructionsText=ia.i,n.createText=ia.e,n.removeText=ia.r,n.loadingText=ia.a,n.errorText=ia.n,n._sharingProvider=n.resources.consume(na.resourceKey),n._getSharingInfo(),n.addBindingHandlers({selectOnFocus:aa.e}),n}return Object(r.__extends)(t,e),t.prototype.onCreateClicked=function(){var e=this;this.isLoading(!0);var t={type:ra.e.Form,role:at.e.Submitter,create:!0};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e._getSharingInfo()},function(t){e.isLoading(!1),e.hasError(!0)})},t.prototype.onRemoveClicked=function(){var e=this;this.isLoading(!0);var t={id:this.sharingLink().id,type:ra.e.Form,role:at.e.None,create:!1};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e.isLoading(!1),e.sharingLink(null)},function(t){e.isLoading(!1),e.hasError(!0)})},t.prototype._getSharingInfo=function(){var e=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(t){if(e.isLoading(!1),t)for(var n=0,a=t;n<a.length;n++){var i=a[n];i.type===ra.e.Form&&e.sharingLink(i)}})},t}(Z.t),ca=ee.e({tagName:"od-share-survey",template:'<div class="ShareSurvey"><div class="od-sharesurvey-preview"><img data-bind="attr:{src:previewSrc}"></div><div class="od-sharesurvey-details">\x3c!--ko if:isLoading--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:loadingText}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<span class="od-sharesurvey-instructions" data-bind="text:instructionsText"></span>\x3c!--ko if:!sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click:onCreateClicked"><span class="od-Button-label" data-bind="text:createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:sharingLink()--\x3e<input type="text" class="od-sharesurvey-textbox" readonly data-bind="attr:{value:sharingLink().url},selectOnFocus:{isPermanent:true}"><br><button class="od-Button" data-bind="click:onRemoveClicked"><span class="od-Button-label" data-bind="text:removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if:hasError()--\x3e<span class="od-sharesurvey-error" data-bind="text:errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="ms-clearfix"></div></div>',viewModel:sa,synchronous:!0}),da=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="Survey",a._actionType=t.actionType,a._navigation=a.resources.consume(N.e),a._dialogProvider=a.resources.consume(G.e),a._itemCommandHelper=new(a.managed(b.e)),a._urlDataSource=a.resources.consume(l.n),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this,t=this._getCommandKey();return this._itemSelectionHelper.filterItems(function(n){return e._itemCommandHelper.isCommandSupported(n,t)})},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var t,n,a,i,o,d,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=r.sent())?1===this._actionType?[2,this.showShareDialog(t)]:(n=this._navigation,a=this._urlDataSource.getAuthKeyParamValue(),i=this._urlDataSource.getTicketParamValue(),o=n.viewParams.qt,d=3===this._actionType?3:2,l=Fe.format("/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel",xe.t.viewerId,t.id,o||"",d),a?l+="&authKey="+a:i&&(l+="&ticket="+i),[2,new(this.managed(mt.e))({url:l,target:"_blank"}).execute(e)]):[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t.prototype.showShareDialog=function(e){var t=Fe.format(ia.o,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:ca.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:ia.t,execute:function(){return s.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new z.e("Cancel")}]}).wait().then(function(){return{resultType:c.t.Success}})},t.prototype._getCommandKey=function(){switch(this._actionType){case 1:return re.c;case 2:return re.d;case 3:return re.r}},t}(d.e),la=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="AddToSharedList",a._itemReedemer=a.resources.consume(m.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,He.t)},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this,!0).then(function(){return t.resources.consume(g.resourceKey).invalidateItem(e.key,{triggerFetch:!0}),{resultType:c.t.Success}})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),ua=Oe.e.isActivated("C092CAF4-C574-4ADB-9783-65C549F8FBFC","11/22/2022","Only show the remove from shared list command in the Shared with me view"),fa=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RemoveFromSharedList",n._itemCommandHelper=new(n.managed(b.e)),n._currentItem=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n._urlDataSource=n.resources.consume(xe.n),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RemoveFromSharedListExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([45,"ondemand.resx-ondemand"],5183))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return(ua||this._urlDataSource.isCurrentQuerySharedWithMe())&&this._itemCommandHelper.isCommandSupported(e,He.r)},t}(I.e),pa=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToBundleAction",n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToBundleExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([6,"ondemand.resx-ondemand"],4893))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&e.ownerId&&e.ownerId.toUpperCase(),n=xe.t.viewerId&&xe.t.viewerId.toUpperCase();return e&&e.isBundle&&t===n},t}(I.e),ma=n(3857),_a=Oe.t.isActivated("7B5F7746-6573-454C-B237-500C813D8D50","4/19/2022","Fix the remove from bundle availability logic in ItemsScope"),ha=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromBundleAction",a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(Object(S.cs)(S.yo)){var t=this._itemSelectionHelper.currentItem();if(_a)return!!e&&!!(null==t?void 0:t.isBundle)&&!t.isAlbum&&Object(h.B)(t.ownerId);var n=t&&t.ownerId&&t.ownerId.toUpperCase(),a=h.W.toUpperCase(),i=(null==e?void 0:e.parentKey)&&Object(h.S)(e.parentKey),r=t.id&&i&&i.id===t.id;return!(!e||!t.isBundle||!r||n!==a)}return!!(e&&e.UNSAFE_parent&&e.UNSAFE_parent.isBundle)&&e.UNSAFE_parent.ownerId===xe.t.viewerId},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this.resources.consumeAsync(ma.e).then(function(n){var a=new n({items:e.map(function(e){return e.id}),bundleAction:1,item:e[0].UNSAFE_parent});return t.trackPromise(a.start()),a.wait()}).then(function(){return{resultType:c.t.Success}})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),ba=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ReportAbuse",n._navigation=n.resources.consume(N.e),n}return Object(r.__extends)(t,e),t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorPath=function(){return"./ReportAbuseExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([47,"ondemand.resx-ondemand"],5184))}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,He.o)||Object(E.isFeatureEnabled)(E.EnableAnonReportConcernCommand)&&!xe.t.viewerId&&e&&!e.itemStatus&&(!e.folder||e.type===Se.e.OneNote)},t.prototype.onExecute=function(t,n){return Object(E.isFeatureEnabled)(E.EnableAnonReportConcernCommand)&&!xe.t.viewerId?(this._navigation.navigateTo({url:"https://www.microsoft.com/concern/onedrive",frameId:"_blank"}),s.n.wrap({resultType:c.t.Success})):e.prototype.onExecute.call(this,t,n)},t}(I.e),ga=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveMountPoint",a._urlDataSource=a.resources.consume(x.Se),a._dialogProvider=a.resources.consume(G.e),a._itemProvider=a.resources.consume(g.resourceKey),a._navigation=a.resources.consume(N.e),a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,He.i)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem.peek(),i=this._itemProvider,r=this._navigation,o=this._dialogProvider;return this._itemSelectionHelper.resolveFirst().then(function(e){if(!e)return{resultType:c.t.ExpectedFailure};var t=e.UNSAFE_parent,d=Fe.format(V.RemoveMountPointDetails2,e.name);return o.requestDialog({title:V.RemoveMountPointTitle,component:{name:Je.e.tagName,params:{text:d}},actions:[{name:V.RemoveMountPoint,execute:function(){return s.n.resolve(2)},isAvailable:n.observables.create(!0),icon:new z.e("Cancel"),isDefault:!0}]}).wait().then(function(){return n._itemSelectionHelper.clearSelection(),i.removeMountPoint({parentKey:a.key,item:e}).then(function(){var e,a=t?n._urlDataSource.getDefaultClickUrl(t):"";Object(S.cs)(S.yo)&&(e=n._urlDataSource.getRootUrl());var i=a||e;return r.navigateTo(i),{resultType:c.t.Success}})})})},t}(d.e),va=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RequestReview",n._itemCommandHelper=new(n.managed(b.e)),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RequestReviewExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([48,"ondemand.resx-ondemand"],5222))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!Object(E.isFeatureEnabled)(E.UseVroomApiForRequestReview),canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,He.s)},t}(I.e),ya=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ViewInFolderAction",a._navigation=a.resources.consume(N.e),a._urlDataSource=a.resources.consume(l.n),a._itemReedemer=a.resources.consume(m.e),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=e&&e.parentKey&&Object(Qt.e)(e.queryType),n=this._urlDataSource.isCurrentQuery(_.e.Photos);return!!e&&(t||n&&e.type===Se.e.Media)&&xe.t.areCidsEqual(e.ownerId,xe.t.viewerId)},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var e,t=this;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this).then(function(){return t._navigation.navigateTo({url:t._urlDataSource.getItemUrl(e.parentKey,{page:Ve.e.Files})}),s.n.resolve({resultType:c.t.Success})})]:[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),Sa=n(3847),Da=n(3849),Ia=n(2896),xa=n(1834),Ca=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromAlbum",a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return!!e.isAlbum&&!!t&&this._itemCommandHelper.isCommandSupported(t,O.o)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();var t={album:a,items:e};return s.n.resolve(n.resources.consumeAsync(Ia.e)).then(function(e){return e.removeFromAlbum(t)}).then(function(){return n._refreshItemsScopeRemovedItems(e),{resultType:c.t.Success}},function(e){return n._refreshItemsScopeCurrentItemSet(),{resultType:c.t.Failure}})})},t.prototype._refreshItemsScopeRemovedItems=function(e){this.resources.consume(xa.e)&&this.resources.consumeAsync(x.k).then(function(t){for(var n=0,a=e;n<a.length;n++){var i=a[n];i.id&&t.invalidateItems(i.key)}})},t.prototype._refreshItemsScopeCurrentItemSet=function(){this.resources.consume(xa.e)&&this.resources.consumeAsync(x.k).then(function(e){e.invalidateCurrentItemSet()})},t}(d.e),Oa=n(449),wa=n(119),Ea=!w.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),Aa=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item;return n._itemSelectionHelper=new(n.child(v.e))({overrideItem:a,allowMultiSelect:!1,canFallback:!0}),n._itemCommandHelper=new(n.managed(b.e)),n.state=n.createPureComputed(n._computeState),n}return Object(r.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!wa.e.hcid&&e.virtualItemType===Oa.e.Album&&(!Ea||e.ownerId&&Object(h.B)(e.ownerId))&&this._itemCommandHelper.isCommandSupported(e,O.e)}},t}(de.n),La=Object(rt.e)({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return s.n.resolve(n.ee([4,"ondemand.resx-ondemand"],5252))}}},handlerType:Aa}),ka=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!1,canFallback:!0}),n.state=n.createPureComputed(n._computeState),n}return Object(r.__extends)(t,e),t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===Oa.e.AlbumRoot}},t}(de.n),Ma=Object(rt.e)({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return s.n.resolve(n.ee([10,"ondemand.resx-ondemand"],5172))}}},handlerType:ka}),Pa=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SelectAction";var i=n.itemSelectionHelperType,r=void 0===i?a.resources.consume(v.e):i,o=n.actionMap,s=void 0===o?a.resources.consume(Ne.e):o;return a._item=t.item,a._selectItems=t.selectItems,a._itemSelectionHelper=new r({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),t.showProperties&&(a._showPropertiesAction=new(a.managed(s.ShowPropertiesAction))({})),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var t,n=this;return Object(r.__generator)(this,function(a){switch(a.label){case 0:return this._selectItems?(t=this._selectItems.map(function(e){return n.observables.peekUnwrap(e)}),this._itemSelectionHelper.selectItems(t)):this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]),this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,{resultType:c.t.Success}]}})})},t}(d.e),Ta=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="SelectAll",a._selectionModel=a.resources.consume(Ne.C),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode},t.prototype.onExecute=function(e,t){return this._selectionModel.selectAll(),s.n.resolve({resultType:c.t.Success})},t}(d.e),Ua=n(2187),Fa=function(e){function t(t){var n=e.call(this,t)||this;return n.name="FilterSearch",n._filter=t.filter,n._urlDataSource=n.resources.consume(x.Se),n._viewParams=n.resources.consume(Ne.T),n._showCurrentView=t.showCurrentView,n._url=n.createPureComputed(n._computeUrl),n._supportsSearchFiltering=n._getSupportsSearchFiltering(),n._navigationAction=new(n.managed(mt.e))({url:n._url,forceNavigation:!0}),n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.onIsAvailable=function(){return this._viewParams(),this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Qt.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()},t.prototype.onIsToggled=function(){this._viewParams();var e=Object(Qt.e)(this._urlDataSource.getQueryType())&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();return e&&this._showCurrentView(e&&this._filter!==Ua.t.all),e},t.prototype._computeUrl=function(){return this._viewParams(),this._urlDataSource.getSearchFilterQueryUrl(this._filter)},t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);return s.n.resolve(this.resources.consumeAsync(x.oe)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)}),e},t}(d.e),Ha=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveTagFromItem",a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a._viewParams=a.resources.consume(Ne.T),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return e.virtualItemType===Oa.e.Tag&&!!t&&!!e.tags&&e.tags.length>0},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem(),i=a.tags,r=this.resources.consume(se.C),o=this.resources.consume(se.f).getAllPhotosSettings().peek();return this._itemSelectionHelper.resolveSelection().then(function(e){var t,d=e[0],l=d&&d.tags;if(l&&i)for(var u=0,f=l;u<f.length;u++){var p=f[u];if(p.tag===i[0].tag){t=p;break}}if(n._itemSelectionHelper.clearSelection(),!t)return s.n.resolve({resultType:c.t.Failure});var m=!1,_=n._viewParams.peek();return n.resources.consume(xa.n)&&void 0===_.tagFilter&&(m=!0),r.updateTags({items:e,tagsToAdd:null,tagsToDelete:[t],parentKey:a.key,rootItemId:o.rootId,skipInvalidate:m}).then(function(){return{resultType:c.t.Success}})})},t}(d.e),Ra=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetAlbumCoverPhoto",n._currentItem=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n._itemCommandHelper=new(n.managed(b.e)),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./SetAlbumCoverPhotoExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([54],5314))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}},t.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===Oa.e.Album&&this._itemCommandHelper.isCommandSupported(e,ke.r)&&!!t&&!(!t.photo&&!t.video)},t}(I.e),Na=n(313),Ba=n(1144),ja=function(e){function t(t){var a=e.call(this,t)||this;return a.name="SetPhotosRoot",a._rootId=t.rootId,a._photoProvider=a.resources.consume(se.f),a._itemProvider=a.resources.consume(g.resourceKey),a._viewParams=a.resources.consume(Ne.T),a._urlDataSource=a.resources.consume(l.n),a._executorLoader=new(a.managed(lt.e))({path:"./SetPhotosRootExecutor",getModule:function(){return s.n.resolve(n.ee([55],4894))},getExecutorParams:function(){return{photoProvider:a._photoProvider,itemProvider:a._itemProvider,urlDataSource:a._urlDataSource,rootId:a._rootId}}}),a}return Object(r.__extends)(t,e),t.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;return"ROOT"===this._rootId?e="root"===t:"SAMSUNGFOLDER"===this._rootId?e="samsungGallery"===this._photoProvider.getAllPhotosSettings()().folderName:"ALLPHOTOSFOLDER"===this._rootId&&(e="photos"===this._photoProvider.getAllPhotosSettings()().folderName),e},t.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case Na.e.AllMyPhotos:case Na.e.onThisDay:case Na.e.onThisMonth:case Na.e.lastWeekPreviousYears:return!0;default:return!1}},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t.prototype.onCreateQosEvent=function(e){return new Ba.e({name:this.name,pageType:this._urlDataSource&&Ve.e[this._urlDataSource.getPageType()]||"",queryType:this._urlDataSource&&_.e[this._urlDataSource.getQueryType()]||"",logStartEnd:this.logStartEnd,extraData:{filter:this._rootId}})},t}(d.e),Va=function(e){function t(t){var n=e.call(this,t)||this;return n.name="FilterSearchByDateAction",n._filter=t.filter,n._urlDataSource=n.resources.consume(x.Se),n._viewParams=n.resources.consume(Ne.T),n._showCurrentView=t.showCurrentView,n._url=n.createPureComputed(n._computeUrl),n._supportsSearchFiltering=n._getSupportsSearchFiltering(),n._navigationAction=new(n.managed(mt.e))({url:n._url,forceNavigation:!0}),n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.onIsAvailable=function(){return this._viewParams(),this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Qt.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()},t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&Object(Qt.e)(this._urlDataSource.getQueryType())&&!this._urlDataSource.isSearchPassThrough();return e&&this._showCurrentView(e&&this._filter!==Ua.e.anyDate),e},t.prototype._computeUrl=function(){return this._viewParams(),this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)},t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);return s.n.resolve(this.resources.consumeAsync(x.oe)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)}),e},t}(d.e),za=n(3135),Ga=n(309),Ka=!Oe.e.isActivated("F821B97F-2856-4BCD-A56C-3D1866606118","05/09/2022",'Enable "copy to" action when accessing a share link'),Wa=function(e){function t(t){var n=e.call(this,t)||this;return n._isMove=t.isMove,n.name="LaunchMoveCopyPanel",n._currentItem=Oe.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(Ne.r):n.selectionHelper.currentItem,n._urlDataSource=n.resources.consume(l.n),n._capabilities=n.resources.consume(za.e),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"../LaunchMoveCopyPanelExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([39],5315))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this;if(!this._capabilities.supportsMoveCopy)return!1;var t=this._currentItem();if(this.selectionHelper.selection().length>1&&t.queryType===_.e.SharedWithMe&&t.isRootFolder)return!1;if(!Ka&&!this._isMove&&this._urlDataSource.getAuthKeyParamValue()&&this.resources.consume(Ga.e))return!1;var n=this._isMove?ke.o:ke.t;return this._urlDataSource.getPageType()!==Ve.e.TextFileEditor&&this.selectionHelper.filterItems(function(t){return e.itemCommandHelper.isCommandSupported(t,n)})},t}(I.e),qa=n(282),Qa=n(848),Ya=n(3309),Ja=function(e){function t(t){var n=e.call(this,t)||this;return n.name="AutoExecute",n._focusItem=t.focusItem,n._actionMap=n.resources.consume(Ne.e),n._navigation=n.resources.consume(N.e),n._urlDataSource=n.resources.consume(l.n),n._viewParams=n.resources.consume(Ne.T),n._originalViewParams=Object(r.__assign)({},n._viewParams.peek()),n._actionType=n.createPureComputed(n._computeAutoActionType,{deferEvaluation:!0}),n._createAction=n.createPureComputed(n._computeCreateAction,{deferEvaluation:!0}),n._action=n.createPureComputed(n._computeAction,{deferEvaluation:!0}),n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a=this,i=this._actionType.peek(),r=this._action.peek(),o=this.item.peek(),d=this._viewParams.peek(),l=new c.e({name:"AutoExecute-".concat(Ze.t[i])});return n=r&&r.isAvailable.peek()?r.execute(e):s.n.resolve({resultType:c.t.ExpectedFailure}),i!==Ze.t.locate&&i!==Ze.t.download&&this._navToDefaultUrl(o,d),n.then(function(e){return i===Ze.t.download&&a._navToDefaultUrl(o,d,"focus"),l.end(e),s.n.resolve(e)}).catch(function(e){return l.end(Object(qa.e)(e)),s.n.reject(e)})},t.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),n=this._focusItem&&this._focusItem(),a=!t.isPlaceholder,i=!n||!n().isPlaceholder;return!!e&&i&&a},t.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)},t.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case Ze.t.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case Ze.t.download:var n=this._focusItem&&this._focusItem(),a=this.item;e=function(){return new(t.managed(t._actionMap.DownloadAction))({item:n||a})};break;case Ze.t.share:case Ze.t.sharing:if(Object(E.isFeatureEnabled)(E.ODCRequestAccess)){var i=this._originalViewParams,r=i.rc,o=i.isEdit,s=i.isDirect,c="1"===o,d="1"===s,l=r?[r]:void 0;e=function(){return new(t.managed(t._actionMap.ShowShareMultiItemAction))({focusItems:t.resources.consume(Qa.n),isEdit:c,isSecureShare:d,defaultRecipients:l})}}else e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case Ze.t.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case Ze.t.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.Text,autoInvokedItem:!0})};break;case Ze.t.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.Word,autoInvokedItem:!0})};break;case Ze.t.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.Excel,autoInvokedItem:!0})};break;case Ze.t.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.ExcelSurvey,autoInvokedItem:!0})};break;case Ze.t.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.PowerPoint,autoInvokedItem:!0})};break;case Ze.t.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:B.e.OneNote,autoInvokedItem:!0})};break;case Ze.t.openInExcel:case Ze.t.openInWord:case Ze.t.openInPowerPoint:case Ze.t.openInOneNote:case Ze.t.openInVisio:case Ze.t.openInProject:case Ze.t.openInPublisher:case Ze.t.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case Ze.t.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case Ze.t.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case Ze.t.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case Ze.t.editBrowser:case Ze.t.edit:case Ze.t.editNew:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case Ze.t.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case Ze.t.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case Ze.t.showProperties:if(this._focusItem&&!this._focusItem()){var u=this._originalViewParams.commentId,f=this.resources.consume(Ya.e);u&&f({commentId:u}),e=function(){return new(t.managed(t._actionMap.ShowPropertiesAction))({useToggleBehavior:!0})}}case Ze.t.locate:}return e},t.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose(),e=null;var t=this._createAction();return t&&(e=t()),e},t.prototype._navToDefaultUrl=function(e,t,n){this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(e,{viewParams:t,urlType:n}))},t}(R.e),Xa=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ToggleSelectionModeAction",n._platformDetection=n.resources.consume(K.e),n._isSelectionModal=n.resources.consume(Bn.n),n._selectionHelper=new(n.child(v.e))({}),n._isOneDriveXboxApp=Object(Y.t)(),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()},t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();return this._isSelectionModal(!t),s.n.wrap({resultType:c.t.Success})},t.prototype.onIsToggled=function(){return this._isSelectionModal()},t}(d.e),Za=function(e){function t(t){var a=e.call(this,t)||this;return a.name="RedeemCode",a._executorLoader=new(a.managed(lt.e))({path:"./RedeemCodeExecutor",getModule:function(){return s.n.resolve(n.ee([44,"ondemand.resx-ondemand"],5200))},getExecutorParams:function(){return{redeemSuccess:t.redeemSuccess,redeemCode:t.redeemCode,actionName:a.name}}}),a}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t.prototype.onIsAvailable=function(){return!0},t}(d.e),$a=n(2634),ei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"../SaveExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([53],4895))}},t}(function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Save",n._itemContentsProvider=n.resources.consume($a.e),n._urlDataSource=n.resources.consume(x.Se),n._selectionHelper=new(n.child(v.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});var a=Object(S.cs)(S.ee)?n._selectionHelper.currentItem.peek():n.resources.consume(Ne.r).peek(),i=n._urlDataSource.getKeyParams(a.key);return n._urlDataSource.getQueryType(i)===_.e.SharedWithMe&&(a=void 0),n._loader=new(n.managed(lt.e))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:n._selectionHelper,currentItem:a}}}),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&!!t.memoryContent()&&!t.hasConflict()&&!t.hasPendingSave()&&t.hasChanges()},t.prototype.onExecute=function(e){return this._loader.execute(e)},t}(d.e)),ti=ei,ni=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Redeem",n._itemProvider=n.resources.consume(g.resourceKey),n._urlDataSource=n.resources.consume(x.Se),n._itemReedemer=n.resources.consume(m.e),n._selectionHelper=new(n.child(v.e))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===Ve.e.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})},t.prototype.onExecute=function(e){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){for(var n=0,a=e;n<a.length;n++){var i=a[n];t._itemProvider.invalidateItem(i.key,{triggerFetch:!0})}return s.n.wrap({resultType:c.t.Success})})})},t}(d.e),ai=n(2309),ii=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SwitchPhotoFolderLayoutType",n._itemSetMonitor=n.resources.consume(ai.e),n}return Object(r.__extends)(t,e),t.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!xe.t.getKeyParams(e.key).ft},t.prototype.getExecutorPath=function(){return"./SwitchPhotoFolderLayoutTypeExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([63],4896))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name}},t}(I.e),ri=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="CreateAlbumFromFolder",n._identity=n.resources.consume(x.D),n._urlDataSource=n.resources.consume(l.n),n._itemParentHelper=n.resources.consume(T.e),n}return Object(r.__extends)(t,e),t.prototype.isValidItem=function(e,t,n){var a=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault")),r=n!==Ve.e.TextFileEditor,o=e&&e.ownerId&&e.ownerId.toUpperCase(),s=xe.t.viewerId&&xe.t.viewerId.toUpperCase();return r&&t&&t.type!==qt.e.anonymous&&o===s&&!a&&e.type===Se.e.Folder&&e.queryType===_.e.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum&&!i},t.prototype.getExecutorPath=function(){return"./CreateAlbumFromFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([9],5316))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.onIsAvailable=function(){if(!Object(E.isFeatureEnabled)(E.EnableCreateAlbumFromFolder)&&Object(A.e)(L.l))return!1;var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),n=this._urlDataSource.getPageType();return this.isValidItem(e,t,n)},t}(I.e),oi=n(2791),si=n(134),ci=n(3141),di=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._urlDataSource=n.resources.consume(x.Se),n._itemParentHelper=n.resources.consume(T.e),n._itemCommandHelper=n.resources.consume(b.t),n._itemSelectionHelper=new(n.child(v.e))({allowMultiSelect:!1,canFallback:!1}),n}return Object(r.__extends)(t,e),t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list,a=!oi.e.isFolder(e,!0)&&si.e.hasItemPermission(e,si.e.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==Ve.e.TextFileEditor&&!!n&&!n.isExternal&&(n.enableVersions||n.isModerated)&&this._itemCommandHelper.isCommandSupported(e,ci.t)&&e.itemStatus!==Ft.t.ConditionalAccessBlocked&&e.itemStatus!==Ft.t.ConditionalAccessViewOnly&&a}},t}(de.n),li=Object(rt.e)({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return s.n.resolve(n.ee([60,"ondemand.resx-ondemand"],5185))}}},handlerType:di}),ui=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="VersionHistory",a._itemCommandHelper=new(a.managed(b.e)),a._itemSelectionHelper=new(a.child(v.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!Object(Y.e)()&&(this._itemCommandHelper.isCommandSupported(e,re.l)||!!e&&(e.type===Se.e.File||e.type===Se.e.Media)&&!e.dateDeletedTime&&Object(E.isFeatureEnabled)(E.VersionAllFiles))},t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,s.n,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=r.sent())?!Object(A.e)(t.ownerId)&&this._itemCommandHelper.isCommandSupported(t,re.l)?(n=this.resources.consume(x.Se),a=n.getVersionHistoryUrl(xe.t.viewerId,t.id),[2,new(this.managed(mt.e))({url:a,target:"_blank"}).execute(e)]):Ie.e.isAuthenticated()?[2,(new(this.managed(li))).execute(e)]:(i=this.resources.consume(N.e),[2,new(this.managed(mt.e))({url:xe.t.getAutoRedeemLoginUrl(t.id,t.ownerId,this.name,i)}).execute(e)]):[2,s.n.resolve({resultCode:"EmptySelection",resultType:c.t.Failure})]}})})},t}(d.e),fi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ApplyOfficeLens",n._item=Object(S.cs)(S.ee)?n.selectionHelper.currentItem:n.resources.consume(Ne.r),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./ApplyOfficeLensExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([8],5317))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,O.n)},t}(I.e),pi=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.name="RemoveOfficeLens",a._selectionHelper=new(a.child(v.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}),a._itemCommandHelper=new(a.managed(b.e)),a._item=Object(S.cs)(S.ee)?a._selectionHelper.currentItem:a.resources.consume(Ne.r),a._loader=new(a.managed(lt.e))({path:"./RemoveOfficeLensExecutor",getModule:function(){return s.n.resolve(n.ee([46],5318))},getExecutorParams:function(){return{actionName:a.name,selectionHelper:a._selectionHelper,item:a._item.peek()}}}),a}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,O.s)},t.prototype.onExecute=function(e){return this._loader.execute(e)},t}(d.e),mi=n(424),_i=function(e){function t(t){var n=e.call(this,t)||this;n._primary=new(n.managed(t.primary))(t.actionParams);var a=Object(r.__assign)(Object(r.__assign)({},t.actionParams),{primaryActionName:n._primary.name});return n._secondary=new(n.managed(t.secondary))(a),n.name=n._primary.name,n.isAvailable=n._primary.isAvailable,n.isExecuting=n.createPureComputed(n._computeIsExecuting),n.isToggled=n.createPureComputed(n._computeIsToggled),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(r.__extends)(t,e),t.create=function(e,n){var a=function(t){function a(a){return t.call(this,{primary:e,secondary:n,actionParams:a})||this}return Object(r.__extends)(a,t),a}(t);return a},t.prototype.execute=function(e){return this._getAction().execute(e)},t.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary},t.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()},t.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()},t.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():mi.e.none},t}(de.n),hi=n(2897),bi=n(156),gi=n(499),vi=!Oe.e.isActivated("85B60F61-8AB8-435E-92B3-7D9D9F3451ED","03/30/2023","Prompt for download on PDF print"),yi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="PrintPdf",n._urlDataSource=n.resources.consume(l.n),n._instrumentationProvider=n.resources.consume(se.o),n._platform=n.resources.consume(K.e),n._navigation=n.resources.consume(N.e),n._supportsIframePrint=!vi&&(n._platform.isChrome||n._platform.isSafari),n._isOneDriveXboxApp=Object(Y.t)(),n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./PrintPdfExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([43,"ondemand.resx-ondemand"],4897))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}},t.prototype.onExecute=function(t){var n=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=n._urlDataSource.getPrintPdfUrl(e);return bi.e.logData({name:hi.t[hi.t.PrintPdfNative],location:hi.e[hi.e.OneUp],usageType:gi.e[gi.e.Click],currentPage:n._instrumentationProvider.currentPageName(),previousPage:n._instrumentationProvider.previousPageName()}),n._navigation.navigateTo({url:t,frameId:"_blank"}),s.n.wrap({resultType:c.t.Success})}):e.prototype.onExecute.call(this,t)},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&!this._isOneDriveXboxApp&&Object(E.isFeatureEnabled)(E.UseWebPdfViewer)},t}(I.e),Si=n(1142),Di=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="SaveAutoAlbum",n._isHidden=t.isHidden||!1,n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./SaveAutoAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([52,"ondemand.resx-ondemand"],5319))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(E.isFeatureEnabled)(E.EnableEvokeAlignments)&&e&&e.virtualItemType===Oa.e.Album&&(Si.r(e)||Object(E.isFeatureEnabled)(E.EvokeDev))},t}(I.e),Ii=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="DiscardAutoAlbum",n}return Object(r.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DiscardAutoAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return s.n.resolve(n.ee([12,"ondemand.resx-ondemand"],5320))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(E.isFeatureEnabled)(E.EnableEvokeAlignments)&&e&&e.virtualItemType===Oa.e.Album&&Si.r(e)},t}(I.e),xi=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ImplicitSaveAutoAlbum",n._action=t.action,n._saveAutoAlbumAction=t.saveAutoAlbumAction,n}return Object(r.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this;return this._action.execute(e).then(function(t){return n._saveAutoAlbumAction.isAvailable()&&n._saveAutoAlbumAction.execute(e),t})},t.prototype.onIsAvailable=function(){return this._action.isAvailable()},t}(d.e),Ci=n(3858),Oi=function(e){function t(t){var n=e.call(this,t)||this;return n._itemRedeemer=n.resources.consume(m.e),n._isEdit=t.isEdit,n._isSecureShare=t.isSecureShare,n._defaultRecipients=t.defaultRecipients,n._itemsBeingShared=t.focusItems,n._selectionHelper=new(n.child(v.e))({overrideItem:null,allowMultiSelect:!0,canFallback:!0}),n._urlDataSource=n.resources.consume(x.Se),n._itemCommandHelper=n.resources.consume(b.t),n.name="ShowShareMultiItemAction",n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._selectionHelper.selection().length;if(!Object(E.isFeatureEnabled)(E.HideShareButton)&&!0===Object(A.e)(L.l)&&1!==t)return!1;var n=t>1&&e.queryType===_.e.SharedWithMe&&e.isRootFolder,a=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,He.c)&&!n&&!a&&!i},t.prototype.onExecute=function(e,t){var n=this;this._itemsBeingShared.peek()&&this._itemsBeingShared(void 0);var a=this._selectionHelper.selection().map(function(e){return e.peek()});return this._itemRedeemer.redeemItems(a,this).then(function(){return n._itemsBeingShared({items:a,defaultRecipients:n._defaultRecipients,isEdit:n._isEdit,isSecureShare:n._isSecureShare}),s.n.wrap({resultType:c.t.Success})},function(e){return s.n.reject(e)})},t}(d.e),wi=function(e){function t(t){var n=this,a=t.load,i=t.actionParams,r=(n=e.call(this,i)||this).resources.consume(se.e.optional);n.isQosLogged=!1,n.name="Deferred".concat(t.modulePath).replace(/Action|\.|\//g,""),n._action=n.createObservable();var o=new Kn.e;return(r?r.waitForPLT().then(a):s.n.resolve(a())).done(function(e){return o.complete(e)},function(e){return o.error(e)}),n._getActionPromise=n.trackPromise(o.getPromise().then(function(e){return new(n.managed(e))(i)})),n._getActionPromise.done(function(e){return n._action(e)}),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(r.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()},t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()},t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})},t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():mi.e.none},t}(d.e),Ei=n(832);function Ai(e,t){return function(e,t){var n;function a(){return n||(n=t())}return function(t){function n(n){return t.call(this,{load:a,modulePath:e,actionParams:n})||this}return Object(r.__extends)(n,t),n}(wi)}(e,function(){return t().then(Ei.e)})}var Li=function(e){function t(){var t=e.call(this)||this,a=Ai("../quotaBlock/odc/QuotaBlockAction",function(){return n.ee(0,4148)});return t.ExternalNavigateAction=f,t.OpenInDesktopAction=p.t,t.AddCoverPhotoAction=D,t.AddPhotosToAlbumAction=La,t.AddToAlbumAction=P,t.AddToBundleAction=pa,t.AddToFolderAction=U,t.AddToSharedListAction=la,t.ApplyOfficeLensAction=fi,t.AutoExecuteAction=Ja,t.ChangeFolderTypeAction=F.e,t.ClearSelectionAction=H,t.CreateAlbumAction=Ma,t.CreateAlbumFromFolderAction=ri,t.CreateDocumentAction=_i.create(Le,a),t.CreateFolderAction=Pe,t.CreateNewFolderAction=Ai("../createNewFolder/odc/CreateNewFolderAction",function(){return n.ee([566],5309)}),t.CreateMountPointAction=Be,t.DefaultClickAction=et,t.DeleteAction=tt,t.DiscardAutoAlbumAction=Ii,t.DownloadAction=nt.e,t.DownloadZipContentsAction=Ai("../downloadZipContents/odc/DownloadZipContentsAction",function(){return n.ee([567],5179)}),t.EditTagsAction=it,t.ShowTagsEditorAction=st,t.EmbedAction=ct,t.EmptyRecycleBinAction=dt,t.FeedbackAction=ut,t.FilterSearchAction=Fa,t.FilterSearchByDateAction=Va,t.ImplicitSaveAutoAlbumAction=xi,t.LanguagePickerAction=ft.e,t.LaunchMoveCopyPanelAction=Wa,t.LaunchMoveCopyPickerAction=Ai("../launchMoveCopyPicker/LaunchMoveCopyPickerAction",function(){return n.ee([362],4883)}),t.MoveCopyAction=Ai("../moveCopy/odc/MoveCopyAction",function(){return n.ee([572],5310)}),t.NavigateToItemAction=pt,t.NavigationAction=mt.e,t.OneDriveSortAction=_t.e,t.OpenAction=gt,t.PreviewAction=It,t.OpenInOfficeClientAction=At,t.OpenPdfInBrowserAction=kt,t.OpenInOfficeOnlineAction=_i.create(Ut,a),t.OpenInTextEditorAction=zt,t.OpenInHtmlViewerAction=Wt,t.OpenInImageEditorAction=Ai("../openInImageEditor/OpenInImageEditorAction",function(){return n.ee([573],4884)}),t.OrderPrintsAction=Yt,t.PlayAudioAction=Jt,t.PlaySlideShowAction=Xt,t.PrintPdfAction=yi,t.RedeemAction=ni,t.RedeemCodeAction=Za,t.RemoveCoverPhotoAction=$t,t.RemoveFromAlbumAction=Ca,t.RemoveFromBundleAction=ha,t.RemoveFromRecentAction=cn,t.RemoveFromSharedListAction=fa,t.RemoveMountPointAction=ga,t.RemoveOfficeLensAction=pi,t.RemoveTagAction=dn,t.RemoveTagFromItemAction=Ha,t.RenameAction=ln,t.ReportAbuseAction=ba,t.RequestReviewAction=va,t.RestoreAction=fn,t.RestoreAllAction=pn,t.RotateAction=hn,t.SaveAction=ti,t.SaveAutoAlbumAction=Di,t.SaveSortOrderAction=yn,t.SelectAction=Pa,t.SelectAllAction=Ta,t.SetAlbumCoverPhotoAction=Ra,t.SetFocusAction=Dn,t.SetPhotosRootAction=ja,t.ShareByLinkAction=In,t.ShowKeyboardMapAction=xn,t.ShowOperationsAction=On,t.ShowPermissionsAction=En,t.ShowSuggestedFilesAction=kn,t.ShowPropertiesAction=Mn.default,t.ShowCopilotAction=Nn,t.ShowSelectionAction=jn,t.ShowVersionHistoryAction=ui,t.SignOutAction=Sa.e,t.SortAction=bn.e,t.StopSlideShowAction=Zt,t.SurveyAction=da,t.SwitchPhotoFolderLayoutTypeAction=ii,t.ToggleDebugWindowAction=Da.e,t.ToggleIsLeftNavUserExpandedAction=Ai("../../controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",function(){return n.ee([579],2468)}),t.ToggleListLayoutAction=Vn.e,t.ToggleSelectionModeAction=Xa,t.UpdateCaptionAction=ea,t.UploadAction=_i.create(Yn,a),t.QuotaBlockAction=a,t.VaultAction=Ci.e,t.ViewInFolderAction=ya,t.ViewOriginalAction=zn,t.ShowShareMultiItemAction=Oi,t}return Object(r.__extends)(t,e),t}(o.e);t.e=Li}],Array(14),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(75),r=n(613),o=n(1022),s=n(1169),c=n(3094),d=n(17);Object(d.n)([{rawString:".od-vault-block{height:521px}"}]);var l=n(402),u=n(260),f=n(807),p=n(2209),m=n(2085),_=n(1),h=n(1719),b=n(1671),g=n(1190),v=n(156),y=n(3361),S=n(1023),D=n(405),I=n(32),x=n(106),C=n(1123),O=n(40),w=n(3360);Object(d.n)([{rawString:".od-vault-overQuota{text-align:center}.od-vault-overQuota .ms-Button--primary{height:40px;border-radius:"},{theme:"roundedCorner2",defaultValue:"2px"},{rawString:";background-color:#107c10}.od-vault-overQuota-image{height:auto;width:340px;padding:20px 140px 40px 140px}.od-vault-overQuota-messageTitle{font-size:20px;padding:14px 0;font-weight:600}.od-vault-overQuota-messageDescription{font-size:14px;height:62px;padding:0 56px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.od-vault-overQuota-premiumLink{font-size:13px;font-weight:600}.od-vault-overQuota-premiumPrice{height:17px;font-size:13px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:";padding:14px 0}.od-vault-block--close{font-size:16px;padding:10px;float:right;cursor:pointer}"}]);var E=function(e){function t(t){var n=e.call(this,t)||this;return n._onSeeAllPremiumFeaturesClick=function(){v.e.logData({name:"Vault.PaywallPositioning.SeeAllFeatures"});var e=n.props.showAllFeatureCards;e&&e()},n._onGoPremiumClick=function(){v.e.logData({name:"Vault.PaywallPositioning.GoPremium"});var e=n._attributionHelper.getPurchaseAttribution({source:"PVault-QuotaPositioning",cta:"GoPremium"}),t=n._odcUrlDataSource.getUpgradeOptionsUrl(e,!0),a=n._resources.consume(I.e),i=new(n._resources.injected(a.NavigationAction))({url:t});n._onDialogDismiss(),i.execute(null),i.dispose()},n._onDialogDismiss=function(){v.e.logData({name:"Vault.PaywallPositioning.Dismiss"});var e=n._resources.consume(C.e).currentDialog();e&&e.dismiss()},n.state={price:""},n._resources=t.resources,n._attributionHelper=n._resources.consume(S.e),n._odcUrlDataSource=n._resources.consume(D.n),n._storageOptionsProvider=n._resources.consume(x.D),n._storageOptionsProvider.getStorageOptions().then(function(e){n.officePlans=e.officePlans,n.setState({price:n._getPersonalPlanMonthlyFee()})}),v.e.logData({name:"Vault.PaywallPositioning.Shown"}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state.price,t=w.e,n=O.format(t,3),a=y.e;return _.createElement("div",{className:"od-vault-overQuota"},_.createElement("div",{className:"od-vault-block--close",onClick:this._onDialogDismiss},_.createElement(b.e,{iconProps:{iconName:"Cancel",ariaLabel:y.t,className:"od-vault-block-dismiss"}})),_.createElement("img",{className:"od-vault-overQuota-image",alt:y.a,src:this._getImagePath("vaultoverquota")}),_.createElement("div",{className:"od-vault-overQuota-notificationSection"},_.createElement("div",{className:"od-vault-overQuota-messageTitle"},y.a),_.createElement("div",{className:"od-vault-overQuota-messageDescription"}," ",n),_.createElement(h.e,{target:"_blank",onClick:this._onSeeAllPremiumFeaturesClick,className:"od-vault-overQuota-premiumLink","aria-label":a},_.createElement("span",{className:"od-vault-overQuota-linkDescription"},a)),_.createElement("div",{className:"od-vault-overQuota-premiumPrice"},e),_.createElement(g.e,{text:y.n,primary:!0,checked:!1,disabled:!1,onClick:this._onGoPremiumClick})))},t.prototype._getPersonalPlanMonthlyFee=function(){var e=this.officePlans;return e&&e[1]&&e[1].purchaseActions[1]&&e[1].purchaseActions[1].price},t.prototype._getImagePath=function(e){return window.require.toUrl("odsp-media/images/vault/".concat(e,".svg"))},t}(_.Component),A=function(e){function t(t){var n=e.call(this,t)||this;return n.addBindingHandlers({react:f.t}),n.vaultOverQuotaComponent=E,n.closeLabel=y.t,n.featureCardsTagName=p.e.tagName,n.featureCardIndex=0,n.source="Vault",n.cta="GoPremium",n.displayFeatureCards=n.createObservable(!1),n._featureCardsProvider=n.resources.consume(m.n),n.featureCardData=n._featureCardsProvider.getFeatureCards(),n.vaultOverQuotaProps={resources:n.resources,showAllFeatureCards:n.showAllFeatureCards.bind(n)},n}return Object(a.__extends)(t,e),t.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1)},t.prototype.showAllFeatureCards=function(){this.displayFeatureCards(!0)},t}(u.t),L=l.e({tagName:"od-vault-increase-block",template:'<div class="od-vault-block" data-bind="react:{componentType:vaultOverQuotaComponent,props:vaultOverQuotaProps}"></div>\x3c!--ko if:displayFeatureCards--\x3e<div data-bind="component:{name:featureCardsTagName,params:{cards:featureCardData,currentIndex:featureCardIndex,close:$component.closeFeatureCards.bind($component),includeOverlay:true}}"></div>\x3c!--/ko--\x3e',viewModel:A,synchronous:!0}),k=n(2154),M=n(47),P=n(1912),T=n(3310),U=n(1904),F=n(62),H=n(2787),R=n(3138),N=n(3),B=n(332),j=n(500),V=1,z=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;a.name="QuotaBlock",a.item=t.item,a._dragAndDrop=t.isDragAndDrop,a._isBlockingWacEditor="OpenInOfficeOnline"===t.primaryActionName,a._shouldCheckVaultQuota=!a._isBlockingWacEditor,a._currentItem=Object(N.cs)(N.ee)?a.selectionHelper.currentItem:a.resources.consume(I.r),a._dialogProvider=a.resources.consume(C.e),a._itemCacheStore=a.resources.consume(B.e.optional);var i=a.resources.consume(x.e),r=i&&i.getBundleInfo(2);return a._userStateProvider=a.createComputed(function(){if(r.isLoaded())try{return a.resources.consume(x.b)}catch(e){F.e.logError(e,{errorCount:V++,href:location.href,requestUrl:n.p})}}),a._itemParentHelper=a.resources.consume(U.e),a._vaultStore=a.resources.consume(T.e.optional),a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._currentItem();if(P.t.viewerId&&!Object(r.e)(e.ownerId,P.t.viewerId))return!1;if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")))return!1;var t=!1;if(this._shouldCheckVaultQuota){var n=this._vaultStore;e&&e.vault&&n&&n.isVaultOpen()&&(t=!!n.isOverQuota())}var a=!1,i=this._userStateProvider();if(i){var s=i.status();a=s>=o.e.full&&s!==o.e.nearing}return t||a},t.prototype.getComponentParameters=function(){return{item:this.item,isWacEditBlock:this._isBlockingWacEditor,resources:this.resources}},t.prototype.onExecute=function(e){var t;return Object(a.__awaiter)(this,void 0,i.n,function(){var r,d,l,u,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(r=this._userStateProvider.peek())?this._isBlockingWacEditor&&r.isSoftLocked()?[2,this._openOfficeDocumentReadOnly(e)]:(d=s.e.blocker,l=c.e.tagName,(u=this._currentItem())&&u.vault&&!u.vault.isLocked&&this._vaultStore&&(f=this._vaultStore.isVaultOpen)&&f()&&this._vaultStore.isOverQuota()&&(l=L.tagName,d=s.e.vaultBlocker),((p=r.status())===o.e.full&&this.resources.consume(j.e)||(p===o.e.outOfSpace||p===o.e.overQuota)&&this.resources.consume(j.t))&&l===c.e.tagName?[4,n.ee(72,4944)]:[3,2]):[2,i.n.wrap({resultType:M.t.ExpectedFailure})];case 1:return m=a.sent().showQuotaBlockDialog,null===(t=this._itemCacheStore)||void 0===t||t.dispatch(m({show:!0,dialogType:"create"})),[3,3];case 2:this._dialogProvider.requestDialog({template:0,style:d,component:{name:l,params:this.getComponentParameters()}}),a.label=3;case 3:return this._dragAndDrop&&r.logEvent(k.e.dragAndDrop),[2,i.n.wrap({resultType:M.t.Success})]}})})},t.prototype._openOfficeDocumentReadOnly=function(e){return new(this.managed(H.e))({item:this.item,forceReadOnly:!0}).execute(e)},t}(R.e);t.default=z},,,,,,,function(e,t,n){"use strict";var a=n(0),i=n(1122),r=n(77),o=n(17);Object(o.n)([{rawString:".LanguagePicker select{width:100%}"}]);var s=n(3848),c=n(122),d=function(e){function t(t){var n=e.call(this,t)||this;n.canary=t.canary,n.selectedLanguage=t.selectedLanguage,n.loadingText=s.t;var a=n.observables;n.isLoading=a.create(!0),n.languages=a.createArray([]),n.currentLanguage=a.create("");var i=n.resources.consume(r.F.optional);return i&&i.getLanguages().then(function(e){n.canary(e.canary),n.currentLanguage(e.currentLanguage);for(var t=e.languageList,a=0,i=t;a<i.length;a++){var r=i[a];r.displayText=(c.t.isRightToLeft?"&rlm;":"&lrm;")+r.nativeName+" - "+r.name}n.languages(t),n.isLoading(!1)}),n}return Object(a.__extends)(t,e),t}(n(260).t),l=n(402).e({tagName:"ms-language-picker",template:'<form class="LanguagePicker">\x3c!--ko if:$data.isLoading--\x3e<div data-bind="text:loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:$data.isLoading--\x3e<select name="language" data-bind="value:selectedLanguage,foreach:languages,automation:\'dropDown\'"><option data-bind="attr:{selected:isoValue===$parent.currentLanguage()},value:isoValue,html:displayText"></option></select>\x3c!--/ko--\x3e</form>',viewModel:d}),u=n(103),f=n(47),p=n(82),m=n(302),_=n(1123),h=function(e){function t(t){var n=e.call(this,t)||this;return n.name="LanguagePicker",n._languagePickerDataSource=n.resources.consume(r.F),n._navigation=n.resources.consume(p.e),n._dialogProvider=n.resources.consume(_.e),n._lang=n.observables.create(""),n._canary=n.observables.create(""),n}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this;return this._dialogProvider.requestDialog({title:s.e,automationId:"languagePicker",component:{name:l.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:s.n,execute:function(){return n.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new m.e("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:f.t.Success}})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){return e._navigation.navigateTo(u.t(window.location.href,"mkt",t)),2})},t}(i.e);t.e=h},,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(17);Object(a.n)([{rawString:".od-vaultCallout{display:flex;padding:10px}.od-vaultCallout-close{padding:3px 0 3px 10px;cursor:pointer;border:transparent;background-color:transparent}html[dir=rtl] .od-vaultCallout-close{padding:3px 10px 3px 0}"}]);var i=n(0),r=n(260),o=n(156),s=n(3903),c=n(1070),d=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.vaultCalloutMessage=a._getCalloutMessage(t.messageType),a.closeButtonAriaLabel=s.e,a._onDismiss=t.onDismiss,a.shouldShowDismissButton=t.messageType===c.e.secondSessionMessage,t.messageType===c.e.lockMessage&&a.async.setTimeout(a.onDismiss.bind(a),3e3),a}return Object(i.__extends)(t,e),t.prototype.onDismiss=function(){this._onDismiss()},t.prototype._getCalloutMessage=function(e){var t;switch(e){case c.e.secondSessionMessage:o.e.logData({name:"Vault.Icon.SecondSessionFRE.Shown"}),t=s.t;break;case c.e.lockMessage:default:t=s.n}return t},t.dependencies={},t}(r.t),l=n(480),u=Object(l.t)({automationName:"od-vaultCallout-ko",name:"VaultCallout",template:'<div class="od-vaultCallout"><div class="od-vaultCallout-lockMessage" data-bind="text:vaultCalloutMessage"></div>\x3c!--ko if:shouldShowDismissButton--\x3e<button class="od-vaultCallout-close" data-bind="attr:{\'aria-label\':closeButtonAriaLabel},click:onDismiss"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e</div>',viewModelType:d});t.default=u},,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a,i=n(0),r=n(7),o=n(135),s=n(77),c=n(3312),d=n(140),l=n(482),u=n(170),f=new r.t({name:"OperationProvider.key",loader:new o.t(function(){return n.ee(0,1129).then(function(e){return e.resourceKey})})}),p=new r.t({name:"KOToItemCacheOperationProvider.key",loader:new o.t(function(){return n.ee(0,3741).then(function(e){return e.resourceKey})})}),m=n(148),_=((a={})[c.e.Cancelled]=d.e.canceled,a[c.e.Completed]=d.e.completed,a[c.e.Failed]=d.e.failed,a[c.e.NotStarted]=d.e.created,a[c.e.InProgress]=d.e.started,a[c.e.Unknown]=d.e.failed,a),h=function(){function e(e,t){void 0===e&&(e={});var n=this;this._restoreOperations=t.restoreOperations;var a=t.resources;this._getOperationProvider=function(){return Object(i.__awaiter)(n,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,a.consumeAsync(m.e.optional)];case 1:return e.sent(),[2,t.getOperationProvider()]}})})},this._getKOToItemCacheOperationProvider=function(){return Object(i.__awaiter)(n,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,a.consumeAsync(m.e.optional)];case 1:return e.sent(),[2,t.getKOToItemCacheOperationProvider()]}})})},this._async=new u.e}return e.prototype.dispose=function(){this._async.dispose()},e.prototype.monitorRestoreProgress=function(e){var t=this;void 0===e&&(e={});var n=e.headers,a=e.itemsScopeCurrentItemSetKey,i=e.showProgressInItemsView;if(!a||this._restoreOperations.shouldMonitorProgressForItemSetKey(a)){var r=void 0;this.pollRestoreProgress(function(e,n,a){!e&&n?(i?t._getKOToItemCacheOperationProvider():t._getOperationProvider()).then(function(e){r||(r=e.register({name:"",type:t._restoreOperations.isOneDrive()?l.e.pointInTimeRestore:l.e.sharepointPointInTimeRestore,iconName:"RevToggleKey",payloads:{},actions:{},progress:{minimum:0,maximum:1,current:0}})),r.progress.current(n.percentComplete/100),r.state(_[n.status]),function(e){return e.status===c.e.Cancelled||e.status===c.e.Completed||e.status===c.e.Failed}(n)&&a()}):a()},n)}},e.prototype.pollRestoreProgress=function(e,t){var n,a=this,i=void 0,r=!1,o=function(){r=!0,n&&a._async.clearInterval(n)},s=function(){a._restoreOperations.getOngoingRestoreOperation({url:i,headers:t}).then(function(t){t?(i=t.url||void 0,e(null,t,o)):e(null,null,o)},function(t){e(t,null,o)})};s(),r||(n=this._async.setInterval(s,5e3))},e.dependencies={restoreOperations:s.ae,getOperationProvider:f.async,getKOToItemCacheOperationProvider:p.async,resources:r.r},e}(),b=Object(o.r)("RestoreOperationProgressProvider",h)}],Array(16),[function(e,t,n){"use strict";var a,i=n(0),r=n(59);!function(e){e[e.unRes=0]="unRes",e[e.doc=1]="doc"}(a||(a={}));var o=n(103),s=n(1030),c=a[a.unRes],d=a[a.doc],l="scaled",u=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.processThumbnailSet=function(e,t){for(var n={},a={},r=0,o=e.thumbnails;r<o.length;r++){var s=o[r];n[s.name]=s,0===s.name.indexOf(l)&&(a[s.name.substring(l.length).toLowerCase()]=s)}var u,f={thumbnailSet:e,thumbnailsByType:n,thumbnailsBySize:a,item:t},p=n[c],m=n[d];return p?u=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(p,f):this._getUnResThumbnail(p,f):m?u=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},m),{width:t.video.width,height:t.video.height}),f):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},m),{width:t.photo.width,height:t.photo.height}),f):this._getDocThumbnail(m,f):Object.keys(a).length&&(u=this._getScaledThumbnail(f)),u},t.prototype.getProcessFiltersUrl=function(e,t){for(var n,a=0,i=e.thumbnails;a<i.length;a++){var r=i[a];"custom"===r.name&&(n=r)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""},t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[s.t[s.t.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,a){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)},t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(a,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,a)}}}},t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(a,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:a.width,height:Math.max(a.height,2048)})}}}},t.prototype._getScaledThumbnail=function(e){var t,n=this,a=[];for(var i in e.thumbnailsBySize){var r=e.thumbnailsBySize[i];"largest"===i?t=r:a.push(r)}a.sort(function(e,t){return e.width*e.height-t.width*t.height}),t=t||a[a.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,r){for(var s,c=i.width*i.height,d=0,l=a;d<l.length;d++){var u=l[d];if(u.width*u.height>.9*c){s=u.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,s||t.url)}}}},t.prototype._createSizedUrl=function(e,t,n){var a={width:Math.ceil(n.width),height:Math.ceil(n.height)};return n.width===n.height&&(a.cropMode="center"),this._createUrl(e,t,a)},t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})},t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var a="".concat(e).concat(t),i=o.n(n)?a.indexOf("?")>-1?"&":"?":"";return"".concat(a).concat(i).concat(o.n(n))},t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,a=e.photo;return".gif"===n.toLowerCase()&&!!a},t}(r.n);t.e=u},function(e,t,n){"use strict";var a=n(0),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="Unsupported",t}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!1},t}(n(1122).e),r=i;t.e=function(){this.AddCoverPhotoAction=r,this.AddExistingAppViewAction=r,this.AddFlowAction=r,this.AddPhotosToAlbumAction=r,this.EditSmartTemplateAction=r,this.DeleteSmartTemplateAction=r,this.DeleteSmartTemplateWithProgressAction=r,this.PublishSmartTemplateAction=r,this.PublishSmartTemplateWithProgressAction=r,this.UnPublishSmartTemplateAction=r,this.UnPublishSmartTemplateWithProgressAction=r,this.CopySmartTemplateLinkAction=r,this.ActivateUniversalAnnotationAction=r,this.AddToAlbumAction=r,this.AddToBundleAction=r,this.AddToFolderAction=r,this.AddToOneDriveAction=r,this.AddToQuickLaunchAction=r,this.AddToSharedListAction=r,this.AddToSpotlightAction=r,this.AlertAction=r,this.ApplyOfficeLensAction=r,this.ApproveRejectAction=r,this.AuthenticationPolicyWarningAction=r,this.AutoExecuteAction=r,this.BackToClassicAction=r,this.CancelEditAction=r,this.ChangeAppViewVisibilityAction=r,this.ChangeFolderTypeAction=r,this.CheckInAction=r,this.CheckOutAction=r,this.ClearFilterAction=r,this.ClearSelectionAction=r,this.ComplianceDetailsAction=r,this.ContentTypeNavigationAction=r,this.LaunchConfigureFlowsPanelAction=r,this.CopyFieldAction=r,this.CopyFormAction=r,this.CreateAlbumAction=r,this.CreateAlbumFromFolderAction=r,this.CreateAppViewAction=r,this.CreateColumnAction=r,this.CreateCustomDocumentAction=r,this.CreateDocumentAction=r,this.CreateFileRequestAction=r,this.CreateFolderAction=r,this.CreateItemAction=r,this.CreateMountPointAction=r,this.CreateNewFolderAction=r,this.CreateSitePageAction=r,this.CustomActionNavigationAction=r,this.CustomizeClientFormAction=r,this.CustomClientFormPaneAction=r,this.CustomizeFormsNavigationAction=r,this.CustomizeViewAction=r,this.DefaultClickAction=r,this.DeleteAction=r,this.DeleteTemplateAction=r,this.DeleteAppAction=r,this.DeleteViewAction=r,this.DiscardAutoAlbumAction=r,this.DownloadAction=r,this.SendForSignatureAction=r,this.SendForSignatureAdobeAction=r,this.SendForSignatureDocusignAction=r,this.OpenSWAAction=r,this.DownloadZipContentsAction=r,this.EditAction=r,this.EditInClipchampAction=r,this.EditItemAction=r,this.EditItemCancelAction=r,this.EditItemSaveAction=r,this.EditNewAppViewAction=r,this.EditNewMenuAction=r,this.EditNewMenuPaneAction=r,this.EditPdfAction=r,this.EditRenditionsAction=r,this.EditTagsAction=r,this.ShowTagsEditorAction=r,this.EmbedAction=r,this.EmptyRecycleBinAction=r,this.ExportListAction=r,this.ExternalNavigateAction=r,this.FeedbackAction=r,this.FileHandlerOpenAction=r,this.FileHandlerCreateAction=r,this.FilterAction=r,this.FilterSearchAction=r,this.FilterSearchByDateAction=r,this.GetLinkAction=r,this.GroupItemsAction=r,this.ImplicitSaveAutoAlbumAction=r,this.InvokeFirstRunExperienceAction=r,this.LanguagePickerAction=r,this.LaunchApprovalDetailsDialogAction=r,this.LaunchChangeTheLookPanelAction=r,this.LaunchColumnCustomizationPaneAction=r,this.LaunchColumnManagementPanelAction=r,this.LaunchCreateAppViewPanelAction=r,this.LaunchCreateGroupPanelAction=r,this.LaunchCreateListDialog=r,this.LaunchCreateShortcutPanel=r,this.LaunchDocLibSettingPanelAction=r,this.LaunchFilterPanelAction=r,this.LaunchFlowWidgetPanelAction=r,this.LaunchFormatViewPaneAction=r,this.LaunchGroupifyPanelAction=r,this.LaunchGroupMembershipPanelAction=r,this.LaunchHubSettingsPanelAction=r,this.LaunchListCreationPanelAction=r,this.LaunchListFormAction=r,this.LaunchMoveCopyPanelAction=r,this.LaunchPdfExtractionAction=r,this.LaunchPdfMergeAction=r,this.LaunchSitePermissionsPanelAction=r,this.LaunchSiteSettingsPanelAction=r,this.LaunchGlobalNavSettingsPanelAction=r,this.LaunchWebTemplatesGalleryAction=r,this.LaunchUserExpirationPanelAction=r,this.LaunchVivaConnectionsSettingsPanelAction=r,this.ListFormActivityPaneToggleAction=r,this.MakeHomepageAction=r,this.VaultAction=r,this.ModifyColumnAction=r,this.ModifyShowInFiltersPaneAction=r,this.MoveCopyAction=r,this.MoveLeftSpotlightAction=r,this.MoveRightSpotlightAction=r,this.NavigateToItemAction=r,this.NavigateToSharePointHomeAction=r,this.NavigationAction=r,this.NewClipchampAction=r,this.OneDriveSortAction=r,this.OpenAction=r,this.OpenChatAction=r,this.OpenAppAction=r,this.OpenDocSetAction=r,this.OpenHyperlinkAction=r,this.OpenInExplorerAction=r,this.OpenInfoPathAction=r,this.OpenInImageEditorAction=r,this.OpenInOfficeClientAction=r,this.OpenInOfficeOnlineAction=r,this.OpenInImmersiveReaderAction=r,this.OpenInSharePointAction=r,this.OpenInDesktopAction=r,this.OpenInTextEditorAction=r,this.OpenInClipchampAction=r,this.OpenInHtmlViewerAction=r,this.OpenNeedsAttentionViewAction=r,this.OpenPdfInBrowserAction=r,this.OpenInPowerBIAction=r,this.OpenInTeamsPreviewAction=r,this.OpenShortcutAction=r,this.OpenSiteAction=r,this.OrderPrintsAction=r,this.PinToMruAction=r,this.PlayAudioAction=r,this.PlaySlideShowAction=r,this.PolicyTipAction=r,this.PreviewAction=r,this.PrintPdfAction=r,this.PublishAction=r,this.RedeemAction=r,this.RedeemCodeAction=r,this.RemoveCoverPhotoAction=r,this.RemoveFromAlbumAction=r,this.RemoveFromBundleAction=r,this.RemoveFromRecentAction=r,this.RemoveFromSharedListAction=r,this.RemoveFromSpotlightAction=r,this.RemoveMountPointAction=r,this.RemoveOfficeLensAction=r,this.RemoveTagAction=r,this.RemoveTagFromItemAction=r,this.RenameAction=r,this.RenameColumnAction=r,this.ReportAbuseAction=r,this.RequestReviewAction=r,this.RestoreAction=r,this.RestoreAllAction=r,this.RestoreFilesAction=r,this.RotateAction=r,this.SaveAction=r,this.SaveAutoAlbumAction=r,this.SaveSortOrderAction=r,this.SaveViewAction=r,this.SeeAllAppsAction=r,this.SelectAction=r,this.SelectAllAction=r,this.SetAlbumCoverPhotoAction=r,this.SetDefaultViewAction=r,this.SetFocusAction=r,this.SetPhotosRootAction=r,this.SetUpApprovalFlowAction=r,this.SetUpReminderFlowAction=r,this.ShareAction=r,this.ShareByLinkAction=r,this.ShowExistingFlowsAction=r,this.ShowFiltersAction=r,this.ShowCopilotAction=r,this.ShowItemAnalyticsAction=r,this.ShowSuggestedFilesAction=r,this.ShowKeyPointsAction=r,this.ShowKeyboardMapAction=r,this.ShowMalwareDetectedAction=r,this.ShowOperationsAction=r,this.ShowPermissionsAction=r,this.ShowPropertiesAction=r,this.ShowReactVersionHistoryAction=r,this.ShowRunReportAction=r,this.ShowSelectionAction=r,this.ShowShareAction=r,this.ShowShareMultiItemAction=r,this.ShowVersionHistoryAction=r,this.SignOutAction=r,this.SortAction=r,this.StopSlideShowAction=r,this.SurveyAction=r,this.SwitchPhotoFolderLayoutTypeAction=r,this.SwitchSharingLinkAction=r,this.SwitchViewAction=r,this.SyncAction=r,this.SynchronizeAppViewAction=r,this.LaunchTeamChannelAction=r,this.ToggleAction=r,this.ToggleDebugWindowAction=r,this.ToggleIsLeftNavUserExpandedAction=r,this.ToggleListLayoutAction=r,this.ToggleSelectionModeAction=r,this.TriggerFlowAction=r,this.TriggerFlowByIdAction=r,this.TriggerODBConvertToPdfFlowAction=r,this.TriggerODBRequestSignOffFlowAction=r,this.TriggerSignoffFlowAction=r,this.TriggerExtractFileMetadataFlowAction=r,this.UndoCheckOutAction=r,this.UnPublishAction=r,this.UpdateCaptionAction=r,this.UpdatePermissionsAction=r,this.UploadAction=r,this.UploadTemplateAction=r,this.QuotaBlockAction=r,this.ViewInFolderAction=r,this.ViewItemAction=r,this.ViewOriginalAction=r,this.WorkflowAction=r}},,,,,function(e,t,n){"use strict";var a=n(0),i=n(59),r=n(1914),o=n(449),s=n(144),c=n(1935),d=n(1030),l=n(703),u=n(2889),f=n(2647),p=n(1994),m=n(3485),_=n(491),h=n(43),b=n(489),g=n(1912),v=n(2890),y=n(8),S=n(40),D=n(1872),I=n(695),x=n(122),C=n(4184),O=n(13),w=n(405),E=n(77),A=n(1826),L=n(2353),k=n(1967),M=n(2030),P=n(379),T=n(3300),U=n(1355),F=n(4803);function H(e){if("number"==typeof e)return Object(F.e)(e)}var R=n(380),N=!y.e.isActivated("B11CEEB1-B225-42EF-A0A0-0892C41C07F1","07/15/2022","Force item redemption for skyapi items when the user is anonymous"),B={0:r.e.Owner,1:r.e.Edit,2:r.e.View,3:r.e.Submitter,4:r.e.CoOwner,5:r.e.None},j="1209427492",V="0000000048166624",z=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.getRootItemTitle,i=void 0===a?n._getRootItemTitle:a,r=t.getItemKeyExtension,o=void 0===r?n._getItemKeyExtension:r;return n._getRootItemTitle=i,n._getItemKeyExtension=o,n._urlDataSource=n.resources.consume(w.n),n._identityDataSource=n.resources.consume(E.D),n._thumbnailProcessor=new(n.managed(C.e)),n}return Object(a.__extends)(t,e),t.prototype.processItemResult=function(e){var t=this,n=e.requestKey,i=e.itemFromServer,c=e.requestMetadata,p=e.setItemKey,_=e.skipSettingChildren,y=e.isPrimaryRequestedItem,C=e.isPlaceholder,w=e.observer,E=this._urlDataSource.getKeyParams(n),L=e.queryType,P=void 0===L?this._urlDataSource.getQueryType(E):L;if(i){var F=this.getItemKey({requestKey:n,itemFromServer:i}),j={key:F},V=i.itemStatus;j.itemStatus=V;var z="";i.locatedIn?z=i.locatedIn:i.deletedFromLocation?z="/"===i.deletedFromLocation[0]?i.deletedFromLocation.substr(1):i.deletedFromLocation:i.ownerCid&&i.ownerCid===g.t.viewerId?z=m.e:i.ownerName&&(z=S.format(m.u,i.ownerName));var G=i.internalPath;G&&(j.internalPath=G);var K=this._identityDataSource.getIdentity(),W=i.ownerCid||K.id,q=this._getNormalizedId(i);j.id=q;var Q="root"===i.id?i.rootResourceId||"root":q,Y=i.resourcePartitionCid||W;j.itemId=Q,void 0!==i.mruId&&(j.mruState={mruId:i.mruId,app:i.mruApp,type:i.mruType}),j.graph={itemId:Q,driveId:Y,driveType:"personal"},j.statistics={views:i.visitorViews},j.eTag=i.eTag,j.isSharerFolder=i.isSharerFolder,j.parentKey=this._getParentKey(i,{requestKeyParams:E});var J=this._getVirtualItemType(i);j.virtualItemType=J;var X=this._isPhotosRoot(i,{requestKeyParams:E}),Z=this._isPhotosSubRoot(i,{requestKeyParams:E,isPhotosRoot:X}),$=this._getIsRootFolder(i,{isPhotosSubRoot:Z});j.isRootFolder=$;var ee=i.name,te="";j.comments={count:i.commentCount||0,settings:{isCommentDisabled:i.commentSettings&&i.commentSettings.commentingDisabled&&!!i.commentSettings.commentingDisabled.isDisabled}},y||(j.isStub=i.isPlaceholder);var ne=i.iconType?D.e[i.iconType.toLowerCase()]:"";j.appMap=ne;var ae=this._getItemType(i,ne),ie=i.extension||"";j.extension=ie,j.size=Number(i.size);var re,oe=i.sharingLevelValue;j.sharingType=oe,j.isBundle=!!i.isBundle,j.locations=i.locations,j.creatorName=i.creatorName,j.caption=i.caption||"",j.itemFromServer=i,(i.photo||i.video||i.isAlbum)&&(re=i.tags||[]),j.tags=re,j.ocr=i.ocr,j.urls=i.urls;var se=i.userRole in B?B[i.userRole]:r.e.None;"MountPoint"===i.groupFolderType&&(se=r.e.Edit,j.mountPoint={}),j.vault=i.vault;var ce=i.vault;ce&&ce.root&&this.resources.consumeAsync(f.e).then(function(e){e.setVaultLockState(ce)}),j.defaultSubText=this._getDefaultSubText(se,oe,i.sharingLevel),j.location=z,j.ownerId=W,j.ownerName=i.ownerName||"",j.uploadOwnerId=Y,j.specialFolderCanonicalName=i.specialFolderCanonicalName||"",j.isSpecialFolder=!!i.isSpecialFolder;var de={};if($&&(g.t.areCidsEqual(j.ownerId,g.t.viewerId)?(ee=this._getRootItemTitle(F),se=r.e.Owner):ee=m.l,c&&(j.taskStatus={restoreAllCount:c.restoreAllWorkItemCount,deleteAllCount:c.deleteAllWorkItemCount})),c&&(j.tokenNeedsRedeeming=c.tokenNeedsRedeeming,j.tokenType=c.tokenType),N&&K.type===R.e.anonymous&&(j.tokenNeedsRedeeming=!0),i.settings&&(de.allPhotosFolderId=i.settings.allPhotosFolderId,de.allPhotosSortAscending=i.settings.allPhotosSortAscending),i.displayQuotaExceeded&&(de.quota={display:{exceeded:i.displayQuotaExceeded,remaining:i.displayQuotaRemaining,total:i.displayQuotaTotal,used:i.displayQuotaUsed,size:i.displaySize},exceeded:i.quotaExceeded,remaining:i.quotaRemaining,status:i.quotaStatus,total:i.quotaTotal}),de.ghostId=i.ghostId,i.thumbnailSet){j.thumbnail=this._thumbnailProcessor.processThumbnailSet(i.thumbnailSet,i);var le=this._thumbnailProcessor.getProcessFiltersUrl(i.thumbnailSet,i);le&&(j.processFilters={thumbnailUrl:le})}var ue=i.folder;if(ue){var fe=[];j.folder={childCount:ue.childCount,documentCount:ue.documentCount,folderCount:ue.folderCount,photoCount:ue.photoCount,totalCount:ue.totalCount,covers:fe};var pe=ue.covers;if(pe)for(var me=0,_e=pe;me<_e.length;me++){var he=_e[me],be=this._thumbnailProcessor.processThumbnailSet(he,i);be&&fe.push(be)}}var ge,ve=i.photo;ve&&(ge={width:ve.width,height:ve.height,cameraMake:ve.cameraMake,cameraModel:ve.cameraModel,exposureNumerator:ve.exposureNumerator,exposureDenominator:ve.exposureDenominator,focalLength:ve.focalLength,focalRatio:ve.focalRatio,iso:ve.iso,originalUrl:i.urls[d.t[d.t.open]],displayDateTaken:ve.displayDateTaken,dateTaken:ve.dateTaken,quality:M.e.optional(ve.quality?{isBad:ve.quality.isBad}:void 0),isLivePhoto:M.e.optional(ve.isLivePhoto),isSamsungMotionPhoto:M.e.optional(ve.isSamsungMotionPhoto)}),j.photo=ge,(null==ve?void 0:ve.isLivePhoto)&&Object(O.isFeatureEnabled)(O.EnableLivePhotoVideos)?j.video=Object(a.__assign)(Object(a.__assign)({},function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:u.e.AppleLivePhoto}}(ve)),i.video):(null==ve?void 0:ve.isSamsungMotionPhoto)&&Object(O.isFeatureEnabled)(O.EnableSamsungMotionPhotoVideos)?j.video=Object(a.__assign)(Object(a.__assign)({},function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:u.e.SamsungMotionPhoto}}(ve)),i.video):j.video=i.video,j.audio=i.audio,j.panorama=i.panorama,j.geoLocation=i.location;var ye=i.textEditorMimeType;j.textEditorMimeType=ye;var Se=!!i.isAlbum;j.isAlbum=Se;var De,Ie=i.photo||i.video,xe=H(i.dateModifiedOnClient),Ce=H(i.creationDate),Oe=H(i.lastAccess),we=H(i.dateShared),Ee=H(i.dateDeleted),Ae=H(i.dateExpires),Le=Ie&&H(Ie.dateTaken),ke=i.displayModifiedDate,Me=i.displayCreationDate,Pe=i.displayLastAccess,Te=i.displayDateShared,Ue=i.displayDateDeleted,Fe=i.displayExpiryDate;try{xe&&(ke=Object(A.i)(xe)),Ce&&(Me=Object(A.d)(Ce)),Oe&&(Pe=Object(A.d)(Oe)),we&&(Te=Object(A.d)(we)),Ee&&(Ue=Object(A.d)(Ee)),Ae&&(Fe=Object(A.d)(Ae)),Le&&(De=Object(A.i)(Le,!1,!1,!0))}catch(e){}j.dateModifiedValue=i.dateModifiedOnClient,j.dateModifiedTime=j.vault&&j.vault.root?"":xe,j.dateCreatedTime=Ce,j.dateAccessedTime=Oe,j.dateSharedTime=we,j.dateDeletedTime=Ee,j.dateExpiresTime=Ae,j.dateModified=j.vault&&j.vault.root?j.vault.isLocked?" ":"Unlocked":ke,j.dateCreated=Me,j.dateAccessed=Pe,j.dateShared=Te,j.dateDeleted=Ue,j.dateExpires=Fe,Ie&&(j.dateTakenTime=M.e.optional(Le),j.dateTaken=M.e.optional(De)),j.itemFromServer=i,j.lifeCycleStatus=M.e.optional(this._getItemLifeCycleStatus(j));var He={},Re={};if(i.isAlbumRoot&&(Re[v.g]=!0,Re[v.H]=!0,Re[v.k]=!0),(null==ve?void 0:ve.isLivePhoto)&&Object(O.isFeatureEnabled)(O.EnableLivePhotoVideos)&&(Re[v.r]=!0,Re[v.F]=!0,Re[v.j]=!0,He[v.t]="1"),(ve||i.video)&&(He[v.a]="1"),ve&&!Object(T.t)(j.extension)&&(Re[v.F]=!0),i.commands)for(var Ne=i.commands.split(","),Be=0;Be<Ne.length;Be+=2)Ne[Be]in Re||(He[Ne[Be]]=Ne[Be+1]);else"root"===j.id&&Object(b.e)(P)&&(He[v.h]="1");i.audio&&(delete He[v.C],He[v.h]="1");var je,Ve,ze,Ge=!!He[v.P];if(j.isViolation=Ge,j.queryType=P,j.displayType=!ue||1!==ue.category||P===h.e.Files&&$?P:h.e.Photos,j.queryType===h.e.Recent&&$&&(He[v.h]="1"),ae===s.e.Folder&&!j.isStub)switch(se){case r.e.Owner:case r.e.CoOwner:case r.e.Edit:ze=j.queryType===h.e.Files||j.queryType===h.e.SharedWithMe&&!$;break;default:ze=!1}if(j.sharingRole=se,j.isDropEnabled=ze,j.iconName=I.a({type:ae,extension:ie,sharingType:oe,textEditorMimeType:ye}),j.iconName=this._isFluidFile(i)?"fluid":j.iconName,j.documentFormat=i.docFormat||0,J===o.e.AlbumRoot&&(ee=l.e),G&&(te=x.t.isRightToLeft?G.slice(0).reverse().join(" < "):G.join(" > ")),C||(j.isPlaceholder=!1),j.isDraggable=j.queryType===h.e.Files&&!j.mountPoint,ue){j.childCount=i.estimatedResultCount||ue.totalCount,j.category=ue.category,je=[],ue.itemGroupings&&(Ve=ue.itemGroupings.map(function(e){var n=e.itemGroups,i=Object(a.__rest)(e,["itemGroups"]);return Object(a.__assign)(Object(a.__assign)({},i),{itemGroups:n.map(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{state:t.observables.create({isCollapsed:!1})})})})}));var Ke={};if(ue.children&&!_)for(var We=0,qe=ue.children;We<qe.length;We++){var Qe=qe[We],Ye=this.processItemResult({observer:w,requestKey:n,itemFromServer:Qe,queryType:P,requestMetadata:c,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;je.push(Ye),Ke[Ye.key]={newTag:this.getNewTagIfExists(Qe),autoAlbumTag:this.getAutoAlbumTagIfExists(Qe)}}if(J===o.e.AlbumRoot){for(var Je={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Xe=[],Ze=0,$e=[],et=Math.max(3,10-je.length),tt=0,nt=je;tt<nt.length;tt++){var at=nt[tt],it=Ke[at.key];it&&it.newTag&&it.autoAlbumTag&&++Ze>et?(Xe.push(at),Je.count++):$e.push(at)}Je.startIndex=$e.length,je=$e.concat(Xe);var rt={name:"newAutoAlbumsGrouping",itemGroups:[Je]};Ve.push(rt)}}else i.name&&this._isFluidFile(i)?j.openUrl=this._generateOpenUrlForFluidFile(i.name,Y,Q):i.urls&&(i.urls.oneNoteWeb?j.openUrl=i.urls.oneNoteWeb:j.openUrl=i.urls.viewInBrowser);var ot=ie&&ie.toLowerCase(),st=ot&&ot.slice(1);(".pdf"===ot||".ai"===ot&&He[v.g])&&(He[v.h]="1",j.openUrl=this._urlDataSource.getDownloadItemUrl({key:F,id:Q,ownerId:W,extension:ie},FilesConfig.canary,!0),Object(O.isFeatureEnabled)(O.UseWebPdfViewer)&&(ae=s.e.Media));var ct,dt,lt="".concat(g.t.getVroomBaseUrl({apiVersion:"v1.0",driveId:Y}),"/drives/").concat(Y,"/items/").concat(Q);!Object(O.isFeatureEnabled)(O.EnableZipFilePreviewing)||".zip"!==ot&&".rar"!==ot||(He[v.h]="1",ae=s.e.Media,j.zip=M.e.optional((ct=st,(dt=lt)?{downloadZipContentsUrl:Object(U.t)("zipcontent",ct,dt),zipMetaDataUrl:Object(U.t)("zipmetadata",ct,dt)}:void 0)));var ut=Object(U.e)(st,lt);ut&&(ae=s.e.Media,j.model3d=ut,He[v.h]="1"),j.type=ae,j.thumbnail&&"4"===He[v.h]&&(He[v.h]="1"),!y&&i.isPlaceholder&&(He[v.h]="1"),"allmyphotos"===E.qt&&j.id===E.id&&(He[v.h]="1",ee="");var ft=ue?ue.childCount:0;j.name=ee,j.displayName=te||"".concat(ee).concat(ie),i.estimatedResultCount&&(ft=je.length+(i.folder&&i.folder.startIndex||0)),i.isRecycled&&i.folder&&!ft&&(ft=je.length,j.childCount=ft),de.newTag=this.getNewTagIfExists({tags:re}),de.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:Se,tags:re});var pt=[F];p&&n&&pt.push(n),e.keyAlias&&pt.push(e.keyAlias);var mt=!0;"allmyphotos"===E.qt&&j.id===E.id&&(mt=!1),de.commandsSupported=M.e.replace(He),j.properties=de;for(var _t=0,ht=Object(k.e)(pt);_t<ht.length;_t++){var bt=ht[_t];w.update([new M.t(bt).succeed({item:mt?j:{key:F}})])}var gt=i.hasMoreResults?""+i.estimatedResultCount:"";return"search"===E.qt&&i.folder&&i.folder.pagingToken&&(gt=i.folder.pagingToken),i.isRecycled&&i.folder&&i.folder.hasMoreRecycledItems&&(gt=i.folder.pagingToken),{item:{key:F},children:je,groupings:Ve,totalChildren:ft,nextRequestToken:gt}}},t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];if(r.tag===L.e){t=r;break}}return t},t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.tag===L.n){n=r;break}}return n},t.prototype.getItemKey=function(e){var t,n,i,r,o,s=e.itemFromServer,c=e.requestKey,d=this._urlDataSource.getKeyParams(c);if(s.isAlbumRoot)o=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=d.tagFilter,t));else if(s.isTagsRoot)o=this._urlDataSource.getKey(((n={}).id="tags",n));else{var l=this._getItemKeyExtension(s,c),u=s.ownerCid,f=s.internalPath,p=void 0===f?[]:f,m=this._getNormalizedId(s),_=this._urlDataSource.isCurrentQuery(h.e.SharedWithMe,d);_&&s.ownerDCid===j&&s.ownerCid===V&&(m=j,u=V),o=this._urlDataSource.getKey(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},l),((i={}).id=m,i.cid=u,i.internalPath=p.join(","),i)),Object(O.isFeatureEnabled)(O.AttachGroupIdToSharedByKey)&&_&&s.groupId?((r={}).u="group_".concat(s.groupId),r):{}))}return o},t.prototype._generateOpenUrlForFluidFile=function(e,t,n){var a=Object(O.isFeatureEnabled)(O.UseFluidDevPreview)?"https://dev.fluidpreview.office.net/p":"https://fluidpreview.office.net/p",i=encodeURIComponent(btoa("spo:https://api.onedrive.com")),r=encodeURIComponent(e),o=encodeURIComponent(t),s=encodeURIComponent(n);return"".concat(a,"/").concat(i,"/").concat(o,"/").concat(s,"/").concat(r)},t.prototype._getDefaultSubText=function(e,t,n){var a;switch(e){case r.e.Owner:a=t===c.e.Private?"":p.p;break;case r.e.View:a=p.t;break;case r.e.Edit:case r.e.CoOwner:a=p.e;break;default:a=""}return a},t.prototype._getItemType=function(e,t){return e.isPlaceholder?s.e.Folder:17===e.itemType?s.e.OneNote:e.folder?s.e.Folder:e.video||e.photo||e.audio?s.e.Media:t||this._isTextEditorFile(e)||this._isFluidFile(e)?s.e.File:e.thumbnailSet?s.e.Media:s.e.File},t.prototype._isFluidFile=function(e){return!!e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase())},t.prototype._isTextEditorFile=function(e){return Object(P.t)(e.extension||"")},t.prototype._getItemKeyExtension=function(e,t){var n,a=this._urlDataSource.getKeyParams(t);return a.id===e.id?a:e.folder?((n={}).ft=a.ft,n.ext=a.ext,n):{}},t.prototype._getRootItemTitle=function(e){return _.e},t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id},t.prototype._getParentKey=function(e,t){var n,a,i=t.requestKeyParams;return e.isRecycled&&"root"!==e.id?a=this._urlDataSource.getRootItemKey(h.e.RecycleBin):e.isSharerFolder?a=this._urlDataSource.getRootItemKey(h.e.SharedWithMe):e.isAlbumRoot?a=void 0:e.parentId&&(a=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n))),a},t.prototype._getVirtualItemType=function(e){var t;return e.isAlbumRoot?t=o.e.AlbumRoot:e.isAlbum?t=o.e.Album:e.isTagsRoot&&(t=o.e.TagsRoot),t},t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n},t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id},t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)},t.prototype._getItemLifeCycleStatus=function(e){var t={};return this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0),t},t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5},t}(i.n);t.e=z}],Array(118),[function(e,t,n){"use strict";n.r(t);var a=n(0),i=n(491),r=n(3253),o=n(144),s=n(1912),c=n(43),d=n(2174),l=n(75),u=n(599),f=n(2030),p=n(3301),m=!n(8).e.isActivated("AEE5FDF9-6C87-43D2-A3AB-A536B277B50D","08/22/2022","Workaround to fix issue causing KO RB to show incorrect default sort used in UX"),_=c.e[c.e.RecycleBin].toLowerCase(),h=function(e){function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(c.e.RecycleBin),a=t.getRootItemTitle(n),i=new(t.resources.consume(f.a));return i.update([new f.t(n).succeed({item:{key:n,type:o.e.Folder,id:t._getRootFileId(),queryType:c.e.RecycleBin,displayType:c.e.RecycleBin,name:a,displayName:a}})]),i.flush(),t}return Object(a.__extends)(t,e),t.prototype.getItem=function(t){var n=this;return!m||t.sortField||t.isAscending||(t.sortField=p.e[p.e.dateDeleted],t.isAscending=!1),e.prototype.getItem.call(this,t).then(function(e){return l.n.wrap(e)},function(a){return 9017===a.errorCode?(n.isLargeRecycleBin(!0),e.prototype.getItem.call(n,t)):l.n.wrapError(a)})},t.prototype.emptyRecycleBin=function(e,t){return t&&this.isLargeRecycleBin(!0),this._deleteNextBatch(e,t)},t.prototype.emptyRecycleBinAsync=function(){return this._deleteAll()},t.prototype.getRootItemTitle=function(e){return i.s},t.prototype._getItemKeyExtension=function(t,n){var a;return t.id!==this._getRootFileId()?((a={}).u=_,a):e.prototype._getItemKeyExtension.call(this,t,n)},t.prototype._deleteAll=function(){var e=s.t.skyApiBaseUrl+"DeleteAll";return(new u.e).sendPost("DeleteAll",e,"")},t.prototype._deleteNextBatch=function(t,n){var a=this,i=this._urlDataSource.getRootItemKey(c.e.RecycleBin);return e.prototype.getItem.call(this,{parentKey:i,startIndex:0,pageSize:100}).then(function(r){if(r.children&&r.children.length)return e.prototype.deleteItems.call(a,{parentKey:i,deletionType:d.e.PermanantDelete,items:r.children}).then(function(){if(r.nextRequestToken||n)return t(t()+r.children.length),a._deleteNextBatch(t,n)})})},t}(r.e);t.default=h},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return d});var a=n(0),i=n(75),r=n(135),o=n(1903),s=n(76),c=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor}return e.prototype.requestReview=function(e){return Object(a.__awaiter)(this,void 0,i.n,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.item,[4,this.getRequestAppealUrl(t)];case 1:return(n=a.sent())?[2,this._vroomDataRequestor.send({apiName:"VroomRequestReview",path:n,useAuthorizationHeaders:!0,requestType:"POST"})]:[2,i.n.wrapError(new Error("invalid url"))]}})})},e.prototype.getRequestAppealUrl=function(e){var t,n,i,r;return Object(a.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=null===(t=e.properties)||void 0===t?void 0:t.siteUrl,s=null===(n=e.properties)||void 0===n?void 0:n.siteId,c=null===(i=e.properties)||void 0===i?void 0:i.listId,d=null===(r=e.properties)||void 0===r?void 0:r.ID,o&&s&&c&&d?[2,"".concat(o,"/_api/v2.1/sites/").concat(s,"/lists/").concat(c,"/items/").concat(d,"/appeal")]:[3,1];case 1:return e.graph?[4,this.getSharepointIds(e.graph.itemId)]:[3,3];case 2:return l=a.sent().sharepointIds,u=l.siteUrl,f=l.siteId,p=l.listId,m=l.listItemId,[2,"".concat(u,"/_api/v2.1/sites/").concat(f,"/lists/").concat(p,"/items/").concat(m,"/appeal")];case 3:return[2,void 0]}})})},e.prototype.getSharepointIds=function(e){return e?this._vroomDataRequestor.send({apiName:"getSharepointIds",path:"".concat(this._getSharepointIdsEndpoint("v2.1",e)),useAuthorizationHeaders:!0}):i.n.wrapError(new Error("invalid itemId"))},e.prototype._getSharepointIdsEndpoint=function(e,t){return void 0===e&&(e="v2.0"),"".concat(Object(s.a)(e),"/drives/").concat(s.l,"/items/").concat(t,"?select=sharepointIds")},e.dependencies={vroomDataRequestor:o.e},e}();t.default=c;var d=Object(r.r)("RequestReviewVroomDataSource",c,{vroomDataRequestor:o.e})}],Array(35),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return x});var a=n(0),i=n(380),r=n(82),o=n(75),s=n(135),c=n(1903),d=n(213),l=n(13),u=n(139),f=n(10),p=n(25),m=n(77),_=n(405),h=n(97),b=n(8),g=n(73),v=n(95),y=!b.e.isActivated("75843FC5-8F0A-4925-BB0B-AA5FCE46444C","02/07/2022","Enable various thumbnail fixes in ItemResultProcessor and addon-graph ItemThumbnailControl"),S=!b.e.isActivated("13F88196-AC5C-4718-8E30-A5727F39F771","01/20/2023","Enables AV override on file downloads for item owners"),D=!b.e.isActivated("73B93157-173C-420F-BB13-90D17CC4B6C8","02/23/2023","Enables anonymous cob user to download file shared via anyone link"),I=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._navigation=t.navigation,this._urlCache=new Map,this._vroomDataRequestor=t.vroomDataRequestor,this._urlDataSource=t.urlDataSource}return e.prototype.getDownloadUrl=function(e,t){var n=this;void 0===t&&(t={});var i=this._urlCache;if(!t.forceRefresh){var r=i.get(e.key)||{},s=r.url,c=r.time;if(s&&c<Date.now()-27e5)return o.n.wrap(s)}var l=this._isCobAnonUser(e),u=this._getAuthKey(),f=this.getItemUrl(e,t),p=t.headers||{};if(u||l){var m=d.get("BadgerAuth");m&&(p=Object(a.__assign)(Object(a.__assign)({},p),{Authorization:"Badger "+m}))}var _="itemDownloadUrl";return t.apiName&&(_="".concat(t.apiName,".").concat(_)),this._vroomDataRequestor.send({apiName:_,path:"".concat(f,"?select=id,@content.downloadUrl").concat(u?"&".concat("authkey","=").concat(u):""),needsAuthorization:!u&&!l,headers:p,qosExtraData:t.qosExtraData,useAuthorizationHeaders:!b.e.isActivated("BCFD327B-F553-4D0D-95B2-2A813398A3B0","10/21/2021","Use auth header in single-file download")}).then(function(t){var a,r,o=t["@content.downloadUrl"];if(!o)throw new h.e({code:"NoDownloadUrl",message:"Vroom response did not contain download URL"});if(S){var s=null===(a=n._urlDataSource.getOwnerId(void 0,{}))||void 0===a?void 0:a.toLowerCase(),c=null===(r=n._urlDataSource.getOwnerId(e.key))||void 0===r?void 0:r.toLowerCase();if(s&&s===c){var d=new g.t(o);d.setQueryParameter("AVOverride","1"),o=d.toString()}}return i.set(e.key,{url:o,time:Date.now()}),o})},e.prototype.getDownloadUrlSync=function(e,t){var n=this.getItemUrl(e,t),a=this._getAuthKey();return n&&a?"".concat(n,"/content?authkey=").concat(a):void 0},e.prototype.getAuthenticationParams=function(e){var t,n=this._getAuthKey();return n?o.n.resolve(((t={}).authkey=n,t)):this._identityDataSource.getSessionToken().then(function(e){var t=e.accessToken,n=e.proofToken,a={};return t&&(a.access_token=decodeURIComponent(t)),n&&(a.prooftoken=decodeURIComponent(n)),a})},e.prototype.getDriveUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0!==n&&n,i=t.apiVersion,r=void 0===i?"v1.0":i,o=this._getGraphFacet(e);return this._getDriveUrl(o,a,r)},e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,a=void 0!==n&&n,i=t.isPath,r=void 0!==i&&i,o=t.apiVersion,s=void 0===o?"v1.0":o,c=this._getGraphFacet(e),d=this._getDriveUrl(c,a,s);return"".concat(d,"/items/").concat(encodeURIComponent(c.itemId)).concat(r?":":"")},e.prototype.getAccessToken=function(e){},e.prototype.refreshAccessToken=function(e,t){return void 0===t&&(t={}),y?this._identityDataSource.getSessionToken():o.n.resolve(void 0)},e.prototype._isCobAnonUser=function(e){return D&&e.ownerId&&Object(v.e)(e.ownerId)&&this._identityDataSource.getIdentity().type===i.e.anonymous},e.prototype._getAuthKey=function(){return this._identityDataSource.getIdentity().type===i.e.anonymous&&this._navigation.viewParams.authkey},e.prototype._getGraphFacet=function(e){var t=e.graph;if(t)return t;var n=Object(f.S)(e.key);return{itemId:n.id,driveId:n.cid}},e.prototype._getDriveUrl=function(e,t,n){var a=t?Object(p.f)({apiVersion:n,driveId:e.driveId}):Object(l.isFeatureEnabled)(l.PreferGraphV1API)||!Object(l.isFeatureEnabled)(l.UseNewShareDialog)||Object(u.e)()&&!Object(l.isFeatureEnabled)(l.UseNewShareDialogForWinApp)?"https://graph.microsoft.com/v1.0":"https://graph.microsoft.com/beta";return"".concat(a,"/drives/").concat(encodeURIComponent(e.driveId))},e.dependencies={identityDataSource:m.D,navigation:r.e,vroomDataRequestor:c.e,urlDataSource:_.n},e}();t.default=I;var x=Object(s.r)("GraphDataSource",I)}],Array(344),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return A});var a=n(0),i=n(82),r=n(7),o=n(135),s=n(3861),c=n(33),d=n(489),l=n(403),u=n(3009),f=n(77),p=n(106),m=n(855),_=n(1);function h(e){return{id:"suggestionClickUpdater",groupUpdaters:b(e)}}function b(e){return[{groupId:"file",createUpdater:g(e)},{groupId:"history",createUpdater:g(e)},{groupId:"tag",createUpdater:g(e)}]}function g(e){return function(){return{component:function(t){return function(n){return _.createElement(t,Object(a.__assign)(Object(a.__assign)({},n),{onClick:function(t){if(n.onClick&&n.onClick(t),"OfficeDocument"!==n.fileType&&(t.preventDefault(),t.stopPropagation(),n.url)){var a=n.url.indexOf("?")>0?n.url.substring(n.url.indexOf("?")+1):void 0,i=a?"#".concat(a):n.url;e.navigation.navigateTo({url:i})}}}))}}}}}var v=n(10),y=n(148),S=n(3),D=n(95),I=n(1872);function x(e){return[{groupId:"file",createUpdater:C(e)}]}function C(e){return function(){return{component:function(t){return function(n){return _.createElement(t,Object(a.__assign)(Object(a.__assign)({},n),{url:O(n),onClick:function(t){if(n.onClick&&n.onClick(t),!w(n.fileExtension)&&(t.preventDefault(),t.stopPropagation(),n.uniqueId)){var a=O(n),i=a.indexOf("?")>0?a.substring(a.indexOf("?")+1):void 0,r=i?"#".concat(i):a;e.navigation.navigateTo({url:r})}}}))}}}}}function O(e){if(e.uniqueId){var t=e.uniqueId.replace(/-/g,"");return w(e.fileExtension)?"https://onedrive.live.com/edit.aspx?resid=".concat(v.W,"!s").concat(t,"&cid=").concat(v.W):"https://onedrive.live.com/?id=".concat(t,"&cid=").concat(v.W)}return e.url}function w(e){return!!e&&!!Object(I.s)(e.toLowerCase())}var E=function(){function e(e,t){this._deps=t}return e.prototype.getSuiteNavProviderKey=function(){return Object(S.cs)(S.Eo)?p.x:u.e},e.prototype.getTokenProviders=function(){return this._deps.searchBoxConfig.getTokenProviders()},e.prototype.getProviderConfigUpdaters=function(){return Object(S.cs)(S.Zr)&&Object(D.e)(v.W)?[(e=this._deps,{id:"3sSuggestionClickUpdater",groupUpdaters:x(e)})]:[h(this._deps)];var e},e.prototype.onSubmitSearchCallback=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this._deps.instrumentationProvider.logStartSearchOnSubmit(),this._deps.engagement.logData({name:"Upscope.Search.Click",isIntentional:!0}),Object(S.cs)(S.Eo)?[4,this._deps.resources.consumeAsync(y.e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,this._deps.resources.consumeAsync(f.oe).then(function(t){t.upscopeSearch({query:e})})];case 3:return t.sent(),[2]}})})},e.prototype.getSearchInstrumenterProps=function(){return{bingConsumerApiContext:{appId:s.e,viewerId:v.W,fromPhotos:Object(v.O)(this._deps.navigation.viewParams)===c.e.Photos}}},e.prototype.isSearchResultsPage=function(){return Object(d.e)(Object(v.L)(this._deps.navigation.viewParams))},e.dependencies={searchBoxConfig:m.e,instrumentationProvider:p.o,engagement:l.e,navigation:i.e,resources:r.r},e}(),A=(t.default=E,Object(o.r)("ODCSearchBoxDataSource",E))}],Array(105),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return x});var a=n(0),i=n(494),r=n(7),o=n(22),s=n(381),c=n(2030),d=n(77),l=n(46),u=n(1050),f=n(180),p=n(235),m=n(1571),_=n(204),h=n(6),b=n(115),g=n(194),v=n(450),y=n(97),S=n(16),D=n(3476),I=S.e.isActivated("6980AF2E-8FE7-4292-ACFB-B04FFCFF2289","11/12/2020","Assign errors per-item for KO mapping"),x=new r.t({name:"KnockoutStoreGetItemsOperationHandler",factory:{dependencies:{urlDataSource:d.Se,itemTaskObserverType:c.a},create:function(e){var t=e.urlDataSource,n=e.itemTaskObserverType;return{instance:Object(o.i)({maxParallelOperationCount:30,mergeForSameItemKey:!0})(function(e){var r=this,o=i.n.deserialize(e.itemKey).itemKey;return function(d){return Object(a.__awaiter)(r,void 0,void 0,function(){var r,S,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j;return Object(a.__generator)(this,function(V){switch(V.label){case 0:if(!(r=d(Object(f.e)(function(e){return e.demandItemFacet(p.t,o)}))))return[3,5];S=r.key,x=t.getKeyParams(S),C=t.getQueryType(x),(O=new n).update([new c.t(S).succeed({item:{key:S,queryType:C}})]),V.label=1;case 1:return V.trys.push([1,3,,4]),[4,d(Object(u.e)(function(e){return e.demandItemFacet(m.oneDriveItemFacet,o)}))];case 2:return w=V.sent(),O.update([new c.t(S).succeed({item:w})]),[3,4];case 3:return E=V.sent(),I&&(L=v.e.requestFailed,k="",M="",E instanceof Error&&(M=E.message),E instanceof y.e&&(k=E.code),E instanceof s.e&&(g.p.unpack(E.facets)||g.e.unpack(E.facets)?L=v.e.accessDenied:g.a.unpack(E.facets)&&(L=v.e.authenticationExpired)),O.update([new c.t(S).succeed({item:{error:{type:L,data:{errorCode:k,errorTitle:M}}}})])),[3,4];case 4:I||(A=d(Object(f.e)(function(e){return e.demandItemFacet(b.t,o)})))&&(L=v.e.requestFailed,k="",M="",A instanceof Error&&(M=A.message),A instanceof y.e&&(k=A.code),A instanceof s.e&&(g.p.unpack(A.facets)||g.e.unpack(A.facets)?L=v.e.accessDenied:g.a.unpack(A.facets)&&(L=v.e.authenticationExpired)),O.update([new c.t(S).succeed({item:{error:{type:L,data:{errorCode:k,errorTitle:M}}}})])),O.flush(),V.label=5;case 5:if((P=new l.e).resolveItems({items:Object(a.__assign)(Object(a.__assign)({},o?(N={},N[o]=Object(a.__assign)({},Object(_.e)().forFacet(h.f).thenInvalidate(e.itemKey,i.e).pack()),N):{}),(B={},B[e.itemKey]=Object(a.__assign)({},i.e.pack(void 0)),B))}),o&&(T=d(Object(D.t)({itemKey:o}))))for(U=Object.keys(T),F=0,H=U;F<H.length;F++)(R=H[F])!==o&&P.mapKeys({mappings:(j={},j[e.itemKey]=i.n.serialize({itemKey:R}),j)});return d(P.execute()),[2]}})})}})}}}})},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"RestoreOperationDataSource",function(){return d}),n.d(t,"resourceKey",function(){return l});var a=n(193),i=n(135),r=n(77),o=n(1903),s=n(3312),c=n(3864),d=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._urlDataSourceLite=t.urlDataSourceLite}return e.prototype.shouldMonitorProgressForItemSetKey=function(e){return!0},e.prototype.getOngoingRestoreOperation=function(e){return e&&(e.headers=this._addRequestFactsHeader(e.headers)),this._dataRequestor.send({apiName:"Operations",headers:e&&e.headers,path:"".concat(this._urlDataSourceLite.getApiBaseUrl({apiVersion:"v1.0",driveId:"me"}),"/drive/operations?$filter=type eq 'pointInTimeRestore'&$orderby=createdDateTime desc&$top=1")}).then(function(e){var t=e.value;if(0!==t.length)return{percentComplete:t[0].percentComplete,status:{cancelled:s.e.Cancelled,completed:s.e.Completed,failed:s.e.Failed,notstarted:s.e.NotStarted,inprogress:s.e.InProgress}[t[0].status.toLowerCase()]}},function(e){if(!Object(a.r)(e)||404!==e.status)throw e})},e.prototype.submitRestore=function(e){e.headers=this._addRequestFactsHeader(e&&e.headers);var t=JSON.stringify({anomalyId:e.anomalyId,restoreToDateTime:e.dateTime,mostRecentActivityId:e.mostRecentActivityId});return this._dataRequestor.send({apiName:"RestoreToDate",requestType:"POST",headers:e&&e.headers,path:"".concat(this._urlDataSourceLite.getApiBaseUrl({apiVersion:"v1.0",driveId:"me"}),"/drive/root/oneDrive.restoreToDate"),postData:t,parseResponse:function(e){return{id:JSON.parse(e.responseText).id,resourceLocation:e.getResponseHeader("Location")}}})},e.prototype.isOneDrive=function(){return!0},e.prototype.getQosPrefix=function(){return""},e.prototype._addRequestFactsHeader=function(e){return Object(c.e)(e)},e.dependencies={vroomDataRequestor:o.e,urlDataSourceLite:r.De},e}(),l=Object(i.r)("RestoreOperationDataSource",d)},,function(e,t,n){"use strict";n.r(t),n.d(t,"DefaultClickAction",function(){return r});var a=n(321),i=n(32),r=Object(a.e)(function(e,t){var n=e.consume(i.e).DefaultClickAction;return new(e.injected(n,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})}],Array(55),[function(e,t,n){"use strict";n.r(t),n.d(t,"RestoreProgressMonitor",function(){return l});var a=n(0),i=n(1),r=n(44),o=n(83),s=n(146),c=n(4167),d=n(265),l=i.memo(function(e){var t=Object(r.n)(),n=Object(s.i)(function(e){return Object(o.e)(e)},[]);return i.useEffect(function(){Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=c.e,[4,t.consume(d.e.optional).waitForPLT()];case 1:return a.sent(),t.consumeAsync(e).then(function(e){e.monitorRestoreProgress({itemsScopeCurrentItemSetKey:n,showProgressInItemsView:!0})}),[2]}})})},[t,n]),null})},,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"ItemIdentityProcessor",function(){return c}),n.d(t,"resourceKey",function(){return d});var a=n(2030),i=n(135),r=n(77),o=n(1850),s="/root:",c=function(){function e(e,t){var n=t.urlDataSource;this._urlDataSource=n}return e.prototype.processIdentity=function(e){var t,n,i,r,c=e.itemFromServer,d=e.observer,l=c.parentReference,u=c.id,f=c.root?"root":u,p=this._urlDataSource.getKey(((t={}).id=f,t));if(l&&l.id){var m=l.id,_=l.path;i=this._urlDataSource.getKey(((n={}).id=(r=_)&&r.lastIndexOf(s)===r.length-s.length?"root":m,n))}return d.update([new a.t(p).succeed({item:{key:p,id:f,parentKey:o.optional(i)}})]),{key:p}},e.dependencies={urlDataSource:r.Se},e}(),d=Object(i.r)("ItemIdentityProcessor",c);t.default=c},,function(e,t,n){"use strict";n.r(t),n.d(t,"RansomwareDetectionDataSource",function(){return _}),n.d(t,"resourceKey",function(){return g});var a=n(103),i=n(75),r=n(7),o=n(135),s=n(97),c=n(1903),d=n(2725),l=n(1912),u=n(3926),f=n(77),p=n(95),m=!n(8).e.isActivated("6442EAF5-2637-4F66-9C7D-E202134D95FF","04/07/2023","Uses vroom 2.1 on anomalies calls for migrated users"),_=function(){function e(e,t){this._dataRequestor=t.vroomDataRequestor,this._itemActivitiesResultProcessor=t.itemActivitiesResultProcessor,this._urlDataSource=t.urlDataSource}return e.prototype.getActiveAnomaly=function(e){return this.getAnomalies(e).then(function(e){var t=e.filter(b);return t.length>0?t[0]:null})},e.prototype.getAnomalies=function(e){var t=this,n=Object(a.n)({$expand:{uriValue:encodeURIComponent("activities($top=5;$expand=driveItem;$filter=irreversible eq null)")}}),r=l.t.viewerId,o="/drives/".concat(r,"/anomalies"),c=e?o:"".concat(o,"?").concat(n),d=m&&Object(p.e)(r)?"v2.1":void 0;return this._dataRequestor.send({apiName:"anomalies",expectedErrors:[{code:"ItemNotFound"}],path:c,apiVersion:d}).then(function(e){return e.value}).then(function(e){return e.map(function(e){return{state:h(e),activities:t._parseAnomalyActivities(e),detectedDateTime:e.detectedDateTime,id:e.id,ransomware:e.ransomware}})}).catch(function(e){var t=e&&e.error||e;return"unlockRequired"===(e&&e.response&&e.response.error&&e.response.error.innererror&&e.response.error.innererror.code)?[{state:0,activities:[],detectedDateTime:"",id:"",ransomware:{},unlockRequired:!0}]:t instanceof s.e&&t.code===u.e.unauthUser?[]:i.n.reject(e)})},e.prototype.updateAnomalyState=function(e,t){var n=l.t.viewerId,a=JSON.stringify(function(e){switch(e){case 0:return{};case 1:return{acknowledged:{confirmed:{}}};case 4:return{acknowledged:{dismissed:{}}};case 2:return{repaired:{allDevicesCleaned:{}}};case 3:return{repaired:{allFilesRestored:{}}}}}(t)),i=m&&Object(p.e)(n)?"v2.1":void 0;return this._dataRequestor.send({apiName:"updateRansomwareState",requestType:"PATCH",postData:a,path:"/drives/".concat(n,"/anomalies/").concat(e),apiVersion:i}).then(function(e){return h(e)})},e.prototype._parseAnomalyActivities=function(e){var t=e.activities;return t?this._itemActivitiesResultProcessor.processResponse({item:{name:"root",graphItemUrl:"".concat(this._urlDataSource.getApiBaseUrl({apiVersion:"v1.0",driveId:"me"}),"/drive/root")},response:{value:t}}).activities:[]},e.dependencies={resources:r.r,itemActivitiesResultProcessor:d.e,urlDataSource:f.Se,vroomDataRequestor:c.e},e}();function h(e){var t=0;return e.repaired?e.repaired.allFilesRestored?t=3:e.repaired.allDevicesCleaned&&(t=2):e.acknowledged&&(e.acknowledged.confirmed?t=1:e.acknowledged.dismissed&&(t=4)),t}function b(e){return e.ransomware&&4!==e.state&&3!==e.state}var g=Object(o.r)("RansomwareDetectionDataSource",_)},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return o});var a=n(135),i=n(3930);n.d(t,"CheckUserAccessDataSource",function(){return i.e});var r=n(1903),o=Object(a.r)("CheckUserAccessDataSource",i.e,{vroomDataRequestor:r.e})}],Array(228),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return Br});var a,i,r,o,s=n(27),c=(n(3841),n(7)),d=n(135),l=n(55),u=n(1892),f=n(288),p=n(0),m=n(59),_=n(1156),h=n(332),b=n(14),g=n(94),v=n(2),y=n(74),S=n(541),D=function(e){function t(t,n){var a=e.call(this)||this;return a._paneKey=t,a._isVisible=n,a}return Object(p.__extends)(t,e),t.prototype.apply=function(e){var t=this._paneKey;return this._isVisible?e&&e.paneKey===t?e:{paneKey:t}:e&&e.paneKey&&e.paneKey!==t?e:void 0},t}(y.t),I=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.itemCacheStore.dispatch,r=n.itemCacheObservablesFactory,o=t.paneKey,s=r.pureCompute(function(e){var t=e.demandItemFacet(f.i,b.e);return!!t&&t.paneKey===o});return a.isExpanded=a.observables.compute({read:function(){return s()},write:function(e){var t;i(Object(g.e)({items:(t={},t[b.e]=Object(p.__assign)({},Object(v.n)({currentPane:f.i},{currentPane:new D(o,e)})),t)})),i(Object(S.e)())},pure:!0}),a}return Object(p.__extends)(t,e),t}(m.n),x=(a="IsInfoPaneExpanded",i=f.a,r=Object(d.o)("".concat(a,".paneExpander"),I,{itemCacheObservablesFactory:_.e,itemCacheStore:h.e}),new c.t({name:a,factory:{dependencies:{paneExpanderType:r},create:function(e){var t=new e.paneExpanderType({paneKey:i});return{instance:t.isExpanded,disposable:t}}}})),C=n(3842),O=new c.t({name:"RansomwareDetectionDataSource.key",loader:new d.t(function(){return n.ee(0,4874).then(function(e){return e.resourceKey})})}),w=new c.t({name:"RestoreActivitiesDataSource.key",loader:new d.t(function(){return n.ee([575,"ondemand.resx-ondemand"],5214).then(function(e){return e.resourceKey})})}),E=new c.t({name:"SearchDataSource.key",loader:new d.t(function(){return n.ee([576,"ondemand.resx-ondemand"],4875).then(function(e){return e.resourceKey})})}),A=n(2646),L=new c.t({name:"DownloadDataSource.key",loader:new d.t(function(){return n.ee([591],4876).then(function(e){return e.resourceKey})})}),k=new c.t({name:"DocumentFormatDataSource.key",loader:new d.t(function(){return n.ee([166],4877).then(function(e){return e.resourceKey})})}),M=n(2647),P=new c.t({name:"VaultTeachingBubble.key",loader:new d.t(function(){return n.ee(27,4186).then(function(e){return e.typeResourceKey})})}),T=new c.t({name:"NotificationProvider.key",loader:new d.t(function(){return n.ee([368],5305).then(function(e){return e.resourceKey})})}),U=n(3843),F=new c.t({name:"NotificationsDataSource.key",loader:new d.t(function(){return n.ee([369,"ondemand.resx-ondemand"],5167).then(function(e){return e.resourceKey})})}),H=new c.t({name:"VideoItemDataSource.key",loader:new d.t(function(){return n.ee([180],5306).then(function(e){return e.resourceKey})})}),R=n(82),N=new c.t({name:"PushChannelDataSource.key",loader:new d.t(function(){return n.ee(0,3927).then(function(e){return e.resourceKey})})}),B=n(2533),j=n(2030),V=n(144),z=n(43),G=n(77),K=n(1827),W=n(3844),q=n(491),Q={itemTaskObserverType:j.a,itemsStore:K.e,observablesFactoryType:m.i,rootItemsTypeFilter:W.e.optional,urlDataSource:G.Se},Y=new c.t({name:"".concat("RootItems.key",".rootItems"),factory:{dependencies:Q,create:function(e){var t=e.itemsStore,n=e.rootItemsTypeFilter,a=e.urlDataSource,i=new e.observablesFactoryType,r=new e.itemTaskObserverType,o=a.getKey(Object(p.__assign)(Object(p.__assign)({},a.getKeyParams(a.getRootItemKey(z.e.Files))),a.saveItemTypeFilter(n))),s=a.getKey(Object(p.__assign)(Object(p.__assign)({},a.getKeyParams(a.getRootItemKey(z.e.Recent))),a.saveItemTypeFilter(n))),c=a.getKey(Object(p.__assign)({},a.getKeyParams(a.getRootItemKey(z.e.AllMyPhotos))));return r.update([new j.t(o).succeed({item:{key:o,name:j.e.backup(q.e),displayName:j.e.backup(q.e),type:j.e.backup(V.e.Folder),properties:{commandsSupported:{defc:"1"}}}}),new j.t(s).succeed({item:{key:s,name:j.e.backup(q.o),displayName:j.e.backup(q.o),type:j.e.backup(V.e.Folder),properties:{commandsSupported:{defc:"1"}}}}),new j.t(c).succeed({item:{key:c,name:j.e.backup(q.i),displayName:j.e.backup(q.i),type:j.e.backup(V.e.Folder),displayType:j.e.backup(z.e.AllMyPhotos),properties:{commandsSupported:{defc:"1"}}}})]),r.flush(),{instance:i.create({files:t.getItem(o),recent:t.getItem(s),photos:t.getItem(c)}),disposable:i}}}}),J=new c.t({name:"ItemAutoRefreshDataSource.key",loader:new d.t(function(){return n.ee(0,3928).then(function(e){return e.resourceKey})})}),X=new c.t({name:"ItemAutoRefreshProvider.key",loader:new d.t(function(){return n.ee(0,3929).then(function(e){return e.resourceKey})})}),Z=n(3134),$=n(641),ee=new c.t({name:"MruRecentDataSource.key",loader:new d.t(function(){return n.ee([173],4878).then(function(e){return e.resourceKey})})}),te=new c.t({name:"ItemActivityFeedHelper.key",loader:new d.t(function(){return n.ee([598,"ondemand.resx-ondemand"],5307).then(function(e){return e.resourceKey})})}),ne=new c.t({name:"ItemActivityFeedSharingHelper.key",loader:new d.t(function(){return n.ee(0,5308).then(function(e){return e.resourceKey})})}),ae=new c.t({name:"ItemCommentsDataSource.key",loader:new d.t(function(){return n.ee([569],5194).then(function(e){return e.resourceKey})})}),ie=new c.t({name:"CheckUserAccessDataSource.key",loader:new d.t(function(){return n.ee(0,4879).then(function(e){return e.resourceKey})})}),re=n(3484),oe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.canSaveAsCopy=function(e){return!!e.item},t.prototype.canSaveAsOriginal=function(e){var t=e.item;return!!t&&this.isWebFormat(t)},t.dependencies={},t}(function(){function e(){}return e.prototype.canSave=function(e){return this.canSaveAsCopy(e)||this.canSaveAsOriginal(e)},e.prototype.isWebFormat=function(e){var t,n=null===(t=null==e?void 0:e.extension)||void 0===t?void 0:t.toLowerCase();return n&&(".png"===n||".jpeg"===n||".jpg"===n)},e}()),se=Object(d.r)("ImageEditorDataSource",oe),ce=new c.t({name:"ProfileChangeHandler.key",loader:new d.t(function(){return n.ee(0,3931).then(function(e){return e.resourceKey})})}),de=n(3002),le=new c.t({name:"InfoPaneManager.key",loader:new d.t(function(){return n.ee([597,"ondemand.resx-ondemand"],5146).then(function(e){return e.typeResourceKey})})}),ue=n(106),fe=function(){function e(e,t){this._subscriptionsProvider=t.subscriptionsProvider,this._urlDataSource=t.urlDataSource}return e.prototype.getNotificationState=function(e,t){var n=this;return this._subscription=void 0,this._subscriptionsProvider.getSubscriptions(e,t).then(function(e){for(var t=!0,a=n._urlDataSource.getOwnerId(void 0,{}).toLowerCase(),i=0,r=e;i<r.length;i++){var o=r[i],s=o.createdBy&&o.createdBy.user;s&&s.id&&s.id.toLowerCase()===a&&(n._subscription=o,t=!o.muted)}return t},function(e){})},e.prototype.updateNotificationState=function(e,t,n){var a={subscription:this._subscription,item:t,isOn:!e,apiNamePrefix:n};return this._subscriptionsProvider.updateSubscription(a).then(function(){return{}},function(e){})},e.dependencies=Object(p.__assign)(Object(p.__assign)({},m.n.dependencies),{subscriptionsProvider:ue.I,urlDataSource:G.Se}),e}(),pe=Object(d.r)("ItemMuteNotificationDataSource",fe,Object(p.__assign)(Object(p.__assign)({},m.n.dependencies),{subscriptionsProvider:ue.I,urlDataSource:G.Se})),me=new c.t({name:"FirstRunExperienceDataSource.key",loader:new d.t(function(){return n.ee([568],3932).then(function(e){return e.resourceKey})})}),_e=n(3003),he=n(1337),be=n(855),ge=n(1185),ve=n(1149),ye=n(909),Se=n(1269),De=n(1353),Ie=n(1298),xe=n(110),Ce=n(819),Oe=n(405),we=n(408),Ee=n(1361),Ae=n(128),Le="userInfo",ke=function(e){function t(){return e.call(this,"UserInfoStore")||this}return Object(p.__extends)(t,e),t.prototype.getUserInfo=function(){var e=this.getValue(Le);return e||(e=s.observable(null),this.setValue(Le,e)),e},t}(Ae.e),Me=n(839),Pe=function(){var e=window.Flight,t=e&&e.Config,n=t&&t.odsp_media,a=n?"odsp-media/".concat(n,"/media"):"odsp-media";Me.e.addPaths({"@ms/odsp-media/lib":a}),this.mediaBaseUrl=a},Te=n(3253),Ue=n(75),Fe=n(832),He=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getItem=function(t){var n,a=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(a);switch(t.qosName=t.qosName||"Odc.".concat(z.e[i],".ItemDataSource.getItem"),i){case z.e.SharedWithMe:n=this._getSharedDataSource().then(function(e){return e.getItem(t)});break;case z.e.Recent:n=this._getRecentDataSource().then(function(e){return e.getItem(t)});break;case z.e.RecycleBin:n=this._getRecycleBinDataSource().then(function(e){return e.getItem(t)});break;case z.e.Search:n=this._getSearchDataSource().then(function(e){return e.getItem(t)});break;default:n=e.prototype.getItem.call(this,t)}return n},t.prototype._getRecentDataSource=function(){var e=this,t=Ue.n.resolve(n.ee([608],4880)).then(Fe.e).then(function(t){return new(e.managed(t))});return this._getRecentDataSource=function(){return t},t},t.prototype._getSearchDataSource=function(){var e=this,t=Ue.n.resolve(n.ee([611],4881)).then(Fe.e).then(function(t){return new(e.managed(t))});return this._getSearchDataSource=function(){return t},t},t.prototype._getRecycleBinDataSource=function(){var e=this,t=Ue.n.resolve(n.ee(0,4309)).then(Fe.e).then(function(t){return new(e.managed(t))});return this._getRecycleBinDataSource=function(){return t},t},t.prototype._getSharedDataSource=function(){var e=this,t=Ue.n.resolve(n.ee([613],4882)).then(Fe.e).then(function(t){return new(e.managed(t))});return this._getSharedDataSource=function(){return t},t},t}(Te.e),Re=He,Ne=n(4309),Be=n(122),je=function(){function e(){}return e.prototype.getCurrentLanguage=function(){return Be.t.language||$Config.lang},e.prototype.getCurrentLanguageCode=function(){return $Config.mkt},e}(),Ve=Object(d.r)("LanguageDataSource",je,{}),ze=n(1151),Ge=function(){function e(e,t){this._languageDataSource=t.languageDataSource,this._startXHR=t.startXHR||ze.e.startAndPostProcess}return e.prototype.getLanguages=function(){var e=this;return this._startXHR({url:"/GetLanguageList"},function(t,n){var a=JSON.parse(t.responseText),i=a.Canary,r=a.LanguageInfoList,o=[];for(var s in r)r.hasOwnProperty(s)&&o.push(r[s]);var c=e._languageDataSource.getCurrentLanguage();return{languageList:o,canary:i,currentLanguage:c=c&&c.toLowerCase()}})},e.prototype.saveLanguage=function(e,t){var n="canary=".concat(encodeURIComponent(t),"&lang=").concat(e);return this._startXHR({url:"/handlers/languagesave.mvc?".concat(n),json:n},function(e,t){return e.responseText})},e}(),Ke=Object(d.r)("LanguagePickerDataSource",Ge,{languageDataSource:Ve}),We=n(2083),qe=n(8),Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getCapabilities=function(){return{supportsMruCaching:!1}},t.prototype.search=function(e,t){var n=Ue.n.resolve(this.resources.consumeAsync(G.z)),a=function(e){var t="",n=e.emailAddresses;if(n&&n.length>0)for(var a=0,i=n;a<i.length;a++){var r=i[a];if(r&&r.address&&r.address.length>0){t=r.address;break}}return{userId:e.displayName,name:e.displayName,email:t}};return qe.e.isActivated("AFE6CC2F-2CFA-40B2-A3B6-4FAD75AEB2DF","10/21/2021","Use People search in legacy Share")?n.then(function(t){return t.getContacts(e)}).then(function(e){return e.map(a)}):n.then(function(t){return t.getPeople(e)}).then(function(e){return e.map(a)})},t.prototype.resolve=function(e,t){var n,a=this,i=function(){n&&(n.cancel(),n=void 0)};return new Ue.n(function(r,o){var s=function(e){i(),r(e)};n=Ue.n.timeout(2e3).then(function(){s(a._getPersonFromQuery(e))}),a.search(e,t).then(function(t){0===t.length?s(a._getPersonFromQuery(e)):s(t[0])},function(t){s(a._getPersonFromQuery(e))})},i)},t.prototype.getPersonaDetails=function(e){return null},t.prototype.subscribePresence=function(e,t){return{dispose:function(){}}},t.prototype.getPickerEntityInformation=function(e){return null},t.prototype._getPersonFromQuery=function(e){var t=new We.e(e),n={};return t.getEmail()&&(n.name=t.getName()||"",n.image="",n.sharingInfo={type:0},n.isResolved=!0),n.email=t.getEmail()||e,n},t}(m.n),Ye=Qe,Je=n(1826),Xe=n(2097),Ze=n(3846),$e=n(1142),et=n(1914),tt=n(2109),nt=n(599),at=n(1268),it=n(40),rt=n(1912),ot=n(4190),st=n(1822),ct=n(124),dt={"-1":et.e.Owner,0:et.e.None,1:et.e.View,2:et.e.Edit,3:et.e.Submitter,4:et.e.CoOwner,5:0},lt=function(e){function t(){var t=e.call(this)||this;return t._urlDataSource=t.resources.consume(Oe.n),t._itemResultProcessor=new(t.managed(ot.e))({getRootItemTitle:function(){return""},getItemKeyExtension:function(e,t){return{}}}),t._itemProvider=t.resources.consume(st.resourceKey),t}return Object(p.__extends)(t,e),t.prototype.getSharingLinks=function(e,t){for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a];if(!t.filterScope||t.filterScope(r))for(var o=0,s=r.people;o<s.length;o++){var c=s[o].sharingInfo;if(3===c.type){var d=Object(p.__assign)(Object(p.__assign)({},c.link),{item:r.item});n.push(d)}}}return n},t.prototype.getSharingScope=function(e,t){var n=this,a=this._getShareItem(e,t),i=t.entities.map(function(e){var t=n.transformEntity(e,{statusCode:e.status,errorMessage:e.errorMessage,role:n.parseEntityRole(e),isChangeable:e.isChangeable,type:e.type,userId:e.id||e.clientId,link:n._getLinkFromEntity(a,e),email:e.email,name:e.name,expiration:e.expirationDateTime,hasPassword:e.hasPassword});return 1===t.sharingInfo.type&&(t.image=rt.t.getProfileImage(t.userId||t.sharingInfo.userId)),t});return{id:t.id,refId:t.refId,canChange:t.canChange,item:a,people:i,hasPendingAccessRequests:!1}},t.prototype.getSharingScopeVroom=function(e,t){for(var n,a,i,r,o,s,c,d=this._getShareItem(e),l=[],u=[],f=0,p=t;f<p.length;f++){var m=p[f],_=m.grantedToV2,h={name:(null===(n=null==_?void 0:_.siteUser)||void 0===n?void 0:n.displayName)||"",email:(null===(a=null==_?void 0:_.siteUser)||void 0===a?void 0:a.email)||"",userId:(null===(i=null==_?void 0:_.siteUser)||void 0===i?void 0:i.id)||"",sharingInfo:{type:m.link?3:1,role:this._getSharingRole(m),userId:null===(r=null==_?void 0:_.siteUser)||void 0===r?void 0:r.id,link:this._getSharingLink(m,d),email:null===(o=null==_?void 0:_.siteUser)||void 0===o?void 0:o.email,name:null===(s=null==_?void 0:_.siteUser)||void 0===s?void 0:s.displayName,expiration:null===(c=m.expirationDateTime)||void 0===c?void 0:c.toISOString(),hasPassword:m.hasPassword}};1===h.sharingInfo.type&&(h.image=rt.t.getProfileImage(h.userId||h.sharingInfo.userId)),u.push(h)}return l.push({id:d.ownerId,item:d,people:u,hasPendingAccessRequests:!1}),l},t.prototype.parseEntityRole=function(e){return dt[e.role]||et.e.None},t.prototype.convertToSharingRole=function(e){return dt[e]},t.prototype.transformEntity=function(e,t){return{name:e.name,email:e.email,userId:e.id,sharingInfo:t}},t.prototype._getSharingRole=function(e){var t=Object(ct.e)(e.roles||[],function(){return!0});return t.owner?et.e.Owner:t.write?et.e.Edit:t.read?et.e.View:et.e.None},t.prototype._getSharingLink=function(e,t){var n;if(!e.link)return null;var a=e.link;return{url:a.webUrl,type:this._getSharingLinkTypeFromVroomLinkType(a.type),name:a.localizedDescription,role:this._getSharingRole(e),id:e.id,isActive:!0,item:t,entityType:3,expiration:null===(n=e.expirationDateTime)||void 0===n?void 0:n.toISOString(),supportsExpiration:!0,hasPassword:e.hasPassword}},t.prototype._getShareItem=function(e,t){var n,a=e.length>1,i=this._urlDataSource.getOwnerId(),r=decodeURIComponent(e[0].key.split(/=|&/)[1]),o=(null==t?void 0:t.id)||r,s=this._urlDataSource.getKey(((n={}).id=o,n.cid=i,n)),c=!a&&this._findItem(e[0],o,s);if(!c){var d=new(this.resources.consume(j.a));this._itemResultProcessor.processItemResult({requestKey:s,isPlaceholder:!0,isPrimaryRequestedItem:!0,itemFromServer:{id:(null==t?void 0:t.id)||r,name:(null==t?void 0:t.name)||"",ownerCid:i,isBundle:a,commands:"sh,1"},observer:d}),d.flush(),c=d.getItem({key:s})}return c},t.prototype._getSharingLinkTypeFromVroomLinkType=function(e){switch(e){case"edit":return tt.e.Edit;case"view":return tt.e.View;case"embed":return tt.e.Embed;default:return tt.e.None}},t.prototype._getLinkFromEntity=function(e,t){return t.link?{url:t.link,type:this._getLinkTypeFromSkyApiSharingLinkType(t.linkType),name:t.linkName,role:this.parseEntityRole(t),id:t.id||t.clientId,isActive:!0,item:e,entityType:t.type,expiration:t.expirationDateTime||"",supportsExpiration:!0,hasPassword:t.hasPassword}:null},t.prototype._getLinkTypeFromSkyApiSharingLinkType=function(e){switch(void 0===e&&(e=0),e){case 5:case 8:return tt.e.View;case 6:return tt.e.Edit;case 3:return tt.e.Embed;case 7:return tt.e.Form;case 1:return tt.e.Network;case 9:return tt.e.Direct;case 10:return tt.e.AppAccess;case 4:return tt.e.App;case 11:return tt.e.RequestAccess;default:return tt.e.None}},t.prototype._findItem=function(e,t,n){for(var a=null;e;){if(e.id===t){a=e;break}e=e.UNSAFE_parent}if(!a){var i=this._itemProvider.getItemSync({parentKey:n}).item.peek();i&&i.isBundle&&(a=i)}return a},t}(m.n),ut=function(){return!!window.sessionStorage.getItem("_isRunningTABTest")},ft=function(e){function t(){var t=e.call(this)||this;return t._sharingDataHelper=new(t.managed(lt)),t._urlDataSource=t.resources.consume(Oe.n),t}return Object(p.__extends)(t,e),t.prototype.manageSharingLinks=function(e,t){var n=this,a=t.name||t.link&&t.link.name,i=t.id||t.link&&t.link.id,r=t.link&&t.link.entityType||3,o=t.expiration,s=t.password,c=[t.person||{userId:i,name:void 0,email:void 0,sharingInfo:{item:e[0].item,role:t.role,type:r,userId:i}}],d={items:e.map(function(e){return e.item}),sendEmail:t.create,roleValue:this._sharingDataHelper.convertToSharingRole(t.create?t.role:et.e.None)},l={modifyPermissions:!t.create,link:{linkType:t.type,linkName:a}};return o&&(l.link.expirationDateTime=o),void 0!==s&&(l.link.password=s),this._setPermissions(c,d,l).then(function(e){return n._sharingDataHelper.getSharingLinks(e,{})},function(e){return e.people?n._sharingDataHelper.getSharingLinks([e],{}):Ue.n.wrapError(e)})},t.prototype.share=function(e,t){return this._setPermissions(e,t,{modifyPermissions:!1}).then(function(e){return{statusCode:0,errorMessage:"",people:e[0].people,itemId:e[0].item.id}},function(e){return e.people?e:Ue.n.wrapError(e)})},t.prototype.unshare=function(e){return this.updatePermissions(null,e,et.e.None)},t.prototype.updatePermissions=function(e,t,n,a){var i={items:[t],roleValue:this._sharingDataHelper.convertToSharingRole(n),sendEmail:!1,expiration:a};return this._setPermissions(e,i,{modifyPermissions:!0}).then(function(t){return{statusCode:0,errorMessage:"",people:n===et.e.None?e.map(function(e){return e.sharingInfo.role=et.e.None,e}):t[0].people}},function(e){return e.people?e:Ue.n.wrapError(e)})},t.prototype.supportsExistingAccessOption=function(e){return!1},t.prototype._setPermissions=function(e,n,a){var i=this,r={message:n.message,requireSignIn:n.requireSignIn,suppressNotification:!n.sendEmail,userAction:a.modifyPermissions?1:0,entities:[]},o=n.items;if(o&&o.length||(o=[]),o.length>1){var s=o.map(function(e){return i._urlDataSource.getKeyParams(e.key).id});r.ids=s,r.bundleName=this._getBundleName(o)}else{var c=o[0],d=this._urlDataSource.getKeyParams(c.key);r.id=d.id}for(var l=0;l<e.length;l++){var u=e[l],f={role:n.roleValue,type:0,email:u.email};u.sharingInfo&&(f.id=u.sharingInfo.userId),n.expiration&&(f.expirationDateTime=n.expiration),n.password&&(f.password=n.password),a.link?(f.type=u.sharingInfo&&u.sharingInfo.type||3,f.linkName=a.link.linkName,f.expirationDateTime=a.link.expirationDateTime,f.password=a.link.password,a.link.linkType&&this._addLinkType(a.link.linkType,f),u.sharingInfo&&(f.id=u.sharingInfo.userId)):!u.email&&u.sharingInfo?(f.id=u.userId,f.type=u.sharingInfo.type):u.sharingInfo&&u.sharingInfo.type&&(f.type=u.sharingInfo.type),u.entityType===Xe.e.application&&(f.clientId=u.userId,a.link?(f.type=3,f.linkType=4):(f.type=7,f.expiry=1),delete f.email),r.entities.push(f)}var p=JSON.stringify(r),m=new nt.e;return ut&&window.sessionStorage.setItem("ODCSkyAPISetPermissionsAPIRequest",JSON.stringify({url:t._ShareUrl,payload:p})),m.send({apiName:"SetPermissions",url:t._ShareUrl,requestType:"POST",postData:p,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1007:case 3006:case 3007:case 3009:case 3012:case 3033:case 3034:case 3035:case 3036:case 3037:return!0;default:return!1}}}).then(function(e){if(ut&&window.sessionStorage.setItem("ODCSkyAPISetPermissionsAPIResponse",JSON.stringify(e)),e.permissions&&e.permissions.permissionScopes)return e.permissions.permissionScopes.map(function(e){return i._sharingDataHelper.getSharingScope(o,e)});if(e.primaryError&&e.primaryError.code){var t=e.errorResult.entity;return Ue.n.wrapError({statusCode:e.primaryError.code,errorMessage:e.primaryError.message,people:[i._sharingDataHelper.transformEntity(t,{statusCode:0,role:i._sharingDataHelper.parseEntityRole(t),type:void 0,userId:t.id||t.clientId})]})}return Ue.n.wrapError(e)},function(e){return e.data?Ue.n.wrapError(e.data):Ue.n.wrapError(e)})},t.prototype._addLinkType=function(e,t){switch(e){case tt.e.Embed:t.linkType=3;break;case tt.e.View:t.linkType=5;break;case tt.e.Edit:t.linkType=6;break;case tt.e.Form:t.linkType=7;break;case tt.e.Network:t.linkType=1;break;case tt.e.Direct:t.linkType=9;break;case tt.e.App:t.linkType=4;break;case tt.e.AppAccess:t.linkType=10;break;case tt.e.RequestAccess:t.linkType=11}},t.prototype._getBundleName=function(e){var t="";if(e&&e.length){for(var n,a=e[0].UNSAFE_parent,i=Ze.BundleNameShared,r=Object(Je.a)(new Date),o=!0,s=!0,c=0,d=e;c<d.length;c++){var l=d[c];if(l.photo&&!l.video)s=!1;else{if(!$e.o(l.extension)){s=o=!1;break}o=!1}}n=o?"Photos":s?"Documents":"Items",a&&!a.isRootFolder&&!a.isSpecialFolder&&a.name&&(i=it.format(Ze.BundleNameFolderName,a.name,"{0}","{1}")),t=it.format(i,Ze["BundleNameType"+n],r)}return t},t._ShareUrl=at.e+"/API/2/SetPermissions",t}(m.n),pt=n(13),mt=n(1903),_t=n(25),ht=n(95),bt=function(e){function t(){var t=e.call(this)||this;return t._sharingDataHelper=new(t.managed(lt)),t._urlDataSource=t.resources.consume(Oe.n),t._vroomDataRequestor=t.resources.consume(mt.e),t}return Object(p.__extends)(t,e),t.prototype.getSettings=function(e){var t=this,n=e.item;return e.getPermissions().then(function(e){var a={itemId:n.id,itemName:n.name,pickerProperties:{AllowEmailAddresses:!0},canManagePermissions:!0,canManageLinks:!0,canSendLink:!0,canSendEmail:!0,anonymousLinksEnabled:!0,organizationLinksEnabled:!1,networkLinksEnabled:!0,showAdvanced:!1,advancedUrl:"",itemUrl:"",supportsSharingPropagation:!1,showAdditionalExternalWarning:!1,sharedWithMany:!1,sharingRoles:t._getSharingRolesForItem(n),requiredAnonymousLinkExpirationInDays:0,mailSettings:{defaultCharacterLimit:4e3},contactInviteLimit:20};return a.sharedWith=e.length?e[0].people:null,Ue.n.wrap(a)})},t.prototype.getPermissions=function(e){var t=this,n=e.item;if(Object(pt.isFeatureEnabled)(pt.UseVroomGetPermissions)&&Object(ht.e)(n.ownerId))return this.getPermissionsVroom(e);var a=this._urlDataSource.getPermissionsUrl(n);return(new nt.e).send({apiName:"GetPermissions",url:a}).then(function(e){var a=[];n.sharingRole!==et.e.Owner&&a.push(t._getOwnerScope(n));for(var i=0,r=e.permissionScopes;i<r.length;i++){var o=r[i];a.push(t._sharingDataHelper.getSharingScope([n],o))}return a})},t.prototype.getPermissionsVroom=function(e){var t=this,n=e.item;if(!n.ownerId||!n.itemId)return Ue.n.wrap([]);var a="".concat(Object(_t.c)("v2.1"),"/drives/").concat(n.ownerId,"/items/").concat(n.itemId,"/permissions");return this._vroomDataRequestor.send({apiName:"GetPermissionsVroom",path:a,requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0}).then(function(e){var a=[];return n.sharingRole!==et.e.Owner&&a.push(t._getOwnerScope(n)),a.push.apply(a,t._sharingDataHelper.getSharingScopeVroom([n],e.value)),Ue.n.wrap(a)})},t.prototype.getBestSharingLink=function(e){var t=e.item;return e.getLinks().then(function(e){if(e){for(var n=null,a=0,i=e;a<i.length;a++){var r=i[a];if(t.id===r.item.id){if(r.type===tt.e.Edit){n=r;break}r.type===tt.e.View&&(n=r)}}return Ue.n.wrap(n)}return Ue.n.wrap(null)},function(e){return Ue.n.wrap(null)})},t.prototype.getLinks=function(e){var t=this;return e.getPermissions().then(function(e){return t._sharingDataHelper.getSharingLinks(e,{})})},t.prototype.doSharingScopesContainLinks=function(){return!0},t.prototype.getRawResponse=function(e){return Ue.n.wrap({})},t.prototype._getSharingRolesForItem=function(e){var t={name:Ze.CanEdit,value:this._sharingDataHelper.convertToSharingRole(et.e.Edit)},n={name:Ze.CanView,value:this._sharingDataHelper.convertToSharingRole(et.e.View)};return e.isAlbum?[n]:[t,n]},t.prototype._getOwnerScope=function(e){return{item:e,canChange:!1,people:[{userId:e.ownerId,name:e.creatorName,email:"",image:e.ownerId?rt.t.getProfileImage(e.ownerId):void 0,sharingInfo:{type:1,item:e,role:et.e.Owner,isChangeable:!1}}],hasPendingAccessRequests:!1,canUnshare:!1}},t}(m.n),gt=n(353),vt=n(325),yt=function(e,t){for(var n in e)this[n]=e[n];this.ClientData=t.toString(),void 0===this.CurrentMainLinkElementID&&(this.CurrentMainLinkElementID=vt.e.ONEDRIVE)},St=function(){function e(e){this.IsRTL=!1,this.IsFallbackShell=!1,this.LyncIntegrationDisabled=!1,this.NewFlexPane=!1,this.MeFlexPaneEnabled=!1,this.LogUrl="",this.LogLevelSwitches=[!1,!1,!1,!1],e&&s.utils.extend(this,JSON.parse(e))}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),Dt=n(380),It=n(2248),xt=n(2395),Ct=n(3847),Ot=n(833),wt=n(4155),Et=n(3849),At=n(62),Lt=n(904),kt=n(824),Mt=n(3850),Pt=n(910),Tt=n(156),Ut=n(18),Ft=n(422),Ht=n(218),Rt=n(914),Nt=n(1207),Bt=FilesConfig&&FilesConfig.SuiteNavConfig,jt=function(e){function t(t){var n=e.call(this,t)||this;return n._fillConsumerData=function(e,t,a){var i=new Pt.e;return t.HasEXOLicense=!0,t.NewFlexPane=!0,t.MeFlexPaneEnabled=!0,t.LyncIntegrationDisabled=!1,t.IsRTL=Be.t.isRightToLeft,e.CurrentWorkloadSettingsSubLinks=n._getSettingsLinks(n._urlDataSource,!1),e.CurrentWorkloadHelpSubLinks=[{Id:vt.e.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:gt.i,Url:Ht.n}],e.CurrentWorkloadHelpSubLinks=Object(Rt.t)(),e.SignOutLink={Id:vt.e.SIGN_OUT,Text:gt.d,Url:"#"},e.ActionsMap={},e.ActionsMap[vt.e.DIAGNOSTICS]=function(e){i.FlexPane.CloseFlexPaneForProvider("Settings");var t=new(e.injected(Et.e))({});return t.execute(null),t.dispose(),!1},e.ActionsMap.ConvergenceClearDebug=function(e){Object(Ft.e)(rt.t.viewerId,!1),window.location.href="/"},e.ActionsMap[vt.e.SIGN_OUT]=function(e){var t=new(e.injected(Ct.e))({url:Bt.Urls.SignOut});return t.execute(null),t.dispose(),!1},e.ActionsMap[vt.e.ONEDRIVE]=function(e){var t=new(e.injected(Ot.e))({url:n._urlDataSource.getFilesQueryUrl(),forceNavigation:!0});return t.execute(null),t.dispose(),!1},e.ActionsMap[vt.e.LANGUAGE]=function(e){if(i.FlexPane.CloseFlexPaneForProvider("Settings"),Tt.e.logData({name:"".concat(Ht.t,".Language.Click"),isIntentional:!0}),Object(pt.isFeatureEnabled)(pt.LanguageRedirect)){var t=new(e.injected(Ot.e))({url:n._urlDataSource.getLanguageWithAuthenRedirectUrl(),forceNavigation:!0,target:n._urlDataSource.getAuthKeyParamValue()?"_blank":null});t.execute(null),t.dispose()}else{var a=new(e.injected(wt.e))({});a.execute(null).done(function(){a.dispose()})}return!1},a&&(e.CurrentWorkloadUserSubLinks=[],e.SignOutLink.Text=Mt.title),t},Bt&&(n._model={data:null,cssUrl:Bt.CssPath,requireConfig:n._getRequireConfig()}),n._identity=n.resources.consume(G.D).getIdentity(),n._premiumStateProvider=n.resources.consume(xt.resourceKey),n._urlDataSource=n.resources.consume(Oe.n),n._navigation=n.resources.consume(R.e),n._attributionHelper=n.resources.consume(It.n),n._dime=n.resources.consume(kt.resourceKey),n}return Object(p.__extends)(t,e),Object.defineProperty(t.prototype,"accountSwitchCallback",{get:function(){var e=this;return function(t){var n=new(e.resources.injected(Ct.e))({url:""});n.execute(null),n.dispose()}},enumerable:!1,configurable:!0}),t.prototype.getCapabilities=function(){return{supportsCaching:!1,supportsRealSuiteNav:!("syncpremiumupsell"===this._navigation.viewParams.v)&&Bt,showO365Text:!1}},t.prototype.getUserTileUrl=function(){return Bt&&Bt.UserTileUrl},t.prototype.getUserName=function(){return Bt&&Bt.UserDisplayName},t.prototype.getUserEmail=function(){return this._identity.email},t.prototype.getRenderSetting=function(e){var t=this,n=Object(pt.isFeatureEnabled)(pt.EnableAccountSwitching);return Object(p.__assign)(Object(p.__assign)({},Object(Rt.e)(this.resources)),{top:e,shellDataOverrides:{SignOutLink:{Id:vt.e.SIGN_OUT,Text:gt.d,Url:Ht.e?Bt.Urls.SignOut:"#",Action:function(){var e=new(t.resources.injected(Ct.e))({url:n?"":Bt.Urls.SignOut});return e.execute(null),e.dispose(),!n&&event&&(event.preventDefault?event.preventDefault():event.returnValue=!1),!1}},SignInLink:{Id:"ShellSignIn",Text:gt.c,Url:FilesConfig.si},AccountSwitchingEnabled:n,AppHeaderLinkText:gt.r,AppHeaderLinkUrl:"/"},workloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!1)})},t.prototype.loadData=function(e){var t=this;return!e&&this._dataPromise||(this._model.requireConfig=this._getRequireConfig(),this._dataPromise=new Ue.n(function(e,n){if(Bt){var a=function(n,a){t._model.data=new yt(n,a),e(t._model)};if(t._identity.type===Dt.e.aad)ze.e.start({url:t._urlDataSource.getSuiteNavConfigUrl()}).then(function(n){try{var i=JSON.parse(n.responseText);i.navBarData.HelpLink.Url=Ht.n,i.navBarData.CurrentWorkloadSettingsSubLinks=[{Id:vt.e.CUSTOM_SETTINGS_1,Text:gt.s,Url:t._urlDataSource.getOptionsUrl(),TargetWindow:"_top"}],t._model={data:i.navBarData,requireConfig:{paths:{shellcore:i.jsUrl.replace(/\.js$/,"")},shim:{shellcore:{exports:"O365"}}},cssUrl:i.cssUrl},t._model.data.ActionsMap={},t._model.data.ActionsMap[vt.e.SIGN_OUT]=function(){return new(t.managed(Ct.e))({url:Bt.Urls.SignOut}).execute(null),!1},e(t._model)}catch(e){At.e.log(e);var r=t._getSuiteNavFallbackData();a(r.data,r.clientData)}},function(e){At.e.log(e);var n=t._getSuiteNavFallbackData();a(n.data,n.clientData)});else if(t.getCapabilities().supportsRealSuiteNav){Me.e.addConfig(t._getRequireConfig());var i=t._identity.type===Dt.e.anonymous;window.require(["shellcore"],function(){var e=new St,n=new yt(null,e);e=t._fillConsumerData(n,e,i),a(n,e)})}else{var r=t._getSuiteNavFallbackData();a(r.data,r.clientData)}}else e(null)})),this._dataPromise},t.prototype._getSuiteNavFallbackData=function(){var e=this,t=this._identity.type===Dt.e.aad,n=Bt.Urls,a=new St;a.IsFallbackShell=!0,a.IsRTL=Be.t.isRightToLeft;var i={WorkloadLinks:[{Id:vt.e.ONEDRIVE,Text:gt.r,Url:"https://onedrive.live.com"}],CurrentWorkloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!t),CurrentWorkloadHelpSubLinks:Object(Rt.t)(),CurrentWorkloadUserSubLinks:t?[]:[{Id:vt.e.ABOUT_ME,Text:gt.a,Url:n.Profile},{Id:vt.e.SETTINGS,Text:gt.e,Url:n.Account}],IsAuthenticated:Bt.IsAuthenticated,SignOutLink:{Id:vt.e.SIGN_OUT,Text:gt.d,Url:n.SignOut},UserDisplayName:Bt.UserDisplayName,ActionsMap:{}};return i.ActionsMap[vt.e.SIGN_OUT]=function(){return new(e.managed(Ct.e))({url:Bt.Urls.SignOut}).execute(null),!1},{data:i,clientData:a}},t.prototype._getSettingsLinks=function(e,t){var n=this,a=Bt.Urls,i=[],r=this.getCapabilities().supportsRealSuiteNav?new Pt.e:null;i.push({Id:vt.e.CUSTOM_SETTINGS_1,Text:gt.s,Url:e.getOptionsUrl(),TargetWindow:"_top",Action:function(){r&&r.FlexPane.CloseFlexPaneForProvider("Settings")}});var o=this._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"UpgradePage"});return i.push({Id:vt.e.CUSTOM_SETTINGS_2,Text:gt.u,Url:e.getUpgradeOptionsUrl(o,!0),TargetWindow:"_top",Action:function(){r&&r.FlexPane.CloseFlexPaneForProvider("Settings"),Tt.e.logData({name:"".concat(Ht.t,".UpgradeOption.Click")})}}),this._premiumStateProvider.hasPlanWith100GBOrMore().then(function(e){if(r){var t=Object(Ut.O)("Diamond"),a="PROD_OneDrive-Web_SuiteNav_Unknown_HeaderDiamond",i=t&&t.subset.fontFace&&t.subset.fontFace.fontFamily||"";void 0===e||e||n._dime.init();var o=n.resources.consume(Nt.e);o({eventData:{name:"".concat(Ht.t,".Diamond.Load"),component:"SuiteNavDiamond"},flowInitiator:"SuiteNavHeaderDiamond",flowStep:"UpsellAppeared"}),r.Extensibility.AddOrUpdateCustomHeaderButton({iconFontFamily:i,iconFontName:"",isStateless:!0,onShow:function(){o({eventData:{name:"".concat(Ht.t,".Diamond.Click"),component:"SuiteNavDiamond"},flowInitiator:"SuiteNavHeaderDiamond",flowStep:"PurchaseInitiated"});var e=document.getElementById(a);return n._dime.navigate("SuiteNav",e),!1},onHide:function(){},id:a,ariaLabel:gt.t,affordanceMenuItemText:gt.t})}}),t&&i.push({Id:vt.e.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:gt.i,Url:Ht.n}),FilesConfig&&FilesConfig.df&&i.push({Id:vt.e.DIAGNOSTICS,Text:gt.n,Url:a.Diagnostics}),this._identity.type===Dt.e.anonymous&&Object(pt.isFeatureEnabled)(pt.HideLanguagePickerForAnonymous)||i.push({Id:vt.e.LANGUAGE,Text:Lt["langname_"+Be.t.language.replace(/-/g,"_")],Url:"#"}),FilesConfig&&FilesConfig.df&&i.push({Id:"ConvergenceClearDebug",Text:"[Debug] Clear migration state",Url:a.Diagnostics}),i},t.prototype._getRequireConfig=function(){return{paths:{shellcore:"https://shellprod.msocdn.com/api/shellbootstrapper/consumer/oneshell?noext"},shim:{shellcore:{exports:"O365Shell"}}}},t}(m.n);!function(e){e[e.folders=0]="folders",e[e.shared=1]="shared",e[e.mru=2]="mru",e[e.search=3]="search",e[e.photos=4]="photos",e[e.recyclebin=5]="recyclebin",e[e.allmyphotos=6]="allmyphotos",e[e.sharedby=7]="sharedby"}(o||(o={}));var Vt,zt=o,Gt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FIRST_PARM_FORMAT="{0}?{1}",t}return Object(p.__extends)(t,e),t.prototype.getPath=function(){return it.format(this.FIRST_PARM_FORMAT,t.APP_PATH_PRE_FIX,t.APP_PATH_POST_FIX)},t.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"},t.APP_PATH_PRE_FIX="ms-onedrive://",t.APP_PATH_POST_FIX="from=web",t}(m.n),Kt=Gt,Wt=n(2352),qt=function(e){function t(t){var n=e.call(this,t)||this;return n.PARAM_EQUALS_FORMAT="{0}={1}",n._queryParamDictionary={id:"resId",cid:"ownerCid",authkey:"authKey",accountId:"accountId",ticket:"ticket"},n._navigation=n.resources.consume(R.e),n._urlDataSource=n.resources.consume(Oe.n),n}return Object(p.__extends)(t,e),t.prototype.getPath=function(){var e=this.getQueryStringParams(),t=this.getView(),n=it.format(Kt.APP_PATH_PRE_FIX+this.FIRST_PARM_FORMAT,t||"",e||"");return e&&(n+="&"),n+Kt.APP_PATH_POST_FIX},t.prototype.getStorePath=function(){return this._urlDataSource.getExternalUrl(Wt.e.iosappstore)},t.prototype.getView=function(){var e,t=this._navigation.viewParams.qt;if(t&&t.length>0)switch(t=t.toLowerCase(),zt[t]){case zt.mru:e="recent";break;case zt.shared:case zt.sharedby:e="shared";break;case zt.folders:e="files";break;default:e=t}else e="files";return e},t.prototype.getQueryStringParams=function(){var e;for(var t in this._queryParamDictionary)if(this._queryParamDictionary.hasOwnProperty(t)){var n=this._navigation.viewParams[t];if("accountId"===t&&!n){var a=window.$Config;n=a&&a.hcid}if(n){if("root"===n)continue;e?e+="&":e="",e+=it.format(this.PARAM_EQUALS_FORMAT,this._queryParamDictionary[t],n)}}return e},t}(Kt),Qt=n(33),Yt=n(298),Jt={base:Object(Yt.e)(function(){return n.ee([184,"ondemand.resx-ondemand"],5247)}),accountChooser:Object(Yt.e)(function(){return n.ee([183,"ondemand.resx-ondemand"],5128)}),textEditor:Object(Yt.e)(function(){return n.ee(28,5138)}),picker:Object(Yt.e)(function(){return n.ee([187,"ondemand.resx-ondemand"],5110)}),files:Object(Yt.e)(function(){return n.ee([188,"ondemand.resx-ondemand"],5147)}),photos:Object(Yt.e)(function(){return n.ee([195,"ondemand.resx-ondemand"],4136)}),photoStream:Object(Yt.e)(function(){return n.ee([193],4150)}),storageInfo:Object(Yt.e)(function(){return n.ee([200,"ondemand.resx-ondemand"],5195)}),storageOptions:Object(Yt.e)(function(){return n.ee([202,"ondemand.resx-ondemand"],5139)}),oneUp:Object(Yt.e)(function(){return n.ee([190,"ondemand.resx-ondemand"],4142)}),photoPreferences:Object(Yt.e)(function(){return n.ee([192,"ondemand.resx-ondemand"],5168)}),photosOptions:Object(Yt.e)(function(){return n.ee([194,"ondemand.resx-ondemand"],5178)}),restore:Object(Yt.e)(function(){return n.ee([198],5215)}),error:Object(Yt.e)(function(){return n.ee([186,"ondemand.resx-ondemand"],5248)}),ransomeware:Object(Yt.e)(function(){return n.ee([196,"ondemand.resx-ondemand"],5126)}),syncPlaceholders:Object(Yt.e)(function(){return n.ee([204,"ondemand.resx-ondemand"],4169)}),syncOnboarding:Object(Yt.e)(function(){return n.ee([203,"ondemand.resx-ondemand"],5216)}),validate:Object(Yt.e)(function(){return n.ee([208,"ondemand.resx-ondemand"],5217)}),unlock:Object(Yt.e)(function(){return n.ee([207],5218)}),manageVault:Object(Yt.e)(function(){return n.ee([189],5219)}),requestAccess:Object(Yt.e)(function(){return n.ee([197,"ondemand.resx-ondemand"],5220)}),traceMe:Object(Yt.e)(function(){return n.ee([206,"ondemand.resx-ondemand"],5169)}),convergence:Object(Yt.e)(function(){return n.ee([185],5249)}),legacySettingsPages:Object(Yt.e)(function(){return n.ee([199],5221)})},Xt=function(){function e(){}return e.prototype.getPageModuleLoader=function(e){switch(e){case Qt.e.FilePicker:return Jt.picker;case Qt.e.TextFileEditor:return Jt.textEditor;case Qt.e.AccountChooser:return Jt.accountChooser;case Qt.e.OneUp:return Jt.oneUp;default:return Jt.base}},e.prototype.getInnerPageModuleLoader=function(e){switch(e){case Qt.e.Files:return Jt.files;case Qt.e.Photos:return Jt.photos;case Qt.e.PhotoStream:return Jt.photoStream;case Qt.e.StorageInfo:return Object(pt.isFeatureEnabled)(pt.EnableManageStorageSettings)?Jt.legacySettingsPages:Jt.storageInfo;case Qt.e.StorageOptions:return Jt.storageOptions;case Qt.e.PhotoPreferences:return Jt.photoPreferences;case Qt.e.TagPreferences:return Jt.legacySettingsPages;case Qt.e.Restore:return Jt.restore;case Qt.e.RansomwareDetection:return Jt.ransomeware;case Qt.e.SyncPlaceholders:return Jt.syncPlaceholders;case Qt.e.SyncOnboarding:return Jt.syncOnboarding;case Qt.e.ValidatePermission:return Jt.validate;case Qt.e.Unlock:return Jt.unlock;case Qt.e.ManageVault:return Jt.manageVault;case Qt.e.RequestAccess:return Jt.requestAccess;case Qt.e.TraceMe:return Jt.traceMe;case Qt.e.Convergence:if(FilesConfig.df)return Jt.convergence;window.location.href="https://onedrive.live.com/dfmanage";break;case Qt.e.DocumentOptions:case Qt.e.DeviceBackups:case Qt.e.Search:case Qt.e.NotificationOptions:return Jt.legacySettingsPages;case Qt.e.Error:default:return Jt.error}},e.prototype.getCommandSetModuleLoader=function(){return function(){return Ue.n.reject("Not Implemented")}},e}(),Zt=new c.t({name:"ModuleLoaderDataSource",factory:new d.i(Xt)}),$t=n(362),en=n(1559),tn=n(3851),nn=n(73),an=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._sessionManagementProvider=n.resources.consume(tn.e),n._urlDataSource=n.resources.consume(G.Se),n}return Object(p.__extends)(t,e),t.prototype.getVersionHistoryInfo=function(e){var t=this;return this._sessionManagementProvider.getToken().then(function(n){return t._getVersionHistory(e.ownerId,Object(en.e)(e.id)).then(function(a){var i=t._parseVersionHistory(a,e,n);return i[0].isCurrentVersion=!0,i})})},t.prototype.restoreVersionByLabel=function(e,t){var n=this;return this._sessionManagementProvider.getToken().then(function(a){var i=Object(ht.e)(e.ownerId),r="/drive/items/"+Object(en.e)(e.id)+"/versions/"+Object(en.e)(t)+"/action.restoreVersion",o=n._getUrl(e,r,a,i),s={Accept:"application/json","Content-Type":"application/json","Content-Length":"0"};return i&&a&&a.accessToken&&(s.Authorization="bearer "+a.accessToken),ze.e.start({url:o,headers:s,method:"POST"}).then(function(e){return e.status>=200&&e.status<=299})})},t.prototype.deleteVersionByLabel=function(e,t){return Ue.n.wrap()},t.prototype.canRestoreVersions=function(){return!0},t.prototype.canDeleteVersions=function(){return!1},t.prototype.showVersionLabel=function(){return!1},t.prototype.getOpenUrlByLabel=function(e,t,n){return this.getDownloadUrlByLabel(e,t,n)},t.prototype.getDownloadUrlByLabel=function(e,t,n){var a=this;return qe.e.isActivated("5CC38F37-D7E0-4AD4-A7FB-6DF63753B403","07/06/2023","Enable download previous content for consumer")?Ue.n.resolve(n):this._sessionManagementProvider.getToken().then(function(i){var r=Object(ht.e)(null==e?void 0:e.ownerId),o=a._getVersionContentUrl(e,i,t,r);if(!r)return n||o;var s={Authorization:"Bearer "+(null==i?void 0:i.accessToken)};return fetch(o,{method:"HEAD",headers:s}).then(function(e){return e.ok&&200===e.status?e.url:n}).catch(function(e){return n})})},t.prototype._parseVersionHistory=function(e,t,n){var a=this;return e.value.map(function(e,i){var r=Object(ht.e)(t.ownerId),o=a._getVersionContentUrl(t,n,e.id,r);return{created:e.lastModifiedDateTime,id:null,isCurrentVersion:0===i,size:e.size,url:o,versionLabel:e.id,appMap:t.appMap,createdBy:{Id:e.lastModifiedBy.user.id,Title:e.lastModifiedBy.user.displayName},disableOpenInOfficeClient:r}})},t.prototype._getVersionHistory=function(e,t){var n=Object(ht.e)(e);return this._getRequestor().send({apiName:"versions",path:"/drive/items/".concat(t,"/versions"),driveId:e,useAuthorizationHeaders:n})},t.prototype._getRequestor=function(){var e=this.resources.consume(mt.e);return this._getRequestor=function(){return e},e},t.prototype._getVersionContentUrl=function(e,t,n,a){var i="/drive/items/"+Object(en.e)(e.id)+"/versions/"+Object(en.e)(n)+"/content";return this._getUrl(e,i,t,a)},t.prototype._getUrl=function(e,t,n,a){var i,r=this._urlDataSource.getApiBaseUrl({apiVersion:a?"v2.1":"v1.0",driveId:e.ownerId});return n&&n.tokenUrl&&0===t.indexOf("/drive/")?i=new nn.t("".concat(n.tokenUrl,"/").concat(t.substring(7))):(i=new nn.t(t)).getScheme()||(i=new nn.t(r+t)),!a&&n&&n.accessToken&&i.setQueryParameter("access_token",n.accessToken),i.toString()},t}(m.n),rn=n(2353),on=n(2308),sn=n(3127),cn=n(1421),dn=n(9),ln=function(e){function t(t){var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(Oe.n),n}return Object(p.__extends)(t,e),t.prototype.updateTags=function(e){if(Object(pt.isFeatureEnabled)(pt.UpdateOdcPhotoApiForConvergence)&&Object(ht.e)(_t.T)){var t=this.resources.consume(h.e),n=Object(_t.f)({apiVersion:"v2.1",driveId:"me",includeViewerId:!1}),a=function(e){return Object(p.__assign)({name:e.tag,localizedName:e.localizedTag},"userdefined"!==e.source.toLowerCase()?{autoTagged:{}}:{})};return new Ue.n(function(i,r){return t.dispatch(Object(cn.e)({items:Object(ct.e)(e.items,function(){var t,n;return{tagsToAdd:(null===(t=e.tagsToAdd)||void 0===t?void 0:t.map(a))||[],tagsToDelete:(null===(n=e.tagsToDelete)||void 0===n?void 0:n.map(a))||[]}},function(e){return dn.e.serialize({endpoint:n,driveId:"me",itemId:e.id})})})).then(function(){i({items:e.items.map(function(e){return{id:e.id}}),pageStats:void 0})}).catch(function(t){i({items:e.items.map(function(e){return{id:e.id}}),pageStats:void 0,error:t})})})}return sn.e.start({apiName:"UpdateTags",url:this._getUpdateTagUrl(),batchSize:200,items:e.items,getPostData:function(t){return{tagsToDelete:e.tagsToDelete,tagsToAdd:e.tagsToAdd,ids:t.map(function(e){return e.id})}}})},t.prototype.getAllTags=function(e){if(Object(pt.isFeatureEnabled)(pt.UpdateOdcPhotoApiForConvergence)&&Object(ht.e)(_t.T))return this.getAllTagsV2(e);var t;switch(e){case on.e.allTags:t=this._getAllTagsUrl();break;case on.e.allPlaces:t=this._getAllGeolocationTagsUrl();break;default:return Ue.n.wrap(null)}return(new nt.e).send({apiName:"GetAllTags",url:t})},t.prototype.getAllTagsV2=function(e){var t=this.resources.consume(mt.e),n={path:"",apiName:"GetAllTagsV2",endpoint:Object(_t.f)({apiVersion:"v2.1",driveId:"me"}),useAuthorizationHeaders:!0};return e===on.e.allTags?t.send(Object(p.__assign)(Object(p.__assign)({},n),{path:"/drives/me/view.listTags"})).then(function(e){var t;return{pageStats:void 0,tags:null===(t=e.value)||void 0===t?void 0:t.map(function(e){var t,n,a;return{count:0,localizedTag:(null===(t=e.tag)||void 0===t?void 0:t.localizedName)||(null===(n=e.tag)||void 0===n?void 0:n.name),tag:null===(a=e.tag)||void 0===a?void 0:a.name}})}}):e===on.e.allPlaces?t.send(Object(p.__assign)(Object(p.__assign)({},n),{path:"/drives/me/view.listLocations"})).then(function(e){var t;return{pageStats:void 0,locations:null===(t=e.value)||void 0===t?void 0:t.map(function(e){var t,n=(null===(t=null==e?void 0:e.location)||void 0===t?void 0:t.address)||{},a=n.city,i=n.countryOrRegion,r=n.locality,o=n.state;return{count:0,hierarchyIndex:"".concat(i,"\t").concat(o,"\t").concat(a),city:a,country:i,lang:r,state:o}})}}):Ue.n.wrap(null)},t.prototype.getParentKeyForTagType=function(e){var t,n;return e===on.e.allTags?n="tags":e===on.e.allPlaces&&(n="places"),this._urlDataSource.getKey(((t={}).id=n,t))},t.prototype._getUpdateTagUrl=function(){return rt.t.skyApiBaseUrl+"UpdateTags"},t.prototype._getAllTagsUrl=function(){return rt.t.skyApiBaseUrl+"AllTags"},t.prototype._getAllGeolocationTagsUrl=function(){return rt.t.skyApiBaseUrl+"AllTags?qt=Geolocation"},t}(m.n),un=n(213),fn=n(103);!function(e){e[e.Event=0]="Event",e[e.AlbumSuggestion=1]="AlbumSuggestion",e[e.Highlights=2]="Highlights",e[e.Burst=3]="Burst"}(Vt||(Vt={}));var pn,mn,_n=n(3486),hn=n(2421),bn=n(4184),gn=n(1863),vn=n(2999),yn=n(703),Sn=n(3300),Dn=n(10),In=((pn={})[Vt[Vt.Event]]=0,pn[Vt[Vt.AlbumSuggestion]]=1,pn[Vt[Vt.Highlights]]=2,pn[Vt[Vt.Burst]]=3,pn),xn=["facesFolder","albumFolder","ascending","minRating","maxRating","favorites","highlights","etrmin","bmtsec","bhash","artmin","amtsec","ahashd","abadt","abadu","aminph","atagsout","aexpbph","wtrmin","wmtsec","whashd","wbadt","wbadu","wminph","wtagsout","wexpbph","wtaglist","wtagsother","wtagsnone","wphcount"];!function(e){e[e.ObjectDetectors=0]="ObjectDetectors",e[e.SystemDefined=1]="SystemDefined",e[e.OCR=2]="OCR",e[e.UserDefined=3]="UserDefined",e[e.LocationAndEventsApi=4]="LocationAndEventsApi"}(mn||(mn={}));var Cn,On=function(e){function t(t){var n=e.call(this,t)||this;return n._itemsStore=n.resources.consume(K.e),n._itemDataSource=n.resources.consume(G.v),n._urlDataSource=n.resources.consume(G.De),n._itemErrorProcessor=new(n.managed(_n.e)),n._identityDataSource=n.resources.consume(G.D),n._navigation=n.resources.consume(R.e),n._userSettingsStore=n.resources.consume(Ce.n),n._allPhotosUserSettings=s.observable(n._userSettingsStore&&n._userSettingsStore.getAllPhotosUserSettings()),n._pendingRequests={},n._thumbnailProcessor=new(n.managed(bn.e)),n._requestor=n.resources.consume(mt.e),n}return Object(p.__extends)(t,e),t.prototype.getAllPhotos=function(e){var t,n=this,a=new nt.e,i={pagingToken:e.pagingToken,ascending:e.ascending?1:0,pageSize:e.pageSize,rootItemId:e.rootItemId||"root",tagFilter:e.tagFilter,locationFilter:e.locationFilter,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights,verbose:2},r="ap";e.tagFilter&&(r="tag"),e.locationFilter&&(r="loc"),un.set("thumb-perf-sd",fn.n({view_id:r,new_ux:Object(pt.isFeatureEnabled)(pt.UseItemsScopeInAllPhotos)}),{secure:!0,domain:".live.com"});var o=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.locationFilter=e.locationFilter,t.tagFilter=e.tagFilter,t)),s=this._getAllPhotosUrl()+"?"+fn.n(i,null,!0),c=this._pendingRequests[s];return c||(c=this._pendingRequests[s]=a.send({apiName:"AllPhotos",url:s,isErrorExpectedCallback:vn.e}).then(function(e){delete n._pendingRequests[s];var t=new(n.resources.consume(j.a));!function(e){e.update([new gn.e(o).succeed({item:{key:o,isPlaceholder:!1,queryType:z.e.AllMyPhotos,type:V.e.Folder,name:yn.t,properties:{commandsSupported:{defc:"1"}},revision:0}})])}(t);var a=n._processAllPhotosResponse(e,t);return t.flush(),a},function(e){delete n._pendingRequests[s];var t=new(n.resources.consume(j.a));return n._processError({requestKey:o,error:e,observer:t}),t.flush(),Ue.n.wrapError(e)})),c},t.prototype.setAllPhotosSettings=function(e){var t=this,n=new nt.e,a=rt.t.skyApiBaseUrl+"UpdateItem?lct=1",i=this._pendingRequests[a];return i||(i=this._pendingRequests[a]=n.sendPost("UpdateItem",a,JSON.stringify(e)).then(function(e){return delete t._pendingRequests[a],e},function(e){return delete t._pendingRequests[a],Ue.n.wrapError(e)})),i},t.prototype.getPhotoSetKey=function(e){var t=e.ascending,n=void 0!==t&&t,a=e.rootItemId,i=void 0===a?"root":a;return fn.n({parentKey:this.getItemKey(e),rootItemId:i,isAscending:n,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights},null,!0)},t.prototype.getItemKey=function(e){var t;return this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t.onThisDay=e.onThisDay,t.onThisMonth=e.onThisMonth,t.lastWeekPreviousYears=e.lastWeekPreviousYears,t.u=e.uniqueName,t))},t.prototype.getAllPhotosSettings=function(e){var t,n=this;if(this._identityDataSource.getIdentity().type===Dt.e.anonymous)return this._allPhotosUserSettings;var a=this._allPhotosUserSettings.peek(),i={parentKey:this._urlDataSource.getKey((t={},t.id="root",t.u="allphotossettings",t)),skipCache:!0,skipInMemoryCache:!!e,pageSize:0,itemSetKey:""},r="",o=!1;return this._itemDataSource.getItem(i).then(function(e){if(e){var t=n.peekUnwrapObservable(n._itemsStore.getItem(e.item.key));if(t&&t.properties)return r=void 0!==t.properties.allPhotosFolderId?t.properties.allPhotosFolderId:a.rootId,o=void 0!==t.properties.allPhotosSortAscending?t.properties.allPhotosSortAscending:a.isAscending,n._requestor.send({apiName:"Items",path:"/drive/items/".concat(r,"?$select=specialFolder"),requestType:"GET",useAuthorizationHeaders:!0})}}).done(function(e){var t={rootId:r,isAscending:o,folderName:e.specialFolder?e.specialFolder.name:"root"};n._userSettingsStore.setAllPhotosUserSettings(t),n._allPhotosUserSettings(t)},function(e){}),this._allPhotosUserSettings},t.prototype.getMetadataContext=function(e){var t,n=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t)),a=this._urlDataSource.getKeyParams(n);return{avoidSeamSnapping:!0,parentKey:n,ownerId:this.getOwnerId(),pageSize:0,filters:{tagFilter:a.tagFilter,locationFilter:a.locationFilter}}},t.prototype.getOwnerId=function(e){return this._urlDataSource.getKeyParams(e).cid||Dn.W},t.prototype._processAllPhotosResponse=function(e,t){for(var n=[],a=[],i=0,r=e.items;i<r.length;i++){var o=r[i];n.push(this._processItem(o,t))}for(var s=0,c=e.itemGroupings;s<c.length;s++){var d=c[s],l=this._processGrouping(d);a.push(l)}return{futurePagingToken:e.futurePagingToken,pastPagingToken:e.pastPagingToken,items:n,itemGroupings:a}},t.prototype._processItem=function(e,t){var n,a=this._urlDataSource.getKey(((n={}).id=e.resId,n)),i={key:a,queryType:z.e.AllMyPhotos,name:e.name,displayName:e.name,extension:e.extension},r=e.thumbnailBaseUrl?this._createThumbnail(e):void 0;e.isVideo?(i.video={height:e.height,width:e.width},i.iconName="video"):(i.photo={height:e.height,width:e.width,quality:{isBad:e.isBad}},i.iconName="photo");var o=e.resId,c=rt.t.viewerId;if(i.id=o,i.itemId=o,i.ownerId=c,i.graph={itemId:o,driveId:c,driveType:"personal"},e.dateTaken){var d=new Date(e.dateTaken.isoDate),l=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds()));i.dateTakenTime=l}i.dateTaken=e.dateTaken&&e.dateTaken.date,(i=Object(Sn.e)(i)).sharingRole=et.e.Owner,i.type=V.e.Media;var u=[];return e.tags&&(u=e.tags.filter(function(e){return!e.source||e.source.toLowerCase()!==mn[mn.OCR].toLowerCase()&&e.source.toLowerCase()!==mn[mn.LocationAndEventsApi].toLowerCase()})),e.location&&(i.geoLocation=s.utils.extend({},e.location),i.geoLocation.displayString=hn.a(i.geoLocation)),i.tags=u,i.isPlaceholder=!1,i.thumbnail=r,t.update([new gn.e(a).succeed({item:i})]),i},t.prototype._processGrouping=function(e){for(var t={},n={},a=[],i=0,r=e.groups;i<r.length;i++){var o=r[i],s=this._processGroup(o);t[s.id]=s;for(var c=0,d=s.keys;c<d.length;c++)n[d[c]]=s.id;a.push(s)}return{name:void 0,itemGroups:void 0,groupType:this._getGroupType(e.groupType),groups:a,groupMap:t,itemToGroupMap:n}},t.prototype._processGroup=function(e){for(var t,n=[],a=0,i=e.resIds;a<i.length;a++){var r=i[a],o=this._urlDataSource.getKey(((t={}).id=r,t));n.push(o)}var c=s.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.earliestPhotoTime.isoDate)},e.earliestPhotoTime),d=s.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.latestPhotoTime.isoDate)},e.latestPhotoTime);return{closedFuture:e.closedFuture,closedPast:e.closedPast,earliestPhotoTime:c,id:e.id,latestPhotoTime:d,location:e.location,keys:n,featuredKey:e.featuredResIds&&e.featuredResIds[0]}},t.prototype._extractUTCFullYearFromIsoDate=function(e){return new Date(e).getUTCFullYear().toString()},t.prototype._processError=function(e){var t=e.requestKey,n=e.error,a=e.observer;2===(n&&n.data&&n.data.code)&&this._identityDataSource.getIdentity().type===Dt.e.anonymous&&(n.data.code=152),this._itemErrorProcessor.processError({requestKey:t,error:n,observer:a})},t.prototype._getAllPhotosUrl=function(){return rt.t.skyApiBaseUrl+"AllPhotos"},t.prototype._createThumbnail=function(e){return this._thumbnailProcessor.processThumbnailSet({baseUrl:"",thumbnails:[{name:"unRes",url:"".concat(e.thumbnailBaseUrl,"?").concat(fn.n({psid:2})),width:e.width,height:e.height}]},{id:e.resId,ownerCid:rt.t.viewerId,photo:{width:e.width,height:e.height}})},t.prototype._getGroupType=function(e){return In[e]||0},t.prototype._addDebugParamsToRequest=function(e){for(var t=this._navigation.viewParams,n=0,a=xn;n<a.length;n++){var i=a[n];i in t&&(e[i]=t[i])}},t}(m.n),wn=n(32),En=n(331),An=n(244),Ln=function(e){function t(){var t=e.call(this)||this;return t._platform=t.resources.consume(An.e),t._urlDataSource=t.resources.consume(Oe.n),t}return Object(p.__extends)(t,e),t.prototype.sendFeedback=function(e){var t=FilesConfig.SuiteNavConfig.UserDisplayName,n=$Config.email,a="\r\n",i=this._getBoundaryString(),r=window.FilesConfig&&window.FilesConfig.df,o=this._platform.osName+" "+this._platform.osVersion,s=$Config.pageContextInfo.pageType,c=it.format(rt.t.feedbackBaseUrl,rt.t.viewerId)+"/SendFeedback?mkt="+$Config.mkt,d=this._platform.browserName,l=this._platform.browserMajor,u=new nt.e,f={};f["Content-Type"]="multipart/form-data; boundary="+i;var p="\r\n--"+i+"\r\nContent-ID: <Feedback>\r\nContent-Type: application/json"+a+a+JSON.stringify({device:{platform:"Web",platformVersion:o,deviceModel:d,deviceVersion:l},appVersion:Flight.version,feedbackType:"Bug",app:"OneDrive",isDogfoodBuild:r?1:0,comment:e,backendVersion:s,user:{email:n,firstName:t,isBusiness:!1,authType:"MSA",authEnvironment:"Prod"},extraData:[{id:"360018226372",value:Flight.session}]})+"\r\n\r\n--"+i+a;return u.send({headers:f,apiName:"SendFeedback",url:c,requestType:"POST",postData:p,returnRawXHR:!0,useDefaultHeaders:!1}).then(function(e){return Ue.n.wrap(e.statusText)},function(e){return Ue.n.wrapError(e)})},t.prototype._getBoundaryString=function(){return En.e.generate()},t}(m.n),kn=function(e){function t(t){var n=e.call(this,t)||this;return n._embedDataSource=n.resources.consume(G.l),n}return Object(p.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)},t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)},t}(m.n),Mn=n(2165),Pn=n(2359),Tn=n(1130),Un=function(e){function t(){var t=e.call(this)||this;return t._dataRequestor=t.resources.consume(Mn.e),t._urlDataSource=t.resources.consume(Oe.n),t}return Object(p.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return Object(p.__awaiter)(this,void 0,Ue.n,function(){var t,n,a,i,r=this;return Object(p.__generator)(this,function(o){switch(o.label){case 0:return Object(pt.isFeatureEnabled)(pt.EnableGraphApiGetEmbedInfo)?[4,this.resources.consumeAsync(G.D)]:[3,3];case 1:return t=o.sent(),this._dataRequestor=new Tn.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(p.__awaiter)(r,void 0,Ue.n,function(){return Object(p.__generator)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,Ue.n.reject("Could not retrieve identity data source")]}})})}}}),this._sharingService=new Pn.e({},{dataRequestor:this._dataRequestor}),[4,this._sharingService.getPermissions(e.id)];case 2:return n=o.sent(),[2,this._parsePermissions(n)];case 3:return a=new nt.e,i=this._urlDataSource.getEmbedInfoUrl(e),[2,a.send({apiName:"GetEmbedInfo",url:i,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return r._isExpected(e)?null:Ue.n.wrapError(e)})]}})})},t.prototype.createEmbedLink=function(e){var t=this,n={type:"embed"};return this._getItemUrl(e).then(function(e){var a="".concat(e,"/createLink");return t._dataRequestor.send({path:a,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n||{}),getErrorAsMessage:!0}).then(function(e){var t=e.link,n=void 0===t?{}:t,a=n.webHtml,i=void 0===a?"":a,r=n.webUrl;return{embedCode:i,embedUrl:void 0===r?"":r}})})},t.prototype._parsePermissions=function(e){for(var t,n=0,a=e;n<a.length;n++){var i=a[n];if("embed"===(null===(t=i.link)||void 0===t?void 0:t.type))return{embedCode:i.link.webHtml,embedUrl:i.link.webUrl}}},t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code},t.prototype._getItemUrl=function(e,t){return Ue.n.resolve(this.resources.consumeAsync(G.y).then(function(n){return n.getItemUrl(e,{apiVersion:t})}))},t}(m.n),Fn=n(3852),Hn=n(1931),Rn=n(403),Nn=n(3487),Bn=n(809),jn=function(){function e(){}return e.escapeUserInput=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},e}(),Vn=n(449),zn=n(1886),Gn=n(313),Kn=function(e){function t(t){var n=e.call(this,t)||this;return n._store=n.resources.consume(K.e),n._tagDataSource=n.resources.consume(G.ge),n._photoProvider=n.resources.consume(ue.f),n._identityDataSource=n.resources.consume(G.D),n._urlDataSource=n.resources.consume(G.Se),n._engagement=n.resources.consume(Rn.e),n._itemErrorProcessor=new(n.managed(_n.e)),n}return Object(p.__extends)(t,e),t.prototype.getAllTags=function(e){var t=this,n=this.getAllTagsSync(e,on.e.allTags);return n.isPlaceholder||n.isExpired?this._tagDataSource.getAllTags(on.e.allTags).then(function(a){t._clearPlaceholder(n.item.peek(),yn.f);var i=[],r=[];return hn.r(t._normalizeTags(a.tags),e.skipGrouping?1:0,i,r,e),n.isExpired=!1,n.isPlaceholder=!1,n.content({items:i,groupings:r}),n},function(e){return t._processError(n.item.peek().key,e),Ue.n.wrapError(e)}):n.content.peek().items.length>0?this._getThumbnails(n,e,on.e.allTags):Ue.n.wrap(n)},t.prototype.ensureHasThumbnails=function(e,t,n){for(var a=e.content.peek().items,i=0;i<a.length;i++)!a[i].peek().folder.covers.length&&i>=t.start&&i<=t.end&&this._fetchThumbnails(a[i],on.e.allTags,n)},t.prototype.getAllTagsForQuery=function(e,t){var n=this._photoProvider.getAllPhotosSettings().peek();return this.getAllTags({parentKey:null,startIndex:0,skipGrouping:!0,rootItemId:n.rootId}).then(function(n){for(var a=[],i=n.content.peek().items,r="#"===e[0]?e.substring(1):e,o=new RegExp("(^|\\s|/)"+jn.escapeUserInput(r),"i"),s=new Hn.e,c="",d={},l=0,u=t;l<u.length;l++)d[u[l].toLocaleLowerCase()]=!0;for(var f=0,p=i;f<p.length;f++){var m=p[f];c=m.peek().name,e&&!o.test(c.substring(1))||d[c.toLocaleLowerCase()]||a.push(m)}return s.item=n.item,s.content.peek().items=a,s})},t.prototype.getAllPlaces=function(e){var t=this,n=this.getAllTagsSync(e,on.e.allPlaces);if(n.isPlaceholder||n.isExpired){var a=[],i=[],r=[];return a.push(this._fetchRecentPlaces(i)),a.push(this._fetchPlaceTags(n.item.peek().key,r)),Ue.n.all(a).then(function(){t._clearPlaceholder(n.item.peek(),yn.d);var a=[],o=[],s=t._urlDataSource.getAllPhotosForPlaceUrl.bind(t._urlDataSource);return hn.i(i,r,a,o,e,s),n.isPlaceholder=!1,n.content({items:a,groupings:o}),n},function(e){return Ue.n.wrapError(e)})}return this._getThumbnails(n,e,on.e.allPlaces)},t.prototype.getAllTagsSync=function(e,t){var n=this._getAllTagsSetKey(t,e),a=this._store.getItemSet(n);if(!a){var i=this._tagDataSource.getParentKeyForTagType(t),r=this._store.getItem(i);if(!r){var o=new Bn.e(i);switch(o.type=V.e.Folder,o.virtualItemType=Vn.e.TagsRoot,o.queryType=z.e.AllMyPhotos,o.isRootFolder=!0,t){case on.e.allPlaces:case on.e.singlePlace:o.displayName=yn.d;break;case on.e.allTags:case on.e.singleTag:o.displayName=yn.f}this._store.setItem(o),r=this._store.getItem(i)}(a=new Nn.e(n,e)).item=r,this._store.setItemSet(n,a)}return a},t.prototype.updateTags=function(e){var t=this,n=this.resources.consume(st.resourceKey);return this._tagDataSource.updateTags(e).then(function(a){for(var i,r=e.skipInvalidate,o=0,s=e.items.length;o<s;o++)if((i=e.items[o]).UNSAFE_parent)if(r){var c={parentKey:i.key,ownerId:t._urlDataSource.getOwnerId(),skipCache:!0};n.getItem(c)}else n.invalidateItem(i.UNSAFE_parent.key);e.parentKey&&!r&&(n.invalidateItem(e.parentKey),t.resources.consumeAsync(G.k).then(function(e){e.invalidateCurrentItemSet()})),t.invalidateAllTags("root");for(var d=0,l=[].concat(e.tagsToAdd).concat(e.tagsToDelete);d<l.length;d++){var u=l[d];u&&u.tag&&t._store.invalidateTag(u.tag)}return t._engagement.logData({name:"TagProvider.UpdateTags",isIntentional:!0,extraData:{itemCount:e.items&&e.items.length,tagsAddedCount:e.tagsToAdd&&e.tagsToAdd.length,tagsRemovedCount:e.tagsToDelete&&e.tagsToDelete.length}}),a},function(e){return Ue.n.wrapError(e)})},t.prototype.invalidateAllTags=function(e){var t={parentKey:null,skipGrouping:!1};this._store.invalidateItemSet(this._getAllTagsSetKey(on.e.allTags,t)),t.skipGrouping=!0,this._store.invalidateItemSet(this._getAllTagsSetKey(on.e.allTags,t))},t.prototype._getThumbnails=function(e,t,n){for(var a=this,i=e.content.peek().items,r=[],o=Math.min(i.length,t.endIndex),s=new zn.e(4),c=function(e,t,n){return function(){return a._fetchThumbnails(e,t,n)}},d=t.startIndex;d<o;d++){var l=i[d].peek();l&&!l.folder.covers.length&&r.push(s.enqueue(c(i[d],n,t)))}return Ue.n.all(r).then(function(){return e},function(e){return Ue.n.wrapError(e)})},t.prototype._fetchThumbnails=function(e,t,n){var a=this,i={parentKey:n.parentKey,rootItemId:n&&n.rootItemId,ascending:n&&n.ascending,pageSize:5,startIndex:0};switch(t){case on.e.allTags:i.tagFilter=e.peek().id,i.photoType=Gn.e.allTags;break;case on.e.allPlaces:i.locationFilter=e.peek().id,i.photoType=Gn.e.allPlaces;break;default:return Ue.n.wrap()}return this._photoProvider.getAllPhotos(i).then(function(t){for(var n=[],i=0,r=t;i<r.length;i++){var o=r[i];o.thumbnail&&n.push(o.thumbnail)}var c=new Bn.e(e.peek().key);return s.utils.extend(c,e.peek()),c.folder=s.utils.extend({},e.peek().folder),c.folder.covers=n,e(c),a._store.setItem(c),Ue.n.wrap()},function(e){return Ue.n.wrapError(e)})},t.prototype._fetchRecentPlaces=function(e){return Object(pt.isFeatureEnabled)(pt.UpdateOdcPhotoApiForConvergence)&&Object(ht.e)(Dn.W)?Ue.n.resolve():this._photoProvider.getAllPhotos({parentKey:void 0,startIndex:0,pageSize:100}).then(function(t){for(var n=t.length,a=0;e.length<5&&a<n;a++){var i=t[a].geoLocation,r=i&&i.hierarchyIndex;r&&(r=r.trim(),e.indexOf(r)<0&&e.push(r))}return Ue.n.wrap()},function(e){return Ue.n.wrapError(e)})},t.prototype._fetchPlaceTags=function(e,t){var n=this;return this._tagDataSource.getAllTags(on.e.allPlaces).then(function(e){for(var n=0,a=e.locations;n<a.length;n++){var i=a[n],r=i.hierarchyIndex&&i.hierarchyIndex.trim();if(r&&(i.hierarchyIndex=r,t.push(i),!i.country)){var o=r.split("\t");i.country=o[0],!i.city&&o.length>1&&(i.city=o[o.length-1])}}return Ue.n.wrap()},function(t){return n._processError(e,t),Ue.n.wrapError(t)})},t.prototype._processError=function(e,t){2===(t&&t.data&&t.data.code||0)&&this._identityDataSource.getIdentity().type===Dt.e.anonymous&&(t.data.code=152);var n=new(this.resources.consume(j.a));this._itemErrorProcessor.processError({requestKey:e,error:t,observer:n}),n.flush()},t.prototype._getAllTagsSetKey=function(e,t){var n={tagType:on.e[e],grouped:t.skipGrouping?0:1};return fn.n(n,null,!0)},t.prototype._normalizeTags=function(e){for(var t={},n=[],a=0,i=e;a<i.length;a++)t[d=(c=i[a]).localizedTag||c.tag]?n.push(d):t[d]=!0;if(n.length){for(var r=[],o=0,s=e;o<s.length;o++){var c,d=(c=s[o]).localizedTag||c.tag,l=-1!==n.indexOf(d);(!l||l&&c.localizedTag!==c.tag)&&r.push(c)}return r}return e},t.prototype._clearPlaceholder=function(e,t){if(e.isPlaceholder){var n=new Bn.e(e.key);s.utils.extend(n,e),n.isPlaceholder=!1,n.queryType=z.e.AllMyPhotos,n.type=V.e.Folder,t&&(n.displayName=t),this._store.setItem(n)}},t}(m.n),Wn=n(1899),qn=n(1453),Qn=n(159),Yn=n(322),Jn=n(608),Xn=n(37),Zn=Object(Jn.e)({eventName:"OnThisDay,",shortEventName:"OnThisDay"},{itemsInFirstPage:Xn.e.Number}),$n="Month",ea=function(e){function t(t){var n=e.call(this,t)||this;n._store=n.resources.consume(K.e),n._photoDataSource=n.resources.consume(G.G),n._urlDataSource=n.resources.consume(G.De),n._itemProvider=n.resources.consume(st.resourceKey),n.pages={},n._photoSetIsUpdating={},n._indicesBeingRequested={},n._pendingMetadataRequests={},n._totalChildCount={},n._photoGroupingData={},n._photoKeyToIndexMap={};var a=function(){if(!Cn)for(var e=0,t=[window.$Config&&window.$Config.mkt,Be.t.language,navigator.language,"en"];e<t.length;e++){var n=t[e];if(n)try{(new Date).toLocaleDateString(n),Cn=n;break}catch(e){}}return Cn}();if(n._formatDate=function(e){return e.toLocaleDateString(a)},"Intl"in window&&"object"==typeof window.Intl)try{n._dateFormatter=new Intl.DateTimeFormat(a,{month:"long",day:"numeric"}),n._formatDate=n._dateFormatter.format}catch(e){}return n}return Object(p.__extends)(t,e),t.prototype.getAllPhotos=function(e){var t=this,n=this.getAllPhotosSync(e),a=n.content.peek().items;return e.tagFilter&&(e.tagFilter=decodeURIComponent(e.tagFilter),n.isPlaceholder&&this.getAllPhotosMetadata(e).done(function(e){t.virtualizeAllPhotosSet(n)})),this._photoDataSource.getAllPhotos(e).then(function(i){if(n.isPlaceholder=!1,n.isExpired){var r=Math.max(t._getAllPhotosCount(n.key).peek(),0);a=new Array(r)}var o=i.items,s=e.tagFilter?[]:t._mergeGroupings(n,i);return t._mergeItemSets(i,n,e,a),n.content({items:a,groupings:s}),o})},t.prototype.determineStartEndRange=function(e,t,n){if(0===n)return{start:0,end:0};if(t.isExpired)return this.determineStartEndRangeForExpiredSet(e);var a=e.startIndex,i=e.endIndex||a+(e.pageSize||200);return i=n>0?Math.min(n,i):i,{start:a=Math.max(0,Math.min(i,a)),end:i}},t.prototype.determineStartEndRangeForExpiredSet=function(e){var t=this.getPhotoSetKey(e),n=e.startIndex;n<0&&(n=0);var a=e.pageSize;if(n<a&&e.endIndex<a)return{start:0,end:a};var i=this.findMonthGroupingByIndex(t,n);return i?(a=i.count,{start:i.startIndex,end:i.startIndex+a}):{start:0,end:0}},t.prototype.hasAllItemsInRange=function(e,t,n,a,i){return!i&&!!t.length&&!e.isExpired&&(a<=0||Wn.e(t,{start:n,end:a}))||!e.isExpired&&this._areAllPhotosInSetBeingRequested(e.key,t,n,a)},t.prototype.getAllPhotosForPage=function(e){var t=this;return Object(pt.isFeatureEnabled)(pt.UseItemsScopeInAllPhotos)?this._getAllPhotosForPagePromise=Ue.n.wrap(this._getAllPhotosForPagePromise).then(function(){return t.getAllPhotosForPage_original(e)},function(){return t.getAllPhotosForPage_original(e)}):this.getAllPhotosForPage_original(e)},t.prototype.getAllPhotosForPage_original=function(e){var t,n=this,a=this.getAllPhotosSync(e);switch(e.photoType){case Gn.e.AllMyPhotos:case Gn.e.singleTag:a.isPlaceholder&&(t=this.getAllPhotosMetadata(e))}return a.isExpired&&(this._invalidatePhotoSet(a.key),t=this.getAllPhotosMetadata(e)),Ue.n.wrap(t).then(function(t){n.virtualizeAllPhotosSet(a);var i=a.content.peek().items;e.endIndex&&e.endIndex>0&&!i[e.endIndex]&&(e.endIndex=e.endIndex+1);var r=n.determineStartEndRange(e,a,i.length),o=r.start,s=r.end,c=!!t&&i.length!==t.items.length&&0!==i.length;if(n.hasAllItemsInRange(a,i,o,s,c))return Ue.n.wrap(a);if(a.isExpired){var d=Math.max(n._getAllPhotosCount(a.key).peek(),0);i=new Array(d)}var l=[],u=n.getPageForIndex(a.key,o,s),f=n.getPastPageForIndex(a.key,o,s,e.pageSize),p=n.getFuturePageForIndex(a.key,o,s,e.pageSize),m=n.findMonthGroupingByIndex(a.key,o),_=n.determinePagingTypeForContext(o,s,f,p,m,e.pageSize),h=qn.e(e);if(1===_){if(!f.pastPagingToken)return;h.pagingToken=f.pastPagingToken,h.startIndex=f.endIndex,h.endIndex=f.endIndex+e.pageSize}else if(2===_){if(!p.futurePagingToken)return;h.pagingToken=p.futurePagingToken,h.startIndex=p.startIndex-e.pageSize,h.endIndex=p.startIndex,h.ascending=!0}else if(3===_){var b=!0,g=n._getStartDateForMonthGroup(m,b),v=m.count>e.pageSize,y=v?e.pageSize:m.count,S=m.startIndex+m.count;if(e.jumpToStartDate){g=e.jumpToStartDate;var D=e.endIndex-e.startIndex;y=(v=D>e.pageSize)?e.pageSize:D,S=e.endIndex,b=e.ascending}if(!g)return Ue.n.wrap(a);if(h.startDate=g,h.startIndex=S-y,h.endIndex=S,h.pageSize=y,h.ascending=b,v)for(var I=0,x=l=n.makeBatchedContextsForDateJumping(h,m,y);I<x.length;I++){var C=x[I];n._storePage(null,a,C)}}else 0===_&&(h.startIndex=o,h.endIndex=e.pageSize);u=n._storePage(u,a,h),l.unshift(h);var O=function(e){return n._photoDataSource.getAllPhotos(e).then(function(t){a.isPlaceholder=!1;for(var r=e.startIndex;r<e.endIndex;r++){var o=r-e.startIndex,s=t.items[o];s&&(n._photoKeyToIndexMap[s.key]=r)}(u=n.getPageForIndex(a.key,e.startIndex,e.endIndex))||(u={startIndex:e.startIndex,endIndex:e.endIndex},n.insertPage(a.key,u)),u.futurePagingToken||u.pastPagingToken||(u.futurePagingToken=t.futurePagingToken,u.pastPagingToken=t.pastPagingToken);var c=e.tagFilter?[]:n._mergeGroupings(a,t);for(n._mergeItemSets(t,a,e,i),r=e.startIndex;r<=e.endIndex;r++)n._indicesBeingRequested[a.key][r]=!1;if(l&&l.length){var d=e.ascending?l.shift():l.pop();return d.pagingToken=e.ascending?t.futurePagingToken:t.pastPagingToken,d.ascending=e.ascending,u=n.getPageForIndex(a.key,d.startIndex,d.endIndex),u=n._storePage(u,a,d),n._photoSetIsUpdating[a.key]=!0,O(d)}return a.isExpired=!1,a.content({items:i,groupings:c}),n._photoSetIsUpdating[a.key]=!1,a},function(e){for(var t=!0,n=0,a=i;n<a.length;n++){var r=a[n];if(r&&r.peek()){t=!1;break}}if(t)return Ue.n.wrapError(e)})};return 1===l.length?O(l.shift()):Ue.n.all([O(l.shift()),O(l.pop())])},function(e){})},t.prototype.makeBatchedContextsForDateJumping=function(e,t,n){for(var a=[],i=Math.ceil((t.count-e.pageSize)/e.pageSize),r=1;r<=i;r++){var o=qn.e(e),s=n*r,c=e.startIndex-s;o.startIndex=c<0?0:c,o.endIndex=e.endIndex-s,r===i?(o.ascending=!1,o.startDate=Object(Yn.c)(this.getDateStringForAllPhotos(new Date(Date.parse(t.data.isoDate)),!0)).toISOString(),o.startIndex=t.startIndex,o.pageSize=Math.abs(o.endIndex-o.startIndex)):(o.ascending=!0,delete o.startDate),a.push(o)}return a},t.prototype.virtualizeAllPhotosSet=function(e){var t=e.content.peek(),n=t.items,a=!1,i=this._getAllPhotosCount(e.key).peek();if(-1!==i)if(n.length<i){for(var r=n.length;r<i;r++)n.push(null);a=!0}else if(n.length>i){var o=n.length-i;n.splice(-1*o),a=!0}a&&e.content({items:n,groupings:t.groupings})},t.prototype.determinePagingTypeForContext=function(e,t,n,a,i,r){var o=0;return n&&e<=n.endIndex?o=1:a&&e<a.startIndex?o=2:e<r&&t<=r?o=0:i&&(o=3),o},t.prototype.getItemSync=function(e){var t=this._photoDataSource.getItemKey(e),n=this._store.getItem(t);if(!n){var a=new Bn.e(t);if(a.properties.commandsSupported={defc:"1"},a.queryType=z.e.AllMyPhotos,a.displayType=z.e.AllMyPhotos,a.type=V.e.Folder,e.tagFilter){var i=e.tagFilter.split(";"),r=i[0],o=i[1];a.virtualItemType=Vn.e.Tag,a.name="#"+r,a.tags=[{source:null,type:null,tag:r,localizedTag:o}]}if(e.locationFilter&&(a.virtualItemType=Vn.e.Location),e.onThisDay){a.folder={childCount:0,photoCount:0,covers:[]};var s=this._urlDataSource.getKeyParams(t);a.ownerId=s.cid||Dn.W;var c=new Date(Date.parse(e.startDate));a.dateTakenTime=c,a.isAlbum=!0,a.virtualItemType=Vn.e.Album}e.tagFilter||e.locationFilter||(a.isRootFolder=!0),n=this._store.setItem(a)}return n},t.prototype.getAllPhotosSync=function(e){var t=this.getPhotoSetKey(e),n=this._store.getItemSet(t),a=this.getItemSync(e);if(!n){var i=e.ascending,r=void 0!==i&&i;(n=new Nn.e(t,e)).content.peek().groupings=[],n.item=a,n.isAscending=r,this._store.setItemSet(t,n)}return n},t.prototype.getAllPhotosMetadata=function(e){var t=this,n=this._photoDataSource.getMetadataContext(e),a=this.getPhotoSetKey(e);if(this._pendingMetadataRequests[a])return this._pendingMetadataRequests[a];var i=!1,r=this._itemProvider.getItem(n).then(function(e){var n=e.content.peek(),r=t.getPhotoGroupingData(a);t._totalChildCount[a]?t._totalChildCount[a](n.items.length):t._totalChildCount[a]=t.createObservable(n.items.length);var o=t._getGroupingByKey(n.groupings,$n);r.itemGroup(o.itemGroups);var s=t._store.getItemSet(a),c=n.groupings,d=s.content.peek().groupings||[];if(s&&c){for(var l=!1,u=0,f=c;u<f.length;u++){for(var m=f[u],_=!1,h=0;h<d.length;h++){var b=d[h];if(b&&b.name===m.name&&(_=!0,b!==m)){l=!0,d.splice(h,1);break}}_||(l=!0)}l&&(d.splice.apply(d,Object(p.__spreadArray)([0,0],c,!1)),s.content({items:s.content.peek().items,groupings:d}))}return t._resolvePhotoSetGroupingData(a),i=!0,delete t._pendingMetadataRequests[a],n},function(e){return t._resolvePhotoSetGroupingData(a),delete t._pendingMetadataRequests[a],i=!0,Ue.n.wrapError(e)});return i||(this._pendingMetadataRequests[a]=r),r},t.prototype.getPhotoGroupingData=function(e){return this._photoGroupingData[e]||(this._photoGroupingData[e]={hasResolved:this.createObservable(!1),itemGroup:this.observables.createArray([])}),this._photoGroupingData[e]},t.prototype.getOnThisDayPhotos=function(e){var t,n=this,a=this.getAllPhotosSync(e),i=0===e.startIndex;return i&&(t=new Zn),a.isPlaceholder||a.isExpired?this.getAllPhotosMetadata(e).then(function(r){for(var o=[],s=new Date(Date.parse(e.startDate)),c=n._getGroupingByKey(r.groupings,$n),d=s.getMonth(),l=s.getDate(),u=s.getFullYear(),f=new Date(u,d,l),p=new Date(u,d,l+1),m={},_=0,h=c.itemGroups;_<h.length;_++){var b=h[_],g=new Date(Date.parse(b.data.isoDate));if(!(g.getTime()>p.getTime())){var v=new Date(g.getTime());for(v.setUTCMonth(g.getUTCMonth()+1);v.getTime()<=f.getTime()||f.getDate()!==l;)u--,f=new Date(u,d,l),p=new Date(u,d,l+1);g.getTime()<p.getTime()&&v.getTime()>f.getTime()&&(m[f.toISOString()]=p.toISOString())}}for(var y in m)o.push({parentKey:void 0,startDate:y,endDate:m[y],highlights:e.highlights,pageSize:100,ascending:!0,rootItemId:e.rootItemId,startIndex:e.startIndex,endIndex:e.endIndex});return Ue.n.all(o.map(function(e){return n.getAllPhotos(e)})).then(function(r){var s,c=[].concat.apply([],r),d=[],l=null;if(c.length){var u=o.map(function(e){return n.getAllPhotosSync(e)});l=u.filter(function(e){return!!e.content.peek().items.length}).map(function(e){return s||(s=new Date(Date.parse(e.context.startDate))),e.content.peek().groupings[0]}).reduce(function(e,t){return{name:t.name,itemGroups:Qn.e(e.itemGroups,t.itemGroups),groupMap:Qn.e(e.groupMap,t.groupMap),groups:e.groups.concat(t.groups),groupType:2,itemToGroupMap:Qn.e(e.itemToGroupMap,t.itemToGroupMap)}},{name:"",itemGroups:[],groupMap:{},groups:[],groupType:2,itemToGroupMap:{}});var f=0;l.groups=l.groups.map(function(e){return e.startIndex=f,f+=e.keys.length,e}),d=c.map(function(e){return n._store.getItem(e.key)})}a.isPlaceholder=!1,a.isExpired=!1;var p=n.getItemSync(e).peek(),m={covers:c.map(function(e){return e.thumbnail}).filter(function(e){return!(!e||!e.url)}),photoCount:c.length},_=s?n._formatDate(s):"";return a.item(Qn.e(Qn.e(new Bn.e(p.key),p),{childCount:c.length,folder:m,isPlaceholder:!1,name:_})),a.content({items:d,groupings:[l]}),i&&t.end({itemsInFirstPage:d.length}),a},function(e){})}):Ue.n.wrap(a)},t.prototype.getPastPageForIndex=function(e,t,n,a){for(var i=0,r=this.pages[e]||(this.pages[e]=[]);i<r.length;i++){var o=r[i],s=o.endIndex+a,c=t<=o.endIndex&&t>=o.startIndex&&n<=s,d=t>=o.endIndex&&t<=s&&n<s,l=o.startIndex===t&&o.endIndex===n;if((c||d)&&!l)return o}return null},t.prototype.getFuturePageForIndex=function(e,t,n,a){for(var i=0,r=this.pages[e]||(this.pages[e]=[]);i<r.length;i++){var o=r[i],s=o.startIndex-a,c=n>=o.startIndex&&n<=o.endIndex&&t>=s,d=n>=o.startIndex&&n<=s&&t<=s,l=o.startIndex===t&&o.endIndex===n;if((c||d)&&!l)return o}return null},t.prototype.getPageForIndex=function(e,t,n){for(var a=0,i=this.pages[e]||(this.pages[e]=[]);a<i.length;a++){var r=i[a];if(t>=r.startIndex&&n<=r.endIndex)return r}return null},t.prototype.insertPage=function(e,t){for(var n=this.pages[e]||(this.pages[e]=[]),a=0;a<n.length;a++){var i=n[a];if(i.startIndex===t.startIndex&&i.endIndex===t.endIndex)return;if(t.endIndex<i.endIndex||t.endIndex===i.endIndex&&t.startIndex<i.startIndex)return void n.splice(a,0,t)}n.push(t)},t.prototype.findMonthGroupingByIndex=function(e,t){var n=this.getPhotoGroupingData(e),a=this.getPhotoGroupingData(e)&&n.itemGroup.peek();if(!a)return null;for(var i=0,r=a;i<r.length;i++){var o=r[i],s=o.startIndex+o.count;if(t>=o.startIndex&&t<s)return o}return null},t.prototype.getPhotoSetKey=function(e){return this._photoDataSource.getPhotoSetKey(e)},t.prototype.setAllPhotosSettings=function(e){return this._photoDataSource.setAllPhotosSettings(e)},t.prototype.getAllPhotosSettings=function(e){return!e&&this._allPhotosSettings||(this._allPhotosSettings=this._photoDataSource.getAllPhotosSettings(e)),this._allPhotosSettings},t.prototype.getDateStringForAllPhotos=function(e,t){var n=new Date(e.getTime());if(n.setUTCDate(1),n.setUTCHours(0),n.setUTCMinutes(0),n.setUTCSeconds(0),n.setUTCMilliseconds(0),!t){var a=n.getUTCMonth();n.setUTCMonth(a+1)}return n},t.prototype._getGroupingByKey=function(e,t){for(var n=null,a=0,i=e;a<i.length;a++){var r=i[a];if(r&&r.name===t){n=r;break}}return n},t.prototype._mergeItemSets=function(e,t,n,a){var i=e.items,r=n.startIndex;if(n.ascending)for(var o=i.length-1;o>=0;o--,r++)a[r]=this._store.getItem(i[o].key);else for(o=0;o<i.length;o++,r++)a[r]=this._store.getItem(i[o].key);var s=this.getPhotoGroupingData(t.key),c=s&&s.itemGroup.peek().length>0,d=!e.futurePagingToken&&!e.pastPagingToken;(!n.locationFilter&&!n.tagFilter||n.pageSize!==i.length||d)&&(c||!s.hasResolved.peek()||d)||a.push(null)},t.prototype._getAllPhotosCount=function(e){var t=this._totalChildCount[e];return t||(t=this._totalChildCount[e]=this.createObservable(-1)),t},t.prototype._storePage=function(e,t,n){if(!e){var a=t.key,i=n.startIndex,r=void 0===i?0:i,o=n.endIndex;e={startIndex:r,endIndex:void 0===o?n.pageSize:o},this.insertPage(a,e);var s=this._indicesBeingRequested[a];s||(s=this._indicesBeingRequested[a]={});for(var c=e.startIndex;c<e.endIndex;c++)s[c]=!0}return e},t.prototype._invalidatePhotoSet=function(e){delete this._photoGroupingData[e],delete this.pages[e],this._photoKeyToIndexMap={}},t.prototype._areAllPhotosInSetBeingRequested=function(e,t,n,a){var i=!0;if(!this._indicesBeingRequested[e])return!1;for(var r=n;r<a;r++)if(!this._indicesBeingRequested[e][r]){i=!1;break}return i},t.prototype._resolvePhotoSetGroupingData=function(e){this.getPhotoGroupingData(e).hasResolved(!0)},t.prototype._getStartDateForMonthGroup=function(e,t){var n,a;return e?(a=e.data.isoDate?new Date(Date.parse(e.data.isoDate)):this._getDateFromString(e.data.monthName,e.data.year),(n=this.getDateStringForAllPhotos(a,t)).toISOString()):n},t.prototype._getDateFromString=function(e,t){var n=Date.parse(e+" 1, "+t);return isNaN(n)?null:new Date(n)},t.prototype._mergeGroupings=function(e,t){for(var n=e.content.peek().groupings||[],a=0,i=t.itemGroupings;a<i.length;a++){for(var r=i[a],o=r.groupType,s=void 0,c=0,d=n;c<d.length;c++){var l=d[c];if(l.groupType===o){s=l;break}}s||n.push(r),this._createMapsFromGroups(s||r,r)}return n},t.prototype._createMapsFromGroups=function(e,t){if(t)for(var n=0,a=t.groups;n<a.length;n++){var i=a[n],r=i.id;if(e.groupMap[r]){for(var o={},s=0,c=e.groupMap[r].keys;s<c.length;s++)o[m=c[s]]=!0;for(var d=0,l=i.keys;d<l.length;d++)o[m=l[d]]=!0;e.groupMap[r].keys=Object.keys(o)}else e.groupMap[r]=i,e.groups.push(i);for(var u=void 0,f=0,p=i.keys;f<p.length;f++){var m=p[f];e.itemToGroupMap[m]=r;var _=this._photoKeyToIndexMap[m];(void 0===u||_<u)&&(u=_)}i.startIndex=u}},t}(m.n),ta=ea,na=function(e){function t(t){var n=e.call(this,t)||this;return n._storageInfoDataSource=n.resources.consume(G.pe),n}return Object(p.__extends)(t,e),t.prototype.getStorageInfo=function(e){var t=this;return void 0===e&&(e=!1),!e&&this._cachedStorageInfo?Ue.n.resolve(this._cachedStorageInfo):this._storageInfoDataSource.getStorageInfo().then(function(e){return t._cachedStorageInfo=e,e},function(){})},t.prototype.redeemCode=function(e){return this._storageInfoDataSource.redeemCode(e)},t.prototype.sendInvitation=function(e){return this._storageInfoDataSource.sendInvitation(e)},t}(m.n),aa=n(2053),ia=n(47),ra=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.storageOptionsData=n.createObservable(null),n._storageOptionsDataSource=n.resources.consume(G.me),n}return Object(p.__extends)(t,e),t.prototype.updateStorageOptions=function(e){if(void 0===e&&(e=!1),!e&&this.storageOptionsData.peek())return Ue.n.wrap(this.storageOptionsData.peek());var t=new ia.e({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)},t.prototype._storageOptionsHelper=function(e,t){var n=this;return e<=7?this._storageOptionsDataSource.getStorageOptions().then(function(a){return t.end({resultType:ia.t.Success,extraData:{retries:e}}),n.storageOptionsData(a),a},function(a){a.data&&159===a.data.code?n.async.setTimeout(function(){n._storageOptionsHelper(e+1,t)},1e3):t.end({resultType:ia.t.Failure,extraData:{retries:e}})}):void t.end({resultType:ia.t.Failure,extraData:{retries:e}})},t}(m.n),oa=107374182400,sa=function(e){function t(t){var n=e.call(this,t)||this;return n._storageOptionsDataSource=n.resources.consume(G.me),n._storageOptionsRequestor=new(n.managed(ra)),n._storageOptionsRequestor.updateStorageOptions(),n.isReady=n.createPureComputed(n._computeIsReady),n.isEligibleForPremium=n.createPureComputed(n._computeIsEligibleForPremium),n.isEligibleForOneDrivePlan=n.createPureComputed(n._computeIsEligibleForOneDrivePlan),n.isEligibleFor100Gbplan=n.createPureComputed(n._computeIsEligibleFor100GbPlan),n.hasOffice=n.createPureComputed(n._computeHasOffice),n.hasStoragePlan=n.createPureComputed(n._computeHasStoragePlan),n._data=n.createPureComputed(function(){return n._storageOptionsRequestor.storageOptionsData()}),n}return Object(p.__extends)(t,e),t.prototype.getStorageOptions=function(e){return void 0===e&&(e=!0),!e&&this._data()?Ue.n.wrap(this._data()):this._storageOptionsDataSource.getStorageOptions()},t.prototype.getPremiumPurchaseInformation=function(e){var t=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var n=t._parsePremiumPlans(e),a=n[0],i=n[1];return a&&a.pricePerMonth?t._getPurchaseInfo(a,!0,!0):i&&i.pricePerMonth?t._getPurchaseInfo(i,!0,!1):a&&a.pricePerYear?t._getPurchaseInfo(a,!1,!0):i&&i.pricePerYear?t._getPurchaseInfo(i,!1,!1):void 0})},t.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})},t.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var a=n[t];if(aa.e[a.type]===aa.e.Home||aa.e[a.type]===aa.e.Personal||aa.e[a.type]===aa.e.Solo)for(var i=0,r=a.purchaseActions;i<r.length;i++){var o=r[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}}return!1})},t.prototype._getHasBiggestOneDrivePlan=function(){var e,t=this._data(),n=t.oneDrivePlans,a=t.hasCurrentOfficePlan,i=null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0;return!(!a||i<1)&&n[i-1].isCurrentPlan},t.prototype._areOneDrivePlansAvailable=function(){var e=this._data().oneDrivePlans;return!!e&&e.length>0},t.prototype._hasPlanWith100GBOrMore=function(){var e=this._data().storagePlans;if(null!==e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.isCurrentPlan&&a.durationInMonths>0)return a.planQuotaBytes>=oa}return!1}return null},t.prototype._getPurchaseInfo=function(e,t,n){e.market=this._data().market;var a=t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl;return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:a,planName:e.type,planType:n?aa.e.Personal:aa.e.Home}},t.prototype._parsePremiumPlans=function(e){var t,n;if(e&&e.officePlans)for(var a=0,i=e.officePlans;a<i.length;a++){var r=i[a];if(aa.e[r.type]!==aa.e.Trial){for(var o=0,s=r.purchaseActions;o<s.length;o++){var c=s[o];1===c.durationInMonths&&(r.pricePerMonth=c.price,r.secondaryOfficePlanUrl=c.purchaseUrl),12===c.durationInMonths&&(r.pricePerYear=c.price,r.mainOfficePlanUrl=c.purchaseUrl)}aa.e[r.type]===aa.e.Home?t=r:n=r}}return[n,t]},t.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var a=n[t];if(aa.e[a.type]===aa.e.Home||aa.e[a.type]===aa.e.Personal||aa.e[a.type]===aa.e.Solo)for(var i=0,r=a.purchaseActions;i<r.length;i++){var o=r[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}return!1}},t.prototype._computeIsEligibleForOneDrivePlan=function(){return!(!this.hasOffice()||!this._areOneDrivePlansAvailable()||this._getHasBiggestOneDrivePlan())},t.prototype._computeIsEligibleFor100GbPlan=function(){var e,t=this._data(),n=null===(e=null==t?void 0:t.storagePlans)||void 0===e?void 0:e.find(function(e){return e.planQuotaBytes===oa&&1===e.durationInMonths});return!(!(null==n?void 0:n.price)||!(null==n?void 0:n.purchaseUrl)||this.hasOffice()||this.hasStoragePlan())},t.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan},t.prototype._computeHasStoragePlan=function(){var e=this._data();if(e)return!!e.hasCurrentStoragePlan||this._hasPlanWith100GBOrMore()},t.prototype._computeIsReady=function(){return!!this._data()},t}(m.n),ca=rt.t.skyApiBaseUrl+"GetApplicationDetails",da=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getApplicationDetails=function(e){var t=this;return(new nt.e).send({apiName:"GetApplicationDetails",url:ca+"?"+fn.n({appId:e.clientId}),requestType:"GET"}).then(function(n){return{userId:t._convertClientIdToUserId(e.clientId),email:null,name:n.name,image:n.logoUrl,profilePage:n.appUrl,entityType:Xe.e.application}})},t.prototype._convertClientIdToUserId=function(e){return parseInt(e,16).toString(10)},t}(m.n),la=da,ua=n(1994),fa=n(3),pa=n(3302),ma=!qe.t.isActivated("C9FA6D94-F790-4F47-BBE9-7F413FF889B1","07/21/2022","Update the way to get factid due to API update"),_a={FreePlan:0,PaidPlan:1,Reward:2,FreePlanBonus:3};function ha(e){return e.name?"FreePlan"===e.name?pa.e.Free:-1!==e.name.indexOf("Office")?pa.e.Office3651:"OneDrive100"===e.name?pa.e.OneDrive100:"OneDriveModern20"===e.name?pa.e.OneDriveModern20:"OneDriveModern200"===e.name?pa.e.OneDriveModern200:void 0:5368709120===e.offeredQuota.total&&"FreePlan"===e.entitlementType?pa.e.Free:void 0}var ba=function(e){function t(){var t=e.call(this)||this;return t._urlDataSource=t.resources.consume(Oe.n),t}return Object(p.__extends)(t,e),t.prototype.getStorageInfo=function(){var e=this;return Object(fa.cs)(fa.qr)?this.getStorageInfoV2():(new nt.e).send({apiName:"GetStorageInfo",url:t._storageInfoUrl}).then(function(e){return e},function(t){return Ue.n.wrapError(e._getError(t.data.code))})},t.prototype.redeemCode=function(e){var n=new nt.e,a=JSON.stringify({token:e.token,trackingGuid:e.trackingGuid});return n.sendPost("RedeemQuotaToken",t._redeemCodeUrl,a).then(function(e){return e.items||e.item},function(e){return Ue.n.wrapError(e.data.message)})},t.prototype.sendInvitation=function(e){var n=this,a=new nt.e;if(!e)return null;var i=JSON.stringify({recipients:e.map(function(e){return{RecipientType:0,EmailAddress:e}})});return a.sendPost("SendInvitation",t._sendInvitationUrl,i).then(function(e){return e},function(e){return Ue.n.wrapError(n._getError(e.data.code).errorTitle)})},t.prototype._getError=function(e,t){var n={errorCode:e,errorDetailedText:"",errorTitle:""};return 4102===e?n.errorTitle=ua.s:(n.errorTitle=ua.i,n.errorDetailedText=ua.a),n},t.prototype.getStorageInfoV2=function(){var e="v2.1";return this.resources.consume(mt.e).send({endpoint:Object(_t.f)({apiVersion:e,driveId:"me",includeViewerId:!0}),apiName:"GetStorageInfoV2",path:"/sites/root/consumerSiteAppConfigs/files",apiVersion:e,useAuthorizationHeaders:!0}).then(function(e){return function(e){if(!e)return null;var t=e.quota,n={displayQuotaExceeded:t.displayExceededQuota,displayQuotaRemaining:t.displayRemainingQuota,displayQuotaTotal:t.displayTotalQuota,displayQuotaUsed:t.displayUsedQuota,displayQuotaDeletedUsed:t.displayDeletedUsedQuota,quotaDeletedUsed:t.deleted,quotaTotal:t.total,quotaUsed:t.used},a=e.entitlements.filter(function(e){return!e.deletedDate||Date.now()<new Date(e.deletedDate).getTime()}).map(function(e){var t,n;return Object(p.__assign)({displayQuota:e.offeredQuota.displayTotalQuota,multiplier:e.quotaMultiplier,quotaBase:e.offeredQuota.base,totalBytes:e.offeredQuota.total,type:_a[e.entitlementType||e.offeredQuota.type],factId:ma&&+e.id||ha(e),category:null===(t=e.planInfo)||void 0===t?void 0:t.category,ownershipType:null===(n=e.planInfo)||void 0===n?void 0:n.ownershipType,displayLink:e.purchaseUrlLinkTitle,linkURL:e.purchaseUrlLink,maxMultiplier:e.maxReferralQuotaMultiplier,dateDeleted:e.deletedDate,displayExpiryDate:e.displayExpiryDate},e)}),i="active"===e.accountInfo.appStatus.state;return Object(p.__assign)(Object(p.__assign)({},e),{oneDriveStatus:{accountEnabled:i},hasHighestPlan:!e.quota.storagePlans.upgradeAvailable,quotaFacts:a,quota:n})}(e)})},t._storageInfoUrl=at.e+"/API/2/GetStorageInfo?planDetails=true&quotaForDisabled=true",t._redeemCodeUrl=at.e+"/API/2/RedeemQuotaToken",t._sendInvitationUrl=at.e+"/API/2/SendInvitation",t}(m.n);function ga(e,t){var n,a=null===(n=e.purchaseActions)||void 0===n?void 0:n[0];return Object(p.__assign)({price:null==a?void 0:a.price,durationInMonths:null==a?void 0:a.durationInMonths,purchaseUrl:null==a?void 0:a.purchaseUrl,planQuotaBytes:e.quotaBytes,market:t.market,purchaseData:{Currency:t.currency,Name:e.planName,Duration:null==a?void 0:a.durationInMonths}},e)}var va="GetUpgradeOptions",ya={unknown:0,upgrade:1,downgrade:2},Sa=function(e){function t(){var t=e.call(this)||this;return t._pendingRequests={},t._navigation=t.resources.consume(R.e),t._ctpMktParam=t._navigation.viewParams.ctpMkt,t}return Object(p.__extends)(t,e),t.prototype.getStorageOptions=function(){var e=this;if(Object(fa.cs)(fa.Qr))return this.getStorageOptionsV2();var n=new nt.e,a=this._navigation.viewParams.accountid,i=new nn.t(t._storageOptionsUrl);if(i.setQueryParameter("ctpMkt",this._ctpMktParam,!1),i.setQueryParameter("accountid",a,!1),this._pendingRequests[i.toString()])return this._pendingRequests[i.toString()];var r=n.send({apiName:va,url:i.toString()}).then(function(t){return delete e._pendingRequests[i.toString()],t}).catch(function(t){return delete e._pendingRequests[i.toString()],Ue.n.wrapError(t)});return this._pendingRequests[i.toString()]=r,r},t.prototype.getStorageOptionsV2=function(){var e=this,t="v2.1",n="/sites/root/consumerSiteAppConfigs/files/oneDrive.getUpgradeOptions(market='".concat(this._ctpMktParam||"en-Us","')");if(this._pendingRequests[n])return this._pendingRequests[n];var a=this.resources.consume(mt.e).send({endpoint:Object(_t.f)({apiVersion:t,driveId:"me",includeViewerId:!0}),apiName:"GetUpgradeOptionsV2",path:n,apiVersion:t,useAuthorizationHeaders:!0}).then(function(t){var a,i,r;return delete e._pendingRequests[n],Object(p.__assign)(Object(p.__assign)({},t),{storagePlans:null===(a=t.storagePlans)||void 0===a?void 0:a.filter(function(e){return e.purchaseActions&&e.purchaseActions.length>0}).map(function(e){return ga(e,t)}),officePlans:null===(i=t.officePlans)||void 0===i?void 0:i.filter(function(e){return e.purchaseActions&&e.purchaseActions.length>0}).map(function(e){return ga(e,t)}),oneDrivePlans:null===(r=t.incrementalOneDrivePlans)||void 0===r?void 0:r.map(function(e){return Object(p.__assign)(Object(p.__assign)({},e),{transition:ya[e.transition]||0})})})}).catch(function(t){return delete e._pendingRequests[n],Ue.n.wrapError(t)});return this._pendingRequests[n]=a,a},t._storageOptionsUrl=at.e+"/API/2/"+va,t}(m.n),Da=new c.t({name:"ReportAbuseVroomDataSource.key",loader:new d.t(function(){return n.ee([385],3942).then(function(e){return e.resourceKey})})}),Ia=new c.t({name:"RequestReviewVroomDataSource.key",loader:new d.t(function(){return n.ee(0,4314).then(function(e){return e.resourceKey})})}),xa=new c.t({name:"RemoveFromShareWithMeListVroomDataSource.key",loader:new d.t(function(){return n.ee([384],3943).then(function(e){return e.resourceKey})})}),Ca=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.getSubscriptions=function(e,t){return this._getSubscriptionsDataSource().then(function(n){return n.getSubscriptions(e,t)})},t.prototype.updateSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateSubscription(e)})},t.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})},t.prototype.createRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.createRootSubscription(e)})},t.prototype.updateRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateRootSubscription(e)})},t.prototype.deleteRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.deleteRootSubscription(e)})},t.prototype._getSubscriptionsDataSource=function(){var e=this;return this._subscriptionsDataSource?Ue.n.resolve(this._subscriptionsDataSource):this.resources.isExposed(G._e)?(this._subscriptionsDataSource=this.resources.consume(G._e),Ue.n.resolve(this._subscriptionsDataSource)):Ue.n.resolve(this.resources.consumeAsync(G._e)).then(function(t){return e._subscriptionsDataSource=t,t})},t}(m.n),Oa=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._vroomDataRequestor=n.vroomDataRequestor,a}return Object(p.__extends)(t,e),t.prototype.getSubscriptions=function(e,t){var n=this;return e.itemId?this._vroomDataRequestor.send({apiName:t?t+"subscriptions":"subscriptions",path:"/drive/items/".concat(e.itemId,"/subscriptions")}).then(function(e){return e.value.map(function(e){return n._translateToSubscriptionModel(e)})}):Ue.n.wrap([])},t.prototype.updateSubscription=function(e){var t=this,n=new Date;n.setMonth(n.getMonth()+1);var a={notificationUrl:"ActivityService://activity",expirationDateTime:n.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:e.apiNamePrefix?e.apiNamePrefix+"subscriptions":"subscriptions",path:"/drives/".concat(e.item.ownerId,"/items/").concat(e.item.itemId,"/subscriptions"),requestType:"POST",postData:JSON.stringify(a)}).then(function(e){return t._translateToSubscriptionModel(e)})},t.prototype.getRootSubscriptions=function(){var e=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(t){return t.value.map(function(t){return e._translateToSubscriptionModel(t)})})},t.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})},t.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/".concat(e.id),useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})},t.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"deleteSubscription",requestType:"DELETE",path:"/drive/root/subscriptions/".concat(e.id),useAuthorizationHeaders:!0})},t.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};return e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}}),t},t.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t},t.dependencies=Object(p.__assign)(Object(p.__assign)({},m.n.dependencies),{vroomDataRequestor:mt.e}),t}(m.n),wa=Object(d.r)("SubscriptionsDataSource",Oa),Ea=999999,Aa=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var a=t.map(La).join(",");return this.resources.consume(mt.e).send({apiName:"thumbnails",path:"/drives/".concat(e.driveId,"/items/").concat(e.itemId,"/thumbnails?select=").concat(a).concat(n?"&authkey=".concat(n):""),needsAuthorization:!n})},t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,Ea):this.getThumbnailForSize(e,Ea,t)},t.prototype.getThumbnailForSize=function(e,t,n){var a="c".concat(t,"x").concat(n);return e.value[0][a]},t}(m.n);function La(e){return"c".concat(e.width||Ea,"x").concat(e.height||Ea)}var ka,Ma,Pa,Ta=function(){function e(){}return e.prototype.getEncoding=function(){return"undefined"!=typeof FilesConfig&&FilesConfig&&FilesConfig.defaultCodePage?FilesConfig.defaultCodePage:null},e}(),Ua=n(3845),Fa=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.getUpsellFromOneRm=function(e){var t=new nt.e,n=new ia.e({name:this.getMarketingRequestApiId()}),a={url:e,apiName:"OneRM",returnRawXHR:!0,useDefaultHeaders:!0};return t.send(a).then(function(e){var t;try{t=e&&e.response&&JSON.parse(e.response)}catch(e){}return t?2===t.ContentType?n.end({resultType:ia.t.ExpectedFailure}):0===t.ContentType?n.end({resultType:ia.t.Success}):n.end({resultType:ia.t.Failure}):n.end({resultType:ia.t.Failure}),t},function(e){return n.end({resultType:ia.t.Failure}),Ue.n.wrapError(e)})},t.prototype.getMarketingRequestApiId=function(){return"SkyDriveWeb_Internal_Control_FirstRunView_MarketingRequest"},t}(m.n),Ha=function(e){function t(t){var n=e.call(this,t)||this;return n._upsellDataSource=n.resources.consume(G.ye),n}return Object(p.__extends)(t,e),t.prototype.getUpsellFromOneRm=function(e){return this._upsellDataSource.getUpsellFromOneRm(e)},t.prototype.getMarketingRequestApiId=function(){return this._upsellDataSource.getMarketingRequestApiId()},t}(m.n),Ra=n(4133),Na=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t},Ba=n(2890),ja=n(3305),Va=n(2397),za=n(2535),Ga=n(3303),Ka=n(2396),Wa=n(2586),qa=n(3139),Qa=((ka={})[Ba.e]=Va.r,ka[Ba.t]=Ga.e,ka[Ba.r]=za.n,ka[Ba.n]=za.c,ka[Ba.a]=[za.t,za.i],ka[Ba.i]=Va.t,ka[Ba.o]=Ka.e,ka[Ba.s]=Va.n,ka[Ba.c]=Ka.t,ka[Ba.d]=Wa.e,ka[Ba.l]=Wa.a,ka[Ba.u]=Ka.n,ka[Ba.f]=Va.e,ka[Ba.p]=Wa.t,ka[Ba.m]=Wa.n,ka[Ba._]=Wa.i,ka[Ba.h]=ja.e,ka[Ba.b]=Ka.r,ka[Ba.g]=qa.e,ka[Ba.v]=Wa.r,ka[Ba.y]=Va.a,ka[Ba.S]=Ka.i,ka[Ba.D]=za.a,ka[Ba.I]=Ka.o,ka[Ba.x]=Wa.o,ka[Ba.C]=za.r,ka[Ba.O]=Ga.t,ka[Ba.w]=za.o,ka[Ba.E]=Ga.n,ka[Ba.A]=Va.i,ka[Ba.k]=Ka.f,ka[Ba.L]=za.s,ka[Ba.M]=Va.o,ka[Ba.P]=Va.s,ka[Ba.T]=Ka.m,ka[Ba.U]=Ka.p,ka[Ba.F]=za.d,ka[Ba.H]=[Va.c,za.e],ka[Ba.R]=Wa.c,ka[Ba.N]=[qa.t,Ka.a],ka[Ba.B]=Wa.s,ka[Ba.j]=za.l,ka[Ba.V]=Wa.d,ka[Ba.z]=Wa.l,ka),Ya=((Ma={})[Ka.l.id]=!0,Ma[Ka.c.id]=!0,Ma[Ka.d.id]=!0,Ma[Ka.u.id]=!0,Ma),Ja=function(e){var t={};for(var n in e){var a=e[n];if(a instanceof Array)for(var i=0,r=a;i<r.length;i++)t[r[i].id]=n;else t[a.id]=n}return t}(Qa),Xa={1:1,2:2,3:3,4:4,7:7,6:6,10:10,11:11,15:15,50:50},Za={1:1,2:2,3:3,4:4,5:5,6:6,7:7},$a={1:1,2:2},ei=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.getCommand=function(e,t){if(Ya[t.id])return new Na;var n,a=this._getCommandName(t);if(a){var i=this._getActionId(e,a);if(i)switch(t){case ja.e:n=this._createDefaultClickCommand(i);break;case Wa.o:n=this._createOpenInClientCommand(i);break;case Wa.i:case Wa.e:case Wa.n:case Wa.t:n=this._createCreateDocumentCommand(i);break;default:this._isSuppressedCommand(e,t)||(n=new Na)}}return n},t.prototype._getActionId=function(e,t){var n;return e&&e.properties&&e.properties.commandsSupported&&(n=e.properties.commandsSupported[t]),n},t.prototype._isSuppressedCommand=function(e,t){if(Object(pt.isFeatureEnabled)(pt.EnableSamsungMotionPhotoVideos)){var n=[za.a,za.c,za.i,za.d,za.n];if(e.photo&&e.photo.isSamsungMotionPhoto)return!!n.find(function(e){return e===t})}return!!(Object(pt.isFeatureEnabled)(pt.EnableLivePhotoVideos)&&(n=[za.d,za.n,za.l],e.photo&&e.photo.isLivePhoto))&&!!n.find(function(e){return e===t})},t.prototype._getCommandName=function(e){return function(e){return Ja[e.id]}(e)},t.prototype._createDefaultClickCommand=function(e){return new Na({behavior:Xa[e]||0})},t.prototype._createOpenInClientCommand=function(e){return new Na({behavior:Za[e]||0})},t.prototype._createCreateDocumentCommand=function(e){return new Na({behavior:$a[e]||0})},t}(m.n),ti=ei;!function(e){e[e.OfficeLens=0]="OfficeLens"}(Pa||(Pa={}));var ni=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.applyOfficeLens=function(e){var t=this.resources.consume(mt.e),n={name:Pa[Pa.OfficeLens]};return t.send({apiName:"lenses",path:"/drive/items/".concat(e.item.id,"/lenses"),requestType:"POST",postData:JSON.stringify(n)})},t.prototype.removeOfficeLens=function(e){return this.resources.consume(mt.e).send({apiName:"lenses",path:"/drive/items/".concat(e.item.id,"/lenses/").concat(Pa[Pa.OfficeLens]),requestType:"DELETE"})},t}(m.n),ai=function(e){function t(t){var n=e.call(this,t)||this;return n._processFiltersDataSource=n.resources.consume(G.q),n._itemProvider=n.resources.consume(st.resourceKey),n}return Object(p.__extends)(t,e),t.prototype.applyOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.applyOfficeLens.bind(this))},t.prototype.removeOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.removeOfficeLens.bind(this))},t.prototype._updateOfficeLens=function(e,t,n){var a=this,i=[new gn.e(e.item.key,e.item)];return t.update(i),n(e).then(function(){a._itemProvider.invalidateItem(e.parentKey),a._itemProvider.invalidateItem(e.item.key,{triggerFetch:!0}),i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){return i=i.map(function(t){return t.fail(e)}),t.update(i),Ue.n.wrapError(e)})},t}(m.n),ii=n(1023),ri=n(3860),oi=n(1850),si=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(G.Se),n}return Object(p.__extends)(t,e),t.prototype.getRecycleBinItem=function(e){var t=this._urlDataSource.getRootItemKey(z.e.RecycleBin),n=new Bn.e(t);return Object(oi.default)(n,{key:t,queryType:z.e.RecycleBin,properties:{commandsSupported:{defc:"1"}},type:V.e.Folder,isRootFolder:!0}),n},t}(m.n),ci=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._dataSource=n.resources.consume(G.$),n}return Object(p.__extends)(t,e),t.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)},t}(m.n),di=n(3249),li=n(823),ui=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._needsOverlayContent=n.needsOverlayContent,a}return Object(p.__extends)(t,e),t.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null},t.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)},t.prototype._getDragAndDropHintComponent=function(e,t){return this._needsOverlayContent.needsOverlayContent.set(!0),{name:di.e.tagName,params:{isRobotVisible:t(),isGridView:e()}}},t.dependencies=Object(p.__assign)(Object(p.__assign)({},m.n.dependencies),{needsOverlayContent:li.e}),t}(m.n),fi=function(){function e(e,t){this._isWinAppWipEnabled=t.platformDetection.isWinAppWipEnabled}return e.prototype.isWIPEnabled=function(){return this._isWinAppWipEnabled},e}(),pi=Object(d.r)("WIPDataSource",fi,{platformDetection:An.e}),mi=n(2792),_i=n(760),hi=n(1416),bi=n(761),gi=n(1417),vi=n(139),yi=n(595),Si=n(717),Di=n(231),Ii=n(549),xi=n(141),Ci=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.rumone=yi.e.getRUMOneLogger(),a}return Object(p.__extends)(t,e),t.prototype.logRUMOneForListView=function(e){var t=this,n=this.rumone,a=this._breakdownData,i=!1;if(n&&n.isRunning()&&!this.listViewLogged){n.addExpectedControl(this.scenarioPrefix+"ListView");var r=this._getFullPageType(this.navigation.viewParams);n.writeScenarioId(this.scenarioPrefix+this.listInfo+"."+r);var o=this._getPageTransitionTypeForListView();n.writePageTransitionType(o);var s=this._getRequiredQuietnessDurationInMilliseconds();n.setSettings({TTISettings:{TTIPolyfillSettings:{enabled:!0,calculateTTI:function(e,n){return i?t._ttiSignal.resolve():i=!0,function(e,t){return Di.e.fullPageLoad,e}(e,n.PageTransitionType)},options:Object(p.__assign)({useMutationObserver:!1,trackNetworkRequests:!1},s)}}}),n.collectW3CPerfTimings(),o===Di.e.fullPageLoad&&n.collectW3cResourceTimings(),void 0!==window.g_duration&&void 0!==window.g_iisLatency&&n.writeServerSideLatency(window.g_duration,window.g_iisLatency),this._logWindowVariables(),this._logColdHit(n);var c=void 0,d=Number(n.getPerformanceDataPropertyValue("W3cNavigationStart")),l=this._getTimingNormalizer(d);e=l(e);var u=l(n.readTempData("appDataFetchStart")),f=l(n.readTempData("appDataFetchEnd")),m=f-u,_=this._CollectBreakDown(),h=!!document.getElementById("requireJsString");if(n.addEUPLBreakdown("inlineRequireJS",{data:h,needFlatten:!0}),n.addEUPLBreakdown("isItemsView",{data:!1,needFlatten:!0}),o===Di.e.fullPageLoad){var b=l(n.getMarkerTime(xi.e)),g=l(n.getMarkerTime("EUPL.AppBoot.NewStart"));n.addEUPLBreakdown("FullPageOrOnePage",{data:!0,needFlatten:!0}),c=l(d);var v=xi.n.summary,y=e-b-(v.dataFetch||0);Qn.e(_,{w3cResponseEnd:a(xi.n.getResponseEnd()-d),appStart:a(v.appStart),newAppStart:a(v.appStart-b+g),newAppStartTime:a(g),dataFetch:a(v.dataFetch),render:a(y),prefetchStart:a(v.prefetchStart),deferredListDataRender:a(v.deferredListDataRender),preRender:a(v.preRender),postRender:a(v.postRender)})}else o===Di.e.none&&(c=l(n.getMarkerTime("ListViewUpdate.Start")),Qn.e(_,{dataFetch:a(m),render:a(e-c-(m||0)),preRender:a(u-c),postRender:a(e-f)}));n.mark("glass"),this._logServiceWorkerMetrics();var S=l(n.getMarkerTime("AppBoot.DOMContentLoaded"));if(!isNaN(S)){var D=l(n.getMarkerTime("AppBoot.Start"));n.addEUPLBreakdown("timeWaitForBody",{data:S-D,needFlatten:!0})}n.writeEUPLBreakdown(JSON.stringify(_));var I=new Ii.e({controlId:this.scenarioPrefix+"ListView",startTime:c,endTime:e});n.writeControlPerformanceData(I),this.listViewLogged=!0}},t.prototype._reset=function(t){e.prototype._reset.call(this,t),this.listViewLogged=!1},t.dependencies=Object(p.__assign)({},Si.e.dependencies),t}(Si.e),Oi=Object(d.r)("RUMOneHelperFull",Ci),wi=n(647),Ei=n(4695),Ai=n(1431),Li=n(3135),ki=new c.t({name:"MoveCopyCapabilities",factory:{dependencies:{},create:function(){return{instance:{supportsMoveCopy:!0,supportsMoveCopyOnShared:!0,supportsMoveCopyFilterParams:!1,supportsCopyCrossSite:!1,supportsMoveCrossSite:!1,supportsThrottling:!1,supportsProgressCaching:!1}}}}}),Mi=n(302),Pi=n(3010),Ti=n(1022),Ui=n(3862),Fi=n(3756),Hi=n(3757),Ri=n(3758),Ni=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._urlDataSource=a.resources.consume(Oe.n),a._appsLink=a._getAppsLink(),a._confidentialText=a._getConfidentialText(),a.items=s.observableArray([]),a.needsBottomPadding=a.createObservable(!1),a._populate=a.createObservable(!1),a._userStateProvider=a.resources.consume(ue.b),a._quotaBarComponent=a._getQuotaBarComponent(),a._premiumUpsellComponent=a._getPremiumUpsellComponent(),a._items=a.createPureComputed(a._computeItems),a.createBackgroundComputed(a._updateItems),a._showUpsellBanner=a.createObservable(!1),a._userInfoProvider=a.resources.consume(ue.A.optional),a._storageOptionsProvider=a.resources.consume(ue.D),a._isPremiumEligible=a.createPureComputed(a._computeIsPremiumEligible),a}return Object(p.__extends)(t,e),t.prototype.populateItems=function(){this._populate(!0)},t.prototype.clearItems=function(){this._populate(!1)},t.prototype._computeIsPremiumEligible=function(){return this._storageOptionsProvider.isReady()?this._storageOptionsProvider.isEligibleForPremium():null},t.prototype._computeItems=function(){var e=this._computeBaseItems();return window.FilesConfig&&(FilesConfig.df||FilesConfig.int)&&e.push(this._confidentialText),this._showUpsellBanner()&&e.indexOf(this._appsLink)>=0&&e.unshift(this._getAppUpsellComponent()),e},t.prototype._computeBaseItems=function(){if(!this._populate())return this.needsBottomPadding(!1),[];var e,t=this._userStateProvider.status(),n=this._userStateProvider.canUpgrade(),a=1===this._userStateProvider.accountState(),i=t!==Ti.e.unknown&&t<Ti.e.critical&&(!n||this._isPremiumEligible());e=this._userStateProvider.isSoftLocked();var r=[];return i&&r.push(this._premiumUpsellComponent),(a||e)&&r.push(this._quotaBarComponent),this.needsBottomPadding(!0),t<Ti.e.critical&&r.push(this._appsLink),r},t.prototype._updateItems=function(){var e,t=this._items(),n=this.items.peek();t.length?(e=this.items).splice.apply(e,Object(p.__spreadArray)([0,n.length],t,!1)):this.items.removeAll()},t.prototype._getQuotaBarComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:Fi.e.tagName,params:{}}}},t.prototype._getPremiumUpsellComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:Hi.e.tagName,params:{}}}},t.prototype._getAppUpsellComponent=function(){var e=this;return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:Ri.e.tagName,params:{message:Ui.t,buttonText:Ui.e,action:new(this.managed(Ot.e))({url:"https://aka.ms/xhkpi9"}),onDismiss:function(){e._showUpsellBanner(!1),e._userInfoProvider.setUserInfo(7,3,null,"26C6F29F-016D-4309-8FA2-1C9B8151AFC9")}}}}},t.prototype._getAppsLink=function(){var e=this._urlDataSource.getOneDriveAppsUrl();return{text:q.t,url:e,action:new(this.managed(Ot.e))({url:e,target:"_blank"}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!0),renderAs:6,engagementName:"GetOneDriveApps"}},t.prototype._getConfidentialText=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:2,text:"Microsoft Confidential"}},t}(m.n),Bi=Ni,ji=(Object(d.r)("NotificationLinks",Ni),n(16)),Vi=n(311),zi=n(76),Gi=ji.e.isActivated("7CD01941-8F71-423B-B632-AC064A42435C","11/01/2021",'Disable the "Photos" (v=photopreferences) pivot in ODC settings left nav, which included setting for auto album creation'),Ki=function(e){function t(){var t,n=e.call(this)||this;return n.mapPageToLeftNavSections=((t={})[Qt.e.StorageInfo]=[3,2],t[Qt.e.StorageOptions]=[3,2],t[Qt.e.PhotoPreferences]=[3,2],t[Qt.e.TagPreferences]=[3,2],t[Qt.e.ManageVault]=[3,2],t[Qt.e.NotificationOptions]=[3,2],t[Qt.e.Restore]=[3,2],t[Qt.e.Files]=[0,1],t[Qt.e.Photos]=[0,1],t[Qt.e.PhotoStream]=[0,1],t[Qt.e.TraceMe]=[0,1],t[Qt.e.TextFileEditor]=[0,1],t[Qt.e.Convergence]=[0,1],t[Qt.e.DocumentOptions]=[3,2],t),n._urlDataSource=n.resources.consume(Oe.n),n._attributionHelper=n.resources.consume(It.n),n._linkGroups=s.observableArray([]),n._notificationLinks=new(n.managed(Bi)),n.needsBottomPadding=n._notificationLinks.needsBottomPadding,n}return Object(p.__extends)(t,e),t.prototype.getLinkGroups=function(e){var t=this._urlDataSource.getPageType();return t===this._previousPage||this._previousPage!==Qt.e.Files&&this._previousPage!==Qt.e.Photos&&this._previousPage!==Qt.e.PhotoStream||t!==Qt.e.Files&&t!==Qt.e.Photos&&t!==Qt.e.PhotoStream?(this._previousPage=t,this._linkGroups.removeAll(),this._isPartApplicable(0)&&(this._getNavLinks(e),this._linkGroups.push(this._navLinks)),this._isPartApplicable(2)&&(this._getOptions(e),this._linkGroups.push(this._optionsLinks)),this._linkGroups):(this._previousPage=t,this._linkGroups)},t.prototype.getNotificationLinks=function(){var e=this._notificationLinks.items;return this._isPartApplicable(1)?this._notificationLinks.populateItems():this._notificationLinks.clearItems(),e},t.prototype._isPartApplicable=function(e){var t=this._urlDataSource.getPageType(),n=this.mapPageToLeftNavSections[t];return n&&-1!==n.indexOf(e)},t.prototype._getNavLinks=function(e){var t,n=this,a=[{text:q.e,automationId:"FilesPageLink",url:this._urlDataSource.getFilesQueryUrl(),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQueryFiles()}),isFocused:s.observable(!1),altText:Pi.r,engagementName:"Files",icon:new Mi.e("FabricFolder")},{text:q.o,url:this._urlDataSource.getRecentQueryUrl(),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQueryRecent()}),isFocused:s.observable(!1),altText:Pi.d,engagementName:"Recent",icon:new Mi.e("History")}],i={text:q.i,automationId:"PhotosPageLink",url:this._urlDataSource.getAllMyPhotosQueryUrl(),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQuery(z.e.Photos)}),isFocused:s.observable(!1),altText:Pi.c,engagementName:"Photos",icon:new Mi.e("Photo2")},r=[{text:q.c,url:!Object(Vi.n)()||Object(Vi.n)()&&Object(fa.cs)(pt.EnablePhotoStreamInLeftNav)?this._urlDataSource.getSharedByQueryUrl():this._urlDataSource.getPhotoStreamMyFeedQueryUrl(),isActive:this.createPureComputed(function(){return e(),Object(Vi.n)()&&!Object(fa.cs)(pt.EnablePhotoStreamInLeftNav)&&n._urlDataSource.isCurrentQuery(z.e.PhotoStream)||n._urlDataSource.isCurrentQuerySharedByMe()||n._urlDataSource.isCurrentQuerySharedWithMe()}),isFocused:s.observable(!1),altText:Pi.u,engagementName:"Shared",icon:new Mi.e("People")},{text:q.s,url:this._urlDataSource.getRecycleBinQueryUrl(),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQueryRecycleBin()}),isFocused:s.observable(!1),altText:Pi.l,engagementName:"RecycleBin",icon:new Mi.e("Delete")}],o=Object(fa.cs)(fa.ue)?Object(p.__spreadArray)(Object(p.__spreadArray)([],a,!0),r,!0):Object(p.__spreadArray)(Object(p.__spreadArray)(Object(p.__spreadArray)([],a,!0),[i],!1),r,!0),c={text:Object(fa.cs)(fa.qa)&&(null===(t=null===FilesConfig||void 0===FilesConfig?void 0:FilesConfig.SuiteNavConfig)||void 0===t?void 0:t.UserDisplayName)?FilesConfig.SuiteNavConfig.UserDisplayName:"OneDrive",url:this._urlDataSource.getFilesQueryUrl(),isExpanded:s.observable(!0),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQueryFiles()}),isFocused:s.observable(!1),automationId:"LeftNav-OneDriveGrouping",links:s.observableArray(o)};Object(Vi.n)()&&Object(fa.cs)(pt.EnablePhotoStreamInLeftNav)&&c.links().push({text:q.a,automationId:"PhotoStreamPageLink",url:this._urlDataSource.getPhotoStreamMyFeedQueryUrl(),isActive:this.createPureComputed(function(){return e(),n._urlDataSource.isCurrentQuery(z.e.PhotoStream)}),isFocused:s.observable(!1),altText:Pi.s,engagementName:"PhotoStream",icon:new Mi.e("PhotoCollection")}),this._navLinks=c},t.prototype._getOptions=function(e){var t=this,n=this._attributionHelper.getPurchaseAttribution({source:"LeftNavPageList",cta:"UpgradePage"});this._optionsLinks={text:Ui.r,url:this._urlDataSource.getNewManageStorageUrl(),isExpanded:s.observable(!0),isActive:this.createPureComputed(function(){return e(),t._urlDataSource.getPageType()===Qt.e.StorageInfo}),isFocused:s.observable(!1),automationId:"LeftNav-OptionsGrouping",links:s.observableArray(Object(p.__spreadArray)(Object(p.__spreadArray)(Object(p.__spreadArray)(Object(p.__spreadArray)(Object(p.__spreadArray)(Object(p.__spreadArray)([{text:q.n,url:this._urlDataSource.getNewManageStorageUrl(),isActive:this.createPureComputed(function(){return e(),t._urlDataSource.getPageType()===Qt.e.StorageInfo}),isFocused:s.observable(!1),altText:q.n},{text:q.r,url:this._urlDataSource.getUpgradeOptionsUrl(n),isActive:this.createPureComputed(function(){return e(),t._urlDataSource.getPageType()===Qt.e.StorageOptions}),isFocused:s.observable(!1),altText:q.r},{text:Ui.i,url:this._urlDataSource.getOfficeFileOptionsUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===Qt.e.DocumentOptions}),isFocused:s.observable(!1),altText:Ui.i}],!Object(ht.e)(zi.l)||Object(fa.cs)(fa.Yr)?[{text:Ui.l,url:this._urlDataSource.getManageVaultUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===Qt.e.ManageVault}),isFocused:s.observable(!1),altText:Ui.l}]:[],!0),Gi?[{text:Ui.o,url:this._urlDataSource.getPhotoPreferencesUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===Qt.e.PhotoPreferences}),isFocused:s.observable(!1),altText:Ui.o}]:[],!0),[{text:Ui.s,url:this._urlDataSource.getTagPreferencesUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===Qt.e.TagPreferences}),isFocused:s.observable(!1),altText:Ui.o},{text:Ui.a,url:this._urlDataSource.getNotificationOptionsUrl(),isActive:this.createPureComputed(function(){return e(),t._urlDataSource.getPageType()===Qt.e.NotificationOptions}),isFocused:s.observable(!1),altText:Ui.a}],!1),Object(fa.cs)(pt.DisableDeviceBackupsPage)?[]:[{text:Ui.n,url:this._urlDataSource.getDeviceBackupsOptionsUrl(),isActive:this.createPureComputed(function(){return e(),!1}),isFocused:s.observable(!1),altText:Ui.n}],!0),[{text:Ui.c,url:this._urlDataSource.getNewRestoreOptionsUrl(),isActive:this.createPureComputed(function(){return e(),t._urlDataSource.getPageType()===Qt.e.Restore}),isFocused:s.observable(!1),altText:Ui.c}],!1),Object(fa.cs)(pt.EnableSearchHistorySettingInCob)||!Object(ht.e)(zi.l)?[{text:Ui.d,url:this._urlDataSource.getSearchOptionsUrl(),isActive:this.createPureComputed(function(){return e(),!1}),isFocused:s.observable(!1),altText:Ui.d}]:[],!0))}},t}(m.n),Wi=n(3495),qi=n(157),Qi=new c.t({name:"".concat("EnableNewOneUpCommandBarResourceKey",".enableNewOneUpCommandBarResourceKey"),factory:{dependencies:{identityDataSource:G.D},create:function(e){var t=e.identityDataSource;if(Object(pt.isFeatureEnabled)(pt.EnableNewOneUpCommandBar))return{instance:!0};if(Object(pt.isFeatureEnabled)(pt.EnableNewOneUpCommandBarODCExperiment)){if(t){var n=t.getIdentity();n&&qi.t.init({userLoginName:n.email})}return{instance:new qi.t({name:"EnableNewOneUpCommandBarODCExperiment",startDate:"6/30/2021",version:qi.e.v2},pt.EnableNewOneUpCommandBarODCExperiment_ABTrigger).isOn()}}return{instance:!1}}}}),Yi=n(3496),Ji=new c.t({name:"".concat("EnableDarkThemeForOneUpMediaResourceKey",".enableDarkThemeForOneUpMedia"),factory:{dependencies:{identityDataSource:G.D},create:function(e){var t=e.identityDataSource;if(Object(pt.isFeatureEnabled)(pt.EnableDarkThemeForOneUpMediaViewer))return{instance:!0};if(Object(pt.isFeatureEnabled)(pt.EnableDarkThemeForOneUpMediaViewerODCExperiment)){if(t){var n=t.getIdentity();n&&qi.t.init({userLoginName:n.email})}return{instance:new qi.t({name:"EnableDarkThemeForOneUpMediaViewerODCExperiment",startDate:"6/30/2021",version:qi.e.v2},pt.EnableDarkThemeForOneUpMediaViewerODCExperiment_ABTrigger).isOn()}}return{instance:!1}}}}),Xi=n(1428),Zi=n(1430),$i=n(3780),er=n(3743),tr=n(2706),nr=n(3863),ar=n(3497),ir=n(36),rr=ji.e.isActivated("43800FCF-595D-4FF1-BAA2-E4E1EB94F953","02/04/2022","Enable ItemInvalidator in ODC Lightspeed"),or=ji.e.isActivated("E435AB9B-59B2-49CC-9FBF-AC1039571D05","05/12/2022","Disable unnecessary resources for unuath users"),sr=ji.e.isActivated("73BA6390-48A0-4E07-9588-9956F9D6D2B8","08/30/2022","Check if we are exposing userSettingsStore resource in ODC Lightspeed"),cr=new c.t("hasExposedAppResources"),dr=n(1403),lr=new c.t({name:"TextFileEditor.key",loader:new d.t(function(){return n.ee(28,5138).then(function(e){return e.resourceKey})})}),ur=n(3498),fr=new c.t({name:"KnockoutContentShim.key",loader:new d.t(function(){return n.ee([100,"ondemand.resx-ondemand"],5209).then(function(e){return e.resourceKey})})}),pr=n(1410),mr=new c.t({name:"KnockoutPhotoShim.key",loader:new d.t(function(){return n.ee([101,"ondemand.resx-ondemand"],5243).then(function(e){return e.resourceKey})})}),_r=n(1411),hr=new c.t({name:"KnockoutPhotoStreamShim.key",loader:new d.t(function(){return n.ee(23,5210).then(function(e){return e.resourceKey})})}),br=n(3311),gr=n(170),vr=n(242),yr=n(1104),Sr=[1,0],Dr=new gr.e,Ir=function(){function e(){this._started=!1,this._done=!1,this._bundleGroups={},this._queuedBundles=[]}return Object.defineProperty(e.prototype,"hasStarted",{get:function(){return this._started},enumerable:!1,configurable:!0}),e.prototype.start=function(){var e=this;this._started||(this._started=!0,Dr.setTimeout(function(){return e._next()},1e3))},e.prototype.queueLoad=function(e,t,n){var a=this._getGroup(e,n),i=this._generateModuleRequest(a,e,t,n);return this._queueBundle(a),i.signal.getPromise()},e.prototype.waitFor=function(e,t){var n=this._getGroup(e,t);return this._generateModuleRequest(n,e,0,t).signal.getPromise()},e.prototype.loadNow=function(e,t){var n=this._getGroup(e,t),a=this._generateModuleRequest(n,e,0,t);return n.isResolved||this._requestBundle(n).done(),a.signal.getPromise()},e.prototype._getGroup=function(e,t){var n=window.require.toUrl(e),a=this._bundleGroups[n];return a||(a=this._createGroup(e,n,t),this._bundleGroups[n]=a),a},e.prototype._createGroup=function(e,t,n){var a=window.require.specified(t),i={bundleUrl:t,requestedPath:e,getModule:n,modules:a?null:{},isResolved:a,isQueued:!1};if(!a)for(var r=0,o=Sr;r<o.length;r++){var s=o[r];i.modules[s]=[]}return i},e.prototype._createModuleRequest=function(e,t){return{path:e,getModule:t,signal:new vr.e,isResolved:!1}},e.prototype._addNewModule=function(e,t,n,a){var i=this._createModuleRequest(t,a);return e.modules[n].push(i),i},e.prototype._generateModuleRequest=function(e,t,n,a){var i;return e.isResolved?(i=this._createModuleRequest(t,a),this._resolveModule(i)):i=this._addNewModule(e,t,n,a),i},e.prototype._queueBundle=function(e){e.isQueued||(this._queuedBundles.push(e),e.isQueued=!0,this._done&&(this._done=!1,this._next()))},e.prototype._next=function(){var e=this;if(this._started){var t=this._getNextGroup();if(t){var n=this._requestBundle(t);n&&n.then(function(){Dr.setTimeout(function(){return e._next()},500)}).done()}}},e.prototype._getNextGroup=function(){for(var e=this._queuedBundles.shift();e;){if(!e.isResolved)return e;e=this._queuedBundles.shift()}this._done=!0},e.prototype._processBundlePriorityLevel=function(e,t){if(!e.modules)return Ue.n.wrap();for(var n=[],a=0,i=e.modules[t];a<i.length;a++){var r=i[a];this._resolveModule(r),n.push(r.signal.getPromise())}return Ue.n.all(n).then(function(){},function(){})},e.prototype._processBundle=function(e){for(var t=this,n=function(n,a){return a.then(function(){return t._processBundlePriorityLevel(e,n)})},a=Ue.n.wrap(),i=0,r=Sr;i<r.length;i++)a=n(r[i],a);return a.then(function(){e.isResolved=!0,e.modules=null})},e.prototype._requestBundle=function(e){var t=this,n=new ia.e({name:"DeferredBundleLoad"});return Object(yr.e)({path:e.requestedPath,getModule:e.getModule}).then(function(){return n.end({resultType:ia.t.Success,extraData:{path:e.requestedPath,url:e.bundleUrl}}),t._processBundle(e)},function(t){n.end({resultType:ia.t.Failure,error:t,extraData:{path:e.requestedPath,url:e.bundleUrl}})})},e.prototype._resolveModule=function(e){e.isResolved=!0,e.path&&Object(yr.e)({path:e.path,getModule:e.getModule}).then(function(t){e.signal.complete(t)})},e}(),xr=function(e){function t(t){var n=e.call(this,t)||this;return n._resources=[],n._finished=new vr.e,n.finishedProcessing=n._finished.getPromise(),n.isLoaded=n.createObservable(!1),n.createBackgroundComputed(n._computeShouldProcess),n}return Object(p.__extends)(t,e),t.prototype.expose=function(e,t){this._resources.push({key:e,getModule:t}),this.isLoaded.peek()&&this._processResources()},t.prototype._processResources=function(){for(var e=this,t=Ue.n.resolve(),n=0,a=this._resources;n<a.length;n++){var i=a[n];t=this._processResource(t,i)}t.then(function(){e._resources.length=0,e._finished.complete()})},t.prototype._processResource=function(e,t){var n=this;return e.then(function(){return t.getModule()}).then(function(e){try{var a=new(n.managed(e.default))({});n.resources.expose(t.key,a)}catch(n){At.e.logError(n,{rawResult:"(".concat(typeof e,"): ").concat(e.default),resourceKey:"(".concat(t.key.id,"): ").concat(t.key.name)})}})},t.prototype._computeShouldProcess=function(){this.isLoaded()&&this._processResources()},t}(m.n),Cr=n(265),Or=n(17),wr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._queue=new Ir;var a=n._pageLoadMonitor=n.resources.consume(Cr.e),i=n.isPageLoaded=n.observables.create(a.isPageLoaded),r=n.isPageRenderingComplete=n.observables.create(a.isPageRenderingComplete);if(a.isPageLoaded?n._onPageLoaded():a.waitForPLT().then(function(){i(a.isPageLoaded),n._onPageLoaded()}),a.isPageRenderingComplete||a.waitForPageRenderingComplete().then(function(){r(a.isPageRenderingComplete)}),n.resources.isExposed(G.i)){var o=n.resources.consume(G.i);n._bundles=o.getBundles()}else n._bundles={};return n}return Object(p.__extends)(t,e),t.prototype.pageLoaded=function(e){Object(Or.e)(0),this._pageLoadMonitor.pageLoaded(e)},t.prototype.pageRenderingIsComplete=function(e){this._pageLoadMonitor.pageRenderingIsComplete(e)},t.prototype.queueLoad=function(e,t){return this._queue.queueLoad(e,0,t)},t.prototype.queueBundle=function(e,t){var n=this.getBundleInfo(e);this.queueLoad(n.path,t||n.getModule).then(function(){n.isLoaded(!0)})},t.prototype.createDeferredContext=function(e){var t=this.getBundleInfo(e),n=new(this.managed(xr))({});return t.path&&this._queue.queueLoad(t.path,1,t.getModule).then(function(){n.finishedProcessing.then(function(){t.isLoaded(!0)}),n.isLoaded(!0)}),n},t.prototype.waitFor=function(e,t){return this._queue.waitFor(e,t)},t.prototype.loadNow=function(e,t){return this._queue.loadNow(e,t)},t.prototype.getBundleInfo=function(e){if(e){var t=this._bundles[e];return t||(t={path:"",getModule:function(){return Ue.n.as(void 0)},isLoaded:this.createObservable(!1)},this._bundles[e]=t),t}},t.prototype.waitForPLT=function(){return this._pageLoadMonitor.waitForPLT()},t.prototype.waitForPageRenderingComplete=function(){return this._pageLoadMonitor.waitForPageRenderingComplete()},t.prototype._onPageLoaded=function(){this._queue.hasStarted||this._queue.start()},t}(m.n),Er=wr,Ar=n(1829),Lr=n(1996),kr=n(1343),Mr=n(102),Pr=new c.t({name:"CurrentPage.key",factory:{dependencies:{observablesFactoryType:m.i,viewParams:wn.T},create:function(e){var t=e.viewParams,n=new e.observablesFactoryType;return{instance:n.pureCompute(function(){return Object(Dn.O)(t())}),disposable:n}}}}),Tr=new c.t({name:"UserSelect.key",factory:{dependencies:{observablesFactoryType:m.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!0),disposable:t}}}}),Ur=n(2018),Fr=n(1834),Hr=new c.t({name:"UseItemsScope.key",factory:{dependencies:{observablesFactoryType:m.i,viewParams:wn.T,urlDataSource:Oe.n,isItemsScopeEnabledInAllPhotosFilePicker:Fr.t.lazy,isItemsScopeEnabledInFilesPivot:Fr.r.lazy,isItemsScopeEnabledInRecentPivot:Fr.o.lazy,isItemsScopeEnabledInSharedPivot:Fr.s.lazy,isItemsScopeEnabledInAllPhotosPivot:Fr.n.lazy,isItemsScopeEnabledInAllAlbumsPivot:Fr.e.lazy,isItemsScopeEnabledInAllTagsPivot:Fr.i.lazy,isItemsScopeEnabledInAllPlacesPivot:Fr.a.lazy,isItemsScopeEnabledInSingleAlbumView:Fr.c.lazy,isItemsScopeEnabledInSinglePlaceView:Fr.d.lazy,isItemsScopeEnabledInSingleTagView:Fr.l.lazy},create:function(e){var t=e.viewParams,n=e.urlDataSource,a=e.isItemsScopeEnabledInAllPhotosFilePicker,i=e.isItemsScopeEnabledInFilesPivot,r=e.isItemsScopeEnabledInRecentPivot,o=e.isItemsScopeEnabledInSharedPivot,s=e.isItemsScopeEnabledInAllPhotosPivot,c=e.isItemsScopeEnabledInAllAlbumsPivot,d=e.isItemsScopeEnabledInAllTagsPivot,l=e.isItemsScopeEnabledInAllPlacesPivot,u=e.isItemsScopeEnabledInSingleAlbumView,f=e.isItemsScopeEnabledInSinglePlaceView,p=e.isItemsScopeEnabledInSingleTagView,m=new e.observablesFactoryType;return{instance:m.pureCompute(function(){var e=t();return n.isCurrentQuery(z.e.Files,e)?i():n.isCurrentQuery(z.e.Recent,e)?r():n.isCurrentQuery(z.e.SharedWithMe,e)||n.isCurrentQuery(z.e.SharedByMe,e)?o():!((!Object(_t.A)(e)||!u()||n.isCurrentQuery(z.e.Search))&&(!Object(_t.k)(e)||!p())&&(!Object(_t.L)(e)||!f())&&(!Object(_t.S)(e)||!a())&&(!Object(_t.h)(e)||!l())&&(!Object(_t.m)(e)||!c())&&(!Object(_t.b)(e)||!d())&&(!Object(_t._)(e)||!s()))}),disposable:m}}}}),Rr=n(2007),Nr=new c.t({name:"UseItemCacheData.Key",factory:{dependencies:{observablesFactoryType:m.i,viewParams:wn.T,urlDataSource:Oe.n,isItemsScopeEnabledInAllPhotosFilePicker:Fr.t.lazy,isVroomEnabledInItemsScopeAllPhotos:Fr.f.lazy,isVroomEnabledInItemsScopeSingleTag:Fr.m.lazy,isVroomEnabledInItemsScopeSinglePlace:Fr.p.lazy,useItemScope:Ur.e},create:function(e){var t=e.viewParams,n=e.urlDataSource,a=e.isItemsScopeEnabledInAllPhotosFilePicker,i=e.isVroomEnabledInItemsScopeAllPhotos,r=e.isVroomEnabledInItemsScopeSingleTag,o=e.isVroomEnabledInItemsScopeSinglePlace,s=e.useItemScope,c=new e.observablesFactoryType;return{instance:c.pureCompute(function(){var e=t(),c=n.getPageType(e);return Object(_t.S)(e)?a()&&i():Object(_t.k)(e)?r()||Object(fa.cs)(fa.Wr)&&Object(ht.e)(_t.T):Object(_t.L)(e)?o():Object(_t._)(e)?i():c!==Qt.e.Photos&&s.peek()}),disposable:c}}}}),Br=new c.t({name:"KnockoutResourceScope",factory:{dependencies:{},create:function(){var e=l.e;return e.expose(wn.T,function(e){var t=e.consume(R.e),n=s.observable(t.viewParams);return n.equalityComparer=kr.e,new Mr.e(null).on(t,"change",function(){n(t.viewParams)}),n}(e)),e.expose(G.i,new(e.injected(br.e))),e.expose(ue.e,new(e.injected(Er))),e.exposeFactory(dr.e,new d.e(lr)),e.exposeFactory(ur.e,new d.e(fr)),e.exposeFactory(pr.e,new d.e(mr)),e.exposeFactory(_r.e,new d.e(hr)),function(e){var t=e;if(t.isExposed(cr))return t;Object(Xi.e)(t),t.exposeFactory(A.e,new d.e(Zt));var a=new(t.injected(rt.t));t.expose(G.Se,a),t.expose(Oe.n,a);var i=t.consume(ue.e);i.createDeferredContext(2),t.exposeFactory(G.J,new d.e($i.e)),t.exposeFactory(ue.b,new d.e(er.e)),t.exposeFactory(ue.p,new d.e(xt.resourceKey));var r=t.consume(R.e);sr&&t.expose(Ce.n,new Ee.e({defaultRootItemId:"root",viewerId:rt.t.viewerId})),t.expose(Ce.t,new ke),t.expose(ii.e,new(t.injected(It.t))),t.exposeFactory(G.O,new d.e(te)),t.exposeFactory(G.L,new d.e(ae)),t.exposeFactory(G.r,new d.e(ie)),t.exposeFactory(G.w,new d.e(ne)),t.exposeFactory(G.M,new d.e(pe)),Object(vi.e)()?Object(pt.isFeatureEnabled)(pt.OdcLightspeed)||Object(Zi.e)(t,!1):t.exposeFactory(G.D,new d.e($t.e)),t.exposeFactory(G.Ae,new d.e(pi)),t.exposeFactory(G._e,new d.e(wa)),t.expose(ue.I,new(t.injected(Ca)));var o=new(t.injected(Re));function c(e){return e.resourceKey}if(t.expose(G.v,o),t.expose(G.T,o),t.expose(G.s,o),t.expose(G.re,o),t.expose(Oe.e,o),t.expose(G.pe,new(t.injected(ba))),t.expose(ue.S,new(t.injected(na))),t.expose(G.me,new(t.injected(Sa))),t.expose(ue.D,new(t.injected(sa))),Object(pt.isFeatureEnabled)(pt.UseVroomApiForReportAbuse)&&t.exposeFactory(G.te,new d.e(Da)),Object(pt.isFeatureEnabled)(pt.UseVroomApiForRequestReview)&&(t.exposeFactory(G.ne,new d.e(Ia)),t.exposeFactory(ue.y,new d.e(nr.e))),t.exposeFactory(G.ee,new d.e(xa)),t.expose(Oe.t,new(t.injected(Ne.default))),t.expose(wn.M,!1),t.exposeFactory(G.oe,new d.e(E)),t.exposeFactory(G.X,new d.e(O.bypass)),t.exposeFactory(G.ie,new d.e(w)),t.exposeFactory(G.U,new d.e(Ve)),t.exposeFactory(G.F,new d.e(Ke)),t.expose(G.ce,new Pe),t.expose(ri.t,new(t.injected(ri.e))),t.expose(wn.D,s.observable(!1)),t.expose(wn.y,s.observable(!1)),t.expose(wn.x,s.observable(!1)),t.expose(wn.g,s.observable(!1)),t.expose(wn.b,s.observable(!1)),t.expose(wn.w,s.observable(!1)),e.exposeFactory(Wi.e,new d.e(Qi)),e.exposeFactory(Yi.e,new d.e(Ji)),t.exposeAsync(G.S,new d.t(function(){return n.ee(0,2356).then(c)})),t.exposeAsync(ue.r,new d.t(function(){return n.ee(0,2355).then(c)})),t.exposeAsync(G.z,new d.t(function(){return n.ee([174],4870).then(c)})),t.exposeAsync(ar.e,new d.t(function(){return n.ee([578,"ondemand.resx-ondemand"],4871).then(c)})),t.exposeAsync(G.y,new d.t(function(){return n.ee(0,4350).then(c)})),t.exposeFactory(C.e,new d.e(Y)),t.expose(G.V,new(t.injected(Ye))),Object(pt.isFeatureEnabled)(fa.Eo)||t.expose(G.he,new(t.injected(jt))({})),t.expose(G.n,new(t.injected(la))),t.expose(G.e,new(t.injected(rn.i))),t.expose(G.ge,new(t.injected(ln))),t.expose(G.C,new(t.injected(qt))),t.exposeFactory(G.d,new d.e(L)),t.exposeFactory(G.c,new d.e(k)),t.expose(G.Ce,new(t.injected(an))),t.exposeFactory(G.xe,new d.e(M.e)),t.exposeFactory(wn.P,new d.e(P)),t.expose(G.de,new(t.injected(ft))),t.expose(G.le,new(t.injected(bt))),t.expose(wn.v,s.observable(!0)),t.expose(wn.S,s.observable(!1)),t.expose(G.se,new(t.injected(Ln))),t.expose(G.l,new(t.injected(Un))),t.expose(ue.a,new(t.injected(kn))),Object(pt.isFeatureEnabled)(pt.UseItemsScopeInOneDrive)||(t.expose(wn.T,s.observable({})),t.exposeFactory(G.De,new d.e(wi.e)),t.expose(we.t,"ODCNext"),t.exposeFactory(we.e,new d.e(Oi))),t.expose(G.o,new(t.injected(Ua.t))),t.exposeFactory(Li.e,new d.e(ki)),t.exposeFactory(ue.g,new d.e(Fn.e)),t.expose(G.G,new(t.injected(On))),t.expose(ue.f,new(t.injected(ta))),t.expose(G.q,new(t.injected(ni))),t.expose(ue.m,new(t.injected(ai))),t.expose(ue.C,new(t.injected(Kn))),t.exposeFactory(ue.d,new d.e(T)),t.expose(ue.w,new(t.injected(Aa))),t.exposeAsync(G.ve,{load:function(){return n.ee([177,"ondemand.resx-ondemand"],5193).then(function(e){return{create:function(){return{instance:e}},dependencies:[]}})}}),t.expose(G.u,new Ta),t.exposeFactory(G.Oe,new d.e(H)),t.expose(G.ye,new(t.injected(Fa))({})),t.expose(ue.E,new(t.injected(Ha))({})),t.exposeFactory(re.e,new d.e(se)),t.expose(wn.e,new Ra.e),t.expose(G.A,new(t.injected(ti))),t.expose(G.$,new(t.injected(si))),t.expose(ue.v,new(t.injected(ci))),e.expose(ue.n,new(e.injected(ui))({},{needsOverlayContent:e.consume(li.e)})),t.expose(wn.l,s.observable(!1)),t.exposeAsync(mi.t,new d.t(function(){return n.ee([69,"ondemand.resx-ondemand"],3925).then(function(e){return e.typeResourceKey.local})})),t.exposeAsync(G.a,new d.t(function(){return n.ee([178],5141).then(function(e){return e.typeResourceKey})})),t.exposeAsync(G.we,new d.t(function(){return n.ee(0,4872).then(c)})),t.exposeAsync(G.Pe,new d.t(function(){return n.ee([583],5291).then(c)})),t.exposeAsync(G.ke,new d.t(function(){return n.ee([582],4873).then(c)})),Object(pt.isFeatureEnabled)(pt.EnableFloodgate)){var l=r.viewParams;i.waitForPLT().then(function(){Object(pt.isFeatureEnabled)(fa.fa)||t.consume(ue.o).userExecuteAction({name:"NewSession"}),(!Object(pt.isFeatureEnabled)(fa.fa)||l[tr.t]||l[tr.n])&&t.consumeAsync($.e).then(function(e){e.processViewParams(l)})})}i.createDeferredContext(4),t.exposeFactory(_e.e,new d.e(me)),i.createDeferredContext(1),(or||ir.e.isAuthenticated())&&(Object(pt.isFeatureEnabled)(pt.LanguageProfileChange)&&i.waitForPLT().then(function(){t.consumeAsync(ce)}),Object(pt.isFeatureEnabled)(pt.EnablePushChannel)&&(t.exposeFactory(G.Y,new d.e(N)),t.exposeFactory(G.E,new d.e(J)),t.consumeAsync(Object(pt.isFeatureEnabled)(pt.EnablePushChannelAutoRefresh)?X:B.e)),t.exposeFactory(G.I,new d.e(Z.e))),t.exposeFactory(G.j,new d.e(F)),t.exposeFactory(ue.l,new d.e(U.e)),t.exposeFactory(G.B,new d.e(ee)),Object(pt.isFeatureEnabled)(fa.qa)&&!Object(pt.isFeatureEnabled)(fa.Eo)&&(t.exposeFactory(be.e,new d.e(Ai.e)),t.exposeFactory(he.e,new d.e(Ei.resourceKey))),t.exposeFactory(ge.e,new d.e(ve.e)),t.exposeFactory(xe.n,new d.e(ye.e)),t.exposeFactory(Se.e,new d.e(De.e)),rr&&t.exposeFactory(G.k,new d.e(Ie.e)),t.exposeFactory(de.e,new d.e(le)),t.exposeFactory(_i.e,new d.e(hi.e)),t.exposeFactory(bi.e,new d.e(gi.e)),e.expose(G.H,new(e.injected(Ki)))}(e),e.exposeFactory(u.resourceKey,new d.e(x)),e.exposeFactory(Ur.e,new d.e(Hr)),e.exposeFactory(Rr.e,new d.e(Nr)),e.exposeFactory(wn.s,new d.e(Pr)),e.exposeFactory(Ar.e.commandBar.transclusionProvider,Lr.e),e.exposeFactory(wn.a,new d.e(Tr)),{instance:e}}}})},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"initializeIcons",function(){return E});var a=n(1334),i=n(18);function r(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('".concat(e,"odsp-next-icons-0-433a26c6.woff') format('woff')")},icons:{DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:"",PageLink:"",DatabaseSource:"",CommentSolid:"",ChangeEntitlements:"",Installation:"",WebAppBuilderModule:"",WebAppBuilderFragment:"",WebAppBuilderSlot:"",BullseyeTargetEdit:"",WebAppBuilderFragmentCreate:"",PageData:"",PageHeaderEdit:"",ProductList:"",UnpublishContent:"",DependencyAdd:"",DependencyRemove:"",EntitlementPolicy:"",EntitlementRedemption:"",SchoolDataSyncLogo:"",BugWarning:"",BugAction:"",SettingsSync:"",SettingsAdd:"",GraphSymbol:"",AddLink:"",SharepointAppIcon16:"",DataflowsLink:"",TimePicker:"",UserWarning:"",ComplianceAudit:"",StickyNotesOutlineAppIcon:"",StickyNotesSolidAppIcon:"",Webcam2Off:"",eDiscovery:"",CalendarYear:"",IgnoreConversation:"",Project2019Document:"",CommonDataServiceCDS:"",Forum:"",SentimentAnalysis:"",TextRecognition:"",KeyPhraseExtraction:"",AltText:"",NumberedListMirrored:"",IncreaseIndent:"",IncreaseIndentMirrored:"",DecreaseIndent:"",DecreaseIndentMirrored:"",IncreaseIndentHanging:"",IncreaseIndentHangingMirrored:"",ArchiveUndo:"",LeaveUser:"",EdgeLogo16:"",EdgeLogo:"",FabricFolderUpload:"",RedEye12:"",MapPin12:"",Insights:"",TaskList:"",MachineLearning:"",HealthRefresh:"",FontSize2:"",SharedDatabase:"",WebEnvironment:"",FormatPainter:"",IndentFirstLine:"",AddSpaceBefore:"",AddSpaceAfter:"",TextAlignTop:"",TextAlignMiddle:"",TextAlignBottom:"",TextParagraphOption:"",TextRotation:"",TextRotateHorizontal:"",TextRotate90Degrees:"",TextRotate270Degrees:"",AutoFitContents:"",AutoFitWindow:"",FixedColumnWidth:"",RepeatHeaderRows:"",TableHeaderRow:"",TableTotalRow:"",TableBrandedRow:"",TableFirstColumn:"",TableLastColumn:"",TableBrandedColumn:"",TagGroup:"",PhotoError:"",HexaditeInvestigation:"",HexaditeInvestigationCancel:"",HexaditeInvestigationSemiAuto:"",DriverOff:"",FileOff:"",ServiceOff:"",URLBlock:"",BugSync:"",BugBlock:""}};Object(i.B)(n,t)}function o(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('".concat(e,"odsp-next-icons-1-d1bde837.woff') format('woff')")},icons:{DeviceRun:"",DeviceOff:"",ProcessingCancel:"",ProcessingRun:"",ProcessingPause:"",CalculatorDelta:"",InputAddress:"",ViewInAR:"",ImageInAR:"",CubeShapeSolid:"",ShapeSolid:"",Reset:"",DeviceBug:"",HomeDropdown:"",ContentFeed:"",CompareUneven:"",VideoAdd:"",D365ProjectOperations:"",FileSystem:"",SQLAnalyticsPool:"",StorageAcount:"",BlobStorage:"",DatabaseView:"",Column:"",AzureDataExplorer:"",SortLinesAscending:"",TextDocumentEdit:"",VideoOff2:"",FastForwardPointFiveX:"",FastForwardOneX:"",FastForwardOneFiveX:"",FastForwardTwoX:"",FastForwardFourX:"",FastForwardEightX:"",RewindPointFiveX:"",RewindOneX:"",RewindOneFiveX:"",RewindTwoX:"",RewindFourX:"",RewindEightX:"",LockShare:"",LightningBoltSolid:"",Gather:"",AssignPolicy:"",CalculatorGroup:"",MobileAngled:"",CopyEdit:"",MostySunnyDay:"",PartlySunnyDay:"",IntermittentCloudsDay:"",HazyDay:"",Showers:"",MostyCloudyShowersDay:"",PartlySunnyShowersDay:"",MostyCloudyTStormsDay:"",PartlySunnyTStormsDay:"",MostyCloudyFlurriesDay:"",PartlySunnyFlurriesDay:"",Ice:"",Sleet:"",FreezingRain:"",MostyClearNight:"",PartlyClearNight:"",IntermittentCloudsNight:"",HazyNight:"",PartlySunnyShowersNight:"",MostyCloudyTStormsNight:"",PartlySunnyTStormsNight:"",MostyCloudyFlurriesNight:"",Sharepoint2013LogoInverse:"",OutlookSpacesBucket:"",CaretSolidAlt:"",PowerVirtualAgentsLogo:"",FluidLogo:"",FormProcessing:"",CategoryClassification:"",PhishingCampaign:"",PhishingHook:"",SecurityTest:"",OfficeCatchUp:"",GroupRemove:"",ReceiptProcessing:"",InboxActive:"",RingerActive:"",FlowTemplate:"",TextDocumentSettings:"",PowerAppsTemplate:"",TemporaryAccessPass:"",CtrlButton:"",DensityDefault:"",DensityComfy:"",ODLink12:"",TableColumn:"",CalculatedTable:"",ColumnSigma:"",ColumnQuestion:"",ColumnQuestionMirrored:"",ColumnFunction:"",PhotoBlock:"",EditTable:""}};Object(i.B)(n,t)}function s(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('".concat(e,"odsp-next-icons-2-7b0250ce.woff') format('woff')")},icons:{AddTable:"",AddField:"",CloudEdit:"",CloudLink:"",ExternalUser:"",OrderLock:"",MetricsUsage:"",MetricsInstall:"",MetricsFailure:"",CommunicationDetails:"",CommunicationDetailsMirrored:"",Variable3:"",SettingsSecure:"",LightningSecure:"",MailSecure:"",CloudSecure:"",IoTSecure:"",MicrosoftListsLogo48:"",TestAdd:"",WebAppBuilderFragmentLock:"",WebAppBuilderFragmentTest:"",WebAppBuilderModuleLock:"",WebAppBuilderModuleTest:"",TestRemove:"",SamsungGallery:"",PBIDirectQuery:"",PBIDual:"",PBIImport:"",PBILiveConnect:"",UserWindow:"",ObjectRecognition:"",ClipboardListAdd:"",ClipboardListQuestion:"",ClipboardListReply:"",SurveyQuestionResponse:"",DesktopFlow:"",DataEnrichment:"",NetworkDeviceScanning:"",D365CustomerVoiceApp:"",DiamondUser:"",FabricChannelFolder:"",ContentUnderstandingApp:"",KnowledgeManagementApp:"",TaskAdd:"",ZeroDayCalendar:"",PBIAnomaly:"",CareActivity:"",CarePlan:"",ClinicalImpression:"",Encounter:"",MedicalCare:"",MedicationAdmin:"",MedicationRequest:"",VaccinationRecent:"",XRay:"",BulkPageBlock:"",PBIAnomaliesMarker:"",Pronouns:"",ExpressRouteCircuits:"",ErrorBadge12:"",Completed12:"",Info12:"",ChevronUpEnd:"",PowerStandby:"",BusinessRule:"",DataFlow:"",ItalicC:"",BoldG:"",UnderlineS:"",BoldF:"",ItalicK:"",BoldN:"",UnderlineRussian:"",BoldRussion:"",FontStyleKorean:"",UnderlineKorean:"",ItalicKorean:"",BoldKorean:"",FontColorKorean:"",ProductWarning:"",SimplifiedView:"",Oauth:"",BoldBulgarian:"",BoldK:"",BoldP:"",BoldT:"",BoldKazakh:"",BoldSerbian:"",UnderlineSerbian:"",UnderlineA:"",UnderlineP:"",ItalicD:"",ItalicS:"",ItalicT:"",ItalicL:"",ItalicKazakh:"",InsertTextBoxKorean:"",StrikethroughKorean:"",PreviewBelow:"",PreviewSideBySide:""}};Object(i.B)(n,t)}function c(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('".concat(e,"odsp-next-icons-3-edd3ada3.woff') format('woff')")},icons:{LearningApp:"",ProcessAdvisor:"",CloudFlow:"",PBIReportTemplate:"",UpperCase:"",LowerCase:"",PeopleExternalShare:"",BorderNone:"",BorderInsideVertical:"",BorderInsideHorizontal:"",BorderInside:"",BorderAll:"",Bill:"",BusinessCard:"",PortalAppTemplate32:"",ModelAppTemplate32:"",CanvasAppTemplate32:"",ClipboardSync:"",ResizeImage:"",PasteImage:"",BrainCircuit:"",EthernetHero:"",SpotifyLogo:"",EditSettings:"",JapaneseIME:"",ChineseWubi:"",ChineseArray:"",ChineseDaYi:"",KoreanOldHangul:"",LaptopPhone:"",FilterAlt:"",Copyright:"",DevToolEdit:"",PlayReverseResumeSolid:"",PauseSolid:"",CopyPath:"",Home20:"",HomeSolid20:"",OEM20:"",OEMSolid20:"",XboxController20:"",XboxControllerSolid20:"",MyMoviesTV20:"",MyMoviesTVSolid20:"",Tag20:"",TagSolid20:"",Work20:"",WorkSolid20:"",Library20:"",LibrarySolid20:"",Unknown20:"",UnknownSolid20:"",SettingsStatusCircle:"",SettingsStatusTriangle:"",SettingsStatusError:"",SettingsStatusWarning:"",EALogo:"",Timer3Sec:"",DualScreenPhone:"",SurfaceEarbuds:"",DeviceEQ:"",NoiseSuppression:"",RectangleMarquee:"",Rotate180:"",InvertColor:"",OutlineColor:"",SetDesktop:"",EditListPencil:"",MediaAdjust:"",ActiveDockFloat:"",WifiProtected1:"",WifiProtected2:"",PlutonChip:"",InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",Phone:"",Shop:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Refresh:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",Favicon:"",Remove:"",Checkbox:"",CheckboxFill:""}};Object(i.B)(n,t)}function d(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('".concat(e,"odsp-next-icons-4-6e238232.woff') format('woff')")},icons:{CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",SwitchUser:"",Print:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",EaseOfAccess:"",UpdateRestore:"",ContactInfo:"",Memo:"",IncomingCall:"",Paste:"",WindowsLogo:"",GripperBarVertical:"",Unlock:"",Slideshow:"",Trim:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",OpenWith:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ViewOriginal:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:"",Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",SDCard:"",TVMonitor:"",Speakers:"",Game:"",HorizontalTabKey:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",Location:"",MapLayers:"",SearchNearby:"",Recent:""}};Object(i.B)(n,t)}function l(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('".concat(e,"odsp-next-icons-5-e665900a.woff') format('woff')")},icons:{Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",CortanaLogoOuter:"",CortanaLogoInner:"",ProvisioningPackage:"",FolderOpen:"",DefenderApp:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:"",Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",Priority:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",PostUpdate:"",NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",DockLeft:"",DockRight:"",Repair:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:""}};Object(i.B)(n,t)}function u(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('".concat(e,"odsp-next-icons-6-c50abfa0.woff') format('woff')")},icons:{ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",FlashAuto:"",Health:"",Webcam2:"",FrontCamera:"",ChevronUpSmall:"",ChevronUpMed:"",ChevronDownMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",HalfAlpha:"",ConstructionCone:"",XboxOneConsole:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",AddMultiple:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:"",Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",Invoice:"",ProjectManagement:"",Total:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Count:"",Freezing:"",FunnelChart:"",Process:"",Processing:"",ProcessMap:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",SummaryChart:"",HailDay:"",WorkFlow:""}};Object(i.B)(n,t)}function f(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('".concat(e,"odsp-next-icons-7-be89d64c.woff') format('woff')")},icons:{LightSnow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",Glasses:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",ContactInfoMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:"",HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",OpenWithMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",SyncError:"",Devices3:"",FlashOff:"",Focus:"",VideoLightOff:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",Vaccination:"",AddNotes:"",AllCurrency:"",BarChart3:"",BarChart4:"",CircleDollar:"",CirclePlus:"",Coffee:"",Cotton:"",Money:"",PieDouble:"",PieSingle:"",Rate:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",MSNVolume:"",Lamp:""}};Object(i.B)(n,t)}function p(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('".concat(e,"odsp-next-icons-8-466ba8e6.woff') format('woff')")},icons:{Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",SecurityCamera:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",EndPointSolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",XboxController:"",Devices4:"",NUIFace:"",AzureIcon:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",XboxLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:"",Certificate:"",FastForward:"",Rewind:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",Transportation:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",ReminderTime:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",MiracastLogoLarge:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioForWindowsAlt:"",MyNetwork:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeOldLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:"",MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:""}};Object(i.B)(n,t)}function m(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('".concat(e,"odsp-next-icons-9-5fd04ebc.woff') format('woff')")},icons:{Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",CloudNotSynced:"",AddMedium:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",Photo2Add:"",Photo2Remove:"",Calories:"",Distance:"",FacebookLogo:"",TwitterLogo:"",RemoveContent:"",AddTo:"",RemoveFrom:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",CreditCardBill:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Hot:"",FangBody:"",Toolbox:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",ScaleUp:"",ResetDevice:"",QRCode:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",Clipboard:"",ReturnToSession:"",CalendarMirrored:"",SwayLogoInverse:"",OutOfOffice:"",SkipBack10:"",SkipForward30:"",Trophy:"",RewardsLogo:"",RewardsLogoSolid:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",BoxLogo:"",DelveLogoInverse:"",DropboxLogo:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",ParatureLogo:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:""}};Object(i.B)(n,t)}function _(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('".concat(e,"odsp-next-icons-10-a01cb5d2.woff') format('woff')")},icons:{PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:"",AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:"",CloudSearch:"",ProgressRing5:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",GoogleDriveLogo:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",EmployeeSelfService:"",ProductionFloorManagement:"",ProductRelease:"",ProductVariant:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",AppsContent:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:""}};Object(i.B)(n,t)}function h(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('".concat(e,"odsp-next-icons-11-20ddf01b.woff') format('woff')")},icons:{FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:"",OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",GoToDashboard:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",RewardsLogoArt64:"",SearchArt64:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",Screen:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:"",CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",EmptyRecycleBin:"",Hide2:"",iOSAppStoreLogo:"",AndroidLogo:"",Breadcrumb:"",BirthdayCake:"",FixedAssetManagement:"",TimeEntry:"",MailLink:""}};Object(i.B)(n,t)}function b(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('".concat(e,"odsp-next-icons-12-38905b0f.woff') format('woff')")},icons:{CRMProcesses:"",PageBlock:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",MergeCase:"",CRMServices:"",EditContact:"",ConnectContacts:"",CRMLead:"",AppIconDefaultAdd:"",AppIconDefaultEdit:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ProductCatalog:"",ScatterChart:"",CustomActivity:"",ServiceActivity:"",AccountActivity:"",CustomEntity:"",DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",PageShared:"",SaveAndClose:"",Script:"",Archive:"",OneNoteDocType:"",MessageFriendRequest:"",ActivityFeed:"",Compare:"",EventDate:"",EditEvent:"",Opportunities:"",Quotes:"",ArrowUpRight:"",CaretRight:"",SetAction:"",ChatBot:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",PhotoVideoMedia:"",AddFavorite:"",AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",DefenderBadge12:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",ScreenPreviewOn:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:""}};Object(i.B)(n,t)}function g(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('".concat(e,"odsp-next-icons-13-cda5b0f1.woff') format('woff')")},icons:{StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",DialShape1:"",DialShape3:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CheckboxIndeterminateCombo:"",CaloriesAdd:"",BranchFork:"",MuteChat:"",AddHome:"",AddWork:"",ScreenTime:"",MobileReport:"",MixerLogo:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",Ribbon2:"",ToggleLeft:"",ToggleRight:"",FullView:"",FocusView:"",CircleShape:"",SquareShape:"",TriangleShape:"",DropShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",SingleColumn:"",DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",OneNoteLogo:"",CompactViewList:"",PowerPointLogo:"",ColumnList:"",PublisherLogo:"",CompactColumnList:"",ScheduleEventAction:"",FlameSolid:"",LocalAdmin:"",WindowConsole:"",ServerProcesses:"",RegistryEditor:"",Server:"",SaveAll:"",CostControl:"",CostContralLedgerAdmin:"",LinkedInLogo:"",Decimals:"",FilterAscending:"",FilterDescending:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",IOT:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewLarge:"",Title:"",TitleMirrored:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",LeftKey:""}};Object(i.B)(n,t)}function v(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('".concat(e,"odsp-next-icons-14-c885311a.woff') format('woff')")},icons:{RightKey:"",Clicked:"",TurnUserLeft:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",Insert:"",RingerRemove:"",TeamsLogoInverse:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioDocument:"",TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:"",BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:""}};Object(i.B)(n,t)}function y(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('".concat(e,"odsp-next-icons-15-f3086b17.woff') format('woff')")},icons:{CircleAddition:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:"",FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",Diploma:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:"",FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:""}};Object(i.B)(n,t)}function S(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('".concat(e,"odsp-next-icons-16-1fe7ee03.woff') format('woff')")},icons:{ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",EgnyteLogo:"",GoogleDriveLogoLeftGreen:"",GoogleDriveLogoBottomBlue:"",GoogleDriveLogoRightYellow:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",DateTime12:"",WordLogoInverse16:"",WordLogo16:"",PowerPointLogoInverse16:"",PowerPointLogo16:"",ExcelLogoInverse16:"",ExcelLogo16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OutlookLogoInverse16:"",OutlookLogo16:"",PublisherLogoInverse16:"",PublisherLogo16:"",VisioLogoInverse16:"",VisioLogo16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",D365CustomerInsights:"",EditCreate:"",UpKey:"",DownKey:"",PlayReverseResume:"",PlayReverse:"",SearchData:"",UnSetColor:"",AutoDeploySettings:"",ContactLock:"",HideVisualFilter:"",DeclineCall:"",RectangularClipping:"",TeamsLogo16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:""}};Object(i.B)(n,t)}function D(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('".concat(e,"odsp-next-icons-17-a09758e5.woff') format('woff')")},icons:{ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",CustomerAssets:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogo16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",MTMLogo:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogo16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:"",SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",NonprofitLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:"",CortanaLogoBeckonInner:"",CortanaLogoBeckonOuter:"",CortanaLogoReadyInner:"",CortanaLogoReadyOuter:"",ShowVisualFilter:"",WaffleOffice365:"",AddConnection:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:""}};Object(i.B)(n,t)}function I(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-18"',src:"url('".concat(e,"odsp-next-icons-18-d9da4454.woff') format('woff')")},icons:{UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:"",AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",ChronosLogo:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",GreetingCard:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:"",CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",DiagnosticDataViewerApp:"",ReportWarning:"",PlaySolid:"",TransitionPop:"",TransitionPush:"",TransitionEffect:""}};Object(i.B)(n,t)}function x(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-19"',src:"url('".concat(e,"odsp-next-icons-19-2d9512f1.woff') format('woff')")},icons:{LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioForWindows:"",ApacheIvyLogo32:"",BitbucketLogo32:"",LinuxLogo32:"",GradleLogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",ChevronDownEnd:"",FabricUserFolder:"",FabricNetworkFolder:"",BullseyeTarget:"",AnalyticsView:"",Video360Generic:"",Untag:"",RemoteApplication:"",Leave:"",DiagnosticDataBar:"",TimeEntryTemplate:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ContentSettings:"",DefaultSettings:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",GitLogo:"",GitHubLogo:"",ApacheMavenLogo:"",NPMLogo:"",GitFork:"",SVNLogo:"",JenkinsLogo:"",VersionControlPush:"",ExternalGit:"",StackedColumnChart2:"",StackedBarChartFull:"",TripleColumnWide:"",QuadColumn:"",SaveAndPublish:"",WhiteBoardApp16:"",WhiteBoardApp32:"",CaseSetting:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",LiveSite:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365CoreHR:"",BacklogList:"",ButtonControl:"",BullseyeTargetDelete:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:""}};Object(i.B)(n,t)}function C(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-20"',src:"url('".concat(e,"odsp-next-icons-20-5d66e90d.woff') format('woff')")},icons:{SaveTemplate:"",UserGauge:"",CRMResourceOptimizationApp32:"",WebSearch:"",TagSolid:"",OfficeChat:"",OfficeChatSolid:"",ReportAlert:"",ReportAlertMirrored:"",MailSchedule:"",Console:"",DataAnalysis:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicOff2:"",MicrosoftTranslatorLogo:"",Whiteboard:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:"",IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",XPowerY:"",RemoveFromShoppingList:"",ShieldAlert:"",StreamDiscover:"",FabricTextHighlightComposite:"",LearningTools:"",Dataflows:"",ShowGrid:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",GenericScanFilled:"",SnapToGrid:"",ContactList:"",SyncOccurenceCancel:"",NewMail:"",EyeShadow:"",Task:"",DockerLogo:"",JavaLogo:"",KeubernetesLogo:"",ReactLogo:""}};Object(i.B)(n,t)}function O(e,t){void 0===e&&(e="");var n={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-21"',src:"url('".concat(e,"odsp-next-icons-21-f34dfeaf.woff') format('woff')")},icons:{SwiftLogo:"",XamarinLogo:"",AmazonWebServicesLogo:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",VirtualNetwork:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:"",CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",D365BusinessCentral:"",PlainText:"",AccessibiltyChecker:"",OneDriveFileVault:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",BulletedTreeList:"",PythonLogoBlue:"",PythonLogoYellow:"",RustLanguageLogo:"",RubyGemsLogo:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",ExpandAll:"",CollapseAll:"",AddReaction:"",RevenueManagement:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2Mirrored:"",Spelling:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TrimStart:"",TrimEnd:"",TableComputed:"",UniteShape:"",SubtractShape:"",IntersectShape:""}};Object(i.B)(n,t)}var w="".concat(i.i,"/assets/icons");function E(e,t,n){void 0===e&&(e=w);var E=[];n||E.push(a.e),E.concat([r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O]).forEach(function(n){return n(e,t)}),Object(i.N)("trash","delete"),Object(i.N)("onedrive","onedrivelogo"),Object(i.N)("alertsolid12","eventdatemissed12"),Object(i.N)("sixpointstar","6pointstar"),Object(i.N)("twelvepointstar","12pointstar"),Object(i.N)("toggleon","toggleleft"),Object(i.N)("toggleoff","toggleright"),Object(i.N)("edgelogo","edgeoldlogo"),Object(i.N)("powerappscds","commondataservicecds"),Object(i.N)("d365talenthrcore","d365corehr"),Object(i.N)("crmcustomerinsightsapp","insights"),Object(i.N)("microsoftflowlogo","powerautomatelogo"),Object(i.N)("fabricmovetofolder","movetofolder"),Object(i.N)("fabricnewfolder","newfolder"),Object(i.N)("PinSolid","PinnedSolid"),Object(i.N)("PinOffSolid","Unpin"),Object(i.N)("BooleanData","CameraOff"),Object(i.N)("EditListPencil","Copyright"),Object(i.N)("StreamPlaylist","MediaAdjust"),Object(i.N)("ODSharedChannel","EALogo"),Object(i.N)("ODSharedChannel12","Timer3Sec"),Object(i.N)("LibraryAddTo","SpotifyLogo")}}],Array(161),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return j});var a=n(0),i=n(7),r=n(234),o=n(6),s=n(235),c=n(59),d=n(135),l=n(13),u=n(106),f=n(2890),p=n(256),m=n(898),_=n(1356),h=n(660),b=n(8),g=n(1362),v=!b.e.isActivated("5BCF2AC1-18A8-4EDB-A97B-7AF867936472","01/024/2023","Unauthenticated users should see Upload action, as it auto redirects anon users to sign in if they try"),y=!b.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),S=!b.e.isActivated("76B47336-9A12-412A-8CAF-3D347A89F015","03/07/2023","Hide report a concern command in sharedWithMe view for folders, as the API doesn't support folder type"),D=!b.e.isActivated("02521260-9CDF-4410-A3D8-27B8A32DFAAF","06/13/2023","Hide report a concern command in sharedWithMe view for oneNote file type"),I=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._userInfoProvider=n.userInfoProvider,a}return Object(a.__extends)(t,e),t.prototype.getCommandStates=function(e,t){var n,i,r,o,s,c,d,u,I=t.itemKey,k=Object(g.e)(e,{itemKey:I}),M=Object(a.__assign)(Object(a.__assign)({},Object(_.e)(e,I)),{isAuthenticated:this._userInfoProvider.isAuthenticated()});return k?((n={})[f.g]=Object(m.e)(M),n[f.b]=x(M),n[f.k]=E(M),n[f.I]=O(M),n[f.D]=C(M),n[f.z]=L(M),n[f.x]=w(M),n[f.B]=A(M),n):((i={})[f.e]=M.isAuthenticated?p.a.HAS_PERMISSION:p.a.NO_PERMISSION,i[f.t]=function(e){var t,n=e.driveItemResponse,a=e.isCoverImage,i=e.isOwner,r=e.isPhoto,o=e.isVideo,s="root"===(null===(t=null==n?void 0:n.parentReference)||void 0===t?void 0:t.id);return!i||!r&&!o||s||a?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.r]=(o=(r=M).driveItemResponse,s=r.isOwner,c=r.isPhoto,d=r.officeLensApplied,u=!!o.file&&o.file.mimeType&&o.file.mimeType.toLowerCase()===p.o,s&&c&&u&&!d?p.a.HAS_PERMISSION:p.a.NO_PERMISSION),i[f.n]=b.e.isActivated("79377716-95D1-43BA-AD2B-A4242532DB70","10/21/2021","Compute AddTag Property")?p.a.NO_PERMISSION:function(e){var t=e.canEdit,n=e.isAuthenticated,a=e.isPhoto,i=e.isVideo,r=e.isOwner;return n&&(a||i)&&t&&r?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.a]=function(e){var t=e.canEdit,n=e.isAuthenticated,a=e.isPhoto,i=e.isVideo,r=e.isOwner;return n&&(a||i)&&t&&r?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.i]=p.a.NO_PERMISSION,i[f.o]=p.a.NO_PERMISSION,i[f.s]=p.a.NO_PERMISSION,i[f.c]=function(e){var t=e.canMove,n=e.isAuthenticated,a=e.isOwner,i=e.isMounted,r=e.isMountPoint,o=e.isRoot,s=e.isSharerFolder,c=e.isBundle,d=e.driveItemResponse,l=d&&d.vault&&d.vault.root;return!n||!t||s||c||o||!a&&!i||r||l?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.d]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;return t?n?1:2:0}(M),i[f.l]=function(e){var t=e.canEdit,n=e.canCreateOfficeDocument,a=e.ownerUsesODF;return t&&n&&!a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.u]=p.a.NO_PERMISSION,i[f.f]=function(e){var t=e.canEdit,n=e.isFolder,a=e.isBundle,i=e.isMounted,r=e.isMountPoint,o=e.isOwner;return!t||!n||a||i||r||o?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.p]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;return y?t?n?1:2:0:t?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.m]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;return t?n?1:2:0}(M),i[f._]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;return t?n?1:2:0}(M),i[f.h]=Object(h.n)(M),i[f.b]=x(M),i[f.g]=Object(m.e)(M),i[f.v]=p.a.NO_PERMISSION,i[f.y]=function(e){var t=e.isRoot,n=e.isBundle,a=e.driveItemResponse,i=e.canEdit,r=a&&a.vault;return t||n||r||y&&!i?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.S]=p.a.NO_PERMISSION,i[f.D]=C(M),i[f.I]=O(M),i[f.x]=w(M),i[f.C]=function(e){var t=e.isAuthenticated,n=e.isOwner,a=e.isXBoxMusicSupportedExtension;return t&&n&&a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.O]=function(e){var t,n=e.driveItemResponse,a=e.isCoverImage,i=e.isOwner,r=e.isPhoto,o=e.isVideo,s="root"===(null===(t=null==n?void 0:n.parentReference)||void 0===t?void 0:t.id);return i&&(r||o)&&!s&&a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.w]=p.a.NO_PERMISSION,i[f.E]=p.a.NO_PERMISSION,i[f.A]=function(e){var t=e.canEdit,n=e.isMounted,a=e.isMountPoint;return t&&n&&a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.k]=E(M),i[f.L]=function(e){var t=e.isOwner,n=e.officeLensApplied;return t&&n?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.M]=function(e){var t=e.isAuthenticated,n=e.isRestricted,a=e.isOwner,i=e.isAdmin,r=e.isFolder,o=e.isOneNote;return!(t&&FilesConfig.rep||Object(l.isFeatureEnabled)(l.EnableAnonReportConcernCommand)&&!t)||n||a||i||S&&r||D&&o?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.P]=function(e){var t=e.isAuthenticated,n=e.isRestricted,a=e.isFolder,i=e.decision,r=e.isShared,o=e.isOwner,s=i.toLowerCase();return!a&&n&&r&&o&&s!==p.r[p.r.DMCARequest].toLowerCase()&&i!==p.r[p.r.TradeMarkViolation].toLowerCase()&&i!==p.r[p.r.LocalCountryLaw].toLowerCase()&&i!==p.r[p.r.OtherPermanentTakedown].toLowerCase()&&t?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.T]=p.a.NO_PERMISSION,i[f.U]=p.a.NO_PERMISSION,i[f.F]=function(e){var t=e.canEdit,n=e.driveItemResponse,a=e.fileExtension,i=e.isAuthenticated,r=e.isPhoto,o=!!n.file&&n.file.mimeType&&n.file.mimeType.toLowerCase()===p.o,s=a&&p.i.indexOf(a.toLowerCase())>-1;return i&&r&&t&&o&&s?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.H]=function(e){var t=e.canEdit,n=e.isAuthenticated,a=e.isRestricted,i=e.isOwner,r=e.isBundle,o=e.isRoot,s=e.driveItemResponse,c=s&&s.vault&&s.vault.root;return!n||a&&!i||!t||o||c?p.l.NO_PERMISSION:r?p.l.CAN_SHARE_COMMAND_STATE:p.l.CAN_MULTI_SHARE_COMMAND_STATE}(M),i[f.R]=p.a.NO_PERMISSION,i[f.N]=function(e){var t=e.canUpload,n=e.isAuthenticated,a=e.isBundle;return(n||v)&&t&&!a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}(M),i[f.B]=A(M),i[f.j]=function(e){var t=e.isRestricted,n=e.isOwner,a=e.isPanorama;return t&&!n||a?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}(M),i[f.V]=p.a.NO_PERMISSION,i[f.z]=L(M),i)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},c.n.dependencies),{userInfoProvider:u.A}),t}(c.n);function x(e){var t=e.canDelete,n=e.isOwner,a=e.isRestricted,i=e.isMountPoint,r=e.isMounted;return a&&!n||!t||i||!n&&!r?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}function C(e){var t=e.canEdit,n=e.isAuthenticated,a=e.isRoot;return n&&t&&!a?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}function O(e){var t=e.canMove,n=e.isAuthenticated,a=e.isOwner,i=e.isMounted,r=e.isMountPoint,o=e.isRoot,s=e.driveItemResponse,c=s&&s.vault&&s.vault.root;return!n||!t||o||c||!a&&!i||r?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}function w(e){var t=e.canEdit,n=e.isBadgerUser,a=e.isAdmin,i=e.isUserRoleFromViewToken,r=e.fileExtension;if(t&&!n&&!a&&!i){var o=p.c[r];if(o)return o}return p.a.NO_PERMISSION}function E(e){var t=e.canRename,n=e.isAuthenticated,a=e.isOwner,i=e.isMounted,r=e.isRoot,o=e.driveItemResponse,s=o&&o.vault&&o.vault.root;return n&&t&&!r&&(a||i)&&!s?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}function A(e){return e.isWacViewEnabled?p.a.HAS_PERMISSION:p.a.NO_PERMISSION}function L(e){var t=e.canEdit,n=e.isOwner,a=e.isWacViewEnabled,i=e.isOneNote,r=e.isFolder;return!t&&!n||!a||i||r?p.a.NO_PERMISSION:p.a.HAS_PERMISSION}var k=Object(d.r)("ItemCacheToKOStoreCommands",I),M=n(3446),P=n(1850),T=n(74),U=n(1547),F=n(145),H=n(43),R=n(939),N=n(309),B=n(36),j=new i.t({name:"OneDriveItemControlHandler",factory:{dependencies:{itemCacheToKOStoreCommands:k,itemResultProcessor:M.e,isUseItemsScopeInSharedEnabled:N.e},create:function(e){var t=e.itemCacheToKOStoreCommands,n=e.itemResultProcessor,i=e.isUseItemsScopeInSharedEnabled;return{instance:function(e,c){var d=c.itemKey,l=c.key,u=c.item;if(u){var f=u.queryType,p=e.demandItemFacet(F.e,d),m=Object(R.e)(e,d);p&&(f=H.e.AllMyPhotos),Object(P.default)(u,{virtualItemType:m,queryType:f})}var _=e.demandItemFacet(r.e,d);if(!u||!_)return{item:u};if(_.remoteItem){var h=_.remoteItem,b=Object(a.__rest)(_,["remoteItem"]);_=Object(T.n)(h,b),_=Object(T.n)(_,{remoteItem:h})}var g=function(e){var t=e.itemCache,n=e.itemKey,a=t.demandItemFacet(o.M,n);if(a){var i=t.demandItemFacet(s.t,a.itemKey);return i?i.key:void 0}}({itemCache:e,itemKey:d}),v=n.buildItemFromServerResponse({itemFromServer:_,key:l,parentKey:g}),y=function(e){var t=e.itemCache,n=e.itemKey,a=e.itemCacheToKOStoreCommands.getCommandStates(t,{itemKey:n}),i={};for(var r in a)0!==a[r]&&(i[r]="".concat(a[r]));return i}({itemCache:e,itemKey:d,itemCacheToKOStoreCommands:t});return{item:Object(T.n)(Object(P.default)(u,v),Object(a.__assign)({properties:{commandsSupported:new U.e(y)}},!B.e.isAuthenticated()&&i?{tokenNeedsRedeeming:!0}:{}))}}}}}})}],Array(25),[function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return S});var a=n(0),i=n(1),r=n(135),o=n(59),s=n(1107),c=n(1672),d=n(2699),l=n(3570),u=n(2359),f=n(2165),p=n(2698),m=n(244),_=n(1817),h=n(2273),b=n(1813),g=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t.prototype.getChildContext=function(){return{resize:this.props.resizeCallback,onDismiss:this.props.dismissCallback,sharingStore:this.props.sharingStore,platformDetection:this.props.platformDetection,shareClickTime:this.props.shareClickTime}},t.prototype.render=function(){var e=this.props.mentionProps;return i.createElement(b.e,{isClickableOutsideFocusTrap:!0},i.createElement(h.AtMention,Object(a.__assign)({},e)))},t.childContextTypes={resize:_.func.isRequired,onDismiss:_.func.isRequired,sharingStore:_.object.isRequired,platformDetection:_.object.isRequired,shareClickTime:_.number},t}(i.Component),v=n(1875),y=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._onCompleteGrantAccessCallback=function(e){a._statusCallback&&(e?a._statusCallback("share_grantAccessCompleted"):a._statusCallback())},a}return Object(a.__extends)(t,e),t.prototype.init=function(e,t){this._resources=e,this._item=t,this._platformDetection=this._resources.consume(m.e);var n=new u.e({},{dataRequestor:this._resources.consume(f.e)});this._store=new l.e({itemName:this._item.displayName,sharingService:n,itemId:this._item.id,itemUrl:this._item.openUrl,defaultRecipients:[],accessChecked:!0,mode:s.e.atMention},void 0),this._store.fetchSharingInformation(!0)},t.prototype.waitUntilReady=function(e){return void 0===e&&(e=0),Object(a.__awaiter)(this,void 0,void 0,function(){var t=this;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return e&&e>0?[4,new Promise(function(n){return t.async.setTimeout(n,e)})]:[3,2];case 1:n.sent(),n.label=2;case 2:return this._store.getSharingInformation()?[2,"ready"]:e>5e3?[2,"timeout"]:[4,this.waitUntilReady(2*e+100)];case 3:return[2,n.sent()]}})})},t.prototype.setDismissCallback=function(e){this._dismissCallback=e},t.prototype.setResizeCallback=function(e){this._resizeCallback=e},t.prototype.setStatusCallback=function(e){this._statusCallback=e},t.prototype.setGrantees=function(e){this._recipients=this._prepareRecipientPeopleFromGrantees(e)},t.prototype.renderGrantAccess=function(){return i.createElement(g,{mentionProps:this._getMentionProps(),dismissCallback:this._dismissCallback,statusCallback:this._statusCallback,resizeCallback:this._resizeCallback,sharingStore:this._store,platformDetection:this._platformDetection,shareClickTime:Date.now()})},t.prototype.getPeoplePickerQueryParams=function(e){return{allowEmailAddresses:!0,groupID:0,maximumEntitySuggestions:30,principalSource:15,principalType:v.e.user,useGraph:!0}},t.prototype.isShareAndNotifyDialogEnabled=function(e){return!0},t.prototype._getMentionProps=function(){return{clientId:c.e.odc,scenarioId:"Item Feed Grant Access",currentSettings:{allowEditing:!0,audience:d.e.anyone,expiration:new Date,hasPassword:!1,password:"",isEdit:!0,sharingLinkKind:p.e.direct,specificPeople:[],updatePassword:!1},sharingInformation:this._store.getSharingInformation(),recipients:this._recipients,onComplete:this._onCompleteGrantAccessCallback}},t.prototype._prepareRecipientPeopleFromGrantees=function(e){for(var t,n,a,i,r,o=[],s=0;s<e.length;s++){var c={name:(null===(t=e[s].user)||void 0===t?void 0:t.displayName)||(null===(n=e[s].user)||void 0===n?void 0:n.email),email:null===(a=e[s].user)||void 0===a?void 0:a.email,userId:(null===(i=e[s].user)||void 0===i?void 0:i.id)||(null===(r=e[s].user)||void 0===r?void 0:r.email),isResolved:!0};o.push(c)}return o},t}(o.n),S=(t.default=y,Object(r.r)("ItemActivityFeedSharingHelper",y))}])]);