(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([[707],{1561:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(115),r=n(64),o=n(153),s=n(488),c=n(94);function d(e){var t=this,n=e.progressItemKey,u=e.started,f=e.completed,p=e.progressSize,m=e.isBatch;return function(_){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,h,b,g,v,y,S;return Object(a.__generator)(this,function(D){switch(D.label){case 0:t={operation:d},h=l(e.onCreated,function(e){}),b=l(e.onStarted,function(e){var t;m||_(Object(c.e)({items:(t={},t[e.progressItemKey]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(r.a.started)),"number"==typeof p?Object(a.__assign)({},r.v.pack({total:0,current:0})):{}),t),publisher:b}))}),g=l(e.onCompleted,function(e){var t;m||_(Object(c.e)({items:(t={},t[n]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(r.a.completed)),"number"==typeof p?Object(a.__assign)({},r.v.pack({total:0,current:p})):{}),t),publisher:g}))}),v=l(e.onFailed,function(e){var t,n=e.error;m||_(Object(c.e)({items:(t={},t[e.progressItemKey]=Object(a.__assign)(Object(a.__assign)({},r.g.pack(n&&Object(o.n)(n)?r.a.canceled:r.a.failed)),n?Object(a.__assign)({},i.t.pack(n)):{}),t),publisher:v}))}),_(Object(s.e)({owner:t,items:(S={},S[n]={},S)})),h({progressItemKey:n}),D.label=1;case 1:return D.trys.push([1,4,5,6]),[4,u];case 2:return D.sent(),b({progressItemKey:n}),[4,f];case 3:return D.sent(),g({progressItemKey:n}),[3,6];case 4:return y=D.sent(),v({progressItemKey:n,error:y}),[3,6];case 5:return _(Object(s.n)({owner:t})),[7];case 6:return[2]}})})}}function l(e,t){return e?function(n,a){e(n,function(e){t(e,a)})}:t}},1565:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(1954),r=n(78),o=n(64),s=n(21),c=n(2),d=n(46),l=n(600),u=n(413),f=n(126),p=n(911),m=n(1784),_=n(180),h=n(1561);function b(e){var t=this,n=e.operationTypeFacet,b=e.progressKeyFacet,g=e.initializeBatch;return Object(f.t)(function(e){var f=e.items,v=Object(a.__rest)(e,["items"]);return function(y){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,S,D,I,x,C,O,w,E,A,L,k,M,P;return Object(a.__generator)(this,function(T){switch(T.label){case 0:for(t=l.e.serializeNext(),S=b.serializeBatchKey(t),D=y(Object(_.e)(function(e){for(var l,p,_=e.demandItemFacet(i.e,S),h=i.e.evaluate(_)(e,{progressItemKey:S,progressRootItemKey:u.e}),g=h.progressRootItemKey,v=h.itemControlHandler,y=h.onBatchCreated,D=h.onBatchCompleted,I=h.onBatchFailed,x={},C=[],O=new d.e,w=0,E=Object.keys(f);w<E.length;w++){var A=E[w],L=f[A],k=b.serializeTaskKey(t,A,L),M=e.demandItemFacet(i.t,k),P=i.t.evaluate(M,v)(e,{progressItemKey:k}),T=P.onItemCreated,U=P.onItemCompleted,F=P.onItemFailed;O.resolveItems({items:(l={},l[k]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.r.pack({itemKey:S})),o.y.pack({itemKey:A})),Object(c.n)({options:n},{options:L})),o.g.pack(o.a.created)),o.m.pack({onItemCreated:T,onItemCompleted:U,onItemFailed:F})),l)}),x[A]=Object(a.__assign)(Object(a.__assign)({},L),{progressItemKey:k}),C.push(k)}return O.resolveItems({items:(p={},p[g]=Object(c.n)({childItems:s.e},{childItems:{itemKeys:new m.e([S],function(e){return e})}}),p[S]=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},s.r.pack({itemKey:g})),Object(c.n)({childItems:s.e},{childItems:{itemKeys:new m.e(C,function(e){return e})}})),o.m.pack({onItemCreated:y,onItemCompleted:D,onItemFailed:I})),r.r.pack(!0)),p)}),{itemResolver:O,finalItems:x}},{evaluationContext:e.evaluationContext})),I=D.itemResolver,x=D.finalItems,y(I.execute()),g&&y(g({items:x,progressBatchKey:S})),C=y(Object(_.e)(function(e){return e.demandItemFacet(o.m,S)})),O=y(Object(p.e)(Object(a.__assign)(Object(a.__assign)({},v),{operationTypeFacet:n,items:x}))),w=O.started,E=O.completed,A=O.items,L=function(e){var n=f[e],i=b.serializeTaskKey(t,e,n),r=y(Object(_.e)(function(e){return e.demandItemFacet(o.m,i)}));y(Object(h.e)(Object(a.__assign)({progressItemKey:i,onCreated:null==r?void 0:r.onItemCreated,onStarted:null==r?void 0:r.onItemStarted,onCompleted:null==r?void 0:r.onItemCompleted,onFailed:null==r?void 0:r.onItemFailed},A[e])))},k=0,M=Object.keys(A);k<M.length;k++)P=M[k],L(P);return y(Object(h.e)({progressItemKey:S,started:w,completed:E,onCreated:null==C?void 0:C.onItemCreated,onStarted:null==C?void 0:C.onItemStarted,onCompleted:null==C?void 0:C.onItemCompleted,onFailed:null==C?void 0:C.onItemFailed,isBatch:!0})),[4,E];case 1:return T.sent(),[2]}})})}})}},1954:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(5),i=new a.e("progressItemOperation",{onItemCreated:a.t,onItemCompleted:a.t,onItemFailed:a.t}),r=new a.e("progressBatchOperation",{onBatchCreated:a.t,onBatchCompleted:a.t,onBatchFailed:a.t,progressRootItemKey:a.t,itemControlHandler:Object(a.n)(i)})},2491:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a=n(17);Object(a.n)([{rawString:".field_77b329c7{display:inline-block;box-sizing:border-box;max-width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.field_77b329c7.block_77b329c7{display:block}.pathSection_77b329c7{display:inline;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.pathSection_77b329c7{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .pathSection_77b329c7{color:HighlightText}}.chevron_77b329c7{font-size:12px;margin:3px 1px;transform:scale(.5);vertical-align:middle;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.chevron_77b329c7{color:WindowText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .chevron_77b329c7{color:HighlightText}}"}]);const i="field_77b329c7",r="block_77b329c7",o="pathSection_77b329c7",s="chevron_77b329c7"},2643:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"e",function(){return a});var a,i={applyPanel:"filtersPane-applyInPanel",pinnedToFiltersPaneChanged:"filtersPane-pinnedToFiltersPaneChanged",showInFiltersPaneChanged:"filtersPane-showInFiltersPaneChangedChanged",sectionInfosChanged:"filtersPane-sectionInfosChanged",canvasFilterChanged:"filtersPane-canvasFilterChanged"};function r(e){return e}!function(e){e[e.none=0]="none",e[e.last3Months=1]="last3Months",e[e.last30Days=2]="last30Days",e[e.last7Days=3]="last7Days",e[e.yesterday=4]="yesterday",e[e.today=5]="today",e[e.tomorrow=6]="tomorrow",e[e.next7Days=7]="next7Days",e[e.next30Days=8]="next30Days",e[e.next3Months=9]="next3Months",e[e.nextYear=10]="nextYear"}(a||(a={}))},2693:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("itemPathField",{displayPathSegments:a.t,openUrl:a.t,action:a.t})},2694:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(1),i=n(448),r=n(1719),o=n(50),s=n(40),c=n(2491),d=n(85),l=function(e){var t=e.displayPathSegments,n=e.parentLink,i=e.target,l=e.onClick,p=e.className,m="",_=[];if(t){var h=t.join(" ".concat(d.w," "));m=s.format(d.E,h),_=function(e,t,n){var a=[];if(!e.length)return a;var i=0,r=60,o="â€¦",s=e.map(function(e){return e.trim()}),c=s[0],d=s.length>=2?s[1]:"",l=d?c.length+d.length+3+o.length-r:0,p=s[s.length-1],m=c.length+p.length+2*(3+o.length)-r;if(c.length>r){var _=c.substr(0,59).trim()+o;a.push(u(_,++i,t))}else if(1===e.length||c.length+3+o.length>r||s.length>2&&c.length+2*(3+o.length)>r)a.push(u(c,++i,t));else if(2===s.length&&l>1)a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o+d.substr(l).trim(),++i,t));else if(s.length>2&&m>1){var h=p.substr(m).trim();a.push(u(c,++i,t)),a.push(f(++i,n)),a.push(u(o,++i,t)),h.length>0&&(a.push(f(++i,n)),a.push(u(o+h,++i,t)))}else{var b=0;a.push(u(c,++i,t)),b+=c.length;for(var g=1;g<e.length;++g){a.push(f(++i,n));var v=s[g];a.push(u(v,++i,t)),b+=3+v.length}for(b>r&&(s.splice(1,1),a.splice(2,1,u(o,++i,t)),b-=d.length-o.length);b>r;){var y=s.splice(1,1)[0];a.splice(3,2),b-=y.length+3}}return a}(t)}return l||n?a.createElement(r.e,{dir:"auto",className:Object(o.e)(c.n,p),"aria-label":m,href:n,target:i,onClick:l,title:d.A},_):a.createElement("div",{dir:"auto","aria-label":m,className:Object(o.e)(c.n,p)},_)};function u(e,t,n){return a.createElement("div",{key:t,className:Object(o.e)(c.a,n)},e)}function f(e,t){return a.createElement(i.e,{key:e,className:Object(o.e)(c.t,t),iconName:"ChevronRightSmall"})}},2882:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(0),i=n(269),r=n(89),o=n(1250),s=n(381);function c(e){var t=this,n=e.itemKey,c=e.itemSetKeyFacet,d=e.getUrl,l=e.sortChildItems,u=e.qosName,f=e.preprocessResponse,p=e.expectedErrors,m=e.disableRemoteItem,_=void 0!==m&&m,h=e.scenarioInfo,b=c.deserialize(n),g=b.driveItemKey,v=g.endpoint,y=g.driveId;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,c,m,g,S,D;return Object(a.__generator)(this,function(I){switch(I.label){case 0:t=Object(i.n)(b.driveItemKey),I.label=1;case 1:return I.trys.push([1,4,,5]),[4,n(Object(r.n)({url:d(b),driveUrl:t,driveId:y,qosName:"getChildren".concat(u?".".concat(u):""),endpoint:v,headers:e.additionalHeaders,expectedErrors:p,timeout:6e4,scenarioInfo:h}))];case 2:return c=I.sent(),m=Object(a.__spreadArray)([],c.value,!0),g=f&&f(m)||c.value,S=l&&l(g)||g,[4,n(Object(o.e)(Object(a.__assign)(Object(a.__assign)({},e),{disableRemoteItem:_,childItemsResponse:Object(a.__assign)(Object(a.__assign)({},c),{value:S})})))];case 3:return[2,{itemResolver:I.sent().itemResolver}];case 4:throw D=I.sent(),new s.e(Object(a.__assign)({code:"userContentMigrated"===D.code?D.code:"UnknownError",isExpected:"userContentMigrated"===D.code||D.isExpected},D instanceof Error?{innerError:D}:{message:JSON.stringify(D)}));case 5:return[2]}})})}}},2883:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(1),i=n(2694),r=n(2491),o=n(6),s=n(28),c=n(356),d=n(251),l=n(181),u=n(2693),f=[];function p(e,t){var n=t.itemKey,d=t.renderer,p=e.demandItemFacet(o.M,n),_=e.demandItemFacet(o.L,null==p?void 0:p.itemKey)||"",h=e.demandItemFacet(u.e,n),b=u.e.evaluate(h)(e,{itemKey:n,displayPathSegments:_?m(_):f,openUrl:_,action:p&&_?Object(l.a)(e,a.createElement(c.e,{itemKey:p.itemKey})):null}),g=b.displayPathSegments,v=void 0===g?f:g,y=b.action,S=b.openUrl;return{renderer:function(e,t,n){var o=d?d(e,t,n):null;return a.createElement(a.Fragment,null,o?a.createElement(a.Fragment,{key:"content"},o):null,v.length>0?a.createElement(s.n,{key:"path",action:y},function(t){var n=t.execute,o=t.isAvailable&&e.isInvokable?function(e){n({event:e}).catch(function(){}),e.preventDefault(),e.stopPropagation()}:void 0;return a.createElement(i.e,{className:r.e,displayPathSegments:v,parentLink:o?S:void 0,onClick:o})}):null)}}}function m(e){for(var t=[],n=0,a=new d.e(e).segments.slice(1);n<a.length;n++){var i=a[n];try{t.push(decodeURIComponent(i))}catch(e){t.push(i)}}return t}},2884:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(2),i=n(440),r=new a.e("removeItemsFromSharedList"),o=new i.e("removeItemsFromSharedList")},3126:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(318),r=n(2883),o=n(189),s=n(136),c=n(863),d=n(1262),l=n(1243),u=n(1244),f=n(1224),p=n(364),m=[r.e,f.t],_=Object(c.e)({key:o.s,name:i.c,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:s.a,data:{facets:Object(a.__assign)({},p.e.pack("nameAndPath"))}},Object(a.__spreadArray)(Object(a.__spreadArray)([d.e],m,!0),[l.e,u.e],!1))},3445:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(29),i=n(22),r=n(147),o=n(339),s=n(268),c=n(114),d=n(0),l=n(632);function u(e,t){var n=t.itemsScopeItemKey,a=t.engagement,i=a&&a.name;return{engagement:{objectType:"SharedWithMe",datasource:"Graph",extraData:Object(d.__assign)({},"ItemsView.Load"===i?Object(l.e)(e,{itemsScopeItemKey:n}):{})}}}function f(e,t){return{engagement:{currentPage:"SharedWithMe"}}}var p=Object(i.t)(function(){return function(e){e(Object(a.t)(c.e,r.e)(u)),e(Object(a.t)(s.e,r.e)(u)),e(Object(a.t)(c.e,o.e)(f))}})},3477:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3838),i=(a.T,a.l,a.F,a.H,a.U,a.i,a.p,a.L,a.C,a.M,a.P,a.k,a.v,a.E,a.y,a.g,a.I,a._,a.x,a.D,a.S,a.h,a.A,a.w,a.O,a.b,[a.r,a.a,a.c,a.e,a.d,a.s,a.o,a.t,a.m,a.f,a.u,a.n])},3479:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(114),i=n(268),r=n(418),o=n(503),s=n(3445),c=Object(o.e)(a.e,function(e){return function(){return{defaultChildItemSet:{itemKey:i.e.serialize({driveItemKey:e,sortBy:"",isAscending:!0})},displayName:r.s,icon:"People"}}},s.e)},3480:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(5),i=new a.e("removeFromShardListAction",{isAvailable:a.t})},5116:function(e,t,n){"use strict";n.r(t),n.d(t,"graphSharedWithMeWebAddon",function(){return kt});var a=n(22),i=n(245),r=n(363),o=n(1168),s=n(29),c=n(0),d=n(451),l=n(611),u=n(1189),f=n(1304),p=n(38),m=n(2),_=n(1),h=n(618),b=n(1276),g={action:_.createElement(p.t,null,_.createElement(b.t,null)),automationId:"removeShortcutFromSharedWithMeCommand",title:h._,iconProps:{iconName:"FabricFolderLink"},key:new m.e("RemoveShortcutFromSWM").id,name:h.m},v=n(52),y=n(83),S=n(124),D=n(28),I=n(41),x=n(19),C=n(3480),O=n(1565),w=n(2884),E=Object(O.e)({operationTypeFacet:w.t,progressKeyFacet:w.e}),A=n(63),L=n(268),k=Object(v.t)(function(e,t){var n=t.itemKeys,a=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,r=void 0===i?E:i,o=Object(y.e)(e)||"",s=e.demandItemFacet(L.e,o);if(0===n.length)return null;for(var d=s&&n.length<=200,l=a,u=0,f=n;u<f.length;u++){var p=f[u],m=e.demandItemFacet(C.e,p);C.e.evaluate(m)(e,{itemKey:p,isAvailable:!0}).isAvailable||(d=!1)}var h=e.dispatch,b=function(){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(c.__generator)(this,function(a){switch(a.label){case 0:return e={itemSetKey:o},t=Object(S.e)(n,function(){return e}),[4,h(r({items:t}))];case 1:return a.sent(),[2]}})})},g=Object(D.o)(function(e){return _.createElement(l,Object(c.__assign)({},e,{onItemRemoved:b,itemKeys:n}))});return _.createElement(I.e,Object(c.__assign)({isAvailable:d,onExecute:g},Object(A.t)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),M=Object(x.r)()(k),P=n(222),T=n(126),U=Object(P.e)(function(){return Object(c.__awaiter)(void 0,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(56,5304)];case 1:return[2,e.sent().RemoveFromSharedListWizard]}})})}),F=Object(T.t)(function(e){return function(t){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var a;return Object(c.__generator)(this,function(i){switch(i.label){case 0:return[4,n.ee(56,5304)];case 1:return a=i.sent().removeItemsFromSharedListWithProgress,[4,t(a(e))];case 2:return[2,i.sent()]}})})}}),H=Object(v.e)(function(){return{removeFromSharedListWizard:U,removeItemsFromSharedList:F}})(M),R={key:n(1374).e,automationId:"removeFromSharedListCommand",name:h.x,action:_.createElement(p.t,null,_.createElement(H,null)),iconProps:{iconName:"Cancel"}},N=n(273),B=n(1045),j=n(1399),V=Object(T.t)(function(e){return function(t){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var a;return Object(c.__generator)(this,function(i){switch(i.label){case 0:return[4,n.ee([247],5303)];case 1:return a=i.sent().addShortcutToAlbumsWithProgress,[4,t(a(e))];case 2:return[2,i.sent()]}})})}}),z=Object(v.t)(function(e,t){var n=t.itemKey;if(!n)return null;var a=e.dispatch,i=e.demandItemFacet(j.e,n),r=j.e.evaluate(i)(e,{itemKey:n,isAvailable:!1}).isAvailable;return _.createElement(I.e,Object(c.__assign)({isAvailable:r,onExecute:function(){return Object(c.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(c.__generator)(this,function(t){switch(t.label){case 0:return e={progressItemKey:n},[4,a(V({items:Object(S.e)([n],function(){return e})}))];case 1:return t.sent(),[2]}})})}},Object(A.t)(e,{itemKey:n,engagement:{name:"AddShortcutToAlbums",isIntentional:!0,extraData:{itemCount:1}}})))}),G=Object(x.r)()(Object(x.t)()(Object(x.a)()(z))),K={action:_.createElement(p.t,null,_.createElement(G,null)),automationId:"AddShortcutToAlbumsCommand",title:h.r,iconProps:{iconName:"FabricFolderLink"},key:new m.e("AddShortcutToAlbums").id,name:h.i},W=n(8),q=W.e.isActivated("8C2620EA-55C7-4436-8589-20C8ECF21325","05/23/2023","Add addShortcutToAlbums command in SWM view"),Q={name:"-",key:"divider_1",itemType:N.e.Divider};function Y(e,t){return{commands:Object(c.__spreadArray)(Object(c.__spreadArray)([B.t,d.n,d.t,Q,u.e,f.e,g],q?[]:[K],!0),[l.e,R],!1)}}var J=n(114);function X(e,t){return{commands:Object(c.__spreadArray)(Object(c.__spreadArray)([B.e,d.n,d.t,u.e,f.e,g],q?[]:[K],!0),[l.e,R],!1)}}var Z,$=n(227),ee=n(337),te=n(189),ne=n(89),ae=((Z={})[te.a]=!0,Z[te.n]=!0,Z[te.s]=!0,Z[ee.u]=!0,Z[ee.e]=!0,Z[ee.d]=!0,Z);function ie(e,t){return{isAvailable:!0,sortHandler:function(e,t){var n=t.itemSetKey,a=t.handler,i=a.columnKey,r=a.isAscending;if(!ae[i])return{};var o=e.demandItemFacet(L.e,n);if(!o)return{};var s=ee.a[i];if(!s)return{};var d=o.driveItemKey.endpoint,l=o.sortBy;return Object(ne.a)(e,d)&&!l&&i===te.n&&r?{newItemSetKey:n}:{newItemSetKey:L.e.serialize(Object(c.__assign)(Object(c.__assign)({},o),{sortBy:s,isAscending:r}))}}}}var re,oe=n(415),se=n(534),ce=n(1092);function de(e,t){var n=t.itemKey,a=e.demandItemFacet(L.e,n),i=a&&a.driveItemKey.endpoint,r=i&&a&&Object(ce.t)(e,{itemSetKey:L.e.serialize(a),parentItemKey:J.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(c.__assign)({},r?{stageItem:r}:{})}var le=((re={})[ee.u]=!0,re[ee.e]=!0,re);function ue(e,t){var n=t.itemSetKey,a=t.handler.columnKey;if(!le[a])return{};var i=e.demandItemFacet(L.e,n);if(!i)return{};var r=ee.a[a];return r?{newItemSetKey:L.e.serialize(Object(c.__assign)(Object(c.__assign)({},i),{groupBy:r}))}:{}}function fe(e,t){var n=t.itemSetKey,a=e.demandItemFacet(L.e,n);return a?{newItemSetKey:L.e.serialize(Object(c.__assign)(Object(c.__assign)({},a),{groupBy:void 0}))}:{}}var pe=n(3479),me=n(2882),_e=n(285),he=n(1559),be=n(695),ge=n(1042);function ve(e,t){var n=new Date(e.valueOf());return n.setDate(n.getDate()-t),n}var ye=n(2643),Se=new Map([["code",_e.e.text],["csv",_e.e.excel],["docx",_e.e.word],["dotx",_e.e.word],["one",_e.e.onenote],["onepkg",_e.e.onenote],["onetoc",_e.e.onenote],["pdf",_e.e.pdf],["photo",_e.e.media],["potx",_e.e.powerpoint],["ppsx",_e.e.powerpoint],["pptx",_e.e.powerpoint],["rtf",_e.e.text],["txt",_e.e.text],["video",_e.e.media],["xlsx",_e.e.excel],["xltx",_e.e.excel],["zip",_e.e.zip]]);function De(e,t,n){var a=e.lastModifiedDateTime,i=t.lastModifiedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function Ie(e,t,n){var a=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,r=a&&i&&new Date(a).getTime()-new Date(i).getTime()||0,o=a&&i&&new Date(i).getTime()-new Date(a).getTime()||0;return n?r:o}function xe(e,t,n){var a=e.name,i=t.name,r=a&&i&&a.localeCompare(i)||0,o=a&&i&&i.localeCompare(a)||0;return n?r:o}function Ce(e,t,n){var a,i,r,o,s,c,d=(null===(a=e.remoteItem)||void 0===a?void 0:a.shared)&&(null!==(i=e.remoteItem.shared.sharedBy)&&void 0!==i?i:e.remoteItem.shared.owner),l=null===(r=null==d?void 0:d.user)||void 0===r?void 0:r.displayName,u=(null===(o=t.remoteItem)||void 0===o?void 0:o.shared)&&(null!==(s=t.remoteItem.shared.sharedBy)&&void 0!==s?s:t.remoteItem.shared.owner),f=null===(c=null==u?void 0:u.user)||void 0===c?void 0:c.displayName,p=l&&f&&l.localeCompare(f)||0,m=l&&f&&f.localeCompare(l)||0;return n?p:m}function Oe(e,t,n,a){return function(e,i){return Object(c.__spreadArray)([],e,!0).sort(function(e,i){var r,o,s,c,d=e.folder||(null===(r=e.remoteItem)||void 0===r?void 0:r.folder)||(null===(o=e.remoteItem)||void 0===o?void 0:o.bundle),l=i.folder||(null===(s=i.remoteItem)||void 0===s?void 0:s.folder)||(null===(c=i.remoteItem)||void 0===c?void 0:c.bundle);return n&&d&&!l?-1:n&&!d&&l?1:a(e,i,t)})}(e)}var we=n(51),Ee=n(166),Ae=n(640),Le=n(58),ke=n(9),Me=n(31),Pe=n(15),Te=new Me.e("SharedByPersonKeyFacet",{displayName:Pe.e,email:Pe.e,id:Pe.e}),Ue=new Me.e("dateSharedGroupKeyFacet",{relativeTime:Pe.e,sharedDateTime:Pe.e}),Fe=new Me.e("relativeTimeGroupKeyFacet",{relativeTime:Pe.e}),He=n(46),Re=n(6),Ne=n(78),Be=n(21),je=n(4307),Ve=n(822),ze=n(40),Ge=n(53),Ke=n(3477);var We=n(870),qe=n(284),Qe=!W.e.isActivated("41661351-5554-42F2-8EF6-669335E500FF","05/09/2023","Reset oneDrive endpoint on 404 userContentMigrated error"),Ye=!W.e.isActivated("0a71cc8a-a9f5-4ba2-a877-159dc05ad1a6","06/28/2023","Change COB SWM api to select top 1000 items"),Je=[{code:"userContentMigrated"}],Xe=Object(a.i)()(function e(t){var n=this,a=L.e.deserialize(t.itemKey),i=a.filters,r=a.sortBy,o=a.isAscending;return function(a){return Object(c.__awaiter)(n,void 0,void 0,function(){var n,s,d,l,u,f,p,m,_,h,b,g,v,y;return Object(c.__generator)(this,function(S){switch(S.label){case 0:return n=function(e){if(L.e.matches(e)){var t=L.e.deserialize(e).groupBy;if(t===ee.a[ee.u])return function(e){var t={},n=function(a){for(var i,r,o=new He.e({publisher:n}),s=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Te.matches(i))return e;var r=Te.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return Te.serialize(e)})}(Object.keys(t)),d=[],l=0,u=s;l<u.length;l++){var f=u[l];if(Te.matches(f)){var p=Te.deserialize(f);o.resolveItems({items:(i={},i[f]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},Re.f.pack(p.displayName)),Ne.r.pack(!0)),Be.e.pack({itemKeys:t[f]})),i)}),d.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(c.__assign)(Object(c.__assign)({},Be.e.pack({itemKeys:d})),Ge.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a,i,r,o,s=e.driveItemKey,d=e.item;if(d&&s){var l=d.remoteItem,u=l&&l.shared&&(null!==(n=l.shared.sharedBy)&&void 0!==n?n:l.shared.owner),f=(null===(a=null==u?void 0:u.user)||void 0===a?void 0:a.displayName)||(null===(i=null==u?void 0:u.user)||void 0===i?void 0:i.email)||je.s,p=Object(c.__assign)(Object(c.__assign)({},null!==(r=null==u?void 0:u.user)&&void 0!==r?r:{}),{displayName:f}),m=ke.e.serialize(s),_=Te.serialize({displayName:p.displayName,email:p.email||"",id:p.id||""});o=_,t.hasOwnProperty(o)||(t[_]=[]),t[_].push(m)}},groupChildItems:n}}(e);if(t===ee.a[ee.e])return function(e){var t={},n=function(a){for(var i,r,o=new He.e({publisher:n}),s=function(e){for(var t={},n=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(!Ue.matches(i))return e;var r=Ue.deserialize(i);t.push(r)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return Ue.serialize(e)})}(Object.keys(e)),a=function(e){return t.hasOwnProperty(e)},i=0,r=n;i<r.length;i++){var o=r[i];if(Ue.matches(o)){var s=Ue.deserialize(o).relativeTime,c=Fe.serialize({relativeTime:s});if(a(c))for(var d=0,l=e[o];d<l.length;d++){var u=l[d];t[c].push(u)}else{t[c]=[];for(var f=0,p=e[o];f<p.length;f++)u=p[f],t[c].push(u)}}}return t}(t),d=[],l=0,u=Object.keys(s);l<u.length;l++){var f=u[l];if(Fe.matches(f)){var p=Fe.deserialize(f).relativeTime;o.resolveItems({items:(i={},i[f]=Object(c.__assign)(Object(c.__assign)(Object(c.__assign)({},Re.f.pack(p)),Ne.r.pack(!0)),Be.e.pack({itemKeys:s[f]})),i)}),d.push(f)}}return o.resolveItems({items:(r={},r[e]=Object(c.__assign)(Object(c.__assign)({},Be.e.pack({itemKeys:d})),Ge.e.pack(!0)),r)}),{itemResolver:o}};return{onProcessResponse:function(e){var n,a=e.driveItemKey,i=e.item;if(i&&a){var r=i.remoteItem,o=r&&r.shared&&r.shared.sharedDateTime,s=ke.e.serialize(a);if(o){var c=function(e,t){if(!e)return je.n;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return Ve.today;if(n.setDate(n.getDate()-1),e>=n)return Ve.yesterday;if(n.setDate(t.getDate()-t.getDay()),e>=n)return je.i;if(n.setDate(n.getDate()-7),e>n)return je.t;var a=new Date(t.getFullYear(),t.getMonth(),1);if(e>=new Date(t.getFullYear(),t.getMonth()-1,1)&&e<a)return je.e;if(n.setDate(n.getDate()-7),e>n)return je.o;if(n.setDate(n.getDate()-7),e>n)return je.r;if(e>=a)return je.a;var i=t.getFullYear()===e.getFullYear(),r=Ke.e[e.getMonth()];return i?r:ze.format(Ve.MonthAndYear,r,e.getFullYear())}(new Date(o),new Date),d=Ue.serialize({relativeTime:c,sharedDateTime:o});n=d,t.hasOwnProperty(n)||(t[d]=[]),t[d].push(s)}}},groupChildItems:n}}(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}(t.itemKey),s=n.onProcessResponse,d=n.groupChildItems,l=L.e.deserialize(t.itemKey),u=l.driveItemKey.endpoint,f=a(Object(Le.e)({graphSharedWithMeEndpoint:we.C,isUnauthenticated:Ae.e,convergenceConfiguration:Ee.e})),p=f.graphSharedWithMeEndpoint,m=f.isUnauthenticated,_=void 0!==m&&m,h=f.convergenceConfiguration,!W.e.isActivated("8D6592C3-9CFD-4B17-B0EC-F88A5B9B7EFA","01/17/2023","Do not query SWM if user is unauth")&&_?[2]:(u=p||u,p&&p!==l.driveItemKey.endpoint?(l=Object(c.__assign)(Object(c.__assign)({},l),{driveItemKey:Object(c.__assign)(Object(c.__assign)({},l.driveItemKey),{endpoint:p})}),[3,3]):[3,1]);case 1:return[4,a(Object(We.e)({endpoint:u}))];case 2:(b=S.sent())!==l.driveItemKey.endpoint&&(l=Object(c.__assign)(Object(c.__assign)({},l),{driveItemKey:Object(c.__assign)(Object(c.__assign)({},l.driveItemKey),{endpoint:b})})),S.label=3;case 3:return(g=a(Object(ne.i)(l.driveItemKey.endpoint)))&&!r&&(r=ee.s,o=!0),v=L.e.serialize(l),[4,a(Object(me.e)(Object(c.__assign)(Object(c.__assign)({},t),{qosName:"sharedWithMe",itemKey:v,itemSetKeyFacet:L.e,parentItemKeyFacet:J.e,disableRemoteItem:!1,getUrl:function(e){var t=e.driveItemKey.endpoint,n=Ye&&(null==h?void 0:h.isUserMigrated)?1e3:500;return g?"".concat(t,"/drive/oneDrive.sharedWithMe?select=*,webDavUrl"):b?"".concat(t,"/drive/sharedWithMe?expand=formats&allowExternal=true&$top=").concat(n).concat("&select=*,webDavUrl"):"".concat(t,"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=").concat(n).concat("&select=*,webDavUrl")},filterChildItems:function(e){return!function(e,t){return void 0===t&&(t=[]),t.every(function(t){var n,a=!("sharedByName"===t.type)||function(e,t){var n,a,i,r=(null===(n=e.remoteItem)||void 0===n?void 0:n.shared)&&(null!==(a=e.remoteItem.shared.sharedBy)&&void 0!==a?a:e.remoteItem.shared.owner),o=null===(i=null==r?void 0:r.user)||void 0===i?void 0:i.displayName;return!!o&&t.indexOf(o)>-1}(e,t.values),i=!("fileName"===t.type)||function(e,t){return!!e.name&&function(e,t){var n,a,i=(n=e,a=Object(he.t)(n,!0),Object(be.n)(a)),r=Se.get(i);return!!r&&Object(_e.t)(t.filters,r)}(e.name,t)}(e,Object(ge.t)(t.values)),r=!("dateModified"===t.type)||function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case ye.e.today:return n;case ye.e.yesterday:return ve(n,1);case ye.e.last7Days:return ve(n,7);case ye.e.last30Days:return ve(n,30);case ye.e.last3Months:return ve(n,90);default:return new Date(0)}}((n=t.values).length<1||-1===Object.keys(ye.e).indexOf(n[0])?ye.e.none:ye.e[n[0]]));return a&&i&&r})}(e,i)},sortChildItems:function(e){return function(e,t,n,a){void 0===a&&(a=!1);var i=ee.a[ee.e],r=ee.a[ee.u],o=ee.a[te.a],s=ee.a[te.n],c=ee.a[ee.d],d=ee.a[te.s];switch(t){case i:return Oe(e,n,a,Ie);case r:return Oe(e,n,a,Ce);case o:case s:case d:return Oe(e,n,a,xe);case c:return Oe(e,n,a,De);default:return e}}(e,r,o,!0)},onProcessResponse:function(e){var t,n,a;if(s&&s(e),!W.e.isActivated("D5DE03D9-65F1-4DBC-ACED-1454D5E5B534","02/06/2023","Call setMigrationState for all migrated drives in SWM")){var i=e.item,r=!!(null===(t=null==i?void 0:i.remoteItem)||void 0===t?void 0:t.sharepointIds),o=null===(a=null===(n=null==i?void 0:i.remoteItem)||void 0===n?void 0:n.parentReference)||void 0===a?void 0:a.driveId;h&&r&&o&&h.setMigrationState(o,!0)}},groupChildItems:d,mapItemSetKey:function(){var n,a=new He.e({publisher:e});return a.mapKeys({mappings:(n={},n[v]=t.itemKey,n)}),{itemResolver:a}},additionalHeaders:Qe?{Prefer:"Migration=EnableRedirect;FailOnMigratedFiles"}:void 0,expectedErrors:Je,scenarioInfo:{scenario:qe.e.PopulateSharedWithMe,scenarioType:qe.t.ActiveUserOperation}})))];case 4:return y=S.sent().itemResolver,a(y.execute()),[2]}})})}}),Ze=n(94),$e=n(294),et=n(3445),tt=Object(a.t)(function(){return function(e){e(Object(Ze.t)({keyFacet:L.e,facets:[L.e,Be.e]})),e(pe.e),e(Object(i.t)(L.e,$e.e)(Xe)),e(et.e)}}),nt=n(622),at=n(3126),it=n(507),rt=n(1155),ot=n(3296),st=n(136),ct=n(454),dt=n(1047),lt=n(34),ut=n(197),ft=Object(st.i)({name:ot.e,key:ee.e,fieldName:"",minWidth:st.e.regularMin,maxWidth:st.e.regularMax,isCollapsable:!0,sortProps:st.t},dt.e)(function(e,t){var n=e.demandItemFacet(ct.e,t),a=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof a||isNaN(a))return{text:""};var i=e.demandItemFacet(lt.k,ut.e),r=(null==i?void 0:i.cultureLCID)||(null==i?void 0:i.language)||window.navigator.language;return r?{text:Object(rt.n)(new Date(a),r)}:{dateValue:a}}),pt=n(1287),mt=n(272),_t=n(1389),ht=n(906),bt=new Me.e("topCollaboratorSetKeyFacet",{endpoint:Pe.e}),gt=n(1551),vt=n(448),yt=n(1695),St=n(4308),Dt=n(17);Object(Dt.n)([{rawString:".topCollaPlaceHolder_f0c2bf25{display:flex;min-width:13px;height:21px}[dir=ltr] .topCollaPlaceHolder_f0c2bf25{padding-right:10px}[dir=rtl] .topCollaPlaceHolder_f0c2bf25{padding-left:10px}.topCollaboratorIcon_f0c2bf25{color:#0078d4;font-size:13px;line-height:21px;text-align:center}.topCollaboratorUserName_f0c2bf25{font-weight:700}.topCollaboratorTooltip_f0c2bf25{padding:0 2px}.userWithTopCollaborator_f0c2bf25{display:flex}.userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{min-width:13px}[dir=ltr] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-right:7px}[dir=rtl] .userWithTopCollaborator_f0c2bf25 .topCollaPlaceHolder_f0c2bf25{padding-left:7px}[dir=ltr] .columnHeader_f0c2bf25{margin-left:20px}[dir=rtl] .columnHeader_f0c2bf25{margin-right:20px}"}]);var It=function(e){function t(t){return e.call(this,t)||this}return Object(c.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,a=_.createElement(vt.e,{className:"topCollaboratorIcon_f0c2bf25",iconName:"TeamFavorite"}),i=_.createElement("span",{className:"topCollaboratorUserName_f0c2bf25"},t),r=_.createElement("div",{className:"topCollaboratorTooltip_f0c2bf25"},ze.formatToArray(St.e,i));return _.createElement("div",{className:"topCollaPlaceHolder_f0c2bf25"},n?null:t?_.createElement(yt.e,{content:r},a):a)},t}(gt.e),xt=Object(st.i)({name:ot.a,key:ee.u,fieldName:"",minWidth:st.e.regularMin,maxWidth:st.e.regularMax,isCollapsable:!0,sortProps:st.a,headerClassName:"columnHeader_f0c2bf25"},pt.e)(function(e,t){var n,a=e.demandItem({shareByPerson:_t.e},t).shareByPerson,i=e.demandItem({sharedBy:ct.e},t).sharedBy,r=null==a?void 0:a.itemKey,o=i&&(null!==(n=i.sharedBy)&&void 0!==n?n:i.owner),s=(null==a?void 0:a.displayValue)||o&&o.user&&o.user.displayName,c=!1;if(r&&ht.e.matches(r)){var d=ht.e.deserialize(r).email,l=e.demandItemFacet(Be.e,bt.serialize({endpoint:"https://graph.microsoft.com/beta"}));l&&(c=l.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(mt.e,t);return!!n&&n===d}))}return r||s?{people:[{itemKey:r||"",displayValue:s}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),a=e.user;return _.createElement("div",{className:"userWithTopCollaborator_f0c2bf25"},_.createElement(It,{userName:a.title,isPlaceholder:!c}),n)}}:{people:[]}},function(e,t){return"".concat(e.demandItemFacet(mt.e,t))});function Ct(e,t){var n=t.itemSetKey,a=!1,i=e.demandItemFacet(L.e,n);if(i){var r=i.driveItemKey.endpoint;a=Object(ne.a)(e,r)}return{columns:Object(c.__spreadArray)(Object(c.__spreadArray)([],a?[nt.e,it.t,ft]:[nt.t,at.e,ft],!0),[xt],!1)}}var Ot=n(384),wt=new Me.e("topCollaboratorItemKeyFacet",{id:Pe.e}),Et=Object(a.i)()(function e(t){var n=this,a=t.itemKey;return function(i){return Object(c.__awaiter)(n,void 0,void 0,function(){var n,r,o,s,d,l,u,f,p,m,_,h,b,g,v,y;return Object(c.__generator)(this,function(S){switch(S.label){case 0:return n=new He.e({publisher:e}),r=i(Object(Le.e)({graphEndpoint:we.y})).graphEndpoint,o=bt.deserialize(a),s=r||o.endpoint,d="".concat(s,"/me/people/"),[4,i(Object(ne.t)({url:d,qosName:"getTopCollaborator",endpoint:s}))];case 1:for(l=S.sent(),u=[],f=0,p=l.value;f<p.length;f++)m=p[f],_=m.id,h=m.displayName,b=m.userPrincipalName,g=wt.serialize({id:_}),i(Object(Ze.e)({items:(v={},v[g]=Object(c.__assign)(Object(c.__assign)({},Re.f.pack(h)),mt.e.pack(b)),v)})),u.push(g);return n.resolveItems({items:(y={},y[t.itemKey]=Object(c.__assign)({},Be.e.pack({itemKeys:u})),y)}),i(n.execute()),[2]}})})}});function At(e,t){return{isAvailable:!1}}function Lt(e,t){return{isAvailable:!1}}var kt=Object(a.t)(function(){return function(e){e(tt),e(Object(s.t)(J.e,r.e)(X)),e(Object(s.t)(J.e,o.e)(Y)),e(Object(s.t)(L.e,$.t)(ie)),e(Object(s.t)(L.e,oe.e)(de)),e(Object(s.t)(L.e,se.e)(ue)),e(Object(s.t)(L.e,se.t)(fe)),e(Object(s.t)(L.e,Ot.e)(Ct)),e(Object(s.t)(Te,oe.e)(At)),e(Object(s.t)(Fe,oe.e)(Lt)),e(Object(i.t)(bt,$e.e)(Et))}})}}]);